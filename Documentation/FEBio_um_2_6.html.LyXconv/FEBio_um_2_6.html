<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<meta name="generator" content="http://www.nongnu.org/elyxer/"/>
<meta name="create-date" content="2017-01-18"/>
<link rel="stylesheet" href="http://elyxer.nongnu.org/lyx.css" type="text/css" media="all"/>
<title>Converted document</title>
<script type="text/javascript"
  src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
</head>
<body>
<div id="globalWrapper">
<script type="math/tex">
\newcommand{\lyxlock}{}
</script>
<noscript>
<div class="warning">
Warning: <a href="http://www.mathjax.org/">MathJax</a> requires JavaScript to correctly process the mathematics on this page. Please enable JavaScript on your browser.
</div><hr/>
</noscript>
<h1 class="title">
<img class="embedded" src="Figures/FigFEBioTitle.png" alt="figure Figures/FigFEBioTitle.png" style="width: 4.88in; max-width: 573px; height: auto; max-height: 206px;"/>
<b><br/>User’s Manual Version 2.6</b>
</h1>
<h2 class="Date">
<b>Last Updated: December 21, 2016</b>
</h2>
<div class="Unindented">
<p><br/>
</p>

</div>
<div class="Paragraph-">
<a class="toc" name="toc-Paragraph--1"></a>Contributors<br/>
</div>
<div class="Unindented">
Steve Maas (<a href="mailto:steve.maas@utah.edu">steve.maas@utah.edu</a>)<br/>Dave Rawlins (<a href="mailto:rawlins@sci.utah.edu">rawlins@sci.utah.edu</a>)<br/>Dr. Jeffrey Weiss (<a href="mailto:jeff.weiss@utah.edu">jeff.weiss@utah.edu</a>)<br/>Dr. Gerard Ateshian (<a href="mailto:ateshian@columbia.edu">ateshian@columbia.edu</a>)
</div>
<div class="Paragraph-">
<a class="toc" name="toc-Paragraph--2"></a>Contact address<br/>
</div>
<div class="Unindented">
Musculoskeletal Research Laboratories, University of Utah<br/>72 S. Central Campus Drive, Room 2646<br/>Salt Lake City, Utah
</div>
<div class="Paragraph-">
<a class="toc" name="toc-Paragraph--3"></a>Website<br/>
</div>
<div class="Unindented">
MRL: <a href="http://mrl.sci.utah.edu">http://mrl.sci.utah.edu</a><br/>FEBio: <a href="http://febio.org">http://febio.org</a>
</div>
<div class="Paragraph-">
<a class="toc" name="toc-Paragraph--4"></a>Forum<br/>
</div>
<div class="Unindented">
<a href="http://mrlforums.sci.utah.edu/forums/">http://mrlforums.sci.utah.edu/forums/</a>
</div>
<div class="Paragraph-">
<a class="toc" name="toc-Paragraph--5"></a>Acknowledgments<br/>
</div>
<div class="Unindented">
Development of the FEBio project is supported in part by a grant from the U.S. National Institutes of Health (R01GM083925).
</div>
<div class="Indented">
<img class="embedded" src="Figures/NIHlogo.png" alt="figure Figures/NIHlogo.png" style="width: auto; max-width: 841px; height: 0.75in; max-height: 650px;"/>

</div>
<div class="fulltoc">
<div class="tocheader">
Table of Contents
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Chapter-1">Chapter 1: Introduction</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Section-1.1">Section 1.1: Overview of FEBio</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Section-1.2">Section 1.2: About this document</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Section-1.3">Section 1.3: Units in FEBio</a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Chapter-2">Chapter 2: Running FEBio</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Section-2.1">Section 2.1: Running FEBio on Windows</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsection-2.1.1">Subsection 2.1.1: Windows XP</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-2.1.2">Subsection 2.1.2: Windows 7</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-2.1.3">Subsection 2.1.3: Running FEBio from Explorer</a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Section-2.2">Section 2.2: Running FEBio on Linux or MAC</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Section-2.3">Section 2.3: The Command Line</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Section-2.4">Section 2.4: The FEBio Prompt</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Section-2.5">Section 2.5: The Configuration File</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Section-2.6">Section 2.6: Using Multiple Processors</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Section-2.7">Section 2.7: FEBio Output</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Section-2.8">Section 2.8: Advanced Options</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsection-2.8.1">Subsection 2.8.1: Interrupting a Run</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-2.8.2">Subsection 2.8.2: Debugging a Run</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-2.8.3">Subsection 2.8.3: Restarting a Run</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-2.8.4">Subsection 2.8.4: Input File Checking</a>
</div>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Chapter-3">Chapter 3: Free Format Input</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Section-3.1">Section 3.1: Free Format Overview</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Section-3.2">Section 3.2: Format Specification Versions</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Section-3.3">Section 3.3: Multiple Input Files</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsection-3.3.1">Subsection 3.3.1: Include Keyword</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-3.3.2">Subsection 3.3.2: The ‘from’ Attribute</a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Section-3.4">Section 3.4: Module Section</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Section-3.5">Section 3.5: Control Section</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsection-3.5.1">Subsection 3.5.1: Common Parameters</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-3.5.2">Subsection 3.5.2: Parameters for Biphasic Analysis</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-3.5.3">Subsection 3.5.3: Parameters for Solute Analysis</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-3.5.4">Subsection 3.5.4: Parameters for Heat Analysis</a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Section-3.6">Section 3.6: Globals Section</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsection-3.6.1">Subsection 3.6.1: Constants</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-3.6.2">Subsection 3.6.2: Solutes</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-3.6.3">Subsection 3.6.3: Solid-Bound Molecules</a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Section-3.7">Section 3.7: Material Section</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Section-3.8">Section 3.8: Geometry Section</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsection-3.8.1">Subsection 3.8.1: Nodes Section</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-3.8.2">Subsection 3.8.2: Elements Section</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection-3.8.2.1">Subsubsection 3.8.2.1: Solid Elements</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-3.8.2.2">Subsubsection 3.8.2.2: Shell Elements</a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-3.8.3">Subsection 3.8.3: NodeSet Section</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-3.8.4">Subsection 3.8.4: Edge Section</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-3.8.5">Subsection 3.8.5: Surface Section</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-3.8.6">Subsection 3.8.6: DiscreteSet Section</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-3.8.7">Subsection 3.8.7: ElementSet Section</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-3.8.8">Subsection 3.8.8: SurfacePair Section</a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Section-3.9">Section 3.9: MeshData Section</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsection-3.9.1">Subsection 3.9.1: ElementData</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-3.9.2">Subsection 3.9.2: SurfaceData</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-3.9.3">Subsection 3.9.3: EdgeData</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-3.9.4">Subsection 3.9.4: NodeData</a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Section-3.10">Section 3.10: Initial Section</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Section-3.11">Section 3.11: Boundary Section</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsection-3.11.1">Subsection 3.11.1: Prescribed Nodal Degrees of Freedom</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-3.11.2">Subsection 3.11.2: Fixed Nodal Degrees of Freedom</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-3.11.3">Subsection 3.11.3: Rigid Nodes</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-3.11.4">Subsection 3.11.4: Prescribed Rigid Body Degrees of Freedom</a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Section-3.12">Section 3.12: Loads Section</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsection-3.12.1">Subsection 3.12.1: Nodal Loads</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-3.12.2">Subsection 3.12.2: Surface Loads</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection-3.12.2.1">Subsubsection 3.12.2.1: Pressure Load</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-3.12.2.2">Subsubsection 3.12.2.2: Traction Load</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-3.12.2.3">Subsubsection 3.12.2.3: Mixture Normal Traction</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-3.12.2.4">Subsubsection 3.12.2.4: Fluid Flux</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-3.12.2.5">Subsubsection 3.12.2.5: Solute Flux</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-3.12.2.6">Subsubsection 3.12.2.6: Heat Flux</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-3.12.2.7">Subsubsection 3.12.2.7: Convective Heat Flux</a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-3.12.3">Subsection 3.12.3: Body Loads</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection-3.12.3.1">Subsubsection 3.12.3.1: Constant Body Force</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-3.12.3.2">Subsubsection 3.12.3.2: Non-Constant Body Force</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-3.12.3.3">Subsubsection 3.12.3.3: Centrifugal Force</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-3.12.3.4">Subsubsection 3.12.3.4: Heat Source</a>
</div>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Section-3.13">Section 3.13: Contact Section</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsection-3.13.1">Subsection 3.13.1: Sliding Interfaces</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-3.13.2">Subsection 3.13.2: Biphasic Contact</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-3.13.3">Subsection 3.13.3: Biphasic-Solute and Multiphasic Contact</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-3.13.4">Subsection 3.13.4: Rigid Wall Interfaces</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-3.13.5">Subsection 3.13.5: Tied Interfaces</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-3.13.6">Subsection 3.13.6: Tied Biphasic Interfaces</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-3.13.7">Subsection 3.13.7: Sticky Interfaces</a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Section-3.14">Section 3.14: Constraints Section</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsection-3.14.1">Subsection 3.14.1: Rigid Joints</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection-3.14.1.1">Subsubsection 3.14.1.1: Rigid Revolute Joint</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-3.14.1.2">Subsubsection 3.14.1.2: Rigid Prismatic Joint</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-3.14.1.3">Subsubsection 3.14.1.3: Rigid Cylindrical Joint</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-3.14.1.4">Subsubsection 3.14.1.4: Rigid Spherical Joint</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-3.14.1.5">Subsubsection 3.14.1.5: Rigid Planar Joint</a>
</div>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Section-3.15">Section 3.15: Rigid Connectors</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsection-3.15.1">Subsection 3.15.1: Rigid Spring</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-3.15.2">Subsection 3.15.2: Rigid Damper</a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Section-3.16">Section 3.16: Discrete Section</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsection-3.16.1">Subsection 3.16.1: Discrete Materials</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-3.16.2">Subsection 3.16.2: Discrete Section</a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Section-3.17">Section 3.17: LoadData Section</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Section-3.18">Section 3.18: Output Section</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsection-3.18.1">Subsection 3.18.1: Logfile</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection-3.18.1.1">Subsubsection 3.18.1.1: Node_Data Class</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-3.18.1.2">Subsubsection 3.18.1.2: Element_Data Class</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-3.18.1.3">Subsubsection 3.18.1.3: Rigid_Body_Data Class</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-3.18.1.4">Subsubsection 3.18.1.4: Rigid_Connector_Data Class</a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-3.18.2">Subsection 3.18.2: Plotfile</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection-3.18.2.1">Subsubsection 3.18.2.1: Plotfile Variables</a>
</div>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Section-3.19">Section 3.19: Parameters Section</a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Chapter-4">Chapter 4: Materials</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Section-4.1">Section 4.1: Elastic Solids</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsection-4.1.1">Subsection 4.1.1: Specifying Fiber Orientation or Material Axes</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.1.1.1">Subsubsection 4.1.1.1: Transversely Isotropic Materials</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.1.1.2">Subsubsection 4.1.1.2: Orthotropic Materials</a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-4.1.2">Subsection 4.1.2: Uncoupled Materials</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.1.2.1">Subsubsection 4.1.2.1: Arruda-Boyce</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.1.2.2">Subsubsection 4.1.2.2: Ellipsoidal Fiber Distribution</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.1.2.3">Subsubsection 4.1.2.3: Ellipsoidal Fiber Distribution Mooney-Rivlin</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.1.2.4">Subsubsection 4.1.2.4: Ellipsoidal Fiber Distribution Veronda-Westmann</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.1.2.5">Subsubsection 4.1.2.5: Fiber with Exponential-Power Law, Uncoupled Formulation</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.1.2.6">Subsubsection 4.1.2.6: Fiber with Toe-Linear Response, Uncoupled Formulation</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.1.2.7">Subsubsection 4.1.2.7: Fung Orthotropic</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.1.2.8">Subsubsection 4.1.2.8: Mooney-Rivlin</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.1.2.9">Subsubsection 4.1.2.9: Muscle Material</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.1.2.10">Subsubsection 4.1.2.10: Ogden</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.1.2.11">Subsubsection 4.1.2.11: Tendon Material</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.1.2.12">Subsubsection 4.1.2.12: Tension-Compression Nonlinear Orthotropic</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.1.2.13">Subsubsection 4.1.2.13: Transversely Isotropic Mooney-Rivlin</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.1.2.14">Subsubsection 4.1.2.14: Transversely Isotropic Veronda-Westmann</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.1.2.15">Subsubsection 4.1.2.15: Uncoupled Solid Mixture</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.1.2.16">Subsubsection 4.1.2.16: Veronda-Westmann</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.1.2.17">Subsubsection 4.1.2.17: Mooney-Rivlin Von Mises Distributed Fibers</a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-4.1.3">Subsection 4.1.3: Compressible Materials</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.1.3.1">Subsubsection 4.1.3.1: Carter-Hayes</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.1.3.2">Subsubsection 4.1.3.2: Cell Growth</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.1.3.3">Subsubsection 4.1.3.3: Cubic CLE</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.1.3.4">Subsubsection 4.1.3.4: Donnan Equilibrium Swelling</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.1.3.5">Subsubsection 4.1.3.5: Ellipsoidal Fiber Distribution</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.1.3.6">Subsubsection 4.1.3.6: Ellipsoidal Fiber Distribution Neo-Hookean</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.1.3.7">Subsubsection 4.1.3.7: Ellipsoidal Fiber Distribution with Donnan Equilibrium Swelling</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.1.3.8">Subsubsection 4.1.3.8: Fiber with Exponential-Power Law</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.1.3.9">Subsubsection 4.1.3.9: Fiber with Toe-Linear Response</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.1.3.10">Subsubsection 4.1.3.10: Fung Orthotropic Compressible</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.1.3.11">Subsubsection 4.1.3.11: Holmes-Mow</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.1.3.12">Subsubsection 4.1.3.12: Isotropic Elastic</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.1.3.13">Subsubsection 4.1.3.13: Orthotropic Elastic</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.1.3.14">Subsubsection 4.1.3.14: Orthotropic CLE</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.1.3.15">Subsubsection 4.1.3.15: Osmotic Pressure from Virial Expansion</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.1.3.16">Subsubsection 4.1.3.16: Neo-Hookean</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.1.3.17">Subsubsection 4.1.3.17: Coupled Mooney-Rivlin</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.1.3.18">Subsubsection 4.1.3.18: Coupled Veronda-Westmann</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.1.3.19">Subsubsection 4.1.3.19: Ogden Unconstrained</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.1.3.20">Subsubsection 4.1.3.20: Perfect Osmometer Equilibrium Osmotic Pressure</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.1.3.21">Subsubsection 4.1.3.21: Solid Mixture</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.1.3.22">Subsubsection 4.1.3.22: Spherical Fiber Distribution</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.1.3.23">Subsubsection 4.1.3.23: Spherical Fiber Distribution from Solid-Bound Molecule</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.1.3.24">Subsubsection 4.1.3.24: Coupled Transversely Isotropic Mooney-Rivlin</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.1.3.25">Subsubsection 4.1.3.25: Coupled Transversely Isotropic Veronda-Westmann</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.1.3.26">Subsubsection 4.1.3.26: Large Poisson’s Ratio Ligament</a>
</div>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Section-4.2">Section 4.2: Continuous Fiber Distribution</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsection-4.2.1">Subsection 4.2.1: Compressible Continuous Fiber Distribution</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-4.2.2">Subsection 4.2.2: Uncoupled Continuous Fiber Distribution</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-4.2.3">Subsection 4.2.3: Fibers</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.2.3.1">Subsubsection 4.2.3.1: Fiber with Exponential-Power Law</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.2.3.2">Subsubsection 4.2.3.2: Fiber with Neo-Hookean Law</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.2.3.3">Subsubsection 4.2.3.3: Fiber with Toe-Linear Response</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.2.3.4">Subsubsection 4.2.3.4: Fiber with Exponential-Power Law Uncoupled</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.2.3.5">Subsubsection 4.2.3.5: Fiber with Neo-Hookean Law Uncoupled</a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-4.2.4">Subsection 4.2.4: Distribution</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.2.4.1">Subsubsection 4.2.4.1: Spherical</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.2.4.2">Subsubsection 4.2.4.2: Ellipsoidal</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.2.4.3">Subsubsection 4.2.4.3: <span class="MathJax_Preview">\pi-</span>Periodic von Mises Distribution</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.2.4.4">Subsubsection 4.2.4.4: Circular</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.2.4.5">Subsubsection 4.2.4.5: Elliptical</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.2.4.6">Subsubsection 4.2.4.6: von Mises Distribution</a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-4.2.5">Subsection 4.2.5: Scheme</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.2.5.1">Subsubsection 4.2.5.1: Gauss-Kronrod Trapezoidal Rule</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.2.5.2">Subsubsection 4.2.5.2: Finite Element Integration Rule</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.2.5.3">Subsubsection 4.2.5.3: Trapezoidal Rule</a>
</div>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Section-4.3">Section 4.3: Viscoelastic Solids</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsection-4.3.1">Subsection 4.3.1: Uncoupled Viscoelastic Materials</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-4.3.2">Subsection 4.3.2: Compressible Viscoelastic Materials</a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Section-4.4">Section 4.4: Reactive Viscoelastic Solid</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsection-4.4.1">Subsection 4.4.1: Relaxation Functions</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.4.1.1">Subsubsection 4.4.1.1: Exponential</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.4.1.2">Subsubsection 4.4.1.2: Exponential Distortional</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.4.1.3">Subsubsection 4.4.1.3: Fung</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.4.1.4">Subsubsection 4.4.1.4: Park</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.4.1.5">Subsubsection 4.4.1.5: Park Distortional</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.4.1.6">Subsubsection 4.4.1.6: Power</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.4.1.7">Subsubsection 4.4.1.7: Power Distortional</a>
</div>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Section-4.5">Section 4.5: Reactive Damage Mechanics</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsection-4.5.1">Subsection 4.5.1: General Specification of Damage Materials</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-4.5.2">Subsection 4.5.2: Cumulative Distribution Functions</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.5.2.1">Subsubsection 4.5.2.1: Simo</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.5.2.2">Subsubsection 4.5.2.2: Log-Normal</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.5.2.3">Subsubsection 4.5.2.3: Weibull</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.5.2.4">Subsubsection 4.5.2.4: Quintic Polynomial</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.5.2.5">Subsubsection 4.5.2.5: Step</a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-4.5.3">Subsection 4.5.3: Damage Criterion</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.5.3.1">Subsubsection 4.5.3.1: Simo</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.5.3.2">Subsubsection 4.5.3.2: Strain Energy Density</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.5.3.3">Subsubsection 4.5.3.3: Specific Strain Energy</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.5.3.4">Subsubsection 4.5.3.4: Von Mises Stress</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.5.3.5">Subsubsection 4.5.3.5: Maximum Shear Stress</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.5.3.6">Subsubsection 4.5.3.6: Maximum Normal Stress</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.5.3.7">Subsubsection 4.5.3.7: Maximum Normal Lagrange Strain</a>
</div>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Section-4.6">Section 4.6: Multigeneration Solids</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsection-4.6.1">Subsection 4.6.1: General Specification of Multigeneration Solids</a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Section-4.7">Section 4.7: Biphasic Materials</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsection-4.7.1">Subsection 4.7.1: General Specification of Biphasic Materials</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-4.7.2">Subsection 4.7.2: Permeability Materials</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.7.2.1">Subsubsection 4.7.2.1: Constant Isotropic Permeability</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.7.2.2">Subsubsection 4.7.2.2: Holmes-Mow</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.7.2.3">Subsubsection 4.7.2.3: Referentially Isotropic Permeability</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.7.2.4">Subsubsection 4.7.2.4: Referentially Orthotropic Permeability</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.7.2.5">Subsubsection 4.7.2.5: Referentially Transversely Isotropic Permeability</a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-4.7.3">Subsection 4.7.3: Fluid Supply Materials</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.7.3.1">Subsubsection 4.7.3.1: Starling Equation</a>
</div>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Section-4.8">Section 4.8: Biphasic-Solute Materials</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsection-4.8.1">Subsection 4.8.1: Guidelines for Biphasic-Solute Analyses</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.8.1.1">Subsubsection 4.8.1.1: Prescribed Boundary Conditions</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.8.1.2">Subsubsection 4.8.1.2: Prescribed Initial Conditions</a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-4.8.2">Subsection 4.8.2: General Specification of Biphasic-Solute Materials</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-4.8.3">Subsection 4.8.3: Diffusivity Materials</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.8.3.1">Subsubsection 4.8.3.1: Constant Isotropic Diffusivity</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.8.3.2">Subsubsection 4.8.3.2: Constant Orthotropic Diffusivity</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.8.3.3">Subsubsection 4.8.3.3: Referentially Isotropic Diffusivity</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.8.3.4">Subsubsection 4.8.3.4: Referentially Orthotropic Diffusivity</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.8.3.5">Subsubsection 4.8.3.5: Albro Isotropic Diffusivity</a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-4.8.4">Subsection 4.8.4: Solubility Materials</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.8.4.1">Subsubsection 4.8.4.1: Constant Solubility</a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-4.8.5">Subsection 4.8.5: Osmotic Coefficient Materials</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.8.5.1">Subsubsection 4.8.5.1: Constant Osmotic Coefficient</a>
</div>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Section-4.9">Section 4.9: Triphasic and Multiphasic Materials</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsection-4.9.1">Subsection 4.9.1: Guidelines for Multiphasic Analyses</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.9.1.1">Subsubsection 4.9.1.1: Initial State of Swelling</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.9.1.2">Subsubsection 4.9.1.2: Prescribed Boundary Conditions</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.9.1.3">Subsubsection 4.9.1.3: Prescribed Initial Conditions</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.9.1.4">Subsubsection 4.9.1.4: Prescribed Effective Solute Flux</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.9.1.5">Subsubsection 4.9.1.5: Prescribed Electric Current Density</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.9.1.6">Subsubsection 4.9.1.6: Electrical Grounding</a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-4.9.2">Subsection 4.9.2: General Specification of Multiphasic Materials</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-4.9.3">Subsection 4.9.3: Solvent Supply Materials</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.9.3.1">Subsubsection 4.9.3.1: Starling Equation</a>
</div>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Section-4.10">Section 4.10: Chemical Reactions</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsection-4.10.1">Subsection 4.10.1: Guidelines for Chemical Reaction Analyses</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-4.10.2">Subsection 4.10.2: General Specification for Chemical Reactions</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-4.10.3">Subsection 4.10.3: Chemical Reaction Materials</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.10.3.1">Subsubsection 4.10.3.1: Law of Mass Action for Forward Reactions</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.10.3.2">Subsubsection 4.10.3.2: Law of Mass Action for Reversible Reactions</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.10.3.3">Subsubsection 4.10.3.3: Michaelis-Menten Reaction</a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-4.10.4">Subsection 4.10.4: Specific Reaction Rate Materials</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.10.4.1">Subsubsection 4.10.4.1: Constant Reaction Rate</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.10.4.2">Subsubsection 4.10.4.2: Huiskes Reaction Rate</a>
</div>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Section-4.11">Section 4.11: Rigid Body</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Section-4.12">Section 4.12: Active Contraction</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsection-4.12.1">Subsection 4.12.1: Contraction in Mixtures of Uncoupled Materials</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.12.1.1">Subsubsection 4.12.1.1: Uncoupled Prescribed Uniaxial Active Contraction</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.12.1.2">Subsubsection 4.12.1.2: Uncoupled Prescribed Transversely Isotropic Active Contraction</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.12.1.3">Subsubsection 4.12.1.3: Uncoupled Prescribed Isotropic Active Contraction</a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-4.12.2">Subsection 4.12.2: Contraction in Mixtures of Compressible Materials</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.12.2.1">Subsubsection 4.12.2.1: Prescribed Uniaxial Active Contraction</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.12.2.2">Subsubsection 4.12.2.2: Prescribed Transversely Isotropic Active Contraction</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-4.12.2.3">Subsubsection 4.12.2.3: Prescribed Isotropic Active Contraction</a>
</div>
</div>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Chapter-5">Chapter 5: Restart Input file</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Section-5.1">Section 5.1: The Archive Section</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Section-5.2">Section 5.2: The Control Section</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Section-5.3">Section 5.3: The LoadData Section</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Section-5.4">Section 5.4: Example</a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Chapter-6">Chapter 6: Multi-Step Analysis</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Section-6.1">Section 6.1: The Step Section</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsection-6.1.1">Subsection 6.1.1: Boundary Conditions</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-6.1.2">Subsection 6.1.2: Relative Boundary Conditions</a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Section-6.2">Section 6.2: An Example</a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Chapter-7">Chapter 7: Parameter Optimization</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Section-7.1">Section 7.1: Optimization Input File</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsection-7.1.1">Subsection 7.1.1: Model Section</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-7.1.2">Subsection 7.1.2: Options Section</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-7.1.3">Subsection 7.1.3: Function Section</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-7.1.4">Subsection 7.1.4: Parameters Section</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-7.1.5">Subsection 7.1.5: Constraints Section</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-7.1.6">Subsection 7.1.6: Load Data Section</a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Section-7.2">Section 7.2: Running a Parameter Optimization</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Section-7.3">Section 7.3: An Example Input File</a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Chapter-8">Chapter 8: Troubleshooting</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Section-8.1">Section 8.1: Before You Run Your Model</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsection-8.1.1">Subsection 8.1.1: The Finite Element Mesh</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-8.1.2">Subsection 8.1.2: Materials</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-8.1.3">Subsection 8.1.3: Boundary Conditions</a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Section-8.2">Section 8.2: Debugging a Model</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Section-8.3">Section 8.3: Common Issues</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsection-8.3.1">Subsection 8.3.1: Inverted elements</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection-8.3.1.1">Subsubsection 8.3.1.1: Material instability</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-8.3.1.2">Subsubsection 8.3.1.2: Time step too large</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-8.3.1.3">Subsubsection 8.3.1.3: Elements too distorted</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-8.3.1.4">Subsubsection 8.3.1.4: Shells are too thick</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-8.3.1.5">Subsubsection 8.3.1.5: Rigid body modes</a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-8.3.2">Subsection 8.3.2: Failure to converge</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsubsection-8.3.2.1">Subsubsection 8.3.2.1: No loads applied</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-8.3.2.2">Subsubsection 8.3.2.2: Convergence Tolerance Too Tight </a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-8.3.2.3">Subsubsection 8.3.2.3: Forcing convergence</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsubsection-8.3.2.4">Subsubsection 8.3.2.4: Problems due to Contact</a>
</div>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Section-8.4">Section 8.4: Guidelines for Contact Problems</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsection-8.4.1">Subsection 8.4.1: The penalty method</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-8.4.2">Subsection 8.4.2: Augmented Lagrangian Method</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-8.4.3">Subsection 8.4.3: Initial Separation</a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Section-8.5">Section 8.5: Guidelines for Multiphasic Analyses</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsection-8.5.1">Subsection 8.5.1: Initial State of Swelling</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-8.5.2">Subsection 8.5.2: Prescribed Boundary Conditions</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-8.5.3">Subsection 8.5.3: Prescribed Initial Conditions</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-8.5.4">Subsection 8.5.4: Prescribed Effective Solute Flux</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-8.5.5">Subsection 8.5.5: Prescribed Electric Current Density</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-8.5.6">Subsection 8.5.6: Electrical Grounding</a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Section-8.6">Section 8.6: Understanding the Solution</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsection-8.6.1">Subsection 8.6.1: Mesh convergence</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-8.6.2">Subsection 8.6.2: Constraint enforcement</a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Section-8.7">Section 8.7: Limitations of FEBio</a>
</div>
<div class="tocindent">
<div class="toc">
<a class="Link" href="#toc-Subsection-8.7.1">Subsection 8.7.1: Geometrical instabilities</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-8.7.2">Subsection 8.7.2: Material instabilities</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-8.7.3">Subsection 8.7.3: Remeshing</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-8.7.4">Subsection 8.7.4: Force-driven Problems</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Subsection-8.7.5">Subsection 8.7.5: Solutions obtained on Multi-processor Machines</a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Section-8.8">Section 8.8: Where to Get More Help</a>
</div>
</div>
<div class="toc">
<a class="Link" href="#toc-Chapter-9">Chapter 9: Configuration File</a>
</div>
<div class="toc">
<a class="Link" href="#toc-Chapter-10">Chapter 10: FEBio Plugins</a>
</div>
</div>
<div class="toc">
<a class="Link" href="#Bibliography">Bibliography</a>
</div>

</div>
<h1 class="Chapter">
<a class="toc" name="toc-Chapter-1">1</a> Introduction<a class="Label" name="chap:introduction"> </a>
</h1>
<h2 class="Section">
<a class="toc" name="toc-Section-1.1">1.1</a> Overview of FEBio<a class="Label" name="sec:overview"> </a>
</h2>
<div class="Unindented">
FEBio is a nonlinear finite element solver that is specifically designed for biomechanical applications. It offers modeling scenarios, constitutive models and boundary conditions that are relevant to many research areas in biomechanics, thus offering a powerful tool for solving 3D problems in computational biomechanics. The software is open-source and the source code, as well as pre-compiled executables for Windows, OS-X and Linux platforms are available for download at <a href="http://febio.org">http://febio.org</a>. This chapter presents a brief overview of the available features of FEBio.
</div>
<div class="Indented">
FEBio can solve different kinds of physics. It can solve problems in structural mechanics, heat transfer, biphasic and multiphasic physics. Both a (quasi-) static and dynamic (or transient) analysis can be performed in each of the different physics modules. For instance, in the structural mechanics module, the (quasi-) static response of the system is sought in a quasi-static analysis and the effects of inertia are ignored. In a dynamic analysis, the inertial effects are included in the governing equations to calculate the time dependent response of the system. In the biphasic module, a coupled solid-fluid problem is solved. In a transient biphasic analysis the time dependent response of both the solid and the fluid phase is determined. For the steady-state analysis the final relaxed state is recovered. Similarly, for multiphasic and heat transfer problems, both the time dependent transient response as well as the steady-state response can be determined.
</div>
<div class="Indented">
Many nonlinear constitutive models are available, allowing the user to model the often complicated biological tissue behavior. Several isotropic constitutive models are supported such as Neo-Hookean, Mooney-Rivlin, Ogden, Arruda-Boyce and Veronda-Westmann. All these models have a nonlinear stress-strain response and are objective for large deformations. In addition to the isotropic models there are several transversely isotropic and orthotropic constitutive models available. These models exhibit anisotropic behavior in a single or multiple preferred directions and are useful for representing biological tissues such as tendons, muscles, cartilage and other tissues that contain fibers. FEBio also contains a <i>rigid body </i>constitutive model. This model can be used to represent materials or structures whose deformation is negligible compared to that of other materials in the overall model. Several constitutive models are available for representing the solid phase of biphasic and multiphasic materials, which are materials that contain both a solid phase and a fluid phase. For incompressible materials FEBio employs special algorithms for enforcing the incompressibility constraint. A three-field formulation is used for tri-linear hexahedral and wedge elements. This algorithm allows the user to capture the accurate response of highly incompressible materials.
</div>
<div class="Indented">
FEBio can now also solve first-order computational homogenization problems. In such problems, the response of the macro-model is determined by the averaged local response of a representative volume element (RVE). The deformation of the macro-model, and more specifically the local deformation gradient, is applied to a RVE model which in turns determines the stress (and tangent) of the macro-model.
</div>
<div class="Indented">
FEBio supports a wide range of boundary conditions to model interactions between materials that are relevant to problems in biomechanics. These include prescribed displacements, fluid pressures or temperatures, depending on the physics model. Also nodal forces or fluxes can be prescribed, as well as several types of surface boundary loads. Deformable models can be connected to rigid bodies. With this feature, the user can model prescribed rotations and torques for rigid segments, thereby allowing the coupling of rigid body mechanics with deformable continuum mechanics. FEBio provides the ability to represent frictionless and frictional contact between rigid and/or deformable materials using sliding interfaces. A sliding surface is defined between two surfaces that are allowed to separate and slide across each other but are not allowed to penetrate. Variations of the sliding interface, such as tied interfaces, tied-sliding (tension-compression) and rigid walls, are available as well. As of version 1.2 it is also possible to model the fluid flow across two contacting biphasic materials. Finally, the user may specify a body force to model the effects such as, gravity, base acceleration or centripetal acceleration.
</div>
<div class="Indented">
FEBio has a large library of element formulations. These include linear tetrahedral, hexahedral and pentahedral (wedge) elements, as well as quadratic tetrahedral and hexahedral elements. FEBio also supports triangular and bi-linear quadratic director-based shell elements.
</div>
<div class="Indented">
FEBio is a nonlinear implicit FE solver and does not have mesh generation capabilities. The finite element mesh, as well as all constitutive parameters and loading is defined in an input file, the format of which is described in detail in this document. This input file needs to be generated by preprocessing software. The preferred preprocessor for FEBio is called <a href="http://febio.org/preview">PreView</a>. PreView can convert some other formats to the FEBio input specification. For instance, NIKE3D <span class="bibcites">[<a class="bibliocite" name="cite-27" href="#biblio-27"><span class="bib-index">27</span></a>]</span> and Abaqus input files can be imported in PreView and can be exported from PreView as a FEBio input file. See the PreView <a href="http://help.mrl.sci.utah.edu/help/index.jsp">User’s Manual</a> for more information.
</div>
<h2 class="Section">
<a class="toc" name="toc-Section-1.2">1.2</a> About this document<a class="Label" name="sec:about"> </a>
</h2>
<div class="Unindented">
This document is part of a set of three manuals that accompany FEBio: the User’s Manual, describing how to use FEBio (this manual), a Developer’s Manual for users who wish to modify or add features to the code, and a <a href="http://help.mrl.sci.utah.edu/help/index.jsp">FEBio Theory Manual</a>, which describes the theory behind the FEBio algorithms.
</div>
<div class="Indented">
This document discusses how to use FEBio and describes the input file format in detail. Chapter <a class="Reference" href="#chap:running-FEBio">2↓</a> describes how to run FEBio and explains the various command line options. It also discusses the different files that are required and created by FEBio. Chapter <a class="Reference" href="#chap:Free-Format-Input">3↓</a> describes the format of the FEBio input file. An XML-based format is used, organizing the data in a convenient hierarchical structure. Chapter <a class="Reference" href="#chap:Materials">4↓</a> gives a detailed overview of the available constitutive models. Chapter <a class="Reference" href="#chap:Restart-Input-file">5↓</a> discusses the restart capabilities of FEBio. The restart feature allows the user to interrupt a run and continue it at a later time, optionally making changes to the problem data. Chapter <a class="Reference" href="#chap:Multi-step-Analysis">6↓</a> describes the multi-step analysis feature, which allows the user to split up the entire analysis into several steps. Chapter <a class="Reference" href="#chap:Parameter-Optimization">7↓</a> explains how to setup and run a parameter optimization problem using FEBio’s optimization module. Chapter <a class="Reference" href="#chap:Troubleshooting">8↓</a> provides helpful information for troubleshooting an FEBio model and offers guidelines that help users avoid common problems.
</div>
<div class="Indented">
Although this document describes some of the theoretical aspects of FEBio, a complete theoretical development can be found in the <a href="http://help.mrl.sci.utah.edu/help/index.jsp">FEBio Theory Manual</a><span class="MathJax_Preview"><script type="math/tex">
.
</script>
</span> Developers who are interested in modifying or extending the FEBio code will find the <a href="http://febiodoc.sci.utah.edu/doxygen/">FEBio Developer’s 
Manual</a><span class="FootOuter"><span class="SupFootMarker"> [A] </span><span class="HoverFoot"><span class="SupFootMarker"> [A] </span>The developers manual is only available online (see  <a href="http://febio.org">http://febio.org</a> for more information)</span></span> very useful.
</div>
<h2 class="Section">
<a class="toc" name="toc-Section-1.3">1.3</a> Units in FEBio<a class="Label" name="sec:units"> </a>
</h2>
<div class="Unindented">
FEBio does not assume a specific unit system. It is up to the user to enter numbers that are defined in consistent units. For example, when entering material parameters in SI units, the user must enter all loads, contact parameters, and other boundary conditions in SI units as well. The units of all the parameters are given when they are defined in this manual. We use a generic designation of units for all the parameters using the following symbols.<div class="defskip"> </div>
</div>
<div class="Indented">
<div class="center">
<table>
<tr>
<td align="center" valign="top">
<b><i>Symbol</i></b>
</td>
<td align="left" valign="top">
<b><i>Name</i></b>
</td>
<td align="left" valign="top">
<b><i>SI unit</i></b> 
</td>

</tr>
<tr>
<td align="center" valign="top">
<b>L</b>
</td>
<td align="left" valign="top">
Length
</td>
<td align="left" valign="top">
meter (m)
</td>

</tr>
<tr>
<td align="center" valign="top">
<b>M</b>
</td>
<td align="left" valign="top">
Mass
</td>
<td align="left" valign="top">
kilogram (kg)
</td>

</tr>
<tr>
<td align="center" valign="top">
<b>t</b>
</td>
<td align="left" valign="top">
Time
</td>
<td align="left" valign="top">
second (s)
</td>

</tr>
<tr>
<td align="center" valign="top">
<b>T</b>
</td>
<td align="left" valign="top">
Temperature
</td>
<td align="left" valign="top">
Kelvin (K)
</td>

</tr>
<tr>
<td align="center" valign="top">
<b>n</b>
</td>
<td align="left" valign="top">
Amount of substance
</td>
<td align="left" valign="top">
mole (mol)
</td>

</tr>
<tr>
<td align="center" valign="top">
<b>F</b>
</td>
<td align="left" valign="top">
Force
</td>
<td align="left" valign="top">
Newton (kg<span class="MathJax_Preview"><script type="math/tex">
\cdot
</script>
</span>m/s<span class="MathJax_Preview"><script type="math/tex">
^{2}
</script>
</span>)
</td>

</tr>
<tr>
<td align="center" valign="top">
<b>P</b>
</td>
<td align="left" valign="top">
Pressure, stress
</td>
<td align="left" valign="top">
Pascal (Pa=N/m<span class="MathJax_Preview"><script type="math/tex">
^{2}
</script>
</span>)
</td>

</tr>
<tr>
<td align="center" valign="top">
<b>Q</b>
</td>
<td align="left" valign="top">
Electric charge
</td>
<td align="left" valign="top">
Coulomb (C=A<span class="MathJax_Preview"><script type="math/tex">
\cdot
</script>
</span>s)
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
Units are given using the bracket notation. For instance, the unit for density is [<b>M/L</b><span class="MathJax_Preview"><script type="math/tex">
^{3}
</script>
</span>] and the unit for permeability is [<b>L</b><span class="MathJax_Preview"><script type="math/tex">
^{4}
</script>
</span><b>/F</b><span class="MathJax_Preview"><script type="math/tex">
\cdot
</script>
</span><b>t].</b> When using SI units, this corresponds to units of kg/m<span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{3}}
</script>
</span> for density and m<span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{4}}
</script>
</span>/N.s for permeability, respectively. Unitless parameters are designated by empty brackets (<b>[ ]</b>). The units for angles are either [<b>deg</b>] for degrees or [<b>rad</b>] for radians.
</div>
<div class="Indented">
When adopting a consistent set of units, first choose a primary set of units, and then determine the remaining derived units. For example, in typical problems in solid mechanics, the primary set consists of three units. If you choose [<b>M</b>]=kg, [<b>L</b>]=m, and [<b>t</b>]=s, then [<b>F</b>]=N and [<b>P</b>]=Pa. Alternatively, if you choose [<b>L</b>]=mm, [<b>F</b>]=N and [<b>T</b>]=s as the primary set, then [<b>P</b>]=MPa (since 1 N/mm<span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{2}}=
</script>
</span> 10<span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{6}}
</script>
</span>N/m<span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{2}}=
</script>
</span> 1 MPa) and [<b>M</b>]=tonne (tonne = N <span class="MathJax_Preview"><script type="math/tex">
\cdot
</script>
</span>s<span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{2}}
</script>
</span>/mm). The primary set of units must be independent. For instance, in the last example, you cannot choose [<b>P</b>] as a primary unit as it can be expressed in terms of [<b>F</b>] and [<b>L</b>] (i.e. [<b>P</b>]=[<b>F/L</b><span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{\mathbf{2}}}
</script>
</span>]).
</div>
<div class="Indented">
<i>Example:</i>
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top" colspan="2">
<b>Primary Units</b>
</td>

</tr>
<tr>
<td align="left" valign="top">
time
</td>
<td align="left" valign="top">
s
</td>

</tr>
<tr>
<td align="left" valign="top">
length
</td>
<td align="left" valign="top">
mm
</td>

</tr>
<tr>
<td align="left" valign="top">
force
</td>
<td align="left" valign="top">
N
</td>

</tr>
<tr>
<td align="left" valign="top">
amount of substance
</td>
<td align="left" valign="top">
nmol
</td>

</tr>
<tr>
<td align="left" valign="top">
charge
</td>
<td align="left" valign="top">
C
</td>

</tr>
<tr>
<td align="left" valign="top">
temperature
</td>
<td align="left" valign="top">
K
</td>

</tr>
<tr>
<td align="left" valign="top" colspan="2">
<b>Derived Units</b>
</td>

</tr>
<tr>
<td align="left" valign="top">
stress
</td>
<td align="left" valign="top">
N/mm<span class="MathJax_Preview"><script type="math/tex">
^{2}
</script>
</span>, MPa
</td>

</tr>
<tr>
<td align="left" valign="top">
permeability
</td>
<td align="left" valign="top">
mm<span class="MathJax_Preview"><script type="math/tex">
^{4}
</script>
</span>/N<span class="MathJax_Preview"><script type="math/tex">
\cdot
</script>
</span>s, mm<span class="MathJax_Preview"><script type="math/tex">
^{2}
</script>
</span>/Pa<span class="MathJax_Preview"><script type="math/tex">
\cdot
</script>
</span>s
</td>

</tr>
<tr>
<td align="left" valign="top">
diffusivity
</td>
<td align="left" valign="top">
mm<span class="MathJax_Preview"><script type="math/tex">
^{2}
</script>
</span>/s
</td>

</tr>
<tr>
<td align="left" valign="top">
concentration
</td>
<td align="left" valign="top">
nmol/mm<span class="MathJax_Preview"><script type="math/tex">
^{3}
</script>
</span>, mM
</td>

</tr>
<tr>
<td align="left" valign="top">
charge density
</td>
<td align="left" valign="top">
nEq/mm<span class="MathJax_Preview"><script type="math/tex">
^{3}
</script>
</span>, mEq/L
</td>

</tr>
<tr>
<td align="left" valign="top">
voltage
</td>
<td align="left" valign="top">
mV
</td>

</tr>
<tr>
<td align="left" valign="top">
current density
</td>
<td align="left" valign="top">
A/mm<span class="MathJax_Preview"><script type="math/tex">
^{2}
</script>
</span>
</td>

</tr>
<tr>
<td align="left" valign="top">
current
</td>
<td align="left" valign="top">
A
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<h1 class="Chapter">
<a class="toc" name="toc-Chapter-2">2</a> Running FEBio<a class="Label" name="chap:running-FEBio"> </a>
</h1>
<div class="Unindented">
FEBio is a command line application which means it does not have its own Graphical User Interface (GUI) and must be run from a shell or command line. FEBio runs on several different computing platforms including Windows, Mac OSX and many versions of Linux. The command line input and output options are described in this chapter.
</div>
<h2 class="Section">
<a class="toc" name="toc-Section-2.1">2.1</a> Running FEBio on Windows<a class="Label" name="sec:running-FEBio-Windows"> </a>
</h2>
<div class="Unindented">
There are several ways to run FEBio on Windows. The easiest way is by simply selecting the FEBio program from the Programs menu or by double-clicking the FEBio icon in the installation folder. However, this runs FEBio with the installation folder as the working folder, and unless the FEBio input files are in this folder, you will need to know the relative or absolute path to your input files. A more practical approach is to run FEBio from a command prompt. Before you can do this, you need to know two things: how to open a command prompt and how to add the FEBio installation folder to your PATH environment variable so that you can run FEBio from any folder on your system. The process is slightly different depending on whether you are using Windows XP or Windows 7, so we’ll look at the two Windows versions separately.
</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-2.1.1">2.1.1</a> Windows XP<a class="Label" name="subsec:windowsXP"> </a>
</h3>
<div class="Unindented">
First, we’ll add the FEBio installation folder to the PATH variable. Open the <i>Control Panel </i>from the <i>Start </i>menu. Switch to <i>Classic View </i>and double-click the <i>System </i>icon. In the dialog box that appears, select the <i>Advanced </i>tab and click the button named <i>Environment variables</i>. Find the <i>path</i> variable and click the <i>Edit</i> button. Add the end of the PATH’s value (don’t delete the current value) type a semi-colon and then the absolute path to the FEBio installation folder (e.g. C:/Program Files/FEBio/). Then click the <i>OK</i>-button on all open dialog boxes.
</div>
<div class="Indented">
To open a command prompt, click the <i>Run </i>menu item on the <i>Start </i>menu. In the dialog box that appears type <i>cmd </i>and press the <i>OK</i>-button. A command prompt window appears. You can now use the <i>cd </i>(change directory) command to navigate to the folder that contains the FEBio input files. To run FEBio, simply type <i>febio </i>(with or without additional arguments) and press <i>Enter</i>.
</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-2.1.2">2.1.2</a> Windows 7<a class="Label" name="subsec:Windows7"> </a>
</h3>
<div class="Unindented">
Let’s first modify the <i>PATH </i>environment variable. Open the <i>Start</i> menu and type <i>system </i>in the search field. From the search results, select the <i>System</i> option under <i>Control Panel</i>. The <i>System </i>window will appear. Find the <i>Change Settings </i>option (on the lower, right side) and click it. The System Properties dialog box appears. Activate the <i>Advanced </i>tab and click the <i>Environment Variables </i>button. Find the <i>path</i> variable and click the <i>Edit</i> button. Add the end of the PATH’s value (don’t delete the current value) type a semi-colon and then the absolute path to the FEBio installation folder (e.g. C:/Program Files/FEBio/). Then click the <i>OK</i>-button on all open dialog boxes.
</div>
<div class="Indented">
Next, open a command prompt as follows. Click the <i>Start </i>menu and type <i>cmd </i>in the search field. From the search results, select the <i>cmd </i>option under Programs. A command prompt window appears. You can now use the <i>cd </i>(change directory) command to navigate to the folder that contains the FEBio input files. To run FEBio, simply type <i>febio </i>(with or without additional arguments) and press <i>Enter</i>.
</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-2.1.3">2.1.3</a> Running FEBio from Explorer<a class="Label" name="subsec:running-Explorer"> </a>
</h3>
<div class="Unindented">
A third method of running FEBio, which often is very convenient, is to run FEBio from Windows Explorer. To do this, first open Explorer and browse to the folder that contains your FEBio input files. Next, right-click on the input file and select <i>Open With</i>. Now select <i>Choose default program</i>. A dialog box appears with a list of programs to open the input file. If FEBio is not on this list yet, click the <i>Browse</i> button. Locate the FEBio executable (e.g. in C:/Program Files/FEBio2/bin), select it and press the <i>Open</i> button. Now select FEBio in the <i>Open With</i> dialog box and press Ok.
</div>
<div class="Indented">
After you have done this once, the process simplifies. After you right-click the input file, FEBio should now show up in the <i>Open With </i>menu item and can be selected immediately without having to go through all the previous steps.
</div>
<h2 class="Section">
<a class="toc" name="toc-Section-2.2">2.2</a> Running FEBio on Linux or MAC<a class="Label" name="sec:Running-Linux-MAC"> </a>
</h2>
<div class="Unindented">
Running FEBio on Linux or Mac is as easy as opening up a shell window and typing FEBio on the command line. However, you may need to define an alias to the folder that contains the FEBio executable if you want to run FEBio from any folder on your system. Since this depends on your shell, you need to consult your Linux documentation on how to do this. E.g. if you are using c-shell, you can define an alias as follows:
</div>
<pre class="LyX-Code">
alias febio ’/path/to/febio/executable/’
</pre>
<div class="Unindented">
If you don’t want to define this alias every time you open a shell window, you can place it in your shell start up file (e.g. <i>.cshrc</i> for c-shell).
</div>
<h2 class="Section">
<a class="toc" name="toc-Section-2.3">2.3</a> The Command Line<a class="Label" name="sec:Command-Line"> </a>
</h2>
<div class="Unindented">
FEBio is started from a shell window (or the <i>command prompt</i> in Windows). The command line is the same for all platforms:
</div>
<pre class="LyX-Code">
febio [-o1 [name1] | -o2 [name2] | ... ]
</pre>
<div class="Unindented">
Where -o1, -o2 are options and <i>name1</i>, <i>name2</i>, ... are filenames. The different options (of which most are optional) are given by the following list:
</div>
<div class="Description">
<span class="Description-entry">-i</span> name of input file 
</div>
<div class="Description">
<span class="Description-entry">-r</span> restart file name 
</div>
<div class="Description">
<span class="Description-entry">-g</span> debug flag (does not require a file name) 
</div>
<div class="Description">
<span class="Description-entry">-p</span> plot file name 
</div>
<div class="Description">
<span class="Description-entry">-a</span> dump file name 
</div>
<div class="Description">
<span class="Description-entry">-o</span> log file name 
</div>
<div class="Description">
<span class="Description-entry">-c</span> data check only 
</div>
<div class="Description">
<span class="Description-entry">-s</span> material parameter optimization control file 
</div>
<div class="Description">
<span class="Description-entry">-d</span> diagnostic input file 
</div>
<div class="Description">
<span class="Description-entry">-nosplash</span> don’t show the welcome screen 
</div>
<div class="Description">
<span class="Description-entry">-cnf</span> configuration filename 
</div>
<div class="Description">
<span class="Description-entry">-noconfig</span> don’t use the configuration file 
</div>
<div class="Description">
<span class="Description-entry">-break</span> set a break point 
</div>
<div class="Unindented">
A more detailed description of these options follows.
</div>
<div class="Description">
<span class="Description-entry"><b>-i</b></span> The -i option is used to specify the name of the input file. The input file is expected to follow the format specifications as described in Chapter <a class="Reference" href="#chap:Free-Format-Input">3↓</a>.
</div>
<div class="Unindented">
<i>Example:</i>
</div>
<pre class="LyX-Code">
&gt; febio -i input.feb
</pre>
<div class="Unindented">
This is the most common way to start a FEBio run. However, FEBio allows the omission of the -i when only a filename is given.
</div>
<pre class="LyX-Code">
&gt; febio input.feb
</pre>
<div class="Unindented">
On Windows, this allows for starting FEBio by double-clicking on an input file (assuming you have chosen FEBio as the default program to open .feb files). Note that if additional options are specified on the command line the -i must be present.
</div>
<div class="Description">
<span class="Description-entry"><b>-r</b></span> The -r option allows you to restart a previous analysis. The filename that must follow this option is a FEBio <i>restart input file </i>or a <i>dump file</i>. The restart input file and dump file are described in more detail in 4.12. The -i  and -r options are mutually exclusive; only one of them may appear on the command line.
</div>
<div class="Unindented">
<i>Example:</i>
</div>
<pre class="LyX-Code">
&gt; febio -r file.feb
</pre>
<div class="Description">
<span class="Description-entry"><b>-g</b></span> The –g option runs FEBio in <i>debug mode</i>. See Section <a class="Reference" href="#subsec:Debugging-a-Run">2.8.2↓</a> for more information on running FEBio in debug mode.
</div>
<div class="Unindented">
<i>Example:</i>
</div>
<pre class="LyX-Code">
&gt; febio -i input.feb –g
</pre>
<div class="Description">
<span class="Description-entry"><b>-p</b></span> The –p option allows the user to specify the name of the <i>plot file</i>. The plot file is a binary file that contains the main results of the analysis. FEBio usually provides a default name for this file; however, the user can override the default name using this option. See Section <a class="Reference" href="#sec:FEBio-Output">2.7↓</a> for more details on the output files generated by FEBio.
</div>
<div class="Unindented">
<i>Example:</i>
</div>
<pre class="LyX-Code">
&gt; febio -i input.feb –p out.plt
</pre>
<div class="Description">
<span class="Description-entry"><b>-a</b></span> It is possible to restart a previous run using the restart capability in FEBio. This is useful when a run terminates unexpectedly. If that happens, the user can restart the analysis from the last converged timestep. Before this feature can be used, the user must request the creation of a <i>dump file</i>. This file will store all the information that FEBio will need to restart the analysis. FEBio will usually provide a default name for the dump file, but the –a command line option allows the user to override the default name for the dump file. See Section <a class="Reference" href="#subsec:Restarting-a-Run">2.8.3↓</a> and Chapter <a class="Reference" href="#chap:Restart-Input-file">5↓</a> for more details on how to use the restart feature.
</div>
<div class="Unindented">
<i>Example:</i>
</div>
<pre class="LyX-Code">
&gt; febio -i input.feb –a out.dmp
</pre>
<div class="Description">
<span class="Description-entry"><b>-o</b></span> <b></b>The –o option allows the user to set the name of the <i>log file</i>. The log file will contain a record of the screen output that was generated during a run. FEBio usually provides a default name for this file (see Section <a class="Reference" href="#sec:FEBio-Output">2.7↓</a>), but the user can override it with this command line option.
</div>
<div class="Unindented">
<i>Example:</i>
</div>
<pre class="LyX-Code">
&gt; febio -i input.feb –o out.log
</pre>
<div class="Description">
<span class="Description-entry"><b>-c</b></span> When the –c option is specified on the command line, FEBio will only read the input file and check it for possible errors. When the check is complete, FEBio will terminate. See Section <a class="Reference" href="#subsec:Input-File-Checking">2.8.4↓</a> for more details on this option.
</div>
<div class="Unindented">
<i>Example:</i>
</div>
<pre class="LyX-Code">
&gt; febio -i input.feb –c
</pre>
<div class="Description">
<span class="Description-entry"><b>-nosplash</b></span> When the –nosplash command is entered on the command line, FEBio will not print the welcome message to the screen. This is useful when calling FEBio from another application and when the user wishes to suppress any screen output from FEBio. Other options for suppressing output can be set in the control section of the FEBio input file (see Section <a class="Reference" href="#subsec:Common-Parameters">3.5.1↓</a>).
</div>
<div class="Unindented">
<i>Example:</i>
</div>
<pre class="LyX-Code">
&gt; febio -i input.feb –nosplash
</pre>
<div class="Description">
<span class="Description-entry"><b>-silent</b></span> When the –silence option is specified on the command line, FEBio will not generate any output to the screen. Unless explicitly instructed not to, FEBio will still create a log file which will have the convergence information.
</div>
<div class="Unindented">
<i>Example:</i>
</div>
<pre class="LyX-Code">
&gt; febio -i input.feb –silent
</pre>
<div class="Description">
<span class="Description-entry"><b>-cnf</b></span> 
</div>
<div class="Description">
<span class="Description-entry"><b>-noconfig</b></span> As of version 1.2, FEBio uses a <i>configuration file</i> to store platform specific settings. Usually FEBio assumes that the location for this configuration file is the same as the executable. However, the user can specify a different location and filename using the –cnf command line option. If the user does not have a configuration file or does not wish to use one, this can be specified using the –noconfig option. More details on the configuration file can be found in Section <a class="Reference" href="#sec:Configuration-file">2.5↓</a> and Chapter <a class="Reference" href="#chap:Configuration-File">9↓</a>.
</div>
<div class="Unindented">
<i>Example:</i>
</div>
<pre class="LyX-Code">
&gt; febio -i input.feb –cnf C:<span class="MathJax_Preview"><script type="math/tex">
\backslash
</script>
</span>path<span class="MathJax_Preview"><script type="math/tex">
\backslash
</script>
</span>to<span class="MathJax_Preview"><script type="math/tex">
\backslash
</script>
</span>febio.xml.
</pre>
<div class="Description">
<span class="Description-entry"><b>-s</b></span> This option instructs FEBio to run a material parameter optimization on the specified input file. The optimization module is described in detail in Chapter <a class="Reference" href="#chap:Parameter-Optimization">7↓</a>. The –s option is followed by the optimization control file which contains among other things the parameters that need to be optimized. Note that the restart feature does not work with the optimization module.
</div>
<div class="Unindented">
<i>Example:</i>
</div>
<pre class="LyX-Code">
&gt; febio –i file.feb –s control.feb
</pre>
<div class="Description">
<span class="Description-entry"><b>-d</b></span> This option will run a FEBio diagnostics. A diagnostic is a special type of test that can be used to verify an implementation. For example, the <i>tangent diagnostic </i>allows users to check the consistency between the material’s stress and tangent implementations.
</div>
<div class="Unindented">
<i>Example:</i>
</div>
<pre class="LyX-Code">
&gt; febio –d diagnostic.feb
</pre>
<div class="Description">
<span class="Description-entry"><b>-break</b></span> With this option a break point can be set which sets a time point at which FEBio will interrupt the run and show the FEBio prompt. The following example sets a break point at time 1.0. FEBio will interrupt the run after the time step at time 1.0 is reached (i.e. has converged).
</div>
<div class="Unindented">
<i>Example:</i>
</div>
<pre class="LyX-Code">
&gt; febio –i file.feb –break 1.0
</pre>
<h2 class="Section">
<a class="toc" name="toc-Section-2.4">2.4</a> The FEBio Prompt<a class="Label" name="sec:FEBio-prompt"> </a>
</h2>
<div class="Unindented">
If you start FEBio without any command arguments, the FEBio prompt will appear (after the welcome message). It will look something like this:
</div>
<pre class="LyX-Code">
febio&gt;
</pre>
<div class="Unindented">
You can now enter one of the following commands:
</div>
<div class="Description">
<span class="Description-entry"><b>help</b></span> prints an overview of available commands with a brief description of each command. 
</div>
<div class="Description">
<span class="Description-entry"><b>quit</b></span> exit FEBio. 
</div>
<div class="Description">
<span class="Description-entry"><b>run</b></span> run an FEBio input file. This command takes the same options as you can enter on the command line. For example, to run a file named <i>test.feb </i>from the FEBio prompt, type the following: 
</div>
<pre class="LyX-Code">
run –i test.feb
</pre>
<div class="Description">
<span class="Description-entry"><b>version</b></span> print version information. 
</div>
<div class="Unindented">
You can also bring up the FEBio prompt during a run by pressing ctrl+c<span class="FootOuter"><span class="SupFootMarker"> [B] </span><span class="HoverFoot"><span class="SupFootMarker"> [B] </span> This feature does not work on some Linux platforms and may abruptly terminate the run.</span></span>. See Section <a class="Reference" href="#subsec:Interrupting-a-Run">2.8.1↓</a> for more details. The FEBio prompt will also be shown when FEBio reaches a break point.
</div>
<h2 class="Section">
<a class="toc" name="toc-Section-2.5">2.5</a> The Configuration File<a class="Label" name="sec:Configuration-file"> </a>
</h2>
<div class="Unindented">
As of version 1.2, FEBio uses a <i>configuration file </i>to store platform-specific settings, such as the default linear solver and the list of plugins that need to be loaded at startup. The configuration file uses an xml format to store data and is detailed in Chapter <a class="Reference" href="#chap:Configuration-File">9↓</a>. For backward compatibility, it is still possible to run FEBio without the configuration file. In that case, the default settings prior to version 1.2 are used.
</div>
<div class="Indented">
<i>Example:</i>
</div>
<pre class="LyX-Code">
&gt; febio –i myfile.feb -noconfig
</pre>
<div class="Unindented">
The configuration file needs to be stored in the same location as the executable and named <i>febio.xml</i>. Alternatively, the location and the name of the file can also be specified on the command line using the –cnf option.
</div>
<div class="Indented">
<i>Example:</i>
</div>
<pre class="LyX-Code">
&gt; febio -i myfile.feb –cnf /home/my/folder/FEBio/febio.cnf
</pre>
<h2 class="Section">
<a class="toc" name="toc-Section-2.6">2.6</a> Using Multiple Processors<a class="Label" name="sec:Using-Multiple-Processors"> </a>
</h2>
<div class="Unindented">
As of version 2.0, FEBio uses OpenMP to parallellize several of the finite element calculations, improving the performance considerably. Both the right-hand-side and the stiffness matrix evaluations for many types of problems have been parallelized. On a system with four processors, a speedup of 2-3 can be expected, depending on the size and type of model. Models with complex material behavior (such as EFD-type materials, biphasic, multiphasic materials, etc.) will benefit most from these parallelization efforts. In addition, FEBio implements the <a href="http://software.intel.com/en-us/intel-mkl/">MKL</a> version of the <a href="http://www.pardiso-project.org/">PARDISO</a> linear solver, which is a parallel linear solver using OpenMP.
</div>
<div class="Indented">
To use multiple processors set the environment variable OMP_NUM_THREADS to the number of desired threads. You should set the number of threads to be equal or less than the number of processors on your system (Setting it higher may actually decrease performance). For example, on a system with four processors you can set the environment as follows. On Linux using the Bash shell, execute:
</div>
<pre class="LyX-Code">
&gt; export OMP_NUM_THREADS=4
</pre>
<div class="Unindented">
Using the c-shell, execute:
</div>
<pre class="LyX-Code">
&gt; setenv OMP_NUM_THREADS 4
</pre>
<div class="Unindented">
Or at a Windows command prompt:
</div>
<pre class="LyX-Code">
&gt; set OMP_NUM_THREADS=4
</pre>
<div class="Unindented">
On Windows, you can add this environment variable as well from the Control Panel. On Win7, open the Control Panel (<i>Start</i><span class="MathJax_Preview"><script type="math/tex">
\to
</script>
</span><i>Control Panel</i>). Open the System panel and click <i>Change Settings</i>. The <i>System Properties </i>dialog box should open up. Select the <i>Advanced Tab</i> and click the <i>Environment Variables </i>button. In the next dialog box, click the <i>New... </i>button under the <i>User variables</i>. Enter OMP_NUM_THREADS for the variable name and 4. Click OK on all open dialog boxes.
</div>
<div class="Paragraph">
<a class="toc" name="toc-Paragraph-1"></a><b>A note on repeatability</b>
</div>
<div class="Unindented">
When using multiple processors, it can not always be guaranteed that all calculations are executed in the same order and, due to numerical round-off, the results of these calculations will not always be the same. In FEBio, this means that the same model run repeatedly on the same machine with multiple processors, may give slightly different convergence norms or even slightly different answers. In many cases, the differences should be small, but in some problems that are prone to ill-conditioning (e.g. contact) the discrepancies may be more significant. When running on one processor, the results of consecutive runs should always be identical.
</div>
<h2 class="Section">
<a class="toc" name="toc-Section-2.7">2.7</a> FEBio Output<a class="Label" name="sec:FEBio-Output"> </a>
</h2>
<div class="Unindented">
After running FEBio, two or three files are created: the <i>log file</i>, the <i>plot file</i> and optionally the <i>dump file</i>. The log file is a text file that contains the same output (and usually more) that was written to the screen. The <i>plot file</i> contains the results of the analysis. Since this is a binary file, the results must be analyzed using post processing software such as <a href="http://febio.org/postview/">PostView</a>. In some cases, the user may wish to request the creation of a <i>dump file</i>. This file contains temporary results of the run. If an analysis terminates unexpectedly or with an error, this file can be used to restart the analysis from the last converged time step. See Section <a class="Reference" href="#subsec:Restarting-a-Run">2.8.3↓</a> and Chapter <a class="Reference" href="#chap:Restart-Input-file">5↓</a> for more details. The names of these files can be specified with the command options –p (plot file), -a (dump file), -o (log file). If one or more of the file names following these flags are omitted, then the omitted file name(s) will be given a default name. The default file names are derived from the input file name. For example, if the input file name is <i>input.feb </i>the logfile will have the name <i>input.log</i>, the plot file is called <i>input.xplt</i> and the dump file is called <i>input.dmp</i>.
</div>
<div class="Indented">
<i>Note 1.</i> The name of the log and plot file can also be specified in the FEBio input file. See Section <a class="Reference" href="#sec:LoadData-Section">3.17↓</a> for more information.
</div>
<div class="Indented">
<i>Note 2.</i> When running an optimization problem the name of the log file is derived from the optimization control file. See Chapter <a class="Reference" href="#chap:Parameter-Optimization">7↓</a> for more information on running optimization problems with FEBio.
</div>
<h2 class="Section">
<a class="toc" name="toc-Section-2.8">2.8</a> Advanced Options<a class="Label" name="sec:Advanced-Options"> </a>
</h2>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-2.8.1">2.8.1</a> Interrupting a Run<a class="Label" name="subsec:Interrupting-a-Run"> </a><span class="FootOuter"><span class="SupFootMarker"> [C] </span><span class="HoverFoot"><span class="SupFootMarker"> [C] </span> This feature may not work properly on all systems, although it will always work on Windows systems.</span></span>
</h3>
<div class="Unindented">
The user can pause the run by pressing ctrl+c. This will bring up the FEBio prompt, and the user can enter a command. The FEBio prompt will also be shown when FEBio reaches a break point. The following commands are available.
</div>
<div class="Description">
<span class="Description-entry"><i><i>cont</i></i></span> continues the run. FEBio will continue the analysis where it left off.
</div>
<div class="Description">
<span class="Description-entry"><i><i>conv</i></i></span> force the current time step to converge. This is useful for example when a time step is having difficulty satisfying too tight of convergence criteria. The user can then manually force the convergence of the time step. However, if the convergence difficulties are due to instabilities, forcing a time step to converge could cause the solution to become unstable or even incorrect. Also be aware that even if the solution recovers on later timesteps, the manually converged step might be incorrect. 
</div>
<div class="Description">
<span class="Description-entry"><i><i>debug [on|off]</i></i></span> entering <i>debug </i>will toggle debug mode. Adding <i>on </i>(<i>off</i>) will turn the debug mode on (resp. off). In debug mode, FEBio will store additional information to the log and plot file that could be useful in debugging the run. It is important to note that since FEBio will store all non-converged states to the plot file, this file may become very large in a short number of time steps. See Section <a class="Reference" href="#subsec:Debugging-a-Run">2.8.2↓</a> for more details on debugging. 
</div>
<div class="Description">
<span class="Description-entry"><i><i>dtmin</i></i></span> set the minimum time step size. This command overrides the minimum time step size that was specified in the input file. 
</div>
<div class="Description">
<span class="Description-entry"><i><i>fail</i></i></span> stop the current iteration and retry. If the current time step is not converging and if the auto-time stepper is enabled, the fail command will stop the current time step and retry it with a smaller time step size. If the auto-time stepper is not enabled, the fail command will simply exit the application. 
</div>
<div class="Description">
<span class="Description-entry"><i><i>help</i></i></span> list the available commands with a short explanation. Prints the information provided in this section of the manual. 
</div>
<div class="Description">
<span class="Description-entry"><i><i>plot</i></i></span> dump current state to plot database and continue. This command is useful when you want to store the non-converged state at the current iteration. Note that this command only stores the state at the current iteration. If you turn on debug mode, all the iterations are stored to the plot file. 
</div>
<div class="Description">
<span class="Description-entry"><i><i>print</i></i></span> print values of variables: 
</div>
<ul>
<li class="nested">
<div class="Description">
<span class="Description-entry"><i><i>nnz</i></i></span> number of non-zeroes in stiffness matrix 
</div>
<div class="Description">
<span class="Description-entry"><i><i>neq</i></i></span> number of equations 
</div>
<div class="Description">
<span class="Description-entry"><i><i>time</i></i></span> the current time step 
</div>

</li>

</ul>
<div class="Description">
<span class="Description-entry"><i><i>quit</i></i></span> exit the application 
</div>
<div class="Description">
<span class="Description-entry"><i><i>restart</i></i></span> toggles restart flag. When the restart flag is set, FEBio will create a dump file at the end of each converged time step. This dump file can then later be used to restart the analysis from the last converged time step. See Section <a class="Reference" href="#subsec:Restarting-a-Run">2.8.3↓</a> and Chapter <a class="Reference" href="#chap:Restart-Input-file">5↓</a> for more details on FEBio’s restart feature. 
</div>
<div class="Description">
<span class="Description-entry"><i><i>time</i></i></span> print elapsed time and an estimation of the remaining time. 
</div>
<div class="Description">
<span class="Description-entry"><i><i>version</i></i></span> print version information 
</div>
<div class="Unindented">
Note that it may take a while before the FEBio prompt is displayed after the user requests a ctrl+c interruption. This may be because the program may be in the middle of a call to the linear solver or another time-consuming part of the analysis procedure that cannot be interrupted.
</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-2.8.2">2.8.2</a> Debugging a Run<a class="Label" name="subsec:Debugging-a-Run"> </a>
</h3>
<div class="Unindented">
As stated in Section <a class="Reference" href="#sec:Command-Line">2.3↑</a>, FEBio can be run in debug-mode by specifying the –g option on the command line. When running in debug mode, FEBio performs additional checks and prints out more information to the screen and to the plot file. It will also store all non-converged geometry states to the plot file. These non-converged states can be very useful for determining the cause of non-convergence or slow convergence. Because of this additional work, the problem may run slightly slower. Note that debug mode can be turned on/off while running an analysis by first interrupting the run with ctrl+c and then using the <i>debug </i>command to toggle the debug mode on or off. It is important to note that since FEBio will store all non-converged states to the plot file, this file may become very large in a short number of time steps. An alternative approach is to use the <i>plot</i> command to write out select non-converged states.
</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-2.8.3">2.8.3</a> Restarting a Run<a class="Label" name="subsec:Restarting-a-Run"> </a>
</h3>
<div class="Unindented">
When the creation of a restart file is requested, the analysis can be restarted from the last converged timestep. This is useful when the run terminated unexpectedly or when the user wishes to modify some parameters during the analysis. To request a restart file, simply set the appropriate option in the control section of the input file. This will generate a <i>dump </i>file which then can be used to restart the analysis. See Chapter <a class="Reference" href="#chap:Restart-Input-file">5↓</a> for more details.
</div>
<div class="Indented">
To restart an analysis, use the -r command line option. This option requires a filename as a parameter, and this name can be either the name of a dump file or the name of a restart input file. The latter case is a text file that allows the user to redefine some parameters when restarting the run. The format of this file is described in 4.12.
</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-2.8.4">2.8.4</a> Input File Checking<a class="Label" name="subsec:Input-File-Checking"> </a>
</h3>
<div class="Unindented">
The <span class="MathJax_Preview"><script type="math/tex">
--c
</script>
</span> option allows the user to stop FEBio after the initial data checking is done. This way, potential input errors can be spotted without running the actual problem.
</div>
<div class="Indented">
<i>Example:</i>
</div>
<pre class="LyX-Code">
&gt; febio –i input.feb –c
</pre>
<h1 class="Chapter">
<a class="toc" name="toc-Chapter-3">3</a> Free Format Input<a class="Label" name="chap:Free-Format-Input"> </a>
</h1>
<div class="Unindented">
This chapter describes the XML-based input format used by FEBio. Since this format follows standard XML conventions, the files can be viewed with any file viewer that supports XML files. Since the free format input file is a text file, it can be edited with any text editor.
</div>
<div class="Indented">
An XML file is composed of a hierarchical list of <i>elements</i>. The first element is called the <i>root element</i>. Elements can have multiple <i>child elements</i>. All elements are enclosed by two <i>tags:</i> a tag defining the element and an <i>end tag</i>. A simple example of an XML file might look like this:
</div>
<pre class="LyX-Code">
&lt;root&gt;
  &lt;child&gt;
    &lt;subchild&gt; ... &lt;/subchild&gt;
  &lt;/child&gt;
&lt;/root&gt;
</pre>
<div class="Unindented">
The <i>value</i> of an element is enclosed between the name and the end tag.
</div>
<pre class="LyX-Code">
&lt;element&gt; here is the value &lt;/element&gt;
</pre>
<div class="Unindented">
Note that the XML format is case-sensitive.
</div>
<div class="Indented">
XML elements can also have <i>attributes</i> in name/value pairs. The attribute value must always be quoted using quotation marks (") or apostrophes (’)<span class="FootOuter"><span class="SupFootMarker"> [D] </span><span class="HoverFoot"><span class="SupFootMarker"> [D] </span> Support for apostrophes was not added until FEBio version 2.1.</span></span>.
</div>
<pre class="LyX-Code">
&lt;element attr="value"&gt;...&lt;/element&gt;
&lt;element attr=’value’&gt;...&lt;/element&gt;
</pre>
<div class="Unindented">
If an XML element has no value, an abbreviated syntax can be used. The following two lines are identical.
</div>
<pre class="LyX-Code">
&lt;element [attribute list]&gt;&lt;/element&gt;
</pre>
<div class="Unindented">
or
</div>
<pre class="LyX-Code">
&lt;element [attribute list]/&gt;
</pre>
<div class="Unindented">
Comments can be added as follows.
</div>
<pre class="LyX-Code">
&lt;!-- This is a comment --&gt;
</pre>
<div class="Unindented">
The first line in the document – the XML declaration – defines the XML version and the character encoding used in the document. An example can be:
</div>
<pre class="LyX-Code">
&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;
</pre>
<h2 class="Section">
<a class="toc" name="toc-Section-3.1">3.1</a> Free Format Overview<a class="Label" name="sec:Free-Format-Overview"> </a>
</h2>
<div class="Unindented">
The free format organizes the FEBio input data into hierarchical XML elements. The root element is called <i>febio_spec</i>. This root element also defines the format version number (Note that FEBio and the input format specification follow different version numberings). This document describes version 2.5 of the FEBio specification<span class="FootOuter"><span class="SupFootMarker"> [E] </span><span class="HoverFoot"><span class="SupFootMarker"> [E] </span> FEBio continues to read some older formats, but they are considered to be obsolete.</span></span> (see Section <a class="Reference" href="#sec:Format-Specification-Versions">3.2↓</a> below for more details on the different input specification formats). The root element will therefore be defined as follows:
</div>
<pre class="LyX-Code">
&lt;febio_spec version="2.5"&gt;
&lt;!-- contents of file --&gt;
&lt;/febio_spec&gt;
</pre>
<div class="Unindented">
The different sections introduced in this chapter are child elements of this root element. The following sections are currently defined:
</div>
<div class="Description">
<span class="Description-entry"><i><i>Module</i></i></span> defines the physics module for solving the model. 
</div>
<div class="Description">
<span class="Description-entry"><i><i>Control</i></i></span> specifies control and solver parameters. 
</div>
<div class="Description">
<span class="Description-entry"><i><i>Globals</i></i></span> Defines the global variables in the model 
</div>
<div class="Description">
<span class="Description-entry"><i><i>Material</i></i></span> Specifies the materials used in the problem and the material parameters. 
</div>
<div class="Description">
<span class="Description-entry"><i><i>Geometry</i></i></span> Defines the geometry of the problem, such as nodal coordinates and element connectivity. 
</div>
<div class="Description">
<span class="Description-entry"><i><i>MeshData</i></i></span> Defines element, facet, edge or nodal data that can be mapped to material parameters or certain boundary conditions and loads. 
</div>
<div class="Description">
<span class="Description-entry"><i><i>Initial</i></i></span> Defines initial conditions for dynamic problems, such as initial velocities, and for transient quasi-static problems. 
</div>
<div class="Description">
<span class="Description-entry"><i><i>Boundary</i></i></span> Defines the boundary conditions that are applied on the geometry. 
</div>
<div class="Description">
<span class="Description-entry"><i><i>Loads</i></i></span> Defines the loads applied to the model. This includes nodal loads, boundary loads and volume loads (or sources for heat transfer problems). 
</div>
<div class="Description">
<span class="Description-entry"><i><i>Contact</i></i></span> This section defines all contact interfaces. 
</div>
<div class="Description">
<span class="Description-entry"><i><i>Constraints</i></i></span> This section defines rigid and nonlinear constraints. 
</div>
<div class="Description">
<span class="Description-entry"><i><i>Discrete</i></i></span> This section defines all the discrete elements (i.e. springs) 
</div>
<div class="Description">
<span class="Description-entry"><i><i>LoadData</i></i></span> Defines the load curve data. 
</div>
<div class="Description">
<span class="Description-entry"><i><i>Ouput</i></i></span> Defines additional data that is to be stored. 
</div>
<div class="Description">
<span class="Description-entry"><i><i>Step</i></i></span> Defines different analysis steps, where in each analysis the boundary, loads, contact and initial conditions can be redefined. 
</div>
<div class="Unindented">
The current format specification expects the different sections of the input file to be listed in the same order as given above. Not all sections are required. Empty sections can be omitted and some are optional. A minimal file must contain at least the Control, Material and Geometry sections. The rest of this chapter describes each of these sections in more detail.
</div>
<h2 class="Section">
<a class="toc" name="toc-Section-3.2">3.2</a> Format Specification Versions<a class="Label" name="sec:Format-Specification-Versions"> </a>
</h2>
<div class="Unindented">
This document describes version 2.5 of the FEBio input specification. This format differs in several aspects from the previous versions of the input specification. This section describes the major changes between the different versions.
</div>
<ul>
<li>
<b>Version 2.5</b>: The latest and recommended version of the FEBio input specification described in this document. This format differs from its predecessor in some important aspects: all nodesets, surfaces, etc., that are used by boundary conditions, loads, contact, etc., must be defined in the Geometry section. Boundary conditions, loads, contact, etc., are now defined by referencing the sets in the Geometry section. This format also adds the <i>MeshData </i>section and reformats the <i>Discrete </i>section. Rigid node sets and prescribed rigid degrees of freedom are moved to the <i>Boundary</i> section. 
</li>
<li>
<b>Version 2.0</b>: This is the first major revision of the input file format and redefines many of the file sections: The <i>Elements </i>section uses a different organization. Elements are now grouped by material and element type. Multiple <i>Elements </i>sections can now be defined to create multiple parts. Surfaces can now be defined in the <i>Geometry </i>section and referenced by boundary conditions and contact definitions. A new <i>Contact</i> section contains all the contact definitions. A new <i>Discrete </i>section was defined that contains all the materials and definitions of the discrete elements (e.g. springs). The <i>Boundary </i>section is also redesigned. This format is <b>still supported </b>but considered obsolete. 
</li>
<li>
<b>Version 1.3</b>: This was an experimental version that redefined the <i>Geometry </i>section, but was later abandoned in favor of version 2.0. This version is <b>no longer supported</b>. 
</li>
<li>
<b>Version 1.2</b>: A <i>Loads </i>section was added and all surface and body loads are now defined in this section instead of the <i>Boundary </i>section. This version is <b>mostly supported</b> but considered obsolete. 
</li>
<li>
<b>Version 1</b>.<b>1</b>: Rigid body constraints are no longer defined in the rigid material definition but instead placed in a new <i>Constraints </i>section. This version is <b>no longer supported</b>. 
</li>
<li>
<b>Version 1.0</b>: The original input format specification. This version is <b>no longer supported</b>. 
</li>

</ul>
<div class="Unindented">
As of FEBio 2.5, only versions 1.2, 2.0, 2.5 are supported. Versions 1.2 and 2.0 are considered obsolete and it is highly recommended to convert older files to the new 2.5 specification for use with newer versions of FEBio. This can be done for instance using PreView.
</div>
<h2 class="Section">
<a class="toc" name="toc-Section-3.3">3.3</a> Multiple Input Files<a class="Label" name="sec:Multiple-Input-Files"> </a>
</h2>
<div class="Unindented">
FEBio supports distributing the model definition across multiple input files. This can greatly facilitate defining large, complex models and allows the re-use of model input files without the need to create the entire model input file from scratch. When using multiple input files to define a model, you must create a master input file that will reference all the other input files. This master file will be used to run the model in FEBio.
</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-3.3.1">3.3.1</a> Include Keyword<a class="Label" name="subsec:Include-Keyword"> </a>
</h3>
<div class="Unindented">
The <i>Include </i>keyword<span class="FootOuter"><span class="SupFootMarker"> [F] </span><span class="HoverFoot"><span class="SupFootMarker"> [F] </span> Supported from FEBio version 2.3 and up.</span></span> can be used to include the contents of another FEBio input file. The filename is entered as the value of the tag.
</div>
<pre class="LyX-Code">
&lt;Include&gt;example.feb&lt;/Include&gt;
</pre>
<div class="Unindented">
The included file must be a valid FEBio file in that it must begin with the <i>febio_spec </i>tag and contain sections defined in this document. However, the included file does not need to define a complete model definition. For instance, it can contain only the <i>Geometry</i> section.
</div>
<div class="Indented">
Note that the contents of the entire file will be included. This is different from the <i>from </i>attribute discussed below, which can be used to include only certain sections from files.
</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-3.3.2">3.3.2</a> The ‘from’ Attribute<a class="Label" name="subsec:The-`from'-Attribute"> </a>
</h3>
<div class="Unindented">
The <i>from </i>attribute can be used to include sections from other files. All the main sections defined in Section <a class="Reference" href="#sec:Free-Format-Overview">3.1↑</a> support the <i>from </i>attribute which can be used to load the section from another input file. For example, to load the <i>Material</i> section from the file mat.feb, defining the <i>Material</i> section in the master input file as follows.
</div>
<pre class="LyX-Code">
&lt;Material from="mat.feb"/&gt;
</pre>
<div class="Unindented">
FEBio will now read the <i>Material</i> section from this child file. The child file must be a valid FEBio input file, meaning it must begin with the <i>febio_spec</i> root section, but does not have to be complete. For example, the file mat.feb only needs to define the Material section. However, the child file may contain other sections. In that case, only the section referenced in the master file will be read from the child file. For example, if the file <i>in.feb </i>contains both the <i>Material</i> and the <i>Geometry</i> section, the master file can read both these sections as follows.
</div>
<pre class="LyX-Code">
&lt;Material from="in.feb"/&gt;
&lt;Geometry from="in.feb"/&gt;
</pre>
<div class="Unindented">
To give a more concrete example, assume that the <i>Material</i>, <i>Geometry</i>, and <i>Boundary</i> sections are defined in the files <i>mat.feb</i>, <i>geom.feb</i>, and <i>bc.feb</i> respectively. The master input file could then look like the following.
</div>
<pre class="LyX-Code">
&lt;febio_spec version="2.0"&gt;
  &lt;Control&gt;
    &lt;time_steps&gt;10&lt;/time_steps&gt;
    &lt;step_size&gt;0.1&lt;/step_size&gt;
  &lt;/Control&gt;
  &lt;Material from="mat.feb"/&gt;
  &lt;Geometry from="geom.feb"/&gt;
  &lt;Boundary from="bc.feb"/&gt;
&lt;/febio_spec&gt;
</pre>
<div class="Unindented">
Notice that the <i>Control </i>section is still defined in the master file. The master file can contain a combination of explicit section definitions and referenced sections using the <i>from </i>attribute. As mentioned above, the master file is used to run the model in FEBio. So, if the master file is called <i>model.feb</i> then the model is run as follows.
</div>
<pre class="LyX-Code">
&gt;febio –i model.feb
</pre>
<div class="Unindented">
When FEBio parses the master file it will automatically parse the referenced child files it encounters in the master input file.
</div>
<div class="Indented">
<p><br/>
</p>

</div>
<h2 class="Section">
<a class="toc" name="toc-Section-3.4">3.4</a> Module Section<a class="Label" name="sec:Module-Section"> </a>
</h2>
<div class="Unindented">
The module section defines the type of analysis to perform with FEBio. This section must be defined as the first section in the input file. It takes on the following format:
</div>
<pre class="LyX-Code">
&lt;Module type="[type]"/&gt;
</pre>
<div class="Unindented">
where <i>type</i> can be any of the following values:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
<b>type</b>
</td>
<td align="left" valign="top">
<b>Description</b>
</td>

</tr>
<tr>
<td align="left" valign="top">
solid
</td>
<td align="left" valign="top">
Structural mechanics analysis: quasi-static or dynamic 
</td>

</tr>
<tr>
<td align="left" valign="top">
biphasic
</td>
<td align="left" valign="top">
Biphasic analysis: steady-state or transient
</td>

</tr>
<tr>
<td align="left" valign="top">
solute
</td>
<td align="left" valign="top">
Biphasic analysis including solute transport: steady-state or transient
</td>

</tr>
<tr>
<td align="left" valign="top">
multiphasic
</td>
<td align="left" valign="top">
Multiphasic analysis including solute transport and chemical reactions
</td>

</tr>
<tr>
<td align="left" valign="top">
heat
</td>
<td align="left" valign="top">
Heat transfer analysis: steady-state or transient
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
For example:
</div>
<pre class="LyX-Code">
&lt;febio_spec version="2.5"&gt;
  &lt;Module type="solid"/&gt;
  &lt;!-- rest of file --&gt;
&lt;/febio_spec&gt;
</pre>
<div class="Unindented">
<b>Note 1: </b>In version 1.2 the Module section was optional. If omitted it was assumed that the <i>solid </i>module was used. In version 2.0 the Module section is required and must be the first section in the file.
</div>
<div class="Indented">
<b>Note 2: </b>Older versions of FEBio (format specification 1.2 and before) allowed you to run a poroelastic (now called biphasic) problem by simply defining a poroelastic material. This is no longer possible. You need to define the proper Module section to run a biphasic analysis. If you have a file that no longer works as of version 1.4 of FEBio, you’ll need to insert the following Module section in the file as the first section of the file.
</div>
<pre class="LyX-Code">
&lt;febio_spec version="2.0"&gt;
  &lt;Module type="biphasic"/&gt;
  &lt;!-- rest of the file unaltered --&gt;
&lt;/febio_spec&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h2 class="Section">
<a class="toc" name="toc-Section-3.5">3.5</a> Control Section<a class="Label" name="sec:Control-Section"> </a>
</h2>
<div class="Unindented">
The control section is defined by the <i>Control </i>element. This section defines all parameters that are used to control the evolution of the solution as well as parameters for the nonlinear solution procedure. These parameters are defined as child elements of the <i>Control</i> element. The parameters depend somewhat on the analysis as defined by the <i>Module</i> section. Many parameters are common to all types of analysis, so they are listed first.
</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-3.5.1">3.5.1</a> Common Parameters<a class="Label" name="subsec:Common-Parameters"> </a>
</h3>
<div class="Unindented">
The following parameters are common for all analysis. If not specified they are assigned default values, which are found in the last column. An asterisk (*) after the name indicates a required parameter. The numbers behind the description refer to the comments following the table.
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
<b>Parameter</b>
</td>
<td align="left" valign="top" style="width: 3in;">
<b>Description</b>
</td>
<td align="left" valign="top">
<b>Default</b> 
</td>

</tr>
<tr>
<td align="left" valign="top">
title
</td>
<td align="left" valign="top" style="width: 3in;">
Title of problem
</td>
<td align="left" valign="top">
(none) 
</td>

</tr>
<tr>
<td align="left" valign="top">
time_steps*
</td>
<td align="left" valign="top" style="width: 3in;">
Total number of time steps. (= <i>ntime</i>)(1)
</td>
<td align="left" valign="top">
(none) 
</td>

</tr>
<tr>
<td align="left" valign="top">
step_size*
</td>
<td align="left" valign="top" style="width: 3in;">
The initial time step size. (= <i>dt</i>) (1)
</td>
<td align="left" valign="top">
(none) 
</td>

</tr>
<tr>
<td align="left" valign="top">
dtol
</td>
<td align="left" valign="top" style="width: 3in;">
Convergence tolerance on displacements (2)
</td>
<td align="left" valign="top">
0.001 
</td>

</tr>
<tr>
<td align="left" valign="top">
etol
</td>
<td align="left" valign="top" style="width: 3in;">
Convergence tolerance on energy (2)
</td>
<td align="left" valign="top">
0.01 
</td>

</tr>
<tr>
<td align="left" valign="top">
rtol
</td>
<td align="left" valign="top" style="width: 3in;">
Convergence tolerance on residual (2)
</td>
<td align="left" valign="top">
0 (disabled) 
</td>

</tr>
<tr>
<td align="left" valign="top">
lstol
</td>
<td align="left" valign="top" style="width: 3in;">
Convergence tolerance on line search (3)
</td>
<td align="left" valign="top">
0.9 
</td>

</tr>
<tr>
<td align="left" valign="top">
time_stepper
</td>
<td align="left" valign="top" style="width: 3in;">
Enable the auto time stepper (4)
</td>
<td align="left" valign="top">
(off) 
</td>

</tr>
<tr>
<td align="left" valign="top">
max_refs
</td>
<td align="left" valign="top" style="width: 3in;">
Max number of stiffness reformations (5)
</td>
<td align="left" valign="top">
15 
</td>

</tr>
<tr>
<td align="left" valign="top">
max_ups
</td>
<td align="left" valign="top" style="width: 3in;">
Max number of BFGS stiffness updates (5)
</td>
<td align="left" valign="top">
10 
</td>

</tr>
<tr>
<td align="left" valign="top">
optimize_bw
</td>
<td align="left" valign="top" style="width: 3in;">
Optimize bandwidth of stiffness matrix (6)
</td>
<td align="left" valign="top">
0 
</td>

</tr>
<tr>
<td align="left" valign="top">
restart
</td>
<td align="left" valign="top" style="width: 3in;">
Generate restart flag (7)
</td>
<td align="left" valign="top">
0 
</td>

</tr>
<tr>
<td align="left" valign="top">
plot_level
</td>
<td align="left" valign="top" style="width: 3in;">
Sets the level of state dumps to the plot file (8)
</td>
<td align="left" valign="top">
PLOT_MAJOR_ITRS 
</td>

</tr>
<tr>
<td align="left" valign="top">
plot_range
</td>
<td align="left" valign="top" style="width: 3in;">
Set the range of the states that will be stored to the plot file (9)
</td>
<td align="left" valign="top">
0,-1 
</td>

</tr>
<tr>
<td align="left" valign="top">
plot_stride
</td>
<td align="left" valign="top" style="width: 3in;">
Set the stride of the states that will be stored to the plot file (9)
</td>
<td align="left" valign="top">
1 
</td>

</tr>
<tr>
<td align="left" valign="top">
plot_zero_state
</td>
<td align="left" valign="top" style="width: 3in;">
Flag that controls whether the &ldquo;zero&rdquo; state will be written to the plot file, even if it is not defined in the range (9)
</td>
<td align="left" valign="top">
0 (false) 
</td>

</tr>
<tr>
<td align="left" valign="top">
cmax
</td>
<td align="left" valign="top" style="width: 3in;">
Set the max condition number for the stiffness matrix (10)
</td>
<td align="left" valign="top">
1e<span class="MathJax_Preview"><script type="math/tex">
+
</script>
</span>5 
</td>

</tr>
<tr>
<td align="left" valign="top">
analysis
</td>
<td align="left" valign="top" style="width: 3in;">
Sets the analysis type (11)
</td>
<td align="left" valign="top">
static 
</td>

</tr>
<tr>
<td align="left" valign="top">
print_level
</td>
<td align="left" valign="top" style="width: 3in;">
Sets the amount of output that is generated on screen (12)
</td>
<td align="left" valign="top">
PRINT_MINOR_ITRS 
</td>

</tr>
<tr>
<td align="left" valign="top">
min_residual
</td>
<td align="left" valign="top" style="width: 3in;">
Sets minimal value for residual tolerance (13)
</td>
<td align="left" valign="top">
1e-20 
</td>

</tr>
<tr>
<td align="left" valign="top">
integration
</td>
<td align="left" valign="top" style="width: 3in;">
Set the integration rule for a particular element (14)
</td>
<td align="left" valign="top">
N/A 
</td>

</tr>
<tr>
<td align="left" valign="top">
output_level
</td>
<td align="left" valign="top" style="width: 3in;">
Controls when to output data to file (15)
</td>
<td align="left" valign="top">
OUTPUT_MAJOR_ITRS 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
<i>Comments</i>:
</div>
<ol>
<li>
The total running time of the analysis is determined by <i>ntime </i>* <i>dt</i>. Note that when the auto-time stepper is enabled (see below), the actual number of time steps and time step size may be different than specified in the input file. However, the total running time will always be determined by <i>ntime </i>* <i>dt.</i> 
</li>
<li>
FEBio determines convergence of a time step based on three convergence criteria: displacement, residual and energy (that is, residual multiplied by displacement). Each of these criteria requires a tolerance value that will determine convergence when the relative change will drop below this value. For example, a displacement tolerance of <span class="MathJax_Preview"><script type="math/tex">
\varepsilon
</script>
</span> means that the ratio of the displacement increment (i.e. the solution of the linearized FE equations, <span class="MathJax_Preview"><script type="math/tex">
\Delta\mathbf{U}=-\mathbf{K}_{k}^{-1}\mathbf{R}_{k})
</script>
</span> norm at the current iteration <span class="MathJax_Preview"><script type="math/tex">
k+
</script>
</span><i>1</i> to the norm of the total displacement (<span class="MathJax_Preview"><script type="math/tex">
\mathbf{U}_{k+1}=\mathbf{U}_{k}+\Delta\mathbf{U})
</script>
</span> must be less than <span class="MathJax_Preview"><script type="math/tex">
\varepsilon
</script>
</span>:<span class="MathJax_Preview">
<script type="math/tex;mode=display">

\frac{\left\Vert \Delta\mathbf{U}\right\Vert }{\left\Vert \mathbf{U}_{k+1}\right\Vert }<\varepsilon

</script>

</span>
For the residual and energy norms, it is the ratio of the current residual norm (resp. energy norm) to the initial one that needs to be less than the specified convergence tolerance.<div class="Unindented">
To disable a specific convergence criterion, set the corresponding tolerance to zero. For example, by default, the residual tolerance is zero, so that this convergence criterion is not used.
</div>

</li>
<li>
The <i>lstol</i> parameter controls the scaling of the vector direction obtained from the line search. A line search method is used to improve the convergence of the nonlinear (quasi-) Newton solution algorithm. After each BFGS or Newton iteration, this algorithm searches in the direction of the displacement increment for a solution that has less energy (that is, residual multiplied with the displacement increment) than the previous iteration. In many problems this will automatically be the case. However, in some problems that are very nonlinear (e.g. contact), the line search can improve convergence significantly. The line search can be disabled by setting the <i>lstol</i> parameter to zero, although this is not recommended. 
</li>
<li>
If the <i>time_stepper</i> parameter is defined it will enable the auto time-stepper, which will adjust the new time step size based on convergence information from the previous time step. The following sub-elements may also be defined, although all are optional. Note that these are sub-elements of the <i>time_stepper </i>element and not of the <i>Control </i>element.<div class="Unindented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
<b>Parameter</b>
</td>
<td align="left" valign="top">
<b>Description</b>
</td>
<td align="left" valign="top">
<b>Default</b> 
</td>

</tr>
<tr>
<td align="left" valign="top">
dtmin
</td>
<td align="left" valign="top">
Minimum time step size
</td>
<td align="left" valign="top">
dt/3 
</td>

</tr>
<tr>
<td align="left" valign="top">
dtmax
</td>
<td align="left" valign="top">
Maximum time step size
</td>
<td align="left" valign="top">
dt*3 
</td>

</tr>
<tr>
<td align="left" valign="top">
max_retries
</td>
<td align="left" valign="top">
Maximum nr. of retries allowed per time step
</td>
<td align="left" valign="top">
5 
</td>

</tr>
<tr>
<td align="left" valign="top">
opt_iter
</td>
<td align="left" valign="top">
Optimal number of iterations
</td>
<td align="left" valign="top">
10 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
The <i>dtmin </i>and <i>dtmax</i> values are used to constrain the range of possible time step values. The <i>opt_iter </i>defines the estimated optimal number of quasi-Newton iterations. If the actual number of iterations is less than or equal to this value the time step size is increased, otherwise it is decreased.
</div>
<div class="Indented">
When a time step fails (e.g. due to a negative jacobian), FEBio will retry the time step with a smaller time step size. The <i>max_retries </i>parameter determines the maximum number of times a timestep may be retried before FEBio error terminates. The new time step size is determined by the ratio of the previous time step size and the <i>max_retries</i> parameter. For example, if the last time step size is 0.1 and <i>max_retries </i>is set to 5, then the time step size is adjusted by 0.02: The first retry will have a step size of 0.08; the next will be 0.06, and so on.
</div>
<div class="Indented">
The user can specify a load curve for the <i>dtmax </i>parameter. This load curve is referred to as the <i>must-point </i>curve and serves two purposes. Firstly, it defines the value of the <i>dtmax </i>parameter as a function of time. This can be useful, for instance, to enforce smaller time steps during rapid loading or larger time steps when approaching steady-state in a transient analysis. Secondly, the time points of the <i>dtmax </i>loadcurve define so-called <i>must-points</i>. A must-point is a time point where FEBio must pass through. This is useful for synchronizing the auto-time stepper with the loading scenario. For instance, when loading starts at time 0.5, adding a must-point at this time will guarantee that the timestepper evaluates the model at that time. In conjunction with the PLOT_MUST_POINT value of the <i>plot_level </i>parameter, this option can also be used to only write results to the plotfile at the specified time points. Consider the following example.
</div>
<pre class="LyX-Code">
&lt;dtmax lc="1"&gt;0.1&lt;/dtmax&gt;
...
&lt;loadcurve id="1" type="step"&gt;
  &lt;loadpoint&gt;0,0&lt;/loadpoint&gt;
  &lt;loadpoint&gt;0.5, 0.1&lt;/loadpoint&gt;
  &lt;loadpoint&gt;1.0, 0.2&lt;/loadpoint&gt;
&lt;/loadcurve&gt;
</pre>
<div class="Unindented">
This example defines load curve 1 as the <i>must-point </i>curve. This curve defines three points where FEBio will pass through (namely 0, 0.5 and 1.0). The values of each time point is the value of the maximum time-step size (<i>dtmax</i>). Since the curve is defined as a step-function, each value is valid up to the corresponding time-point. Thus, between time 0 and time 0.5, the maximum time step value is 0.1. Between 0.5 and 1.0 the maximum time step value is 0.2. If the <i>plot_level </i>parameter is set to PLOT_MUST_POINTS, then only the three defined time points will be stored to the plotfile.
</div>

</li>
<li>
The <i>max_ups </i>and <i>max_refs </i>parameters control the BFGS method that FEBio uses to solve the nonlinear FE equations. In this method the global stiffness matrix is only calculated at the beginning of each time step. For each iteration, a matrix update is then done. The maximum number of such updates is set with <i>max_ups</i>. When FEBio reaches this number, it reforms the global stiffness matrix (that is, it recalculates it) and factorizes it, essentially taking a "full Newton" iteration. Then FEBio continues with BFGS iterations. The <i>max_refs </i>parameter is used to set the maximum of such reformations FEBio can do, before it fails the timestep. In that case, FEBio will either terminate or, if the auto-time stepper is enabled, retry with a smaller time step size. <div class="Unindented">
Note that when max_ups is set to 0, FEBio will use the Full-Newton method instead of the BFGS method. In other words, the stiffness matrix is reformed for every iteration. In this case it is recommended to increase the number of <i>max_refs </i>(to e.g. 50), since the default value might cause FEBio to terminate prematurely when convergence is slow.
</div>

</li>
<li>
The <i>optimize_bw</i> parameter enables bandwidth minimization for the global stiffness matrix. This can drastically decrease the memory requirements and running times when using the skyline solver. It is highly recommended when using the skyline solver. <pre class="LyX-Code">
&lt;optimize_bw&gt;1&lt;/optimize_bw&gt;
</pre>
<div class="Unindented">
When using a different linear solver (e.g., pardiso or SuperLU), the bandwidth optimization can still be performed if so desired. However, for these solvers there will be little or no effect since these solvers are not as sensitive to the bandwidth as the skyline solver.
</div>

</li>
<li>
The <i>restart</i> parameter can be used to generate a restart dump file. To activate it, specify a non-zero value. A filename may be specified as an option. If the filename is omitted, a default name will be provided. Note that this will only generate the binary dump file that is needed to restart the analysis. To override certain parameters before restarting, create a restart input file. FEBio does not generate this file automatically so the user needs to create that file manually. See Chapter <a class="Reference" href="#chap:Restart-Input-file">5↓</a> on the format of the restart input file. <pre class="LyX-Code">
&lt;restart file="out.dmp"&gt;1&lt;/restart&gt;
</pre>

</li>
<li>
The <i>plot_level </i>allows the user to control exactly when the solution is to be saved to the plot file. The following values are allowed: <div class="Unindented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
<b>Value</b>
</td>
<td align="left" valign="top">
<b>Description</b> 
</td>

</tr>
<tr>
<td align="left" valign="top">
PLOT_NEVER
</td>
<td align="left" valign="top">
Don’t save the solution 
</td>

</tr>
<tr>
<td align="left" valign="top">
PLOT_MAJOR_ITRS
</td>
<td align="left" valign="top">
Save the solution after each converged timestep 
</td>

</tr>
<tr>
<td align="left" valign="top">
PLOT_MINOR_ITRS
</td>
<td align="left" valign="top">
Save the solution for every quasi-Newton iteration 
</td>

</tr>
<tr>
<td align="left" valign="top">
PLOT_MUST_POINTS
</td>
<td align="left" valign="top">
Only save the solution at the must points 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
The PLOT_MUST_POINTS option must be used in conjunction of a <i>must-point </i>curve. See the comments on the <i>dtmax </i>parameter for more information on must-point curves. When the <i>plot_level </i>option is set to PLOT_MUST_POINTS, only the time-points defined in the must-point curve are stored to the plotfile.
</div>

</li>
<li>
When using the fixed time stepper, several parameters control which time steps are stored to the plot file. <div class="Unindented">
The <i>plot_range </i>parameter sets the range of the states that will be stored to the plot file. The range is defined by two values that specify the first and last time step that will be stored to the plot file. The value &ldquo;0&rdquo; refers to the initial time step, usually time zero, and negative values count backwards from the final time step (as defined by the <i>time_steps</i> parameter). For instance, the default values,
</div>
<pre class="LyX-Code">
&lt;plot_range&gt;0,-1&lt;/plot_range&gt;
</pre>
<div class="Unindented">
store all time steps to the plot file, including the initial &ldquo;zero&rdquo; time step. As another example, to store only the last five time steps, set
</div>
<pre class="LyX-Code">
&lt;plot_range&gt;-5,-1&lt;/plot_range&gt;
</pre>
<div class="Unindented">
By default, all time steps within the range will be stored to the plot file. Time steps can be skipped using the <i>plot_stride </i>parameter. For instance, to store only every 10 steps, set
</div>
<pre class="LyX-Code">
&lt;plot_stride&gt;10&lt;/plot_stride&gt;
</pre>
<div class="Unindented">
Note that the first and last time step defined by the range will always be stored, regardless of the plot stride.
</div>
<div class="Indented">
The &ldquo;zero&rdquo; time step refers to the initial state of the model, before any calculations are done. This state will only be stored to the plot file if the minimal value of the plot range is set to zero. To force storing this state to the plot file, set the <i>plot_zero_state </i>parameter to one.
</div>
<pre class="LyX-Code">
&lt;plot_zero_state&gt;1&lt;/plot_zero_state&gt;
</pre>
<div class="Unindented">
This will store the zero time step to the plot file, even when it is not specified inside the plot range.
</div>
<div class="Indented">
Again, the <i>plot_range</i>, <i>plot_stride</i>, and <i>plot_zero_state</i> parameters are only used by the fixed time stepper. Currently, these parameters are not used with the auto time stepper.
</div>

</li>
<li>
When the condition number of the stiffness matrix becomes too large, inversions of the stiffness matrix become inaccurate. This will negatively affect the convergence of the quasi-Newton or Newton solution algorithm. FEBio monitors the condition number of the BFGS stiffness update and when it exceeds <i>cmax </i>it reforms the stiffness matrix. <pre class="LyX-Code">
&lt;cmax&gt;1e5&lt;/cmax&gt;
</pre>

</li>
<li>
The <i>analysis </i>element sets the analysis type. Currently, FEBio defines three analysis types: (quasi-)static, steady-state, and dynamic. In a quasi-static analysis, inertial effects are ignored and an equilibrium solution is sought. Note that in this analysis mode it is still possible to simulate time dependant effects such as viscoelasticity. In a dynamic analysis the inertial effects are included.<div class="Unindented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
<b>Value</b>
</td>
<td align="left" valign="top" style="width: 3in;">
<b>Description</b> 
</td>

</tr>
<tr>
<td align="left" valign="top">
static
</td>
<td align="left" valign="top" style="width: 3in;">
(quasi-) static analysis 
</td>

</tr>
<tr>
<td align="left" valign="top">
steady-state
</td>
<td align="left" valign="top" style="width: 3in;">
steady-state response of a transient (quasi-static) biphasic, biphasic-solute, or triphasic analysis 
</td>

</tr>
<tr>
<td align="left" valign="top">
dynamic
</td>
<td align="left" valign="top" style="width: 3in;">
dynamic analysis. 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>

</li>
<li>
The <i>print_level </i>allows the user to control exactly how much output is written to the screen. The following values are allowed: <div class="Unindented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
<b>Value</b>
</td>
<td align="left" valign="top">
<b>Description</b> 
</td>

</tr>
<tr>
<td align="left" valign="top">
PRINT_NEVER
</td>
<td align="left" valign="top">
Don’t generate any output 
</td>

</tr>
<tr>
<td align="left" valign="top">
PRINT_PROGRESS
</td>
<td align="left" valign="top">
Only print a progress bar 
</td>

</tr>
<tr>
<td align="left" valign="top">
PRINT_MAJOR_ITRS
</td>
<td align="left" valign="top">
Only print the converged solution 
</td>

</tr>
<tr>
<td align="left" valign="top">
PRINT_MINOR_ITRS
</td>
<td align="left" valign="top">
Print convergence information during equilibrium iterations 
</td>

</tr>
<tr>
<td align="left" valign="top">
PRINT_MINOR_ITRS_EXP
</td>
<td align="left" valign="top">
Print additional convergence info during equilib. iterations 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>

</li>
<li>
If no force is acting on the model, then convergence might be problematic due to numerical noise in the calculations. For example, this can happen in a displacement driven contact problem where one of the contacting bodies is moved before initial contact is made. When this happens, the residual norm will be very small. When it drops below the tolerance set by <i>min_residual</i>, FEBio will assume that there is no force acting on the system and will converge the time step. 
</li>
<li>
You can override FEBio’s default integration rule for specific element classes. For each element class, define a <i>rule </i>element in which you set the integration rule. <pre class="LyX-Code">
&lt;integration&gt;
  &lt;rule elem="&lt;elem&gt;"&gt;VALUE&lt;/rule&gt;
  &lt;!-- repeat rules for other elements --&gt;
&lt;/integration&gt;
</pre>
<div class="Unindented">
The <i>elem </i>attribute value defines for which element class you wish to override the default integration rule and can have any of the following values.
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
<b>elem</b>
</td>
<td align="left" valign="top">
<b>Description</b> 
</td>

</tr>
<tr>
<td align="left" valign="top">
hex8
</td>
<td align="left" valign="top">
8-node hexahedral element 
</td>

</tr>
<tr>
<td align="left" valign="top">
tet4
</td>
<td align="left" valign="top">
4-node linear tetrahedral element 
</td>

</tr>
<tr>
<td align="left" valign="top">
tet10
</td>
<td align="left" valign="top">
10-node quadratic tetrahedral element 
</td>

</tr>
<tr>
<td align="left" valign="top">
tet15
</td>
<td align="left" valign="top">
15-node quadratic tetrahedral element 
</td>

</tr>
<tr>
<td align="left" valign="top">
tri3
</td>
<td align="left" valign="top">
3-node linear triangles (e.g. for contact) 
</td>

</tr>
<tr>
<td align="left" valign="top">
tri6
</td>
<td align="left" valign="top">
6-node quadratic triangles 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
The values of the rule elements depend on the <i>elem </i>attribute. The tables below show the available integration rules for the different element types. The values marked with an asterisk (*) are the default.
</div>
<ul>
<li>
For the <i>hex8 </i>element, the following values are defined.<div class="Unindented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
<b>hex8</b>
</td>
<td align="left" valign="top">
<b>Description</b> 
</td>

</tr>
<tr>
<td align="left" valign="top">
GAUSS8*
</td>
<td align="left" valign="top">
Gaussian integration using 2x2x2 integration points. 
</td>

</tr>
<tr>
<td align="left" valign="top">
POINT6
</td>
<td align="left" valign="top">
Alternative integration rule for bricks using 6 integration point 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>

</li>
<li>
For the <i>tet4 </i>element, the following values are allowed.<div class="Unindented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
<b>tet4</b>
</td>
<td align="left" valign="top">
<b>Description</b> 
</td>

</tr>
<tr>
<td align="left" valign="top">
GAUSS4
</td>
<td align="left" valign="top">
Gaussian integration rule using 4 integration points. 
</td>

</tr>
<tr>
<td align="left" valign="top">
GAUSS1*
</td>
<td align="left" valign="top">
Gaussian integration rule using one integration point. 
</td>

</tr>
<tr>
<td align="left" valign="top">
UT4
</td>
<td align="left" valign="top">
Nodally integrated tetrahedron. (1) 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>

</li>

</ul>
<div class="Unindented">
<i>Comments:</i>
</div>
<div class="Indented">
1. The UT4 is a special formulation for tetrahedral elements that uses a nodally averaged integration rule, as proposed by Gee et al <span class="bibcites">[<a class="bibliocite" name="cite-19" href="#biblio-19"><span class="bib-index">19</span></a>]</span>. This formulation requires additional parameters. To override the default values, use the following alternative syntax:
</div>
<pre class="LyX-Code">
&lt;rule elem="tet4" type="UT4"&gt;
  &lt;alpha&gt;0.05&lt;/alpha&gt;
  &lt;iso_stab&gt;0&lt;/iso_stab&gt;
&lt;/rule&gt;
</pre>
<div class="Unindented">
The <i>alpha </i>parameter defines the amount of &ldquo;blending&rdquo; between the regular tet-contribution and the nodally integrated contribution. The value must be between 0 and 1, where 0 means no contribution from the regular tet and 1 means no contribution from the nodally averaged tet. The <i>iso_stab </i>parameter is a flag that chooses between two slightly different formulations of the nodally integrated tet. When set to 0, the stabilization is applied to the entire virtual work, whereas when set to 1 the stabilization is applied only to the isochoric part. See the <a href="http://help.mrl.sci.utah.edu/help/index.jsp">FEBio Theory Manual</a> for a detailed description of this formulation.
</div>
<ul>
<li>
For the <i>tet10 </i>element, the following integration rules are supported.<div class="Unindented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
<b>tet10</b>
</td>
<td align="left" valign="top">
<b>description</b> 
</td>

</tr>
<tr>
<td align="left" valign="top">
GAUSS4*
</td>
<td align="left" valign="top">
Gaussian integration rule using 4 integration points 
</td>

</tr>
<tr>
<td align="left" valign="top">
GAUSS8
</td>
<td align="left" valign="top">
Gaussian integration rule using 8 integration points 
</td>

</tr>
<tr>
<td align="left" valign="top">
LOBATTO11
</td>
<td align="left" valign="top">
Gauss-Lobatto integration rule using 11 integration points 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>

</li>

</ul>
<div class="Unindented">
<i>Notes:</i>
</div>
<div class="Indented">
The Lobatto integration rule differs from a regular Gauss integration rule in that it includes the vertices of the tetrahedral element. The <i>Lobatto11</i> integration rule uses the 10 tetrahedral nodes, plus one integration rule located at the center of the element.
</div>
<ul>
<li>
For the <i>tet15</i> element, the following integration rules are defined.<div class="Unindented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
<b>tet15</b>
</td>
<td align="left" valign="top">
<b>description</b> 
</td>

</tr>
<tr>
<td align="left" valign="top">
GAUSS8
</td>
<td align="left" valign="top">
Gaussian integration rule using 8 integration points 
</td>

</tr>
<tr>
<td align="left" valign="top">
GAUSS11
</td>
<td align="left" valign="top">
Gaussian integration rule using 11 integration points 
</td>

</tr>
<tr>
<td align="left" valign="top">
GAUSS15
</td>
<td align="left" valign="top">
Gaussian integration rule using 15 integration points 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>

</li>
<li>
For the <i>tri3 </i>element, the following integration rules are supported.<div class="Unindented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
<b>tri3</b>
</td>
<td align="left" valign="top">
<b>description</b> 
</td>

</tr>
<tr>
<td align="left" valign="top">
GAUSS1
</td>
<td align="left" valign="top">
Gaussian integration with one integration point 
</td>

</tr>
<tr>
<td align="left" valign="top">
GAUSS3*
</td>
<td align="left" valign="top">
Guassian integration with three integration rules. 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>

</li>
<li>
For the <i>tri6 </i>element, the following integration rules are supported.<div class="Unindented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
<b>tri6</b>
</td>
<td align="left" valign="top">
<b>description</b> 
</td>

</tr>
<tr>
<td align="left" valign="top">
GAUSS3*
</td>
<td align="left" valign="top">
Gaussian integration with 3 integration points 
</td>

</tr>
<tr>
<td align="left" valign="top">
GAUSS6
</td>
<td align="left" valign="top">
Gaussian integration with 6 integration points 
</td>

</tr>
<tr>
<td align="left" valign="top">
GAUSS4
</td>
<td align="left" valign="top">
Gaussian integration with 4 integration points 
</td>

</tr>
<tr>
<td align="left" valign="top">
GAUSS7
</td>
<td align="left" valign="top">
Gaussian integration with 7 integration points 
</td>

</tr>
<tr>
<td align="left" valign="top">
LOBATTO7
</td>
<td align="left" valign="top">
Gauss-Lobatto integration with 7 integration points. 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>

</li>

</ul>
<div class="Unindented">
<i>Notes:</i>
</div>
<div class="Indented">
The GAUSS6 rule has only nonzero weights at the edge nodes, which effectively reduces this rule to a 3-node rule.
</div>

</li>
<li>
The <i>output_level</i> can be used to control when FEBio outputs the data files. The following values are supported.<div class="Unindented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
<b>Value</b>
</td>
<td align="left" valign="top">
<b>Description</b> 
</td>

</tr>
<tr>
<td align="left" valign="top">
OUTPUT_NEVER
</td>
<td align="left" valign="top">
Don’t generate any output 
</td>

</tr>
<tr>
<td align="left" valign="top">
OUTPUT_MUST_POINTS
</td>
<td align="left" valign="top">
Only output at must points 
</td>

</tr>
<tr>
<td align="left" valign="top">
PRINT_MAJOR_ITRS
</td>
<td align="left" valign="top">
Output at end of each time step 
</td>

</tr>
<tr>
<td align="left" valign="top">
PRINT_MINOR_ITRS
</td>
<td align="left" valign="top">
Output at each iteration 
</td>

</tr>
<tr>
<td align="left" valign="top">
OUTPUT_FINAL
</td>
<td align="left" valign="top">
Only output the data at the last converged time step. 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>

</li>

</ol>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-3.5.2">3.5.2</a> Parameters for Biphasic Analysis<a class="Label" name="subsec:Parameters-Biphasic-Analysis"> </a>
</h3>
<div class="Unindented">
A biphasic analysis is defined by using the <i>biphasic </i>type in Module section. Since a biphasic analysis couples a fluid problem to a solid mechanics problem, all control parameters above can be used in a biphasic analysis. In addition, the following parameters can be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
<b>Parameter</b>
</td>
<td align="left" valign="top">
<b>Description</b>
</td>
<td align="left" valign="top">
<b>Default</b> 
</td>

</tr>
<tr>
<td align="left" valign="top">
ptol
</td>
<td align="left" valign="top">
Specify the fluid pressure convergence tolerance
</td>
<td align="left" valign="top">
0.01 
</td>

</tr>
<tr>
<td align="left" valign="top">
symmetric_biphasic
</td>
<td align="left" valign="top">
Choose between a symmetric or nonsymmetric formulation
</td>
<td align="left" valign="top">
1 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-3.5.3">3.5.3</a> Parameters for Solute Analysis<a class="Label" name="subsec:Parameters-Solute-Analysis"> </a>
</h3>
<div class="Unindented">
When the type attribute of the Module section is set to <i>solute</i> or <i>triphasic</i>,  an analysis is solved that includes solute transport. All parameters for a biphasic analysis can be used (including the ones for a structural mechanics analysis). In addition, the following parameters can be specified:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
<b>Parameter</b>
</td>
<td align="left" valign="top">
<b>Description</b>
</td>
<td align="left" valign="top">
<b>Default</b> 
</td>

</tr>
<tr>
<td align="left" valign="top">
ctol
</td>
<td align="left" valign="top">
Specify the concentration convergence tolerance
</td>
<td align="left" valign="top">
0.01 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-3.5.4">3.5.4</a> Parameters for Heat Analysis<a class="Label" name="subsec:Parameters-Heat-Analysis"> </a>
</h3>
<div class="Unindented">
A heat analysis uses the parameters defined in Section <a class="Reference" href="#subsec:Common-Parameters">3.5.1↑</a>. However, not all parameters have an effect. In particular, any parameter related to the auto-time stepping capability of FEBio or the nonlinear solution strategy is ignored.
</div>
<div class="Indented">
<p><br/>
</p>

</div>
<h2 class="Section">
<a class="toc" name="toc-Section-3.6">3.6</a> Globals Section<a class="Label" name="sec:Globals-Section"> </a>
</h2>
<div class="Unindented">
The <i>Globals</i> section is used to define some global variables, such as global constants, solute data and solid bound molecule data.
</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-3.6.1">3.6.1</a> Constants<a class="Label" name="subsec:Constants"> </a>
</h3>
<div class="Unindented">
Global constants currently include the universal gas constant <span class="MathJax_Preview"><script type="math/tex">
R
</script>
</span> [<b>F</b><span class="MathJax_Preview"><script type="math/tex">
\cdot
</script>
</span><b>L</b>/<b>n</b><span class="MathJax_Preview"><script type="math/tex">
\cdot
</script>
</span><b>T</b>], absolute temperature <span class="MathJax_Preview"><script type="math/tex">
\theta
</script>
</span> [<b>T</b>], and Faraday constant <span class="MathJax_Preview"><script type="math/tex">
F_{c}
</script>
</span> [<b>Q</b>/<b>n</b>]. These constants must be expressed in units consistent with the rest of the analysis:
</div>
<pre class="LyX-Code">
&lt;Globals&gt;
  &lt;Constants&gt;
    &lt;R&gt;8.314e-6&lt;/R&gt;
    &lt;T&gt;298&lt;/T&gt;
    &lt;Fc&gt;96485e-9&lt;/Fc&gt;
  &lt;/Constants&gt;
&lt;/Globals&gt;
</pre>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-3.6.2">3.6.2</a> Solutes<a class="Label" name="subsec:Solutes"> </a>
</h3>
<div class="Unindented">
In biphasic-solute, triphasic and multiphasic analyses, a unique identifier must be associated with each solute in order to enforce consistent nodal degrees of freedom across boundaries of different materials. This unique identification is achieved by listing each solute species that appears in the entire finite element model and associating it with a unique <i>id</i>, <i>nam,e</i> charge number <span class="MathJax_Preview"><script type="math/tex">
z^{\alpha}
</script>
</span>, molar mass <span class="MathJax_Preview"><script type="math/tex">
M^{\alpha}
</script>
</span>, and density <span class="MathJax_Preview"><script type="math/tex">
\rho_{T}^{\alpha}
</script>
</span>:
</div>
<pre class="LyX-Code">
&lt;Globals&gt;
  &lt;Solutes&gt;
    &lt;solute id="1" name="Na"&gt;
      &lt;charge_number&gt;1&lt;/charge_number&gt;
      &lt;molar_mass&gt;22.99&lt;/molar_mass&gt;
      &lt;density&gt;0.97&lt;density&gt;
    &lt;/solute&gt;
    &lt;solute id="2" name="Cl"&gt;
      &lt;charge_number&gt;-1&lt;/charge_number&gt;
      &lt;molar_mass&gt;35.45&lt;/molar_mass&gt;
      &lt;density&gt;3.21&lt;density&gt;
    &lt;/solute&gt;
    &lt;solute id="3" name="Glc"&gt;
      &lt;charge_number&gt;0&lt;/charge_number&gt;
      &lt;molar_mass&gt;180.16&lt;/molar_mass&gt;
      &lt;density&gt;1.54&lt;density&gt;
    &lt;/solute&gt;
  &lt;/Solutes&gt;
&lt;/Globals&gt;
</pre>
<div class="Unindented">
These solute identification numbers should be referenced in the <i>sol</i> attribute of solutes when defining a biphasic-solute (Section <a class="Reference" href="#subsec:General-Specification-BS-Materials">4.8.2↓</a>), triphasic or multiphasic material (Section <a class="Reference" href="#subsec:General-Specification-Multiphasic-Mat">4.9.2↓</a>).
</div>
<div class="Indented">
The molar mass and density of solutes are needed only when solutes are involved in chemical reactions. When not specified, default values for these properties are set to 1.
</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-3.6.3">3.6.3</a> Solid-Bound Molecules<a class="Label" name="subsec:Solid-Bound-Molecules"> </a>
</h3>
<div class="Unindented">
In multiphasic analyses with chemical reactions involving solid-bound molecules, a unique identifier must be associated with each such molecule in order to enforce consistent properties across the entire model. This unique identification is achieved by listing each solid-bound species that appears in the entire finite element model and associating it with a unique <i>id</i>, <i>name,</i> charge number, molar mass and density:
</div>
<pre class="LyX-Code">
&lt;Globals&gt;
  &lt;SolidBoundMolecules&gt;
    &lt;solid_bound id="1" name="CS"&gt;
      &lt;charge_number&gt;-2&lt;/charge_number&gt;
      &lt;molar_mass&gt;463.37&lt;/molar_mass&gt;
      &lt;density&gt;1.5&lt;density&gt;
    &lt;/solid_bound &gt;
  &lt;/SolidBoundMolecules &gt;
&lt;/Globals&gt;
</pre>
<div class="Unindented">
The <i>id</i> number should be referenced in the <i>sbm</i> attribute of solid-bound molecules when included in the definition of a multiphasic material (Section <a class="Reference" href="#sec:Triphasic-Multiphasic-Materials">4.9↓</a>). The charge number is used in the calculation of the fixed charge density contributed by this solid-bound molecule to the overall solid matrix fixed-charge density. The density is used in the calculation of the contribution of this molecule to the referential solid volume fraction. The density and molar mass are used in the calculation of the molar volume of this molecule in chemical reactions.
</div>
<div class="Indented">
<p><br/>
</p>

</div>
<h2 class="Section">
<a class="toc" name="toc-Section-3.7">3.7</a> Material Section<a class="Label" name="sec:Material-Section"> </a>
</h2>
<div class="Unindented">
The material section is defined by the <i>Material</i> element. This section defines all the materials and material parameters that are used in the model. A material is defined by the <i>material</i> child element. This element has two attributes: <i>id,</i> which specifies a number that is used to reference the material, and <i>type</i>, which specifies the type of the material. The <i>material</i> element can also have a third optional attribute called <i>name</i>, which can be used to identify the material by a text description. A material definition might look like this:
</div>
<pre class="LyX-Code">
&lt;material id="1" type="isotropic elastic"&gt;
</pre>
<div class="Unindented">
Or, if the optional <i>name</i> attribute is present:
</div>
<pre class="LyX-Code">
&lt;material id="2" type="rigid body" name="femur"&gt;
</pre>
<div class="Unindented">
The material name is required for parameter optimizations since the material parameters are resolved using the material’s name.
</div>
<div class="Indented">
The material parameters that have to be entered depend on the material type. A complete list of available materials is provided in Chapter <a class="Reference" href="#chap:Materials">4↓</a>.
</div>
<div class="Indented">
<p><br/>
</p>

</div>
<h2 class="Section">
<a class="toc" name="toc-Section-3.8">3.8</a> Geometry Section<a class="Label" name="sec:Geometry-Section"> </a>
</h2>
<div class="Unindented">
The geometry section contains all the geometry data, including nodal coordinates and element connectivity. It has the following sub-sections:
</div>
<div class="Description">
<span class="Description-entry"><i><i>Nodes</i></i></span> contains nodal coordinates 
</div>
<div class="Description">
<span class="Description-entry"><i><i>Elements</i></i></span> contains element connectivity 
</div>
<div class="Description">
<span class="Description-entry"><i><i>NodeSet</i></i></span> defines a node set 
</div>
<div class="Description">
<span class="Description-entry"><i><i>Edge</i></i></span> defines an edge, i.e. a set of line elements 
</div>
<div class="Description">
<span class="Description-entry"><i><i>Surface</i></i></span> defines a surface, i.e. a set of facets 
</div>
<div class="Description">
<span class="Description-entry"><i><i>DiscreteSet</i></i></span> <i></i>defines a set of discrete elements (e.g. springs) 
</div>
<div class="Description">
<span class="Description-entry"><i><i>ElementSet</i></i></span> defines an element set 
</div>
<div class="Description">
<span class="Description-entry"><i><i>SurfacePair</i></i></span> <i></i>define a surface pair that can be used by a contact definition. 
</div>
<div class="Unindented">
The <i>Nodes </i>and <i>Elements </i>sections are required. The other sections are optional. The <i>NodeSet</i>, <i>Edge</i>, <i>Surface</i>, <i>DiscreteSet</i>, <i>ElementSet</i>, and <i>SurfacePair </i>sections define sets of nodes, edges, facets, discrete elements, elements, and surface pairs, respectively, and can be referenced by other sections of the model file. For instsance, boundary conditions can be defined by referencing the sets to which the boundary condition will be applied.
</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-3.8.1">3.8.1</a> Nodes Section<a class="Label" name="subsec:Nodes-Section"> </a>
</h3>
<div class="Unindented">
The <i>Nodes </i>section contains nodal coordinates. It has an optional attribute called <i>name</i>. If this attribute is defined, the <i>Nodes </i>section also defines a node set.
</div>
<pre class="LyX-Code">
&lt;Nodes [name="&lt;set name&gt;"]&gt;
</pre>
<div class="Unindented">
The nodes are defined using the <i>node </i>tag which is a child of the <i>Nodes </i>section. Repeat the following XML-element for each node:
</div>
<pre class="LyX-Code">
&lt;node id="n"&gt;x,y,z&lt;/node&gt;
</pre>
<div class="Unindented">
The <i>id</i> attribute is the global identifier of the node and must be a unique number within the model definition. This <i>id</i> is used as a reference in the element connectivity section.
</div>
<div class="Indented">
Multiple <i>Nodes </i>sections can be defined, but each node can only be defined once. For example:
</div>
<pre class="LyX-Code">
&lt;Nodes name="set01"&gt;
  &lt;node id="1"&gt;0,0,0,&lt;/node&gt;
  ...
  &lt;/node id="101"&gt;1,1,1&lt;/node&gt;
&lt;/Nodes&gt;
&lt;Nodes name ="set02"&gt;
  &lt;node id="102"&gt;2,1,1&lt;/node&gt;
  ...
  &lt;node id="999"&gt;2,2,2&lt;/node&gt;
&lt;/Nodes&gt;
</pre>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-3.8.2">3.8.2</a> Elements Section<a class="Label" name="subsec:Elements-Section"> </a>
</h3>
<div class="Unindented">
The <i>Elements</i> sections contain a list of the element connectivity data. Multiple <i>Elements </i>sections can be defined. The <i>Elements </i>section can have the following attributes.
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
<b>Attribute</b>
</td>
<td align="left" valign="top">
<b>Description</b> 
</td>

</tr>
<tr>
<td align="left" valign="top">
mat
</td>
<td align="left" valign="top">
material identifier 
</td>

</tr>
<tr>
<td align="left" valign="top">
type
</td>
<td align="left" valign="top">
element type 
</td>

</tr>
<tr>
<td align="left" valign="top">
name
</td>
<td align="left" valign="top">
unique name that identifies this domain (optional) 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
Each <i>Elements </i>section contains multiple <i>elem </i>elements that define the element connectivities. Each <i>elem </i>tag has a <i>id </i>attribute that defines the element number. For example, the following <i>Elements</i> section defines a list of hexahedral elements:
</div>
<pre class="LyX-Code">
&lt;Elements type="hex8" mat="1" name="part1"&gt;
  &lt;elem id="1"&gt;1,2,3,4,5,6,7,8&lt;/elem&gt;
  &lt;elem id="2"&gt;1,2,3,4,5,6,7,8&lt;/elem&gt;
  &lt;...&gt;
&lt;/Elements&gt;
</pre>
<div class="Unindented">
FEBio classifies elements in two categories, namely <i>solids </i>and <i>shells</i>.
</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-3.8.2.1">3.8.2.1</a> Solid Elements<a class="Label" name="subsec:Solid-Elements"> </a>
</h4>
<div class="Unindented">
The following solid element types are defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
hex8
</td>
<td align="left" valign="top">
8-node trilinear hexahedral element 
</td>

</tr>
<tr>
<td align="left" valign="top">
hex20
</td>
<td align="left" valign="top">
20-node quadratic hexahedral elements 
</td>

</tr>
<tr>
<td align="left" valign="top">
hex27
</td>
<td align="left" valign="top">
27-node quadratic hexahedral elements 
</td>

</tr>
<tr>
<td align="left" valign="top">
penta6
</td>
<td align="left" valign="top">
6-node linear pentahedral (wedge) element 
</td>

</tr>
<tr>
<td align="left" valign="top">
tet4
</td>
<td align="left" valign="top">
4-node linear tetrahedral element 
</td>

</tr>
<tr>
<td align="left" valign="top">
tet10
</td>
<td align="left" valign="top">
10-node quadratic tetrahedral element 
</td>

</tr>
<tr>
<td align="left" valign="top">
tet15
</td>
<td align="left" valign="top">
15-node quadratic tetrahedral element 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
The node numbering has to be defined as in the figure below.
</div>
<div class="Indented">
<div class="center">
<div class="Frameless" style="width: 100%;">
<div class="PlainVisible">
<div class="center">
<img class="embedded" src="Figures/FigNodeNumberingSolidElements.png" alt="figure Figures/FigNodeNumberingSolidElements.png" style="max-width: 397px; max-height: 149px;"/>

</div>
<br/>
<div class="center">
Node numbering for solid elements
</div>

</div>

</div>

</div>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-3.8.2.2">3.8.2.2</a> Shell Elements<a class="Label" name="subsec:Shell-Elements"> </a>
</h4>
<div class="Unindented">
FEBio currently supports a 4-noded quadrilateral and a 3-noded triangular shell element.
</div>
<div class="Indented">
<div class="center">
<div class="Frameless" style="width: 100%;">
<div class="PlainVisible">
<div class="center">
<img class="embedded" src="Figures/FigNodeNumberingShellElements.png" alt="figure Figures/FigNodeNumberingShellElements.png" style="max-width: 334px; max-height: 112px;"/>

</div>
<br/>
<div class="center">
Node numbering for shell elements
</div>

</div>

</div>

</div>

</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-3.8.3">3.8.3</a> NodeSet Section<a class="Label" name="subsec:NodeSet-Section"> </a>
</h3>
<div class="Unindented">
The <i>NodeSet </i>section allows users to define node sets. These node sets can then later be used in the definition of the fixed and prescribed boundary conditions. A node set is defined by the <i>NodeSet </i>tag. This tag takes one required attribute, <i>name</i>, which defines the name of the node set. A node set definition is followed by a list of nodes. For each a <i>node </i>tag is defined which requires one attribute, named &ldquo;id&rdquo;, which takes the node number as its value. For example,
</div>
<pre class="LyX-Code">
&lt;NodeSet name="nodeset1"&gt;
  &lt;node id="1"/&gt;
  &lt;node id="2"/&gt;
  &lt;node id="101"/&gt;
  &lt;node id="102"/&gt;
&lt;/NodeSet&gt;
</pre>
<div class="Unindented">
Node sets can also be nested.
</div>
<pre class="LyX-Code">
&lt;NodeSet name="set1"&gt; ... &lt;/NodeSet&gt;
&lt;NodeSet name="set2"&gt; ... &lt;/NodeSet&gt;
&lt;NodeSet name="set3"&gt;
&lt;NodeSet node_set="set1"/&gt;
&lt;NodeSet node_set="set2"/&gt;
&lt;NodeSet&gt;
</pre>
<div class="Unindented">
This is useful for defining larger nodesets without repeating node numbers.
</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-3.8.4">3.8.4</a> Edge Section<a class="Label" name="subsec:Edge-Section"> </a>
</h3>
<div class="Unindented">
The <i>Edge </i>section allows users to define a set of edges. These edges can be used to define boundary conditions or load.s
</div>
<pre class="LyX-Code">
&lt;Edge name="edge1"&gt;
  &lt;line2 lid="1"&gt;1,2&lt;/line2&gt;
  &lt;line2 lid="2"&gt;2,3&lt;/line2&gt;
&lt;/Edge&gt;
</pre>
<div class="Unindented">
Here, the <i>lid </i>attribute defines the <i>local </i>id of the edge, local with respect to the edge definition. The local ids must begin at 1 and defined sequentially.
</div>
<div class="Indented">
The edge elements are defined by using a tag that depends on the type of the edge element. The following edge elements are currently supported.
</div>
<div class="Description">
<span class="Description-entry"><i>line2</i></span> 2-node line element 
</div>
<div class="Description">
<span class="Description-entry"><i>line3</i></span> 3-node line element 
</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-3.8.5">3.8.5</a> Surface Section<a class="Label" name="subsec:Surface-Section"> </a>
</h3>
<div class="Unindented">
The <i>Surface </i>section allows users to define surfaces. These surfaces can then later be used to define the boundary conditions and contact definitions. A surface definition is followed by a list of surface elements, following the format described below.
</div>
<pre class="LyX-Code">
&lt;Surface name="named_surface"&gt;
  &lt;quad4 lid="1"&gt;1,2,3,4&lt;/quad4&gt;
  &lt;...&gt;
&lt;/Surface&gt;
</pre>
<div class="Unindented">
The <i>Surface </i>takes one required attribute, namely the <i>name</i>. This attribute sets the name of the surface. This name will be used later to refer back to this surface.
</div>
<div class="Indented">
The following surface elements are available:
</div>
<div class="Description">
<span class="Description-entry"><i>quad4</i></span> 4-node quadrilateral element 
</div>
<div class="Description">
<span class="Description-entry"><i>quad8</i></span> 8-node serendipity quadrilater element 
</div>
<div class="Description">
<span class="Description-entry"><i>tri3</i></span> 3-node triangular element 
</div>
<div class="Description">
<span class="Description-entry"><i>tri6</i></span> 6-node quadratic triangular element 
</div>
<div class="Description">
<span class="Description-entry"><i>tri7</i></span> 7-node quadratic triangular element 
</div>
<div class="Unindented">
The value for the surface element is the nodal connectivity:
</div>
<pre class="LyX-Code">
&lt;quad4 id="n"&gt;n1,n2,n3,n4&lt;/quad4&gt;
&lt;tri3 id="n"&gt;n1,n2,n3&lt;/tri3&gt;
</pre>
<div class="Unindented">
Surface elements cannot overlap element boundaries. That is, the surface element must belong to a specific element. Surface elements do not contribute to the total number of elements in the mesh. They are also not to be confused with shell elements.
</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-3.8.6">3.8.6</a> DiscreteSet Section<a class="Label" name="subsec:DiscreteSet-Section"> </a>
</h3>
<div class="Unindented">
The <i>DiscreteSet </i>section defines sets of discrete elements. These sets can then be used to define e.g. springs.
</div>
<pre class="LyX-Code">
&lt;DiscreteSet name="springs"&gt;
  &lt;delem&gt;1,2&lt;/delem&gt;
  &lt;delem&gt;3,4&lt;/delem&gt;
&lt;/DiscreteSet&gt;
</pre>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-3.8.7">3.8.7</a> ElementSet Section<a class="Label" name="subsec:ElementSet-Section"> </a>
</h3>
<div class="Unindented">
The <i>ElementSet </i>section can be used to define an element set. Element sets can be used to output data for only a subset of elements. An element set is defined through the <i>ElementSet </i>tag, which takes one attribute, namely <i>name</i> that specifies the name of the element set. For each element in the set, an <i>elem </i>tag is defined which takes the element id as an attribute. For example,
</div>
<pre class="LyX-Code">
&lt;ElementSet name="set01"&gt;
  &lt;elem id="1001"/&gt;
  &lt;elem id="1002"/&gt;
  &lt;elem id="1003"/&gt;
&lt;/ElementSet&gt;
</pre>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-3.8.8">3.8.8</a> SurfacePair Section<a class="Label" name="subsec:SurfacePair-Section"> </a>
</h3>
<div class="Unindented">
The <i>SurfacePair </i>section defines a pair of surfaces that can be used to define surface-to-surface interactions (e.g. contact).
</div>
<pre class="LyX-Code">
&lt;SurfacePair name="contact1"&gt;
  &lt;master surface="surface1"/&gt;
  &lt;slave surface="surface2"/&gt;
&lt;/SurfacePair&gt;
</pre>
<div class="Unindented">
The surfaces (i.e. <i>surface1 </i>and <i>surface2</i>) are surfaces defined in the <i>Surface </i>section. Because surfaces must already be defined before they can be referenced in the <i>SurfacePair </i>section, the <i>Surface </i>must be defined before the <i>SurfacePair </i>section.
</div>
<div class="Indented">
<p><br/>
</p>

</div>
<h2 class="Section">
<a class="toc" name="toc-Section-3.9">3.9</a> MeshData Section<a class="Label" name="sec:MeshData-Section"> </a>
</h2>
<div class="Unindented">
The <i>MeshData </i>section is where data can be specified that will be mapped to the primitives of the model (i.e. nodes, edges, facets, and elements). Different tags are used to map to different primitive types.
</div>
<div class="Description">
<span class="Description-entry"><i>ElementData</i></span> defines element data 
</div>
<div class="Description">
<span class="Description-entry"><i>SurfaceData</i></span> defines surface data 
</div>
<div class="Description">
<span class="Description-entry"><i>EdgeData</i></span> defines edge data 
</div>
<div class="Description">
<span class="Description-entry"><i>NodeData</i></span> defines node data 
</div>
<div class="Unindented">
For each of these sections a list of items and the data for that item follows. It is important to node that the IDs used in this section are all <i>local IDs</i>, i.e. indices into the array of the set definition.
</div>
<div class="Indented">
Data is then defined for predefined variables (i.e. material parameters) or user-defined data maps. Predefined variables are referenced using the <i>var </i>attribute. User defined data requires the <i>name </i>attribute as well as additional attributes to define the specific data type and format as listed below.
</div>
<div class="Description">
<span class="Description-entry"><b>data type</b></span> <b></b>defines the type of data 
</div>
<div class="Description">
<span class="Description-entry"><b>data format</b></span> defines how the data is mapped to the set. 
</div>
<div class="Unindented">
The following table lists the supported data types.
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
<b>data type</b>
</td>
<td align="left" valign="top">
<b>Description</b> 
</td>

</tr>
<tr>
<td align="left" valign="top">
scalar
</td>
<td align="left" valign="top">
A single floating point value 
</td>

</tr>
<tr>
<td align="left" valign="top">
vec2
</td>
<td align="left" valign="top">
A 2D vector defined as <span class="MathJax_Preview"><script type="math/tex">
x
</script>
</span>, <span class="MathJax_Preview"><script type="math/tex">
y
</script>
</span> 
</td>

</tr>
<tr>
<td align="left" valign="top">
vec3
</td>
<td align="left" valign="top">
A 3D vector defined as <span class="MathJax_Preview"><script type="math/tex">
x
</script>
</span>, <span class="MathJax_Preview"><script type="math/tex">
y
</script>
</span>, <span class="MathJax_Preview"><script type="math/tex">
z
</script>
</span> 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
If the data type is not defined, the <i>scalar </i>data type is assumed.
</div>
<div class="Indented">
The following table lists the supported data formats.
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
<b>data format</b>
</td>
<td align="left" valign="top" style="width: 3in;">
<b>Description</b> 
</td>

</tr>
<tr>
<td align="left" valign="top">
const
</td>
<td align="left" valign="top" style="width: 3in;">
Data is constant acress item. Only one value per item is specified. 
</td>

</tr>
<tr>
<td align="left" valign="top">
shape
</td>
<td align="left" valign="top" style="width: 3in;">
Data is interpolated using item’s shape function. One value for each node of the item needs to be specified. 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
If the data format is not specified, the <i>const </i>format is assumed.
</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-3.9.1">3.9.1</a> ElementData<a class="Label" name="subsec:ElementData"> </a>
</h3>
<div class="Unindented">
This section defines data that will be mapped to the elements of a part. Currently, only predefined variables can be mapped (i.e. requires the <i>var </i>attribute). The element set that this data will be mapped to is defined via the <i>elem_set </i>attribute. The following table lists the currently supported predefined variables.
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
<b>Property</b>
</td>
<td align="left" valign="top">
<b>Description</b>
</td>
<td align="left" valign="top">
<b>Data type/format</b> 
</td>

</tr>
<tr>
<td align="left" valign="top">
fiber
</td>
<td align="left" valign="top">
Specify a local fiber direction
</td>
<td align="left" valign="top">
vec3/const 
</td>

</tr>
<tr>
<td align="left" valign="top">
shell thickness
</td>
<td align="left" valign="top">
Specify the shell element thickness
</td>
<td align="left" valign="top">
float/shape 
</td>

</tr>
<tr>
<td align="left" valign="top">
MRVonMisesParameters
</td>
<td align="left" valign="top">
Von Mises Fibers coefficients kf and tp
</td>
<td align="left" valign="top">
vec2/const 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
Some materials define spatially varying material parameters. Data to these types of parameters can be mapped using the <i>ElementData </i>section and the <i>var </i>attribute.
</div>
<pre class="LyX-Code">
&lt;MeshData&gt;
  &lt;ElementData var="shell thickness" elem_set="part1"&gt;
    &lt;elem lid="1"&gt;1.0, 1.0, 1.0, 1.0&lt;/elem&gt;
    &lt;elem lid="2"&gt;1.0, 1.0, 1.0, 1.0&lt;/elem&gt;
  &lt;/ElementData &gt;
  &lt;ElementData var="pre_stretch" elem_set="part2"&gt;
    &lt;elem lid="1"&gt;1.05&lt;/elem&gt;
    &lt;elem lid="2"&gt;1.05&lt;/elem&gt;
  &lt;/ElementData &gt;
&lt;/MeshData&gt;
</pre>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-3.9.2">3.9.2</a> SurfaceData<a class="Label" name="subsec:SurfaceData"> </a>
</h3>
<div class="Unindented">
This section allows users to define data that can be mapped to the surfaces of certain boundary conditions and loads. This section only defines user-defined data maps, i.e. the <i>name</i>, <i>data_type </i>and <i>data_format </i>attributes must be used. The surface is defined via the <i>surf </i>attribute.
</div>
<pre class="LyX-Code">
&lt;SurfaceData name="values" surf="surface1"&gt;
  &lt;face lid="1"&gt;1.23&lt;/face&gt;
  &lt;face lid="2"&gt;3.45&lt;/face&gt;
&lt;/SurfaceData&gt;
</pre>
<div class="Unindented">
The surface definition is defined in the <i>Geometry </i>section. Note that the ids refer to the local ids of the surface facets. By default, the <i>scalar </i>data type and <i>const </i>data format are assumed so only one value per facet is expected. Other data types and formats can be specified with the <i>data_type </i>and <i>data_format </i>attributes.
</div>
<pre class="LyX-Code">
&lt;SurfaceData name="data" data_type="vec3" surf="surface1"&gt;
  &lt;face lid="1"&gt;0.0, 1.0, 0.0&lt;/face&gt;
  &lt;face lid="2"&gt;0.0, 2.0, 0.0&lt;/face&gt;
&lt;/SurfaceData&gt;
</pre>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-3.9.3">3.9.3</a> EdgeData<a class="Label" name="subsec:EdgeData"> </a>
</h3>
<div class="Unindented">
This section allows users to define user-defined data maps that will be mapped to an edge defined in the Geometry section.
</div>
<pre class="LyX-Code">
&lt;EdgeData name="data" edge="edge1"&gt;
  &lt;edge lid="1"&gt;1.0&lt;/edge&gt;
  &lt;edge lid="2"&gt;2.0&lt;/edge&gt;
&lt;/EdgeData&gt;
</pre>
<div class="Unindented">
Notice that the <i>local </i>IDs are required here.
</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-3.9.4">3.9.4</a> NodeData<a class="Label" name="subsec:NodeData"> </a>
</h3>
<div class="Unindented">
This section allows users to define data that will be mapped to node sets.
</div>
<pre class="LyX-Code">
&lt;NodeData name="data" node_set="set1"&gt;
  &lt;node lid="1"&gt;1.0&lt;/node&gt;
  &lt;node lid="2"&gt;2.0&lt;/node&gt;
&lt;/NodeData&gt;
</pre>
<div class="Unindented">
For node data the <i>data_format </i>attribute, if specified, will be ignored.
</div>
<div class="Indented">
<p><br/>
</p>

</div>
<h2 class="Section">
<a class="toc" name="toc-Section-3.10">3.10</a> Initial Section<a class="Label" name="sec:Initial-Section"> </a>
</h2>
<div class="Unindented">
The <i>Initial</i> section defines all initial conditions that may be applied to the analysis. An initial condition is defined via the <i>init </i>element and requires the <i>bc </i>attribute and <i>node_set </i>attribute. The <i>bc </i>attribute defines the degree of freedom to which the initial condition is applied. The <i>node_set </i>attribute defines the set of nodes that this initial condition affects. The value of the initial condition is then defined with the <i>value </i>element.
</div>
<pre class="LyX-Code">
&lt;init bc="vx" node_set="set1"&gt;
  &lt;value&gt;1.0&lt;/value&gt;
&lt;/init&gt;
</pre>
<div class="Unindented">
The node set must be defined in the <i>Geometry </i>section. To define a different value for each node of the node set, define a <i>NodeData </i>field in the MeshData section and add the <i>node_data </i>attribute to the <i>value </i>element.
</div>
<pre class="LyX-Code">
&lt;MeshData&gt;
  &lt;NodeData name="init_vel" node_set="set1"&gt;
    &lt;node lid="1"&gt;1.0&lt;/node&gt;
    &lt;node lid="2"&gt;1.5&lt;/node&gt;
    &lt;node lid="3"&gt;1.0&lt;/node&gt;
  &lt;/NodeData&gt;
&lt;/MeshData&gt;
&lt;Initial&gt;
  &lt;init bc="vx" node_set="set1"&gt;
    &lt;value node_data="init_vel"/&gt;
  &lt;/init&gt;
&lt;/Initial&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h2 class="Section">
<a class="toc" name="toc-Section-3.11">3.11</a> Boundary Section<a class="Label" name="sec:Boundary-Section"> </a>
</h2>
<div class="Unindented">
The <i>Boundary</i> section defines all fixed and prescribed boundary conditions that may be applied to the geometry.
</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-3.11.1">3.11.1</a> Prescribed Nodal Degrees of Freedom<a class="Label" name="subsec:Prescribed-Nodal-Degrees"> </a>
</h3>
<div class="Unindented">
Nodal degrees of freedom (dof) can be prescribed using the <i>prescribe</i> sub-element. This element has two required attributes (<i>bc</i> and <i>node_set</i>). The value is defined via the <i>value </i>parameter. (If omitted the default value is 1.0). A scale parameter can also be defined using <i>scale</i>. A loadcurve can be associated with the scale parameter and a data map can be associated with the value parameter. The relative parameter defines wheter the values are absolute or relative to the current displacement.
</div>
<pre class="LyX-Code">
&lt;prescribe bc="x" node_set="nodeset1"&gt;
  &lt;scale lc="1"&gt;2.0&lt;/scale&gt;
  &lt;relative&gt;0&lt;/relative&gt;
  &lt;value&gt;1.0&lt;/value&gt;
&lt;/prescribe&gt;
</pre>
<div class="Unindented">
Here, <i>nodeset1 </i>is the name of a node set defined in the Geometry section. See Section <a class="Reference" href="#subsec:NodeSet-Section">3.8.3↑</a> for more information on how to define node sets.
</div>
<div class="Indented">
The <i>bc</i> attribute specifies the particular degree of freedom. The following values are allowed:
</div>
<div class="Description">
<span class="Description-entry">x</span> apply displacement in <span class="MathJax_Preview"><script type="math/tex">
x
</script>
</span>-direction
</div>
<div class="Description">
<span class="Description-entry">y</span> apply displacement in <span class="MathJax_Preview"><script type="math/tex">
y
</script>
</span>-direction
</div>
<div class="Description">
<span class="Description-entry">z</span> apply displacement in <span class="MathJax_Preview"><script type="math/tex">
z
</script>
</span>-direction
</div>
<div class="Description">
<span class="Description-entry">u</span> apply rotation about x-direction
</div>
<div class="Description">
<span class="Description-entry">v</span> apply rotation about y-direction
</div>
<div class="Description">
<span class="Description-entry">w</span> apply rotation about <span class="MathJax_Preview"><script type="math/tex">
z
</script>
</span>-direction
</div>
<div class="Description">
<span class="Description-entry">p</span> apply prescribed effective fluid pressure
</div>
<div class="Description">
<span class="Description-entry">T</span> apply prescribed temperature (heat transfer analysis)
</div>
<div class="Description">
<span class="Description-entry">c</span> apply prescribed effective solute concentration (biphasic analysis)
</div>
<div class="Description">
<span class="Description-entry">c[<span class="MathJax_Preview"><script type="math/tex">
n
</script>
</span>]</span> apply prescribed effective solute concentration on solute <span class="MathJax_Preview"><script type="math/tex">
n
</script>
</span>
</div>
<div class="Unindented">
For solutes, replace &ldquo;<span class="MathJax_Preview"><script type="math/tex">
n
</script>
</span>&rdquo; with the solute id from the global solute table (Section <a class="Reference" href="#subsec:Solutes">3.6.2↑</a>); for example, &ldquo;c2&rdquo;.
</div>
<div class="Indented">
The loadcurve for the scale parameter is specified with the <i>lc</i> attribute. The value of the <i>lc</i> attribute is the ID of the loadcurve that is defined in the <i>LoadData</i> section of the input file.
</div>
<div class="Indented">
The optional <i>relative </i>parameter allows users to choose between absolute (default) and relative boundary conditions. Absolute boundary conditions assign the specified value to the desired nodal degree of freedom. Relative boundary conditions are meaningful only in multi-step analyses. When a nodal degree of freedom is specified to be relative at a particular step, the value prescribed for that node is superposed over the value of that degree of freedom at the end of the preceding step.
</div>
<div class="Indented">
To define a different displacement value for each node, the <i>value </i>parameter is needed which references a node data map which in turn is defined in the new <i>MeshData </i>section.
</div>
<pre class="LyX-Code">
&lt;MeshData&gt;
  &lt;NodeData name="values" node_set="set1"&gt;
    &lt;node lid="1"&gt;1.0&lt;/node&gt;
    &lt;node lid="2"&gt;2.0&lt;/node&gt;
    &lt;node lid="3"&gt;3.0&lt;/node&gt;
  &lt;/NodeData&gt;
&lt;/MeshData&gt;
&lt;Boundary&gt;
  &lt;prescribe bc="x" node_set="set1"&gt;
    &lt;scale lc="1"&gt;2.0&lt;/scale&gt;
    &lt;relative&gt;0&lt;/relative&gt;
    &lt;value node_data="values"/&gt;
  &lt;/prescribe&gt;
&lt;/Boundary&gt;
</pre>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-3.11.2">3.11.2</a> Fixed Nodal Degrees of Freedom<a class="Label" name="subsec:Fixed-Nodal-Degrees"> </a>
</h3>
<div class="Unindented">
Degrees of freedom that are fixed (in other words, constrained, or are always zero) can be defined using the <i>fix</i> element:
</div>
<pre class="LyX-Code">
&lt;fix bc="x" node_set="<i>nodeset</i>"/&gt;
</pre>
<div class="Unindented">
The node set must be defined in the <i>Geometry </i>section.
</div>
<div class="Indented">
Although the <i>prescribe </i>element with a value of zero for the <i>node </i>tags can also be used to fix a certain nodal degree of freedom, the user should use the <i>fix </i>element whenever possible, since this option causes the equation corresponding to the constrained degree of freedom to be removed from the linear system of equations. This results in fewer equations that need to be solved for and thus reduces the run time of the FE analysis.
</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-3.11.3">3.11.3</a> Rigid Nodes<a class="Label" name="subsec:Rigid-Nodes"> </a>
</h3>
<div class="Unindented">
A node set can be attached to a rigid body using the <i>rigid </i>boundary condition. Rigid nodes are not assigned degrees of freedom.
</div>
<pre class="LyX-Code">
&lt;rigid rb="2" node_set="set1"/&gt;
</pre>
<div class="Unindented">
The <i>rb </i>attribute defines the material (which must be a rigid material) that in turn defines the rigid body. The node set must be defined in the <i>Geometry </i>section.
</div>
<div class="Indented">
<p><br/>
</p>

</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-3.11.4">3.11.4</a> Prescribed Rigid Body Degrees of Freedom<a class="Label" name="subsec:Prescribed-Rigid-Body-DOFs"> </a>
</h3>
<div class="Unindented">
Rigid bodies are initially unconstrained which means they can move in all three directions and can rotate about all three axes. To constrain the degrees of freedom of a rigid body you can use the <i>rigid_body </i>element:
</div>
<pre class="LyX-Code">
&lt;rigid_body mat="&lt;id&gt;"&gt;
  &lt;!-- constraints go here --&gt;
&lt;/rigid_body&gt;
</pre>
<div class="Unindented">
The <i>mat </i>attribute defines the material (which must be rigid) that defines the rigid body.
</div>
<div class="Indented">
The following table lists the elements that can be defined in the <i>rigid_body </i>element:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
<b>Tag</b>
</td>
<td align="left" valign="top">
<b>Description</b> 
</td>

</tr>
<tr>
<td align="left" valign="top">
fixed
</td>
<td align="left" valign="top">
Degree of freedom is fixed 
</td>

</tr>
<tr>
<td align="left" valign="top">
prescribed
</td>
<td align="left" valign="top">
Degree of freedom is prescribed by user 
</td>

</tr>
<tr>
<td align="left" valign="top">
force
</td>
<td align="left" valign="top">
A force is applied in direction of degree of freedom 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
All these tags require the <i>bc </i>attribute which defines the degree of freedom that will be constrained.
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
<b>Bc</b>
</td>
<td align="left" valign="top">
<b>Description</b> 
</td>

</tr>
<tr>
<td align="left" valign="top">
x
</td>
<td align="left" valign="top">
Constrain the <span class="MathJax_Preview"><script type="math/tex">
x
</script>
</span>degree of freedom 
</td>

</tr>
<tr>
<td align="left" valign="top">
y
</td>
<td align="left" valign="top">
Constrain the <span class="MathJax_Preview"><script type="math/tex">
y
</script>
</span>degree of freedom 
</td>

</tr>
<tr>
<td align="left" valign="top">
z
</td>
<td align="left" valign="top">
Constrain the <span class="MathJax_Preview"><script type="math/tex">
z
</script>
</span>degree of freedom 
</td>

</tr>
<tr>
<td align="left" valign="top">
Rx
</td>
<td align="left" valign="top">
Prevent the rigid body from rotating around the <span class="MathJax_Preview"><script type="math/tex">
x-
</script>
</span>axis 
</td>

</tr>
<tr>
<td align="left" valign="top">
Ry
</td>
<td align="left" valign="top">
Prevent the rigid body from rotating around the <span class="MathJax_Preview"><script type="math/tex">
y-
</script>
</span>axis 
</td>

</tr>
<tr>
<td align="left" valign="top">
Rz
</td>
<td align="left" valign="top">
Prevent the rigid body from rotating around the <span class="MathJax_Preview"><script type="math/tex">
z-
</script>
</span>axis 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
If the tag is <i>prescribed</i> or <i>force</i> then the <i>lc </i>attribute can be used to specify a load curve defining the amplitude of the displacement or force. The value is then interpreted as a scale factor. For all other types the value is ignored. The syntax and interpretation is the same for the other translation and rotation codes.
</div>
<div class="Indented">
When the type is <i>force</i>, the force is applied at the center of mass for translational degrees of freedom and torque is applied around the center of mass for rotational degrees of freedom. The center of mass of a rigid body is either specified in the material definition or calculated automatically by FEBio.
</div>
<div class="Indented">
<i>Example:</i>
</div>
<pre class="LyX-Code">
&lt;rigid_body mat="1"&gt;
  &lt;prescribed bc="x" lc"1"&gt;2.0&lt;/prescribed&gt;
  &lt;fixed bc="y"/&gt;
  &lt;fixed bc="z"/&gt;
  &lt;fixed bc="Rx"/&gt;
  &lt;fixed bc="Ry"/&gt;
  &lt;fixed bc="Rz"/&gt;
&lt;/rigid_body&gt;
</pre>
<div class="Unindented">
In this example the rigid body that corresponds to material definition <i>1 </i>has a prescribed displacement defined for the <span class="MathJax_Preview"><script type="math/tex">
x
</script>
</span>degree of freedom and has all other degrees of freedom fixed.
</div>
<div class="Indented">
A force (torque) can be applied at the center of mass by setting the <i>type </i>attribute to <i>force</i>. Note that specifying a force (torque) will automatically free the corresponding translational (rotational) degree of freedom. For example, applying a force in the <span class="MathJax_Preview"><script type="math/tex">
x
</script>
</span>-direction while keeping the <span class="MathJax_Preview"><script type="math/tex">
y
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
z
</script>
</span>directions fixed and the rotational degrees of freedom free, can be done as follows:
</div>
<pre class="LyX-Code">
&lt;rigid_body mat="1" &gt;
  &lt;force bc="x" lc="1"&gt;1.0&lt;/force&gt;
  &lt;fixed bc="y"/&gt;
  &lt;fixed bc="z"/&gt;
&lt;/rigid_body&gt;
</pre>
<h2 class="Section">
<a class="toc" name="toc-Section-3.12">3.12</a> Loads Section<a class="Label" name="sec:Loads-Section"> </a>
</h2>
<div class="Unindented">
The <i>Loads </i>section defines all nodal, surface and body loads that can be applied to the model.
</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-3.12.1">3.12.1</a> Nodal Loads<a class="Label" name="subsec:Nodal-Loads"> </a>
</h3>
<div class="Unindented">
Nodal loads are applied by the <i>nodal_load </i>element. When the loads are applied to displacement degrees of freedom, the forces always point in the same direction and do not deform with the geometry (i.e. they are non-follower forces). For other degrees of freedom they define a constant normal flux.
</div>
<pre class="LyX-Code">
&lt;nodal_load bc="x" node_set="set1"&gt;
  &lt;scale lc="1"&gt;1.0&lt;/scale&gt;
  &lt;value&gt;3.14&lt;/value&gt;
&lt;/nodal_load&gt;
</pre>
<div class="Unindented">
The <i>bc</i> attribute gives the degree of freedom. The following values are allowed:
</div>
<div class="Description">
<span class="Description-entry">x</span> apply force in <span class="MathJax_Preview"><script type="math/tex">
x
</script>
</span>-direction
</div>
<div class="Description">
<span class="Description-entry">y</span> apply force in <span class="MathJax_Preview"><script type="math/tex">
y
</script>
</span>-direction
</div>
<div class="Description">
<span class="Description-entry">z</span> apply force in <span class="MathJax_Preview"><script type="math/tex">
z
</script>
</span>-direction
</div>
<div class="Description">
<span class="Description-entry">p</span> apply normal volumetric fluid flow rate
</div>
<div class="Description">
<span class="Description-entry">c<span class="MathJax_Preview"><script type="math/tex">
n
</script>
</span></span> apply normal molar solute flow rate
</div>
<div class="Description">
<span class="Description-entry">t:</span> apply normal heat flux (heat transfer analysis)
</div>
<div class="Unindented">
For solutes, replace &ldquo;<span class="MathJax_Preview"><script type="math/tex">
n
</script>
</span>&rdquo; with the solute id from the global solute table (Section <a class="Reference" href="#subsec:Solutes">3.6.2↑</a>); for example, &ldquo;c2&rdquo;.
</div>
<div class="Indented">
An optional <i>loadcurve</i> can be specified for the <i>scale </i>parameter with the <i>lc</i> attribute. If a loadcurve is not specified, the value will be automatically ramped from a value of 0 at time <span class="MathJax_Preview"><script type="math/tex">
t=
</script>
</span>0 to the value specified in the xml file at the time corresponding to the end of the analysis.
</div>
<div class="Indented">
The value of the <i>value </i>parameter (e.g. 3.14 in the example above) is the value for the nodal force. This value will be scaled by the <i>scale </i>parameter. Note that if a <i>loadcurve</i> is specified, this value scales the value determined by the <i>loadcurve</i>.
</div>
<div class="Indented">
To define a different value for each node of the node set, define a <i>NodData</i> field in the <i>MeshData </i>section and reference it by defining the <i>node_data </i>attribute in the <i>value </i>parameter.
</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-3.12.2">3.12.2</a> Surface Loads<a class="Label" name="subsec:Surface-Loads"> </a>
</h3>
<div class="Unindented">
A surface load can be applied using the <i>surface_load </i>element. This element takes two attributes, namely <i>type</i>, which defines the type of surface load that will be applied, and <i>surface </i>which defines the surface that this load will be applied to.
</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-3.12.2.1">3.12.2.1</a> Pressure Load<a class="Label" name="subsec:Pressure-Load"> </a>
</h4>
<div class="Unindented">
Pressure loads are applied to the surface of the geometry and are defined by the <i>surface_load </i>element with the type attribute set to <i>pressure</i>:
</div>
<pre class="LyX-Code">
&lt;surface_load type="pressure" surface="surface1"&gt;
  &lt;pressure [lc="1"]&gt;1.0&lt;/pressure&gt;
  &lt;value surface_data="pressure_value"/&gt;
&lt;/surface_load&gt;
</pre>
<div class="Unindented">
The surface must be defined in the <i>Geometry </i>section. If the pressure value differs per facet, it must be defined (as in the example) using the <i>value </i>parameter and the <i>surface_data </i>attribute.
</div>
<div class="Indented">
These pressure forces are also known as <i>follower forces</i>; they change direction as the body is deformed and, in this case, are always oriented along the local surface normal. The sign convention is so that a positive pressure will act opposite to the normal, so it will compress the material. The <i>pressure </i>element defines the pressure value [<b>P</b>]. The optional parameter <i>lc</i> defines a loadcurve for the pressure evolution. If <i>lc</i> is not defined a constant pressure is applied.
</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-3.12.2.2">3.12.2.2</a> Traction Load<a class="Label" name="subsec:Traction-Load"> </a>
</h4>
<div class="Unindented">
A traction load applies a traction to a surface. The direction of the traction remains unchanged as the mesh deforms.
</div>
<pre class="LyX-Code">
&lt;surface_load type="traction" surface="surface1"&gt;
  &lt;scale lc="1"&gt;1.0&lt;/scale&gt;
  &lt;traction&gt;0,0,1&lt;/traction&gt;
&lt;/surface_load&gt;
</pre>
<div class="Unindented">
If a different needs to be specified for each facet, use the following syntax.
</div>
<pre class="LyX-Code">
&lt;surface_load type="traction" surface="surface1"&gt;
  &lt;scale lc="1"&gt;1.0&lt;/scale&gt;
  &lt;traction surface_data="traction_value"/&gt;
&lt;/surface_load&gt;
</pre>
<div class="Unindented">
The traction vector is determined by two quantities. The direction and magnitude is defined by the <i>traction </i>element. In addition, the magnitude can be scaled using the <i>scale </i>element. An optional load curve can be defined for the <i>scale </i>element using the <i>lc </i>attribute. This allows the traction load to become time dependent. If the <i>lc </i>attribute is omitted a constant traction load is applied.
</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-3.12.2.3">3.12.2.3</a> Mixture Normal Traction<a class="Label" name="subsec:Mixture-Normal-Traction"> </a>
</h4>
<div class="Unindented">
This section applies to biphasic, biphasic-solute, triphasic and multiphasic analyses. In a mixture of intrinsically incompressible solid and fluid constituents, the formulation adopted in FEBio implies that the total traction is a natural boundary condition (<a href="http://help.mrl.sci.utah.edu/help/index.jsp">FEBio Theory 
Manual</a>). If this boundary condition is not explicitly prescribed, the code automatically assumes that it is equal to zero. Therefore, boundaries of mixtures are traction-free by default.
</div>
<div class="Indented">
The <i>mixture traction </i><span class="MathJax_Preview"><script type="math/tex">
\mathbf{t}
</script>
</span> is the traction vector corresponding to the mixture (or total) stress <span class="MathJax_Preview"><script type="math/tex">
\boldsymbol{\sigma}
</script>
</span>; thus <span class="MathJax_Preview"><script type="math/tex">
\mathbf{t}=\boldsymbol{\sigma}\cdot\mathbf{n}
</script>
</span>, where <span class="MathJax_Preview"><script type="math/tex">
\mathbf{n}
</script>
</span> is the outward unit normal to the boundary surface. Since <span class="MathJax_Preview"><script type="math/tex">
\boldsymbol{\sigma}=-p\mathbf{I}+\boldsymbol{\sigma}^{e}
</script>
</span>, where <span class="MathJax_Preview"><script type="math/tex">
p
</script>
</span> is the fluid pressure and <span class="MathJax_Preview"><script type="math/tex">
\boldsymbol{\sigma}^{e}
</script>
</span> is the <i>effective stress</i> resulting from strains in the solid matrix, it is also possible to represent the total traction as <span class="MathJax_Preview"><script type="math/tex">
\mathbf{t}=-p\mathbf{n}+\mathbf{t}^{e}
</script>
</span>, where <span class="MathJax_Preview"><script type="math/tex">
\mathbf{t}^{e}=\boldsymbol{\sigma}^{e}\cdot\mathbf{n}
</script>
</span> is the <i>effective traction</i>. Currently, FEBio allows the user to specify only the normal component of the traction, either <span class="MathJax_Preview"><script type="math/tex">
t_{n}=\mathbf{t}\cdot\mathbf{n}
</script>
</span> (the normal component of the mixture traction) or <span class="MathJax_Preview"><script type="math/tex">
t_{n}^{e}=\mathbf{t}^{e}\cdot\mathbf{n}
</script>
</span> (the normal component of the effective traction):
</div>
<div class="Indented">
A mixture normal traction is defined by the <i>surface_load </i>element using <i>normal_traction </i>for the type attribute.
</div>
<pre class="LyX-Code">
&lt;surface_load type="normal_traction" surface="surface1"&gt;
  &lt;traction [lc="1"]&gt;1.0&lt;/traction&gt;
  &lt;effective&gt;1&lt;/effective&gt;
  &lt;linear&gt;0&lt;/linear&gt;
&lt;/surface_load&gt;
</pre>
<div class="Unindented">
The <i>traction </i>element defines the magnitude of the traction force. The optional attribute <i>lc </i>defines a loadcurve that controls the time dependency of the traction force magnitude. If omitted a constant traction is applied.
</div>
<div class="Indented">
The <i>effective </i>element defines whether the traction is applied as an effective traction or a total mixture traction.
</div>
<div class="Indented">
The <i>linear </i>element defines whether the traction remains normal to the deformed surface or the reference surface. If set to true the traction remains normal to the reference surface. When false it defines a follower force that remains normal to the deformed surface.
</div>
<div class="Indented">
The <i>surface </i>element defines the surface to which the traction is applied. It consists of child elements defining the individual surface facets.
</div>
<div class="Indented">
Unlike the mixture and effective traction, the fluid pressure <span class="MathJax_Preview"><script type="math/tex">
p
</script>
</span> is a nodal variable (see Section <a class="Reference" href="#subsec:Prescribed-Nodal-Degrees">3.11.1↑</a>). There may be common situations where the user must apply a combination of related fluid pressure and traction boundary conditions. For example, if a biphasic surface is subjected to a non-zero fluid pressure <span class="MathJax_Preview"><script type="math/tex">
p_{0}
</script>
</span>, the corresponding boundary conditions are <span class="MathJax_Preview"><script type="math/tex">
p=p_{0}
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
t_{n}=-p_{0}
</script>
</span> (or <span class="MathJax_Preview"><script type="math/tex">
t_{n}^{e}=0
</script>
</span>). In FEBio, both boundary conditions must be applied. For example:
</div>
<pre class="LyX-Code">
&lt;Boundary&gt;
  &lt;prescribed bc="p" node_set="set1"&gt;
    &lt;scale lc="1"&gt;1.0&lt;/scale&gt;
  &lt;/prescribed&gt;
  &lt;surface_load type="normal_traction" surface="surf1"&gt;
    &lt;traction lc="1"&gt;-1.0&lt;/traction&gt;
    &lt;effective&gt;0&lt;/effective&gt;
    &lt;linear&gt;0&lt;/linear&gt;
  &lt;/surface_load&gt;
&lt;/Boundary&gt;
&lt;LoadData&gt;
  &lt;loadcurve id="1"&gt;
    &lt;loadpoint&gt;0,0&lt;/loadpoint&gt;
    &lt;loadpoint&gt;1,2.0&lt;/loadpoint&gt;
  &lt;/loadcurve&gt;
&lt;/LoadData&gt;
</pre>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-3.12.2.4">3.12.2.4</a> Fluid Flux<a class="Label" name="subsec:Fluid-Flux"> </a>
</h4>
<div class="Unindented">
In a biphasic mixture of intrinsically incompressible solid and fluid constituents, the <span class="MathJax_Preview"><script type="math/tex">
\mathbf{u}-p
</script>
</span> formulation adopted in FEBio implies that the normal component of the relative fluid flux is a natural boundary condition. If this boundary condition is not explicitly prescribed, the code automatically assumes that it is equal to zero. Therefore, biphasic boundaries are impermeable by default. (To implement a free-draining boundary, the fluid pressure nodal degrees of freedom should be set to zero.)
</div>
<div class="Indented">
The flux of fluid relative to the solid matrix is given by the vector <span class="MathJax_Preview"><script type="math/tex">
\mathbf{w}
</script>
</span>. Since viscosity is not explicitly modeled in a biphasic material, the tangential component of <span class="MathJax_Preview"><script type="math/tex">
\mathbf{w}
</script>
</span> on a boundary surface may not be prescribed. Only the normal component of the relative fluid flux, <span class="MathJax_Preview"><script type="math/tex">
w_{n}=\mathbf{w}\cdot\mathbf{n}
</script>
</span>, represents a natural boundary condition. To prescribe a value for <span class="MathJax_Preview"><script type="math/tex">
w_{n}
</script>
</span> on a surface, use:
</div>
<pre class="LyX-Code">
&lt;surface_load type="fluidflux" surface="surf1"&gt;
  &lt;flux [lc="1"]&gt;1.0&lt;/flux&gt;
  &lt;linear&gt;0&lt;/linear&gt;
  &lt;mixture&gt;1&lt;/mixture&gt;
&lt;/fluidflux&gt;
</pre>
<div class="Unindented">
The <i>flux </i>parameter defines the flux that will be applied to the surface. The optional parameter <i>lc</i> defines a loadcurve for the normal flux evolution. If omitted a constant fluid flux is applied.
</div>
<div class="Indented">
When <i>linear </i>is set to zero (default) it means that the flux matches the prescribed value even if the surface on which it is applied changes in area as it deforms. Therefore, the net volumetric flow rate across the surface changes with changes in area. This type of boundary condition is useful if the fluid flux is known in the current configuration.
</div>
<div class="Indented">
When <i>linear </i>is set to non-zero it means that the prescribed flux produces a volumetric flow rate based on the undeformed surface area in the reference configuration. Therefore, the flux in the current configuration does not match the prescribed value. This type of boundary condition is useful if the net volumetric flow rate across the surface is known. For example: Let <span class="MathJax_Preview"><script type="math/tex">
Q
</script>
</span> be the known volumetric flow rate, let <span class="MathJax_Preview"><script type="math/tex">
A_{\mathrm{0}}
</script>
</span> be the surface area in the reference configuration (a constant). Using <i>&ldquo;linear&rdquo;</i> means that the user prescribes <span class="MathJax_Preview"><script type="math/tex">
Q
</script>
</span>/<span class="MathJax_Preview"><script type="math/tex">
A_{\mathrm{0}}
</script>
</span> as the flux boundary condition. (However, regardless of the <i>type</i>, the fluid flux saved in the output file has a normal component equal to <span class="MathJax_Preview"><script type="math/tex">
Q
</script>
</span>/<span class="MathJax_Preview"><script type="math/tex">
A
</script>
</span>, where <span class="MathJax_Preview"><script type="math/tex">
A=
</script>
</span>area in current configuration.)
</div>
<div class="Indented">
Prescribing <span class="MathJax_Preview"><script type="math/tex">
w_{n}
</script>
</span> on a free surface works only if the nodal displacements of the corresponding faces are also prescribed. If the nodal displacements are not known a priori, the proper boundary condition calls for prescribing the normal component of the mixture velocity, <span class="MathJax_Preview"><script type="math/tex">
v_{n}=\left(\mathbf{v}^{s}+\mathbf{w}\right)\cdot\mathbf{n}
</script>
</span>. To prescribe the value of <span class="MathJax_Preview"><script type="math/tex">
v_{n}
</script>
</span> on a surface, use
</div>
<pre class="LyX-Code">
&lt;surface_load type="fluidflux" surface="surf1"&gt;
  &lt;flux lc="1"&gt;1.0&lt;/flux&gt;
  &lt;linear&gt;0&lt;/linear&gt;
  &lt;mixture&gt;1&lt;/mixture&gt;
&lt;/surface_load&gt;
</pre>
<div class="Unindented">
For example, this boundary condition may be used when modeling a permeation problem through a biphasic material, when the upstream fluid velocity is prescribed, <span class="MathJax_Preview"><script type="math/tex">
v_{n}=v_{0}
</script>
</span>. If the upstream face is free, the companion boundary condition would be to let <span class="MathJax_Preview"><script type="math/tex">
t_{n}^{e}=0
</script>
</span> on that face as well.
</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-3.12.2.5">3.12.2.5</a> Solute Flux<a class="Label" name="subsec:Solute-Flux"> </a>
</h4>
<div class="Unindented">
The molar flux of solute relative to the solid matrix is given by the vector <span class="MathJax_Preview"><script type="math/tex">
\mathbf{j}
</script>
</span>. Since solute viscosity is not explicitly modeled in a biphasic-solute material, the tangential component of <span class="MathJax_Preview"><script type="math/tex">
\mathbf{j}
</script>
</span> on a boundary surface may not be prescribed. Only the normal component of the relative solute flux, <span class="MathJax_Preview"><script type="math/tex">
j_{n}=\mathbf{j}\cdot\mathbf{n}
</script>
</span>, represents a natural boundary condition. To prescribe a value for <span class="MathJax_Preview"><script type="math/tex">
j_{n}
</script>
</span> on a surface, use:
</div>
<pre class="LyX-Code">
&lt;surface_load type="soluteflux" surface="surface1"&gt;
  &lt;flux [lc="1"]&gt;1.0&lt;/flux&gt;
  &lt;linear&gt;0&lt;/linear&gt;
  &lt;solute_id&gt;1&lt;/solute_id&gt;
&lt;/ surface_load&gt;
</pre>
<div class="Unindented">
The optional parameter <i>solute_id</i> specifies to which solute this flux condition applies, referencing the corresponding list in the Globals section (Section <a class="Reference" href="#subsec:Solutes">3.6.2↑</a>). If <i>solute_id</i> is not defined, the default value is 1.
</div>
<div class="Indented">
The <i>flux </i>element defines the flux magnitude. The optional parameter <i>lc</i> defines a loadcurve for the normal flux evolution. If omitted a constant flux is applied.
</div>
<div class="Indented">
When <i>linear </i>is set to 0 (default) it means that the flux matches the prescribed value even if the surface on which it is applied changes in area as it deforms. Therefore, the net molar flow rate across the surface changes with changes in area. This type of boundary condition is useful if the solute molar flux is known in the current configuration.
</div>
<div class="Indented">
When <i>linear </i>is set to non-zero it means that the prescribed flux produces a molar flow rate based on the undeformed surface area in the reference configuration. Therefore, the flux in the current configuration does not match the prescribed value. This type of boundary condition is useful if the net molar flow rate across the surface is known. For example: Let <span class="MathJax_Preview"><script type="math/tex">
Q
</script>
</span> be the known molar flow rate (in units of moles per time [<b>n</b>/<b>t</b>]), let <span class="MathJax_Preview"><script type="math/tex">
A_{\mathrm{0}}
</script>
</span> be the surface area in the reference configuration (a constant). Using <i>&ldquo;linear&rdquo;</i> means that the user prescribes <span class="MathJax_Preview"><script type="math/tex">
Q
</script>
</span>/<span class="MathJax_Preview"><script type="math/tex">
A_{\mathrm{0}}
</script>
</span> as the flux boundary condition (in units of moles per area per time [<b>n</b>/<b>L</b><span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{2}}\cdot
</script>
</span><b>t</b>]). However, regardless of the <i>type</i>, the solute molar flux saved in the output file has a normal component equal to <span class="MathJax_Preview"><script type="math/tex">
Q
</script>
</span>/<span class="MathJax_Preview"><script type="math/tex">
A
</script>
</span>, where <span class="MathJax_Preview"><script type="math/tex">
A=
</script>
</span>area in current configuration.
</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-3.12.2.6">3.12.2.6</a> Heat Flux<a class="Label" name="subsec:Heat-Flux"> </a>
</h4>
<div class="Unindented">
A heat flux can be defined for heat transfer analyses using the <i>surface_load </i>element with type set to <i>heatflux </i>element.
</div>
<pre class="LyX-Code">
&lt;surface_load type="heatflux" surface="surface1"&gt;
  &lt;flux [lc="1"]&gt;1.0&lt;/flux&gt;
&lt;/surface_load&gt;
</pre>
<div class="Unindented">
The heat flux element takes two parameters, namely <i>flux</i> which defines the flux that will be applied. It has an optional <i>lc </i>attribute which defines the load curve for this parameter. If omitted, a constant heat flux will be applied. The other (optional) parameter is the <i>value </i>parameter which can be used to define a different flux value for each surface facet.
</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-3.12.2.7">3.12.2.7</a> Convective Heat Flux<a class="Label" name="subsec:Convective-Heat-Flux"> </a>
</h4>
<div class="Unindented">
A convective heat flux can be defined to a surface that is cooled (or heated) by exposure to an ambient temperature.
</div>
<pre class="LyX-Code">
&lt;surface_load type="convective_heatflux" surface="surf1"&gt;
  &lt;Ta [lc="1"]&gt;1.0&lt;/Ta&gt;
  &lt;hc&gt;1.0&lt;/hc&gt;
&lt;/surface_load&gt;
</pre>
<div class="Unindented">
The <i>hc </i>parameter defines the heat transfer coefficient. The ambient temperature is defined by the <i>Ta </i>parameter. It takes an optional load curve defined through the <i>lc </i>attribute. The <i>value </i>parameter with the <i>surface_data </i>attribute can be defined to define a different temperature value for each surface facet.
</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-3.12.3">3.12.3</a> Body Loads<a class="Label" name="subsec:Body-Loads"> </a>
</h3>
<div class="Unindented">
A body load can be used to define a source term to the model. The following sections define the different type of body loads that can be applied.
</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-3.12.3.1">3.12.3.1</a> Constant Body Force<a class="Label" name="subsec:Constant-Body-Force"> </a>
</h4>
<div class="Unindented">
The body force is defined as a 3D vector. Each component can be associated with a load curve to define a time dependent body force. Only the non-zero components need to be defined. This type of body force is spatially homogeneous, though it may vary with time when associated with a load curve:
</div>
<pre class="LyX-Code">
&lt;body_load type="const"&gt;
  &lt;x lc="1"&gt;1.0&lt;/x&gt;
  &lt;y lc="2"&gt;1.0&lt;/y&gt;
  &lt;z lc="3"&gt;1.0&lt;/z&gt;
&lt;/body_load&gt;
</pre>
<div class="Unindented">
The <i>lc </i>attribute defines the load curve to use for the corresponding component. The values of the components can be used to define scale factors for the load values.
</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-3.12.3.2">3.12.3.2</a> Non-Constant Body Force<a class="Label" name="subsec:Non-Constant-Body-Force"> </a>
</h4>
<div class="Unindented">
This type of body force may be spatially inhomogeneous. The spatial inhomogeneity may be specified using a formula with variables x, y, z. For example:
</div>
<pre class="LyX-Code">
&lt;body_load type="non-const"&gt;
  &lt;x&gt;x<span class="MathJax_Preview"><script type="math/tex">
+
</script>
</span>y<span class="MathJax_Preview"><script type="math/tex">
+
</script>
</span>z&lt;/x&gt;
  &lt;y&gt;x-y-z&lt;/y&gt;
  &lt;z&gt;x*x<span class="MathJax_Preview"><script type="math/tex">
+
</script>
</span>z&lt;/z&gt;
&lt;/body_load&gt;
</pre>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-3.12.3.3">3.12.3.3</a> Centrifugal Force<a class="Label" name="subsec:Centrifugal-Force"> </a>
</h4>
<div class="Unindented">
A centrifugal body force may be used for bodies undergoing steady-state rotation with angular speed <span class="MathJax_Preview"><script type="math/tex">
\omega
</script>
</span> about a rotation axis directed along <span class="MathJax_Preview"><script type="math/tex">
\mathbf{n}
</script>
</span> and passing through the rotation center <span class="MathJax_Preview"><script type="math/tex">
\mathbf{c}
</script>
</span>.
</div>
<pre class="LyX-Code">
&lt;body_load type="centrifugal"&gt;
  &lt;angular_speed&gt;1.0&lt;/angular_speed&gt;
  &lt;rotation_axis&gt;0.707,0.707,0&lt;/rotation_axis&gt;
  &lt;rotation_center&gt;0,0,0&lt;/rotation_center&gt;
&lt;/body_load&gt;
</pre>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-3.12.3.4">3.12.3.4</a> Heat Source<a class="Label" name="subsec:Heat-Source"> </a>
</h4>
<div class="Unindented">
A heat source can be defined using the <i>heat_source </i>type.
</div>
<pre class="LyX-Code">
&lt;body_load type="heat_source"&gt;
  &lt;Q&gt;1.0&lt;/Q&gt;
&lt;/body_load&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h2 class="Section">
<a class="toc" name="toc-Section-3.13">3.13</a> Contact Section<a class="Label" name="sec:Contact-Section"> </a>
</h2>
<div class="Unindented">
The <i>Contact </i>section defines all the contact interfaces. Contact boundary conditions are defined with the <i>contact</i> sub-element. The <i>type</i> attribute specifies the type of contact interface that is defined. The <i>surface_pair </i>attribute defines the surface pair to use for this contact definition. The surface pair is defined the the <i>Geometry </i>section. For example:
</div>
<pre class="LyX-Code">
&lt;contact type="sliding_with_gaps" surface_pair="contact1"&gt;
  &lt;!-- parameter go here --&gt;
&lt;/contact&gt;
</pre>
<div class="Unindented">
The <i>type</i> can be one of the following options:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top" style="width: 2in;">
<b>Type</b>
</td>
<td align="left" valign="top" style="width: 3in;">
<b>Description</b> 
</td>

</tr>
<tr>
<td align="left" valign="top" style="width: 2in;">
sliding_with_gaps, facet-to-facet sliding, sliding2, sliding3, sliding-multiphasic
</td>
<td align="left" valign="top" style="width: 3in;">
A sliding interface that may separate (with biphasic contact for <i>sliding2</i>, biphasic-solute contact for <i>sliding3</i>, and multiphasic contact for <i>sliding-multiphasic</i>) 
</td>

</tr>
<tr>
<td align="left" valign="top" style="width: 2in;">
sliding-tension-compression
</td>
<td align="left" valign="top" style="width: 3in;">
A sliding interface that may optionally sustain tension 
</td>

</tr>
<tr>
<td align="left" valign="top" style="width: 2in;">
rigid_wall
</td>
<td align="left" valign="top" style="width: 3in;">
A sliding interface with rigid wall as master surface 
</td>

</tr>
<tr>
<td align="left" valign="top" style="width: 2in;">
rigid_joint
</td>
<td align="left" valign="top" style="width: 3in;">
A joint between two rigid bodies 
</td>

</tr>
<tr>
<td align="left" valign="top" style="width: 2in;">
tied,sticky, tied-biphasic
</td>
<td align="left" valign="top" style="width: 3in;">
A tied interface (solid-solid, solid-rigid, solid-biphasic, rigid-biphasic) or tied-biphasic interface (biphasic-biphasic). 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-3.13.1">3.13.1</a> Sliding Interfaces<a class="Label" name="subsec:Sliding-Interfaces"> </a>
</h3>
<div class="Unindented">
A sliding interface can be used to setup a non-penetration constraint between two surfaces. As of version 1.2, three different sliding contact algorithms are available. Although all three are based on the same contact enforcement method, they all differ slightly in their implementation and have been shown to give different performance for different contact scenarios. Each sliding contact implementation is identified by a different <i>type </i>attribute.
</div>
<div class="Description">
<span class="Description-entry"><i><i>sliding_with_gaps (SWG)</i></i></span> This is FEBio’s original implementation of sliding contact. It is based on Laursen’s contact formulation <span class="bibcites">[<a class="bibliocite" name="cite-26" href="#biblio-26"><span class="bib-index">26</span></a>]</span> which poses the contact problem as a nonlinear constrained optimization problem. In FEBio, the Lagrange multipliers that enforce the contact constraints are computed either using a penalty method or the augmented Lagrangian method. 
</div>
<div class="Description">
<span class="Description-entry"><i><i>facet-to-facet sliding (F2F)</i></i></span> This implementation is identical to the <i>sliding_with_gaps</i> implementation but uses a more accurate integration rule: where the former method uses nodal integration, this method uses Gaussian quadrature to integrate the contact equations. This method has been demonstrated to give additional stability and often converges when the former method does not. 
</div>
<div class="Description">
<span class="Description-entry"><i><i>sliding-tension-compression (STC)</i></i></span> This sliding contact interface may be set to sustain tension to prevent contact surfaces from separating along the direction normal to the interface, while still allowing tangential sliding. This interface is useful for creating symmetry planes, e.g., for axisymmetric problems. 
</div>
<div class="Description">
<span class="Description-entry"><i><i>sliding2 (S2)</i></i></span> This method is similar to the <i>facet-to-facet sliding</i> but differs in the linearization of the contact forces, which results in a different contact stiffness matrix compared to the previous two methods. This method is described in detail in <span class="bibcites">[<a class="bibliocite" name="cite-8" href="#biblio-8"><span class="bib-index">8</span></a>]</span>. This method sometimes performs better than the previous two methods for problems that are dominated by compression. However, the formulation is inherently non-symmetric and therefore will require additional memory and running time. A symmetrized version of this implementation is available (see below), but the symmetric version does not converge as well as the non-symmetric version. This particular contact implementation also supports biphasic contact (see the next section). 
</div>
<div class="Description">
<span class="Description-entry"><i><i>sliding3 (S3)</i></i></span> This method is similar to <i>sliding2</i>. This contact implementation supports biphasic-solute contact (see the next section). When using biphasic-solute materials, the non-symmetric version must be used. 
</div>
<div class="Description">
<span class="Description-entry"><i><i>sliding-multiphasic (SMP)</i></i></span> This method is similar to <i>sliding3</i>. This contact implementation supports multiphasic contact (see the next section). When using multiphasic materials, the non-symmetric version must be used. 
</div>
<div class="Unindented">
The following table lists the properties that are defined for sliding interfaces. It is important to note that the three different sliding implementations cannot be used interchangeably: not all features are available for each method. The third, fourth and fifth column indicate if a parameter is available for a particular implementation.
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
<b>Parameter</b>
</td>
<td align="left" valign="top" style="width: 2in;">
<b>Description</b>
</td>
<td align="center" valign="top">
<b>SWG</b>
</td>
<td align="center" valign="top">
<b>F2F</b>
</td>
<td align="center" valign="top">
<b>STC</b>
</td>
<td align="center" valign="top" style="width: 0.38in;">
<b>S2 S3 SMP</b>
</td>
<td align="left" valign="top">
<b>Default</b> 
</td>

</tr>
<tr>
<td align="left" valign="top">
penalty
</td>
<td align="left" valign="top" style="width: 2in;">
normal penalty scale factor (1)
</td>
<td align="center" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\CIRCLE
</script>
</span>
</td>
<td align="center" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\CIRCLE
</script>
</span>
</td>
<td align="center" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\CIRCLE
</script>
</span>
</td>
<td align="center" valign="top" style="width: 0.38in;">
<span class="MathJax_Preview"><script type="math/tex">
\CIRCLE
</script>
</span>
</td>
<td align="left" valign="top">
1.0 
</td>

</tr>
<tr>
<td align="left" valign="top">
auto_penalty
</td>
<td align="left" valign="top" style="width: 2in;">
auto-penalty calculation flag (2)
</td>
<td align="center" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\CIRCLE
</script>
</span>
</td>
<td align="center" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\CIRCLE
</script>
</span>
</td>
<td align="center" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\CIRCLE
</script>
</span>
</td>
<td align="center" valign="top" style="width: 0.38in;">
<span class="MathJax_Preview"><script type="math/tex">
\CIRCLE
</script>
</span>
</td>
<td align="left" valign="top">
0 
</td>

</tr>
<tr>
<td align="left" valign="top">
two_pass
</td>
<td align="left" valign="top" style="width: 2in;">
two-pass flag (3)
</td>
<td align="center" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\CIRCLE
</script>
</span>
</td>
<td align="center" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\CIRCLE
</script>
</span>
</td>
<td align="center" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\CIRCLE
</script>
</span>
</td>
<td align="center" valign="top" style="width: 0.38in;">
<span class="MathJax_Preview"><script type="math/tex">
\CIRCLE
</script>
</span>
</td>
<td align="left" valign="top">
0 
</td>

</tr>
<tr>
<td align="left" valign="top">
laugon
</td>
<td align="left" valign="top" style="width: 2in;">
augmented Lagrangian flag (4)
</td>
<td align="center" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\CIRCLE
</script>
</span>
</td>
<td align="center" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\CIRCLE
</script>
</span>
</td>
<td align="center" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\CIRCLE
</script>
</span>
</td>
<td align="center" valign="top" style="width: 0.38in;">
<span class="MathJax_Preview"><script type="math/tex">
\CIRCLE
</script>
</span>
</td>
<td align="left" valign="top">
0 
</td>

</tr>
<tr>
<td align="left" valign="top">
tolerance
</td>
<td align="left" valign="top" style="width: 2in;">
aug. Lagrangian convergence tolerance (4)
</td>
<td align="center" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\CIRCLE
</script>
</span>
</td>
<td align="center" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\CIRCLE
</script>
</span>
</td>
<td align="center" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\CIRCLE
</script>
</span>
</td>
<td align="center" valign="top" style="width: 0.38in;">
<span class="MathJax_Preview"><script type="math/tex">
\CIRCLE
</script>
</span>
</td>
<td align="left" valign="top">
1.0 
</td>

</tr>
<tr>
<td align="left" valign="top">
gaptol
</td>
<td align="left" valign="top" style="width: 2in;">
tolerance for gap value (4)
</td>
<td align="center" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\CIRCLE
</script>
</span>
</td>
<td align="center" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\CIRCLE
</script>
</span>
</td>
<td align="center" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\CIRCLE
</script>
</span>
</td>
<td align="center" valign="top" style="width: 0.38in;">
<span class="MathJax_Preview"><script type="math/tex">
\CIRCLE
</script>
</span>
</td>
<td align="left" valign="top">
0.0 (off) 
</td>

</tr>
<tr>
<td align="left" valign="top">
minaug
</td>
<td align="left" valign="top" style="width: 2in;">
minimum number of augmentations (4)
</td>
<td align="center" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\CIRCLE
</script>
</span>
</td>
<td align="center" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\CIRCLE
</script>
</span>
</td>
<td align="center" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\CIRCLE
</script>
</span>
</td>
<td align="center" valign="top" style="width: 0.38in;">

</td>
<td align="left" valign="top">
0 
</td>

</tr>
<tr>
<td align="left" valign="top">
maxaug
</td>
<td align="left" valign="top" style="width: 2in;">
maximum number of augmentations (4)
</td>
<td align="center" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\CIRCLE
</script>
</span>
</td>
<td align="center" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\CIRCLE
</script>
</span>
</td>
<td align="center" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\CIRCLE
</script>
</span>
</td>
<td align="center" valign="top" style="width: 0.38in;">

</td>
<td align="left" valign="top">
10 
</td>

</tr>
<tr>
<td align="left" valign="top">
fric_coeff
</td>
<td align="left" valign="top" style="width: 2in;">
frictional coefficient (5)
</td>
<td align="center" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\CIRCLE
</script>
</span>
</td>
<td align="center" valign="top">

</td>
<td align="center" valign="top">

</td>
<td align="center" valign="top" style="width: 0.38in;">

</td>
<td align="left" valign="top">
0.0 
</td>

</tr>
<tr>
<td align="left" valign="top">
fric_penalty
</td>
<td align="left" valign="top" style="width: 2in;">
tangential penalty factor (5)
</td>
<td align="center" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\CIRCLE
</script>
</span>
</td>
<td align="center" valign="top">

</td>
<td align="center" valign="top">

</td>
<td align="center" valign="top" style="width: 0.38in;">

</td>
<td align="left" valign="top">
0.0 
</td>

</tr>
<tr>
<td align="left" valign="top">
ktmult
</td>
<td align="left" valign="top" style="width: 2in;">
tangential stiffness multiplier (5)
</td>
<td align="center" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\CIRCLE
</script>
</span>
</td>
<td align="center" valign="top">

</td>
<td align="center" valign="top">

</td>
<td align="center" valign="top" style="width: 0.38in;">

</td>
<td align="left" valign="top">
1.0 
</td>

</tr>
<tr>
<td align="left" valign="top">
seg_up
</td>
<td align="left" valign="top" style="width: 2in;">
maximum number of segment updates (6)
</td>
<td align="center" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\CIRCLE
</script>
</span>
</td>
<td align="center" valign="top">

</td>
<td align="center" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\CIRCLE
</script>
</span>
</td>
<td align="center" valign="top" style="width: 0.38in;">

</td>
<td align="left" valign="top">
0 (off) 
</td>

</tr>
<tr>
<td align="left" valign="top">
symmetric_stiffness
</td>
<td align="left" valign="top" style="width: 2in;">
symmetric stiffness matrix flag (7)
</td>
<td align="center" valign="top">

</td>
<td align="center" valign="top">

</td>
<td align="center" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\CIRCLE
</script>
</span>
</td>
<td align="center" valign="top" style="width: 0.38in;">
<span class="MathJax_Preview"><script type="math/tex">
\CIRCLE
</script>
</span>
</td>
<td align="left" valign="top">
0 
</td>

</tr>
<tr>
<td align="left" valign="top">
search_tol
</td>
<td align="left" valign="top" style="width: 2in;">
Projection search tolerance (8)
</td>
<td align="center" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\CIRCLE
</script>
</span>
</td>
<td align="center" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\CIRCLE
</script>
</span>
</td>
<td align="center" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\CIRCLE
</script>
</span>
</td>
<td align="center" valign="top" style="width: 0.38in;">
<span class="MathJax_Preview"><script type="math/tex">
\CIRCLE
</script>
</span>
</td>
<td align="left" valign="top">
0.01 
</td>

</tr>
<tr>
<td align="left" valign="top">
search_radius
</td>
<td align="left" valign="top" style="width: 2in;">
search radius (9)
</td>
<td align="center" valign="top">

</td>
<td align="center" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\CIRCLE
</script>
</span>
</td>
<td align="center" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\CIRCLE
</script>
</span>
</td>
<td align="center" valign="top" style="width: 0.38in;">
<span class="MathJax_Preview"><script type="math/tex">
\CIRCLE
</script>
</span>
</td>
<td align="left" valign="top">
1.0 
</td>

</tr>
<tr>
<td align="left" valign="top">
tension
</td>
<td align="left" valign="top" style="width: 2in;">
tension flag (10)
</td>
<td align="center" valign="top">

</td>
<td align="center" valign="top">

</td>
<td align="center" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\CIRCLE
</script>
</span>
</td>
<td align="center" valign="top" style="width: 0.38in;">

</td>
<td align="left" valign="top">
0 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
<i>Comments:</i>
</div>
<ol>
<li>
If the augmented Lagrangian flag is turned off (see comment 4), the penalty method is used to enforce the contact constraint. In this method, the contact traction is determined by the gap (i.e. penetration distance) multiplied by the user-defined <i>penalty</i> factor. In the augmented Lagrangian method, the <i>penalty</i> parameter is also used but has a slightly different meaning. In this case, it scales the Lagrange multiplier increment. Due to the different meanings, the user might have to adjust the penalty factor when switching between penalty method and augmented Lagrangian method. In general the penalty method requires a larger penalty factor to reach the same gap than the augmented Lagrangian method. See comment 4 for more information on when to use which method. 
</li>
<li>
Choosing a good initial penalty parameter can often be a difficult task, since this parameter depends on material properties as well as on mesh dimensions. For this reason, an algorithm has been implemented in FEBio that attempts to calculate a good initial value for the penalty factor <span class="MathJax_Preview"><script type="math/tex">
\varepsilon_{i}
</script>
</span>for a particular node/integration piont <span class="MathJax_Preview"><script type="math/tex">
i
</script>
</span> on the contact interface: <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\varepsilon_{i}=\frac{EA}{V}.

</script>

</span>
Here, <span class="MathJax_Preview"><script type="math/tex">
A
</script>
</span> is the area of the element the integration point belongs to, <span class="MathJax_Preview"><script type="math/tex">
V
</script>
</span> is the element volume and <span class="MathJax_Preview"><script type="math/tex">
E
</script>
</span> is a measure of the elasticity modulus, which is calculated from the elasticity tensor of the element. Although the meaning of <span class="MathJax_Preview"><script type="math/tex">
E
</script>
</span>depends on the precise material formulation, in general one can regard it as a measure of the small strain Young’s modulus of the material.<div class="Unindented">
To use this feature, add the following element to the contact section:
</div>
<pre class="LyX-Code">
&lt;auto_penalty&gt;1&lt;/auto_penalty&gt;
</pre>
<div class="Unindented">
When the auto-penalty flag is on, the value of the <i>penalty </i>parameter serves as a scale factor for the automatically-calculated penalty factor.
</div>

</li>
<li>
Each sliding interface consists of a master surface and a slave surface. The slave surface is the surface over which the contact equations are integrated and on which the contact tractions are calculated. The master surface is used to measure the gap function and to define the necessary kinematic quantities such as surface normals and tangents. This approach is usually referred to as the <i>single-pass </i>method. When using the single-pass algorithm, the results can be influenced by the choice of slave and master surfaces. It is best to use the most tessellated surface as the slave and the coarsest as the master surface. To resolve the bias issue, one can also use a <i>two-pass</i> algorithm for enforcement of the contact constraint. In this case, a single pass is performed first, after which the slave and master surfaces are swapped and another pass is performed. When using the two-pass method, the definition of master and slave surfaces is arbitrary. In most problems, the single pass is sufficient to enforce contact; with a judicious choice of slave-master pair and contact parameters, good results can be obtained. If however, the single pass does not give good answers, for example, when due to the geometry’s curvature the gap cannot be small enough with a single pass, the two-pass method can be used, although at the expense of more calculations. <div class="Unindented">
If one of the contacting surfaces is rigid, a slightly different approach is recommended. In this case, it is best to pick the rigid surface as the master surface and to use a single pass algorithm. The reason is that the nodal degrees of freedom on the rigid surface are condensed to the rigid degrees of freedom and if the rigid surface is the slave surface, the reaction forces may not propagate correctly to the master surface. This is especially true if the rigid degrees of freedom are fixed.<span class="FootOuter"><span class="SupFootMarker"> [G] </span><span class="HoverFoot"><span class="SupFootMarker"> [G] </span> In future versions of FEBio rigid surfaces will be automatically picked to be the master. </span></span>
</div>

</li>
<li>
In the presence of a sliding interface (and other contact interfaces), FEBio needs to calculate the contact tractions that prevent the two participating surfaces from penetrating. In general these tractions can be found using the method of Lagrange multipliers. However, the direct calculation of these multipliers has several computational disadvantages and therefore FEBio approximates the multipliers using one of two alternative methods: the penalty method and the augmented Lagrangian method. In the former method, the multipliers are approximated by the gap (i.e. penetration distance) scaled by a suitably chosen penalty factor. In many cases, this method is sufficient to get good results. Since the correctness of a contact solution is directly determined by the amount of penetration at the converged state, the user has direct control over the quality of the solution. By increasing the penalty factor, the penetration is reduced. However, in some cases, especially in large compression problems, the penalty factor required to achieve an acceptable amount of penetration has to be so large that it causes numerical instabilities in the non-linear solution algorithm due to ill-conditioning of the stiffness matrix. In these cases, the augmented Lagrangian method might be a better choice. In this method, the multipliers are determined iteratively where, in each iteration, the multiplier’s increments are determined with a penalty-like method. The advantage of this method is twofold: due to the iterative nature, the method will work with a smaller penalty factor, and in the limit, the exact Lagrange multipliers can be recovered. <div class="Unindented">
To turn on the augmented Lagrangian method, simply add the following line to the contact section:
</div>
<pre class="LyX-Code">
&lt;laugon&gt;1&lt;/laugon&gt;
</pre>
<div class="Unindented">
To turn off the augmented Lagrangian method, either set the value to 0 or remove the parameter altogether. The convergence tolerance is set as follows:
</div>
<pre class="LyX-Code">
&lt;tolerance&gt;0.01&lt;/tolerance&gt;
</pre>
<div class="Unindented">
With this parameter set, the augmented Lagrangian method will iterate until the relative increment in the multipliers is less than the tolerance. For instance, setting the tolerance parameter to 0.01 implies that the augmented Lagrangian method will converge when there is less than a 1% change in the L2 norm of the augmented Lagrangian multiplier vector between successive augmentations. Alternatively, the user can also specify a tolerance for the gap value. In this case, the iterations will terminate when the gap norm, which is defined as the averaged L2 norm, (<span class="MathJax_Preview"><script type="math/tex">
\sqrt{\sum\nolimits _{i}<g_{i}>^{2}}/N
</script>
</span>, <span class="MathJax_Preview"><script type="math/tex">
<\cdot>
</script>
</span>the Macauley Bracket) is less than the user-specified value:
</div>
<pre class="LyX-Code">
&lt;gaptol&gt;0.001&lt;/gaptol&gt;
</pre>
<div class="Unindented">
However, one must be careful when specifying a gap tolerance. First note that the gap tolerance is an absolute value (unlike the <i>tolerance </i>which is a relative value), so this parameter depends on the dimensions of the model. Also, there are cases when a gap tolerance simply cannot be reached due to the geometry of the model in which case the augmentations may never converge.
</div>
<div class="Indented">
Note that both convergence parameters may be defined at once. In that case, FEBio will try to satisfy both convergence criteria. On the other hand, setting a value of zero will turn off the convergence criteria. For example, the default value for <i>gaptol</i> is zero, so that FEBio will not check the gap norm by default.
</div>
<div class="Indented">
Finally, the <i>minaug </i>and <i>maxaug</i> can be used to set a minimum and maximum number of augmentations. When the <i>maxuag </i>value is reached, FEBio will move on to the next timestep, regardless of whether the force and gap tolerances have been met. When specifying a value for <i>minaug</i>, FEBio will perform at least minaug augmentations.
</div>

</li>
<li>
The <i>sliding_with_gaps </i>contact implementation is currently the only contact algorithm that supports friction. Three parameters control the frictional response: <i>fric_coeff </i>is the material’s friction coefficient and its value must be in the range from 0.0 to 1.0; <i>fric_penalty </i>is the penalty factor that regulates the tangential traction forces, much like the <i>penalty </i>parameter regulates the normal traction force component; the parameter <i>ktmult </i>is a scale factor for the tangential stiffness matrix. It is default to 1.0, but it is observed that reducing this value might sometimes improve convergence. 
</li>
<li>
In a contact problem, FEBio calculates the projection of each slave node on the master surface. As a slave node slides across the master surface, the corresponding master segment can change. However, in some cases, switching segments is undesirable since it might cause instabilities in the solution process or a state in which the node oscillates continuously between two adjacent facets and thus prevents FEBio from meeting the displacement convergence tolerance. The parameter <i>seg_up </i>allows the user to control the number of segment updates FEBio will perform during each time step. For example, a value of 4 tells FEBio it can do the segment updates during the first four iterations. After that, slave nodes will not be allowed to switch to new master segments. The default value is 0, which means that FEBio will do a segment update each iteration of each timestep. 
</li>
<li>
The <i>sliding2</i>, <i>sliding3</i> and <i>sliding-multiphasic</i> contact implementations for sliding contact are inherently non-symmetric formulations. Symmetrized versions of these algorithms do not perform as well as the nonsymmetric version so it is recommended to use the latter. The following line controls which version of the algorithm is used. <pre class="LyX-Code">
&lt;symmetric_stiffness&gt;0&lt;/symmetric_stiffness&gt;
</pre>
<div class="Unindented">
A value of 1 uses the symmetric version, where a value of 0 uses the non-symmetric version.
</div>

</li>
<li>
The <i>search_tol</i> parameter defines the search tolerance of the algorithm that projects slave nodes onto master facets. A node that falls outside an element, but whose distance to the closest element’s edge is less than the search tolerance is still considered inside. This can alleviate convergence problems when nodes are projected onto edges of master elements and due to numerical error may be projected outside the master surface. 
</li>
<li>
The <i>search_radius</i> parameter defines the search radius for the algorithm that projects slave points onto master facets. When the distance between the slave point and the master facet exceeds the search_radius, that projection is ignored. This can alleviate convergence problems when master surfaces have multiple folds and the projection produces multiple solutions, only one of which (the closest distance) is valid. 
</li>
<li>
The <i>tension</i> flag determines whether the contact interface can sustain tension and compression (<i>tension</i>=1) or only compression (<i>tension</i>=0). 
</li>

</ol>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-3.13.2">3.13.2</a> Biphasic Contact<a class="Label" name="subsec:Biphasic-Contact"> </a>
</h3>
<div class="Unindented">
The <i>sliding2 </i>implementation for sliding interfaces can deal with biphasic contact surfaces (including biphasic-on-biphasic, biphasic-on-elastic, biphasic-on-rigid). It allows for the possibility to track fluid flow across the contact interface. In other words, fluid can flow from one side of the contact interface to the other when both contact surfaces are biphasic. To use this feature, the user must define an additional contact parameter, namely:
</div>
<pre class="LyX-Code">
&lt;pressure_penalty&gt;1.0&lt;/pressure_penalty&gt;
</pre>
<div class="Unindented">
In the same way that the <i>penalty </i>parameter controls the contact tractions, this parameter controls the penalty value that is used to calculate the Lagrange multipliers for the pressure constraint. If the <i>laugon </i>flag is set, the augmented Lagrangian method is used to enforce the pressure constraint. And if the <i>auto_penalty </i>flag is defined (which is the recommended approach), an initial guess for the pressure penalty is calculated automatically using the following formula:<span class="MathJax_Preview">
<script type="math/tex;mode=display">

\varepsilon_{p}=\frac{kA}{V},

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
A
</script>
</span> is the element’s area, <span class="MathJax_Preview"><script type="math/tex">
V
</script>
</span> is the element’s volume and <span class="MathJax_Preview"><script type="math/tex">
k
</script>
</span> is a measure of the permeability which is defined as one third of the trace of the material’s initial permeability tensor.
</div>
<div class="Indented">
When either contact surface is biphasic, the surface outside the contact area(s) is automatically set to free-draining conditions (equivalent to setting the fluid pressure to zero).
</div>
<div class="Indented">
When performing biphasic-solute-on-rigid contact, a two-pass analysis should not be used; the biphasic-solute surface should be the slave surface.
</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-3.13.3">3.13.3</a> Biphasic-Solute and Multiphasic Contact<a class="Label" name="subsec:Biphasic-Solute-Multiphasic-Contact"> </a>
</h3>
<div class="Unindented">
The <i>sliding3 </i>implementation for sliding interfaces can deal with biphasic-solute contact surfaces (including biphasic-solute-on-biphasic-solute, biphasic-solute-on-biphasic, biphasic-solute-on-elastic, biphasic-solute-on-rigid) and the <i>sliding-multiphasic</i> contact interface can similarly deal with multiphasic contact surfaces. These contact interfaces allow for the possibility to track fluid and solute flow across the contact interface. In other words, fluid and solute can flow from one side of the contact interface to the other. To use this feature, the user must define additional contact parameters, namely:
</div>
<pre class="LyX-Code">
&lt;pressure_penalty&gt;1.0&lt;/pressure_penalty&gt;
&lt;concentration_penalty&gt;1.0&lt;/concentration_penalty&gt;
&lt;ambient_pressure&gt;0&lt;/ambient_pressure&gt;
&lt;ambient_concentration&gt;0&lt;/ambient_concentration&gt; (for sliding3)
</pre>
<div class="Unindented">
or
</div>
<pre class="LyX-Code">
&lt;ambient_concentration sol=&rdquo;id&rdquo;&gt;0&lt;/ambient_concentration&gt; (for sliding-multiphasic)
</pre>
<div class="Unindented">
In the same way that the <i>penalty </i>parameter controls the contact tractions, these penalty parameters control the penalty values that are used to calculate the Lagrange multipliers for the pressure and concentration constraints. If the <i>laugon </i>flag is set, the augmented Lagrangian method is used to enforce the pressure and concentration constraints. And if the <i>auto_penalty </i>flag is defined, an initial guess for the pressure and concentration penalty is calculated automatically using the following formulas: <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\varepsilon_{p}=\frac{k\cdot A}{V}\,,\quad\varepsilon_{c}=\frac{d\cdot A}{V}\,,

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
A
</script>
</span> is the element’s area, <span class="MathJax_Preview"><script type="math/tex">
V
</script>
</span> is the element’s volume, <span class="MathJax_Preview"><script type="math/tex">
k
</script>
</span> is a measure of the fluid permeability which is defined as one third of the trace of the material’s initial permeability tensor, and <span class="MathJax_Preview"><script type="math/tex">
d
</script>
</span> is a measure of the solute diffusivity which is defined as one third of the trace of the material’s initial diffusivity tensor.
</div>
<div class="Indented">
When either contact surface is biphasic-solute or multiphasic, the surface outside the contact area(s) is automatically set to ambient conditions (equivalent to setting the effective fluid pressure and effective solute concentration to the &lt;ambient_pressure&gt; and &lt;ambient_concentration&gt; values, respectively). Ambient conditions may also be associated with a load curve, for example:
</div>
<pre class="LyX-Code">
&lt;ambient_pressure lc="2"&gt;1.0&lt;/ambient_pressure&gt;
&lt;ambient_concentration lc="3"&gt;1.0&lt;/ambient_concentration&gt;
</pre>
<div class="Unindented">
When performing biphasic-solute-on-rigid or multiphasic-on-rigid contact, a two-pass analysis should not be used; the rigid surface should be the master surface.
</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-3.13.4">3.13.4</a> Rigid Wall Interfaces<a class="Label" name="subsec:Rigid-Wall-Interfaces"> </a>
</h3>
<div class="Unindented">
A rigid wall interface is similar to a sliding interface, except that the master surface is a rigid wall. The following properties are defined for rigid wall interfaces:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
<b>Parameter</b>
</td>
<td align="left" valign="top">
<b>Description</b>
</td>
<td align="left" valign="top">
<b>Default</b> 
</td>

</tr>
<tr>
<td align="left" valign="top">
laugon
</td>
<td align="left" valign="top">
Augmented Lagrangian flag
</td>
<td align="left" valign="top">
0 (false) 
</td>

</tr>
<tr>
<td align="left" valign="top">
tolerance
</td>
<td align="left" valign="top">
augmentation tolerance
</td>
<td align="left" valign="top">
0.01 
</td>

</tr>
<tr>
<td align="left" valign="top">
penalty
</td>
<td align="left" valign="top">
penalty factor
</td>
<td align="left" valign="top">
1.0 
</td>

</tr>
<tr>
<td align="left" valign="top">
plane
</td>
<td align="left" valign="top">
the plane equation for the rigid wall
</td>
<td align="left" valign="top">
N/A 
</td>

</tr>
<tr>
<td align="left" valign="top">
offset
</td>
<td align="left" valign="top">
the normal offset of the plane defined by the <i>plane </i>parameter
</td>
<td align="left" valign="top">
0.0 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
The <i>plane </i>property defines the reference plane for the rigid wall. Its value is an array of four values:<span class="MathJax_Preview"><script type="math/tex">
a,b,c,d_{0}
</script>
</span>. The actual plane is defined by specifying the <i>offset </i>to the reference plane. The offset parameter takes a loadcurve as an optional attribute to define the motion of the plane as a function of time. The loadcurve defines the offset <span class="MathJax_Preview"><script type="math/tex">
h
</script>
</span> from the initial position in the direction of the plane normal: <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\begin{array}{cc}
ax+by+cz+d\left(t\right)=0, & d\left(t\right)=d_{0}+h\left(t\right)\end{array}

</script>

</span>
So, for example, a rigid wall that initially lies in the xy-coordinate plane and moves in the z-direction would be specified as follows:
</div>
<pre class="LyX-Code">
&lt;plane&gt;0,0,1,0&lt;/plane&gt;
&lt;offset lc="1"&gt;1.0&lt;/offset&gt;
</pre>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-3.13.5">3.13.5</a> Tied Interfaces<a class="Label" name="subsec:Tied-Interfaces"> </a>
</h3>
<div class="Unindented">
A tied interface can be used to connect two non-conforming meshes. A tied interface requires the definition of both a slave and a master surface. It is assumed that the nodes of the slave surface are connected to the faces of the master surface. The following control parameters need to be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;penalty&gt;
</td>
<td align="left" valign="top">
penalty factor 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;tolerance&gt;
</td>
<td align="left" valign="top">
augmentation tolerance 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-3.13.6">3.13.6</a> Tied Biphasic Interfaces<a class="Label" name="subsec:Tied-Biphasic-Interfaces"> </a>
</h3>
<div class="Unindented">
A tied biphasic interface is similar to the tied interface. It may be used for tying any combination of solid, biphasic, and rigid materials. It enforces continuity of the fluid pressure across the interface when both materials are biphasic. The following control parameters need to be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
<b>Parameter</b>
</td>
<td align="left" valign="top">
<b>Description</b>
</td>
<td align="left" valign="top">
<b>Default</b> 
</td>

</tr>
<tr>
<td align="left" valign="top">
penalty
</td>
<td align="left" valign="top">
normal penalty scale factor (1)
</td>
<td align="left" valign="top">
1.0 
</td>

</tr>
<tr>
<td align="left" valign="top">
auto_penalty
</td>
<td align="left" valign="top">
auto-penalty calculation flag (2)
</td>
<td align="left" valign="top">
0 
</td>

</tr>
<tr>
<td align="left" valign="top">
two_pass
</td>
<td align="left" valign="top">
two-pass flag (3)
</td>
<td align="left" valign="top">
0 
</td>

</tr>
<tr>
<td align="left" valign="top">
laugon
</td>
<td align="left" valign="top">
augmented Lagrangian flag (4)
</td>
<td align="left" valign="top">
0 
</td>

</tr>
<tr>
<td align="left" valign="top">
tolerance
</td>
<td align="left" valign="top">
aug. Lagrangian convergence tolerance (4)
</td>
<td align="left" valign="top">
1.0 
</td>

</tr>
<tr>
<td align="left" valign="top">
gaptol
</td>
<td align="left" valign="top">
tolerance for gap value (4)
</td>
<td align="left" valign="top">
0.0 (off) 
</td>

</tr>
<tr>
<td align="left" valign="top">
symmetric_stiffness
</td>
<td align="left" valign="top">
symmetric stiffness matrix flag (7)
</td>
<td align="left" valign="top">
0 
</td>

</tr>
<tr>
<td align="left" valign="top">
search_tol
</td>
<td align="left" valign="top">
Projection search tolerance (8)
</td>
<td align="left" valign="top">

</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-3.13.7">3.13.7</a> Sticky Interfaces<a class="Label" name="subsec:Sticky-Interfaces"> </a>
</h3>
<div class="Unindented">
A sticky interface is similar to a tied interface except that it allows for initial separation of the tied surfaces and breaking of the tie after a user-defined normal traction is exceeded. The tie is only applied when the surfaces contact and sustained as long as the normal traction is less than the threshold.
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
<b>Parameter</b>
</td>
<td align="left" valign="top">
<b>Description</b> 
</td>

</tr>
<tr>
<td align="left" valign="top">
laugon
</td>
<td align="left" valign="top">
augmentation flag 
</td>

</tr>
<tr>
<td align="left" valign="top">
penalty
</td>
<td align="left" valign="top">
penalty factor 
</td>

</tr>
<tr>
<td align="left" valign="top">
tolerance
</td>
<td align="left" valign="top">
augmentation tolerance 
</td>

</tr>
<tr>
<td align="left" valign="top">
minaug
</td>
<td align="left" valign="top">
minimum number of required augmentations 
</td>

</tr>
<tr>
<td align="left" valign="top">
maxaug
</td>
<td align="left" valign="top">
maximum number of augmentations 
</td>

</tr>
<tr>
<td align="left" valign="top">
search_tolerance
</td>
<td align="left" valign="top">
tolerance for nodal projection onto master facet 
</td>

</tr>
<tr>
<td align="left" valign="top">
max_traction
</td>
<td align="left" valign="top">
threshold for normal traction (1) 
</td>

</tr>
<tr>
<td align="left" valign="top">
snap_tol
</td>
<td align="left" valign="top">
minimum distance for tie activation (2) 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
The contact surfaces are defined as in the <i>tied </i>interface (see Section <a class="Reference" href="#subsec:Tied-Interfaces">3.13.5↑</a>).
</div>
<div class="Indented">
<i>Comments:</i>
</div>
<ol>
<li>
The <i>max_traction </i>parameter can be used to break the tied interface after the normal traction exceeds the specified value. Initially, this value is set to zero, in which case FEBio will ignore this value and the tie cannot be broken. 
</li>
<li>
The <i>snap_tol </i>parameter is used in determining the minimum distance that a slave node must have approached the master facet in order to snap onto the master surface. The initial value is zero, meaning a slave node must have penetrated the master surface before it will be tied to it. 
</li>

</ol>
<div class="Unindented">
<p><br/>
</p>

</div>
<h2 class="Section">
<a class="toc" name="toc-Section-3.14">3.14</a> Constraints Section<a class="Label" name="sec:Constraints-Section"> </a>
</h2>
<div class="Unindented">
The Constraints section allows the user to enforce additional constraints to the model.
</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-3.14.1">3.14.1</a> Rigid Joints<a class="Label" name="subsec:Rigid-Joints"> </a>
</h3>
<div class="Unindented">
Rigid joints produce nonlinear constraints between rigid bodies. The term ‘rigid’ refers to the bodies, not to the joints. These nonlinear constraints are enforced using Lagrange multipliers. Each rigid joint needs to define two rigid bodies (<span class="MathJax_Preview"><script type="math/tex">
a
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
b)
</script>
</span>, a joint origin common to both bodies, and a set of axes that determine the relative orientation of the joint degrees of freedom. These axes define orthonormal basis vectors <span class="MathJax_Preview"><script type="math/tex">
\left\{ \mathbf{e}_{1}^{a},\mathbf{e}_{2}^{a},\mathbf{e}_{3}^{a}\right\} 
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
\left\{ \mathbf{e}_{1}^{b},\mathbf{e}_{2}^{b},\mathbf{e}_{3}^{b}\right\} 
</script>
</span> on each rigid body, with both bases being coincident, <span class="MathJax_Preview"><script type="math/tex">
\left\{ \mathbf{e}_{1},\mathbf{e}_{2},\mathbf{e}_{3}\right\} 
</script>
</span>, at the start of the analysis, and given in world coordinates.
</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-3.14.1.1">3.14.1.1</a> Rigid Revolute Joint<a class="Label" name="subsec:Rigid-Revolute-Joint"> </a>
</h4>
<div class="Unindented">
A rigid revolute joint connects rigid bodies <span class="MathJax_Preview"><script type="math/tex">
a
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
b
</script>
</span> at a point in space, allowing one degree of freedom for rotation about an axis through that point:
</div>
<pre class="LyX-Code">
&lt;constraint type="rigid revolute joint" name="Joint 1"&gt;
  &lt;tolerance&gt;0&lt;/tolerance&gt;
  &lt;gaptol&gt;1e-4&lt;/gaptol&gt;
  &lt;angtol&gt;1e-4&lt;/angtol&gt;
  &lt;force_penalty&gt;1e12&lt;/force_penalty&gt;
  &lt;moment_penalty&gt;1e12&lt;/moment_penalty&gt;
  &lt;body_a&gt;1&lt;/body_a&gt;
  &lt;body_b&gt;3&lt;/body_b&gt;
  &lt;joint_origin&gt;-150,0,2&lt;/joint_origin&gt;
  &lt;rotation_axis&gt;0,0,1&lt;/rotation_axis&gt;
&lt;/constraint&gt;
</pre>
<div class="Unindented">
The <i>tolerance </i>element defines the augmentation tolerance. That is, when the relative change in the constraint forces and moments (the Lagrange multipliers) are less than this value. The <i>gaptol</i> element defines the tolerance for spatial separation of the joint origin on the two bodies (in units of length). The <i>angtol</i> element defines the tolerance for angular separation of the joint axis on the two bodies (in units of radians). Setting any of these three elements to zero disables the enforcement of that tolerance. The <i>force_penalty</i> parameter (with units of force per length) represents the stiffness that prevents the joint origin on the two bodies from separating. The <i>moment_penalty</i> parameter (with units of moment per radians) represents the torsional stiffness that enforces parallelism of the joint axis on the two bodies. The <i>body_a</i> and <i>body_b </i>elements are the material numbers of the two rigid bodies. The <i>joint_origin </i>element defines the position of the joint origin (the origin of the basis <span class="MathJax_Preview"><script type="math/tex">
\left\{ \mathbf{e}_{1},\mathbf{e}_{2},\mathbf{e}_{3}\right\} )
</script>
</span> in world coordinates at the start of the analysis. Note that this point does not have to be inside or on the surface of either of the two bodies. The <i>rotation_axis </i>element defines the orientation of the joint rotation axis <span class="MathJax_Preview"><script type="math/tex">
\mathbf{e}_{1}
</script>
</span> in world coordinates at the start of the analysis.
</div>
<div class="Indented">
Optionally, the rotation of body <span class="MathJax_Preview"><script type="math/tex">
b
</script>
</span> relative to body <span class="MathJax_Preview"><script type="math/tex">
a
</script>
</span> may be prescribed using the additional tags
</div>
<pre class="LyX-Code">
&lt;prescribed_rotation&gt;1&lt;/prescribed_rotation&gt;
&lt;rotation lc="1"&gt;3.14159&lt;/rotation&gt;
</pre>
<div class="Unindented">
The <i>prescribed_rotation</i> element is a flag that indicates that the motion of the joint is prescribed (1 for prescribed, 0 for free). The <i>rotation</i> element specifies the amount of rotation (with units of radians) with an optional associated load curve.
</div>
<div class="Indented">
Optionally, a moment may be prescribed on body <span class="MathJax_Preview"><script type="math/tex">
b
</script>
</span> relative to body <span class="MathJax_Preview"><script type="math/tex">
a
</script>
</span>, about the joint axis, using the additional tag
</div>
<pre class="LyX-Code">
&lt;moment lc="1"&gt;5.e-3&lt;/moment&gt;
</pre>
<div class="Unindented">
The <i>moment</i> element specifies the magnitude of the moment, with an optional associated load curve. The <i>moment</i> element should not be used simultaneously with a prescribed rotation.
</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-3.14.1.2">3.14.1.2</a> Rigid Prismatic Joint<a class="Label" name="subsec:Rigid-Prismatic-Joint"> </a>
</h4>
<div class="Unindented">
A rigid prismatic joint connects rigid bodies <span class="MathJax_Preview"><script type="math/tex">
a
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
b
</script>
</span> at a point in space, allowing one degree of freedom for translation along an axis through that point:
</div>
<pre class="LyX-Code">
&lt;constraint type="rigid prismatic joint" name="Joint02 "&gt;
  &lt;tolerance&gt;0&lt;/tolerance&gt;
  &lt;gaptol&gt;1e-4&lt;/gaptol&gt;
  &lt;angtol&gt;1e-4&lt;/angtol&gt;
  &lt;force_penalty&gt;1e12&lt;/force_penalty&gt;
  &lt;moment_penalty&gt;1e12&lt;/moment_penalty&gt;
  &lt;body_a&gt;4&lt;/body_a&gt;
  &lt;body_b&gt;1&lt;/body_b&gt;
  &lt;joint_origin&gt;-150,0,2&lt;/joint_origin&gt;
  &lt;translation_axis&gt;1,0,0&lt;/translation_axis&gt;
  &lt;prescribed_translation&gt;150&lt;/prescribed_translation&gt;
  &lt;translation lc="1"&gt;1&lt;/translation&gt;
&lt;/constraint&gt;
</pre>
<div class="Unindented">
The <i>tolerance </i>element defines the augmentation tolerance. That is, when the relative change in the constraint forces and moments (the Lagrange multipliers) are less than this value. The <i>gaptol</i> element defines the tolerance for spatial separation of the joint origin on the two bodies (in units of length). The <i>angtol</i> element defines the tolerance for angular separation of the joint axis on the two bodies (in units of radians). Setting any of these three elements to zero disables the enforcement of that tolerance. The <i>force_penalty</i> parameter (with units of force per length) represents the stiffness that prevents the joint origin on the two bodies from separating. The <i>moment_penalty</i> parameter (with units of moment per radians) represents the torsional stiffness that enforces parallelism of the joint axis on the two bodies. The <i>body_a</i> and <i>body_b </i>elements are the material numbers of the two rigid bodies. The <i>joint_origin </i>element defines the position of the joint (the origin of the basis <span class="MathJax_Preview"><script type="math/tex">
\left\{ \mathbf{e}_{1},\mathbf{e}_{2},\mathbf{e}_{3}\right\} )
</script>
</span> in world coordinates at the start of the analysis. Note that this point does not have to be inside or on the surface of either of the two bodies. The <i>translation_axis </i>element defines the orientation <span class="MathJax_Preview"><script type="math/tex">
\mathbf{e}_{1}
</script>
</span> of the joint translation axis in world coordinates at the start of the analysis.
</div>
<div class="Indented">
Optionally, the translation of body <span class="MathJax_Preview"><script type="math/tex">
b
</script>
</span> relative to body <span class="MathJax_Preview"><script type="math/tex">
a
</script>
</span> may be prescribed using the additional tags
</div>
<pre class="LyX-Code">
&lt;prescribed_translation&gt;1&lt;/prescribed_translation&gt;
&lt;translation lc="1"&gt;5.0&lt;/translation&gt;
</pre>
<div class="Unindented">
The <i>prescribed_translation</i> element is a flag that indicates that the motion of the joint is prescribed (1 for prescribed, 0 for free). The <i>translation</i> element specifies the amount of translation (with units of length) with an optional associated load curve.
</div>
<div class="Indented">
Optionally, a force may be prescribed on body <span class="MathJax_Preview"><script type="math/tex">
b
</script>
</span> relative to body <span class="MathJax_Preview"><script type="math/tex">
a
</script>
</span>, along the joint axis using the additional tag
</div>
<pre class="LyX-Code">
&lt;force lc="1"&gt;5.e-3&lt;/force&gt;
</pre>
<div class="Unindented">
The <i>force</i> element specifies the magnitude of the force, with an optional associated load curve. The <i>force</i> element should not be used simultaneously with a prescribed translation.
</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-3.14.1.3">3.14.1.3</a> Rigid Cylindrical Joint<a class="Label" name="subsec:Rigid-Cylindrical-Joint"> </a>
</h4>
<div class="Unindented">
A rigid cylindrical joint connects rigid bodies <span class="MathJax_Preview"><script type="math/tex">
a
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
b
</script>
</span> at a point in space, allowing one degree of freedom for rotation about an axis through that point, and another degree of freedom for translation along that axis:
</div>
<pre class="LyX-Code">
&lt;constraint type="rigid cylindrical joint" name="Joint03"&gt;
  &lt;tolerance&gt;0&lt;/tolerance&gt;
  &lt;gaptol&gt;1e-4&lt;/gaptol&gt;
  &lt;angtol&gt;1e-4&lt;/angtol&gt;
  &lt;force_penalty&gt;1e12&lt;/force_penalty&gt;
  &lt;moment_penalty&gt;1e12&lt;/moment_penalty&gt;
  &lt;body_a&gt;1&lt;/body_a&gt;
  &lt;body_b&gt;2&lt;/body_b&gt;
  &lt;joint_origin&gt;0,0,0&lt;/joint_origin&gt;
  &lt;joint_axis&gt;0,0,1&lt;/joint_axis&gt;
&lt;/constraint&gt;
</pre>
<div class="Unindented">
The <i>tolerance </i>element defines the augmentation tolerance. That is, when the relative change in the constraint forces and moments (the Lagrange multipliers) are less than this value. The <i>gaptol</i> element defines the tolerance for spatial separation of the joint origin on the two bodies (in units of length). The <i>angtol</i> element defines the tolerance for angular separation of the joint axis on the two bodies (in units of radians). Setting any of these three elements to zero disables the enforcement of that tolerance. The <i>force_penalty</i> parameter (with units of force per length) represents the stiffness that prevents the joint origin on the two bodies from separating. The <i>moment_penalty</i> parameter (with units of moment per radians) represents the torsional stiffness that enforces parallelism of the joint axis on the two bodies. The <i>body_a</i> and <i>body_b </i>elements are the material numbers of the two rigid bodies. The <i>joint_origin </i>element defines the position of the joint (the origin of the basis <span class="MathJax_Preview"><script type="math/tex">
\left\{ \mathbf{e}_{1},\mathbf{e}_{2},\mathbf{e}_{3}\right\} )
</script>
</span> in world coordinates at the start of the analysis. Note that this point does not have to be inside or on the surface of either of the two bodies. The <i>joint_axis </i>element defines the orientation <span class="MathJax_Preview"><script type="math/tex">
\mathbf{e}_{1}
</script>
</span> of the joint rotation and translation axis in world coordinates at the start of the analysis.
</div>
<div class="Indented">
Optionally, the rotation of body <span class="MathJax_Preview"><script type="math/tex">
b
</script>
</span> relative to body <span class="MathJax_Preview"><script type="math/tex">
a
</script>
</span> may be prescribed using the additional tags
</div>
<pre class="LyX-Code">
&lt;prescribed_rotation&gt;1&lt;/prescribed_rotation&gt;
&lt;rotation lc="1"&gt;1.570796327&lt;/rotation&gt;
</pre>
<div class="Unindented">
The <i>prescribed_rotation</i> element is a flag that indicates that the motion of the joint is prescribed (1 for prescribed, 0 for free). The <i>rotation</i> element specifies the amount of rotation (with units of radians) with an optional associated load curve.
</div>
<div class="Indented">
Optionally, the translation of body <span class="MathJax_Preview"><script type="math/tex">
b
</script>
</span> relative to body <span class="MathJax_Preview"><script type="math/tex">
a
</script>
</span> may be prescribed using the additional tags
</div>
<pre class="LyX-Code">
&lt;prescribed_translation&gt;1&lt;/prescribed_translation&gt;
&lt;translation lc="2"&gt;10.0&lt;/translation&gt;
</pre>
<div class="Unindented">
Optionally, a moment may be prescribed about the joint axis using the additional tag
</div>
<pre class="LyX-Code">
&lt;moment lc="1"&gt;5.e-3&lt;/moment&gt;
</pre>
<div class="Unindented">
The <i>moment</i> element specifies the magnitude of the moment, with an optional associated load curve. The <i>moment</i> element should not be used simultaneously with a prescribed rotation.
</div>
<div class="Indented">
Optionally, a force may be prescribed along the joint axis using the additional tag
</div>
<pre class="LyX-Code">
&lt;force lc="1"&gt;2.0&lt;/force&gt;
</pre>
<div class="Unindented">
The <i>force</i> element specifies the magnitude of the force, with an optional associated load curve. The <i>force</i> element should not be used simultaneously with a prescribed translation.
</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-3.14.1.4">3.14.1.4</a> Rigid Spherical Joint<a class="Label" name="subsec:Rigid-Spherical-Joint"> </a>
</h4>
<div class="Unindented">
A rigid spherical joint connects rigid bodies <span class="MathJax_Preview"><script type="math/tex">
a
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
b
</script>
</span> at a point in space, allowing three degrees of freedom for rotation about that point:
</div>
<pre class="LyX-Code">
&lt;constraint type="rigid spherical joint" name="Joint01"&gt;
  &lt;tolerance&gt;0.1&lt;/tolerance&gt;
  &lt;gaptol&gt;0&lt;/gaptol&gt;
  &lt;force_penalty&gt;1e12&lt;/force_penalty&gt;
  &lt;body_a&gt;1&lt;/body_a&gt;
  &lt;body_b&gt;2&lt;/body_b&gt;
  &lt;joint_origin&gt;0,0,0&lt;/joint_origin&gt;
&lt;/constraint&gt;
</pre>
<div class="Unindented">
The <i>tolerance </i>element defines the augmentation tolerance. That is, when the relative change in the constraint forces and moments (the Lagrange multipliers) are less than this value. The <i>gaptol</i> element defines the tolerance for spatial separation of the joint origin on the two bodies (in units of length). Setting either of these elements to zero disables the enforcement of that tolerance. The <i>force_penalty</i> parameter (with units of force per length) represents the stiffness that prevents the joint origin on the two bodies from separating. The <i>body_a</i> and <i>body_b </i>elements are the material numbers of the two rigid bodies. The <i>joint_origin </i>element defines the position of the joint (the origin of the basis <span class="MathJax_Preview"><script type="math/tex">
\left\{ \mathbf{e}_{1},\mathbf{e}_{2},\mathbf{e}_{3}\right\} )
</script>
</span> in world coordinates at the start of the analysis. Note that this point does not have to be inside or on the surface of either of the two bodies. The <i>rotation_axis </i>element defines the orientation of the joint rotation axis in world coordinates at the start of the analysis.
</div>
<div class="Indented">
Optionally, the rotation of body <span class="MathJax_Preview"><script type="math/tex">
b
</script>
</span> relative to body <span class="MathJax_Preview"><script type="math/tex">
a
</script>
</span> may be prescribed using the additional tags
</div>
<pre class="LyX-Code">
&lt;moment_penalty&gt;1e20&lt;/moment_penalty&gt;
&lt;prescribed_rotation&gt;1&lt;/prescribed_rotation&gt;
&lt;rotation_x lc="1"&gt;1&lt;/rotation_x&gt;
&lt;rotation_y lc="2"&gt;1&lt;/rotation_y&gt;
&lt;rotation_z&gt;0&lt;/rotation_z&gt;
</pre>
<div class="Unindented">
The <i>prescribed_rotation</i> element is a flag that indicates that the motion of the joint is prescribed (1 for prescribed, 0 for free). The <i>rotation_x</i>, <i>rotation_y</i> and <i>rotation_z</i> elements specify the components <span class="MathJax_Preview"><script type="math/tex">
\left(\theta_{1},\theta_{2},\theta_{3}\right)
</script>
</span> of rotation (with units of radians), with optional associated load curves. The rotation occurs about the axis directed along <span class="MathJax_Preview"><script type="math/tex">
\theta_{1}\mathbf{e}_{1}^{a}+\theta_{2}\mathbf{e}_{2}^{a}+\theta_{3}\mathbf{e}_{3}^{a}
</script>
</span>, with a magnitude <span class="MathJax_Preview"><script type="math/tex">
\sqrt{\theta_{1}^{2}+\theta_{2}^{2}+\theta_{3}^{2}}
</script>
</span>. Either all or none of the rotation components must be prescribed, since all rotation components are needed to define a rotation tensor. The <i>moment_penalty</i> parameter (with units of moment per radians) represents the torsional stiffness that enforces tracking of the prescribed rotations between the two bodies.
</div>
<div class="Indented">
Optionally, moments may be prescribed on body <span class="MathJax_Preview"><script type="math/tex">
b
</script>
</span> relative to body <span class="MathJax_Preview"><script type="math/tex">
a
</script>
</span>, about the world coordinate axes, using the additional tag
</div>
<pre class="LyX-Code">
&lt;moment_x lc="3"&gt;1.e-3&lt;/moment_x&gt;
&lt;moment_y lc="4"&gt;3.e-3&lt;/moment_y&gt;
&lt;moment_z lc="5"&gt;2.e-3&lt;/moment_z&gt;
</pre>
<div class="Unindented">
The <i>moment</i> elements specify the components of the moment vector in world coordinates, with optional associated load curves. The <i>moment</i> elements should not be used simultaneously with a prescribed rotation.
</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-3.14.1.5">3.14.1.5</a> Rigid Planar Joint<a class="Label" name="subsec:Rigid-Planar-Joint"> </a>
</h4>
<div class="Unindented">
A rigid planar joint connects rigid bodies <span class="MathJax_Preview"><script type="math/tex">
a
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
b
</script>
</span>, allowing one degree of freedom for rotation about the axis <span class="MathJax_Preview"><script type="math/tex">
\mathbf{e}_{1}
</script>
</span> through that point, and two degrees of freedom for translations in the plane perpendicular to that axis, along <span class="MathJax_Preview"><script type="math/tex">
\mathbf{e}_{2}^{a}
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
\mathbf{e}_{3}^{a}
</script>
</span>:
</div>
<pre class="LyX-Code">
&lt;constraint type="rigid planar joint" name="Joint01"&gt;
  &lt;tolerance&gt;0&lt;/tolerance&gt;
  &lt;gaptol&gt;1e-4&lt;/gaptol&gt;
  &lt;angtol&gt;1e-4&lt;/angtol&gt;
  &lt;force_penalty&gt;1e12&lt;/force_penalty&gt;
  &lt;moment_penalty&gt;1e16&lt;/moment_penalty&gt;
  &lt;body_a&gt;1&lt;/body_a&gt;
  &lt;body_b&gt;2&lt;/body_b&gt;
  &lt;joint_origin&gt;0,0,0&lt;/joint_origin&gt;
  &lt;rotation_axis&gt;0,-0.5,0.8660254&lt;/rotation_axis&gt;
  &lt;translation_axis_1&gt;1,0,0&lt;/translation_axis_1&gt;
&lt;/constraint&gt;
</pre>
<div class="Unindented">
The <i>tolerance </i>element defines the augmentation tolerance. That is, when the relative change in the constraint forces and moments (the Lagrange multipliers) are less than this value. The <i>gaptol</i> element defines the tolerance for spatial separation of the joint origin on the two bodies (in units of length). The <i>angtol</i> element defines the tolerance for angular separation of the joint axes on the two bodies (in units of radians). Setting any of these three elements to zero disables the enforcement of that tolerance. The <i>force_penalty</i> parameter (with units of force per length) represents the stiffness that prevents the joint origin on the two bodies from separating along the rotation axis. The <i>moment_penalty</i> parameter (with units of moment per radians) represents the torsional stiffness that enforces parallelism of the joint rotation axis on the two bodies. The <i>body_a</i> and <i>body_b </i>elements are the material numbers of the two rigid bodies. The <i>joint_origin </i>element defines the position of the joint (the origin of the basis <span class="MathJax_Preview"><script type="math/tex">
\left\{ \mathbf{e}_{1},\mathbf{e}_{2},\mathbf{e}_{3}\right\} )
</script>
</span> in world coordinates at the start of the analysis. Note that this point does not have to be inside or on the surface of either of the two bodies. The <i>rotation_axis </i>element defines the orientation of the joint rotation axis <span class="MathJax_Preview"><script type="math/tex">
\mathbf{e}_{1}
</script>
</span> in world coordinates at the start of the analysis. The <i>translation_axis_1</i> element defines the orientation of the joint translation axis <span class="MathJax_Preview"><script type="math/tex">
\mathbf{e}_{2}^{a}
</script>
</span> in the plane perpendicular to the joint rotation axis, in world coordinates at the start of the analysis.
</div>
<div class="Indented">
Optionally, the rotation of body <span class="MathJax_Preview"><script type="math/tex">
b
</script>
</span> relative to body <span class="MathJax_Preview"><script type="math/tex">
a
</script>
</span> may be prescribed using the additional tags
</div>
<pre class="LyX-Code">
&lt;prescribed_rotation&gt;1&lt;/prescribed_rotation&gt;
&lt;rotation lc="1"&gt;1.570796327&lt;/rotation&gt;
</pre>
<div class="Unindented">
The <i>prescribed_rotation</i> element is a flag that indicates that the motion of the joint is prescribed (1 for prescribed, 0 for free). The <i>rotation</i> element specifies the amount of rotation (with units of radians) with an optional associated load curve.
</div>
<div class="Indented">
Optionally, the translation of body <span class="MathJax_Preview"><script type="math/tex">
b
</script>
</span> relative to body <span class="MathJax_Preview"><script type="math/tex">
a
</script>
</span> may be prescribed along <span class="MathJax_Preview"><script type="math/tex">
\mathbf{e}_{2}^{a}
</script>
</span> using the additional tags
</div>
<pre class="LyX-Code">
&lt;prescribed_translation_1&gt;1&lt;/prescribed_translation_1&gt;
&lt;translation_1 lc="2"&gt;10.0&lt;/translation_1&gt;
</pre>
<div class="Unindented">
Optionally, the translation of body <span class="MathJax_Preview"><script type="math/tex">
b
</script>
</span> relative to body <span class="MathJax_Preview"><script type="math/tex">
a
</script>
</span> may be prescribed along <span class="MathJax_Preview"><script type="math/tex">
\mathbf{e}_{3}^{a}
</script>
</span> using the additional tags
</div>
<pre class="LyX-Code">
&lt;prescribed_translation_2&gt;1&lt;/prescribed_translation_2&gt;
&lt;translation_2 lc="2"&gt;10.0&lt;/translation_2&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h2 class="Section">
<a class="toc" name="toc-Section-3.15">3.15</a> Rigid Connectors<a class="Label" name="sec:Rigid-Connectors"> </a>
</h2>
<div class="Unindented">
Rigid connectors produce forces between rigid bodies. The term ‘rigid’ refers to the bodies, not to the connectors.
</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-3.15.1">3.15.1</a> Rigid Spring<a class="Label" name="subsec:Rigid-Spring"> </a>
</h3>
<div class="Unindented">
A rigid spring connects rigid bodies <span class="MathJax_Preview"><script type="math/tex">
a
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
b
</script>
</span> with a linear spring:
</div>
<pre class="LyX-Code">
&lt;constraint type="rigid spring"&gt;
  &lt;body_a&gt;1&lt;/body_a&gt;
  &lt;body_b&gt;2&lt;/body_b&gt;
  &lt;insertion_a&gt;0,0,1&lt;/insertion_a&gt;
  &lt;insertion_b&gt;0,0,3&lt;/insertion_b&gt;
  &lt;k&gt;1&lt;/k&gt;
&lt;/constraint&gt;
</pre>
<div class="Unindented">
The <i>body_a</i> and <i>body_b </i>elements are the material numbers of the two rigid bodies. The <i>insertion_a </i>element defines the position of the spring insertion point on rigid body <span class="MathJax_Preview"><script type="math/tex">
a
</script>
</span>. The <i>insertion_b </i>element defines the position of the spring insertion point on rigid body <span class="MathJax_Preview"><script type="math/tex">
b
</script>
</span>. The <span class="MathJax_Preview"><script type="math/tex">
k
</script>
</span> element represents the spring stiffness (in units of force per length). The resting length of the spring is the distance between insertion points at the start of the analysis.
</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-3.15.2">3.15.2</a> Rigid Damper<a class="Label" name="subsec:Rigid-Damper"> </a>
</h3>
<div class="Unindented">
A rigid damper connects rigid bodies <span class="MathJax_Preview"><script type="math/tex">
a
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
b
</script>
</span> with a linear damper:
</div>
<pre class="LyX-Code">
&lt;constraint type="rigid damper"&gt;
  &lt;body_a&gt;1&lt;/body_a&gt;
  &lt;body_b&gt;2&lt;/body_b&gt;
  &lt;insertion_a&gt;0,0,1&lt;/insertion_a&gt;
  &lt;insertion_b&gt;0,0,3&lt;/insertion_b&gt;
  &lt;c&gt;1e-7&lt;/c&gt;
&lt;/constraint&gt;
</pre>
<div class="Unindented">
The <i>body_a</i> and <i>body_b </i>elements are the material numbers of the two rigid bodies. The <i>insertion_a </i>element defines the position of the damper insertion point on rigid body <span class="MathJax_Preview"><script type="math/tex">
a
</script>
</span>. The <i>insertion_b </i>element defines the position of the damper insertion point on rigid body <span class="MathJax_Preview"><script type="math/tex">
b
</script>
</span>. The <span class="MathJax_Preview"><script type="math/tex">
c
</script>
</span> element represents the damping coefficient (in units of force per velocity).
</div>
<div class="Indented">
<p><br/>
</p>

</div>
<h2 class="Section">
<a class="toc" name="toc-Section-3.16">3.16</a> Discrete Section<a class="Label" name="sec:Discrete-Section"> </a>
</h2>
<div class="Unindented">
This section defines the materials used by the discrete elements and assigns these materials to the discrete elements sets defined in the Geometry section. The materials are defined via the <i>discrete_material </i>element and the materials are assigned to discrete element sets using the <i>discrete </i>element.
</div>
<pre class="LyX-Code">
&lt;Discrete&gt;
  &lt;discrete_material id="1" type="nonlinear spring"&gt;
    &lt;force lc="1"&gt;1.0&lt;/force&gt;
  &lt;/discrete_material&gt;
  &lt;discrete_material id="2" type="linear spring"&gt;
    &lt;E&gt;2.0&lt;/E&gt;
  &lt;/discrete_material&gt;
  &lt;discrete dmat="1" discrete_set="springs1"/&gt;
  &lt;discrete dmat="2" discrete_set="springs2"&gt;
&lt;/Discrete&gt;
</pre>
<div class="Unindented">
The <i>discrete_material </i>and the <i>discrete </i>elemens are defined in more detail below.
</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-3.16.1">3.16.1</a> Discrete Materials<a class="Label" name="subsec:Discrete-Materials"> </a>
</h3>
<div class="Unindented">
The <i>discrete_material </i>section defines a material that can be assigned to a discrete element set. The <i>id </i>attribute defines the material ID and the <i>type </i>attribute defines the material type. The following types are currently supported.
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
<b>Type</b>
</td>
<td align="left" valign="top">
<b>Description</b> 
</td>

</tr>
<tr>
<td align="left" valign="top">
linear spring
</td>
<td align="left" valign="top">
spring that has a linear force-displacement relation 
</td>

</tr>
<tr>
<td align="left" valign="top">
nonlinear spring
</td>
<td align="left" valign="top">
user defines the force-displacement relation 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
The linear element requires the E parameter that defines the spring constant.
</div>
<div class="Indented">
The nonlinear spring requires the <i>force</i> parameter which defines the loadcurve that will be used for the force-displacement relation.
</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-3.16.2">3.16.2</a> Discrete Section<a class="Label" name="subsec:Discrete-Section"> </a>
</h3>
<div class="Unindented">
After the discrete materials are defined, the materials are assigned to the discrete element sets that are defined in the Geometry section using the <i>discrete </i>element. This element requires two attributes:
</div>
<div class="Description">
<span class="Description-entry"><b>dmat</b></span> discrete material ID 
</div>
<div class="Description">
<span class="Description-entry"><b>discrete_set</b></span> discrete element set defined in the Geometry section 
</div>
<div class="Unindented">
<p><br/>
</p>

</div>
<h2 class="Section">
<a class="toc" name="toc-Section-3.17">3.17</a> LoadData Section<a class="Label" name="sec:LoadData-Section"> </a>
</h2>
<div class="Unindented">
The <i>LoadData</i> section contains the loadcurve data. A loadcurve is defined by the <i>loadcurve </i>element. Each loadcurve is defined by repeating the <i>point </i>element for all data points:
</div>
<pre class="LyX-Code">
&lt;loadcurve id="1" [type="type" extend="extend"]&gt;
  &lt;point&gt; 0, 0 &lt;/point&gt;
  ...
  &lt;point&gt; 1, 1 &lt;/point&gt;
&lt;/loadcurve&gt;
</pre>
<div class="Unindented">
The <i>id </i>attribute is the loadcurve number and is used in other sections of the input file as a means to reference this curve.
</div>
<div class="Indented">
The optional attributes <i>type </i>and <i>extend </i>define how the value of the loadcurve is interpolated from the data points. The <i>type </i>defines the interpolation function and <i>extend </i>defines how the values of the loadcurve are determined outside of the interval defined by the first and last data point. The following tables list the possible values. The default values are marked with an asterisk (*).
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
<b>Type</b>
</td>
<td align="left" valign="top">
<b>Description</b> 
</td>

</tr>
<tr>
<td align="left" valign="top">
step
</td>
<td align="left" valign="top">
Use a step interpolation function 
</td>

</tr>
<tr>
<td align="left" valign="top">
linear*
</td>
<td align="left" valign="top">
Use a linear interpolation function 
</td>

</tr>
<tr>
<td align="left" valign="top">
smooth
</td>
<td align="left" valign="top">
The values are interpolated using a cubic spline. 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
<div class="Frameless" style="width: 100%;">
<div class="PlainVisible">
<div class="center">
<img class="embedded" src="Figures/FigLoadCurveTypes.png" alt="figure Figures/FigLoadCurveTypes.png" style="max-width: 394px; max-height: 117px;"/>

</div>
<br/>
<div class="center">
<b>The different values for the <i>type</i> attribute of load curves</b>
</div>

</div>

</div>

</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
<b>Extend</b>
</td>
<td align="left" valign="top">
<b>Description</b> 
</td>

</tr>
<tr>
<td align="left" valign="top">
constant
</td>
<td align="left" valign="top">
The value of the curve is the value of the closest endpoint 
</td>

</tr>
<tr>
<td align="left" valign="top">
extrapolate*
</td>
<td align="left" valign="top">
The value is extrapolated linearly from the endpoints 
</td>

</tr>
<tr>
<td align="left" valign="top">
repeat
</td>
<td align="left" valign="top">
The curve is repeated 
</td>

</tr>
<tr>
<td align="left" valign="top">
repeat offset
</td>
<td align="left" valign="top">
The curve is repeated but offset from the endpoints 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
<div class="Frameless" style="width: 100%;">
<div class="PlainVisible">
<div class="center">
<img class="embedded" src="Figures/FigLoadCurveExtend.png" alt="figure Figures/FigLoadCurveExtend.png" style="max-width: 460px; max-height: 120px;"/>

</div>
<br/>
<div class="center">
<b>The different values for the <i>extend</i> attribute of the load curve.</b>
</div>

</div>

</div>

</div>
<div class="Indented">
<b><div class="defskip"> </div></b>
</div>
<div class="Indented">
<p><br/>
</p>

</div>
<h2 class="Section">
<a class="toc" name="toc-Section-3.18">3.18</a> Output Section<a class="Label" name="sec:Output-Section"> </a>
</h2>
<div class="Unindented">
FEBio usually splits the output in two files: the <i>logfile,</i> which contains the same information that was written to the screen during the analysis, and the <i>plotfile,</i> which contains the results. The contents of these output files can be customized in the <i>Output</i> section.
</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-3.18.1">3.18.1</a> Logfile<a class="Label" name="subsec:Logfile"> </a>
</h3>
<div class="Unindented">
The logfile records the same output that is printed to the screen. In addition, the user can request FEBio to output additional data to the logfile. This feature is called <i>data logging</i>. To use this feature, simply define the following element in the <i>Output</i> section of the input file:
</div>
<pre class="LyX-Code">
&lt;Output&gt;
  &lt;logfile [file="&lt;log file&gt;"]&gt;
    &lt;node_data [attributes]&gt;item list&lt;/node_data&gt;
    &lt;element_data [attributes]&gt;item list&lt;/element_data&gt;
    &lt;rigid_body_data [attributes]&gt;item list&lt;/rigid_body_data&gt;
  &lt;/logfile&gt;
&lt;/Output&gt;
</pre>
<div class="Unindented">
The optional attribute <i>file </i>defines the name of the logfile. If omitted, a default name is used that is derived from the FEBio input file. See Section <a class="Reference" href="#sec:FEBio-Output">2.7↑</a> for details on default naming conventions for output files.
</div>
<div class="Indented">
Additional data is stored to the logfile by adding one or more of the following elements:
</div>
<div class="Description">
<span class="Description-entry"><i><i>node_data</i></i></span> request nodal data 
</div>
<div class="Description">
<span class="Description-entry"><i><i>element_data</i></i></span> request element data 
</div>
<div class="Description">
<span class="Description-entry"><i><i>rigid_body_data</i></i></span> request rigid body data 
</div>
<div class="Unindented">
Each of these data classes takes the following attributes:
</div>
<div class="Description">
<span class="Description-entry"><i><i>data</i></i></span> an expression defining the data that is to be stored 
</div>
<div class="Description">
<span class="Description-entry"><i><i>name</i></i></span> a descriptive name for the data (optional; default = data expression) 
</div>
<div class="Description">
<span class="Description-entry"><i><i>file</i></i></span> the name of the output file where the data is stored. (optional; default = logfile) 
</div>
<div class="Description">
<span class="Description-entry"><i><i>delim</i></i></span> the delimiter used to separate data in multi-column format (optional; default = space) 
</div>
<div class="Description">
<span class="Description-entry"><i><i>format</i></i></span> an optional format string (optional; default = not used) 
</div>
<div class="Unindented">
The <i>data </i>attribute is the most important one and is mandatory. It contains a list of variable names, separated by a semi-colon. The available variable names depend on the data class and are defined below. For example, the data expression:
</div>
<pre class="LyX-Code">
data="x;y;z"
</pre>
<div class="Unindented">
will store the variables <span class="MathJax_Preview"><script type="math/tex">
x
</script>
</span>, <span class="MathJax_Preview"><script type="math/tex">
y
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
z
</script>
</span> in separate columns. See below for more examples.
</div>
<div class="Indented">
The optional <i>name </i>attribute is a descriptive name for the data. It is used in the logfile to refer to this data and can be used to quickly find the data record in the logfile. If omitted, the data expression is used as the name.
</div>
<div class="Indented">
The<i> file </i>attribute defines the name of the output file where the data is to be stored. This attribute is optional and when not specified the data will be stored in the logfile. Note that the filename given is a template. FEBio appends a number at the end of the filename to indicate to which timestep the data belongs. For instance, if you define a file name as follows:
</div>
<pre class="LyX-Code">
file="data.txt"
</pre>
<div class="Unindented">
then the first file that is written will have the name <i>data000.txt</i>. After the first converged timestep a file with name <i>data001.txt </i>will be written and so on.
</div>
<div class="Indented">
The optional <i>delim</i> attribute defines the delimiter that is used in multi-column format. As described above, data can be stored in multiple columns and the delimiter is used to separate the columns. The default is a single space.
</div>
<div class="Indented">
The optional <i>format </i>attribute defines a format string that will be used to format the output. If this attribute is present, the <i>delim </i>attribute will be ignored. The format string is composed of literal characters and special formatting characters. The special formatting characters are preceded by the percentage character (%). The following formatting characters are currently defined.
</div>
<div class="Description">
<span class="Description-entry">%i</span> replace with the index of the corresponding item (i.e. node numbers for node data) 
</div>
<div class="Description">
<span class="Description-entry">%g</span> replace with a data value. Use a %g for each data item. 
</div>
<div class="Description">
<span class="Description-entry">%t</span> insert tab character in output. 
</div>
<div class="Description">
<span class="Description-entry">%n</span> insert newline character in output. 
</div>
<div class="Unindented">
The following example,
</div>
<pre class="LyX-Code">
&lt;node_data data="x;y;z" format=’&lt;node id="%i"&gt;%g,%g,%g&lt;/node&gt;’&gt;&lt;/node_data&gt;
</pre>
<div class="Unindented">
will print the following output (e.g. for node 1).
</div>
<pre class="LyX-Code">
&lt;node id="1"&gt;0.1,0.2,0.3&lt;/node&gt;
</pre>
<div class="Unindented">
Notice the use of the apostrophe (’) in the format string. This is necessary in order to include the quotation marks as part of the format string. Also note that each data string will automatically be printed on a new line, so there is no need to end the format string with a newline character.
</div>
<div class="Indented">
The value of the data elements is a list of items for which the data is to be stored. For example, for the <i>node_data </i>element the value is a list of nodes, for the <i>element_data </i>element it is a list of FE elements and for the <i>rigid_body </i>element it is a list of rigid bodies. The value may be omitted in which case the data for all items will be stored. For instance, omitting the value for the <i>node_data </i>element will store the data for all nodes.
</div>
<div class="Indented">
As stated above, the data is either stored in the logfile or in a separate file. In any case, a record is made in the logfile. When storing the data in the logfile, the following entry will be found in the logfile at the end of each converged timestep for each data element:
</div>
<pre class="LyX-Code">
Data Record #&lt;n&gt;
Step = &lt;time step&gt;
Time = &lt;time value&gt;
Data = &lt;data name&gt;
&lt;actual data goes here&gt;
</pre>
<div class="Unindented">
The record number <span class="MathJax_Preview"><script type="math/tex">
n
</script>
</span> corresponds to the <span class="MathJax_Preview"><script type="math/tex">
n
</script>
</span>th data element in the input file. The <i>Step </i>value is the current time step. The <i>Time </i>value is the current solution time. The <i>Data </i>value is the name of the data element as provided by the <i>name </i>attribute (or the <i>data </i>attribute if <i>name </i>is omitted). The actual data immediately follows this record. If multiple column output is used, the columns are separated by the <i>delim </i>attribute of the data element.
</div>
<div class="Indented">
When storing the data in a separate file, the format is slightly different:
</div>
<pre class="LyX-Code">
Data Record #&lt;n&gt;
Step = &lt;time step&gt;
Time = &lt;time value&gt;
Data = &lt;data name&gt;
File = &lt;file name&gt;
</pre>
<div class="Unindented">
The <i>File </i>value is the name of the physical file. Note that this is the name to which the time step number is appended. In addition, the physical file that stores the data contains the following header:
</div>
<pre class="LyX-Code">
*Title = &lt;problem title&gt;
*Step = &lt;time step&gt;
*Time = &lt;time value&gt;
*Data = &lt;data name&gt;
&lt;actual data goes here&gt;
</pre>
<div class="Unindented">
The problem title is as defined in the input file.
</div>
<div class="Indented">
In either case, the actual data is a multi-column list, separated by the delimiter specified with the <i>delim </i>attribute (or a space when omitted). The first column always contains the item number. For example, the following data element:
</div>
<pre class="LyX-Code">
&lt;node_data
data="x;y;z" name="nodal coordinates" delim=","&gt;1:4:1&lt;/node_data&gt;
</pre>
<div class="Unindented">
will result in the following record in the logfile:
</div>
<pre class="LyX-Code">
Data Record #1
Step = 1
Time = 0.1
Data = "nodal coordinates"
1,0.000,0.000,0.000
2,1.000,0.000,0.000
3,1.000,1.000,0.000
4,0.000,1.000,0.000
</pre>
<div class="Unindented">
This data record is repeated for each converged time step. The following sections define the data variables that are available for each of the data classes.
</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-3.18.1.1">3.18.1.1</a> Node_Data Class<a class="Label" name="subsec:Node_Data-Class"> </a>
</h4>
<div class="Unindented">
The <i>node_data </i>class defines a set of nodal variables. The data is stored for each node that is listed in the item list of the <i>node_data </i>element or for all nodes if no list is defined. The following nodal variables are defined.
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
<b>Node variables</b>
</td>
<td align="left" valign="top">
<b>Description</b> 
</td>

</tr>
<tr>
<td align="left" valign="top">
x
</td>
<td align="left" valign="top">
x-coordinate of current nodal position 
</td>

</tr>
<tr>
<td align="left" valign="top">
y
</td>
<td align="left" valign="top">
y-coordinate of current nodal position 
</td>

</tr>
<tr>
<td align="left" valign="top">
z
</td>
<td align="left" valign="top">
z-coordinate of current nodal position 
</td>

</tr>
<tr>
<td align="left" valign="top">
ux
</td>
<td align="left" valign="top">
x-coordinate of nodal displacement 
</td>

</tr>
<tr>
<td align="left" valign="top">
uy
</td>
<td align="left" valign="top">
y-coordinate of nodal displacement 
</td>

</tr>
<tr>
<td align="left" valign="top">
uz
</td>
<td align="left" valign="top">
z-coordinate of nodal displacement 
</td>

</tr>
<tr>
<td align="left" valign="top">
vx
</td>
<td align="left" valign="top">
x-coordinate of nodal velocity 
</td>

</tr>
<tr>
<td align="left" valign="top">
vy
</td>
<td align="left" valign="top">
y-coordinate of nodal velocity 
</td>

</tr>
<tr>
<td align="left" valign="top">
vz
</td>
<td align="left" valign="top">
z-coordinate of nodal velocity 
</td>

</tr>
<tr>
<td align="left" valign="top">
ax
</td>
<td align="left" valign="top">
x-coordinate of nodal acceleration 
</td>

</tr>
<tr>
<td align="left" valign="top">
ay
</td>
<td align="left" valign="top">
y-coordinate of nodal acceleration 
</td>

</tr>
<tr>
<td align="left" valign="top">
az
</td>
<td align="left" valign="top">
z-coordinate of nodal acceleration 
</td>

</tr>
<tr>
<td align="left" valign="top">
Rx
</td>
<td align="left" valign="top">
x-coordinate of nodal reaction force 
</td>

</tr>
<tr>
<td align="left" valign="top">
Ry
</td>
<td align="left" valign="top">
y-coordinate of nodal reaction force 
</td>

</tr>
<tr>
<td align="left" valign="top">
Rz
</td>
<td align="left" valign="top">
z-coordinate of nodal reaction force 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
For analyses using biphasic, biphasic-solute, and triphasic materials, the following additional variables can be defined.
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
<b>Node variables</b>
</td>
<td align="left" valign="top">
<b>Description</b> 
</td>

</tr>
<tr>
<td align="left" valign="top">
p
</td>
<td align="left" valign="top">
effective fluid pressure 
</td>

</tr>
<tr>
<td align="left" valign="top">
vx
</td>
<td align="left" valign="top">
x-component of solid velocity 
</td>

</tr>
<tr>
<td align="left" valign="top">
vy
</td>
<td align="left" valign="top">
y-component of solid velocity 
</td>

</tr>
<tr>
<td align="left" valign="top">
vz
</td>
<td align="left" valign="top">
z-component of solid velocity 
</td>

</tr>
<tr>
<td align="left" valign="top">
c[n]
</td>
<td align="left" valign="top">
effective concentration of solute n, with n from 1 to 8 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
For heat transfer problems the following nodal variables are available.
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
<b>Node variables</b>
</td>
<td align="left" valign="top">
<b>Description</b> 
</td>

</tr>
<tr>
<td align="left" valign="top">
T
</td>
<td align="left" valign="top">
Nodal temperature 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
For example, to store the current nodal positions of all nodes, use the following <i>node_data </i>element:
</div>
<pre class="LyX-Code">
&lt;node_data data="x;y;z"&gt;&lt;/node_data&gt;
</pre>
<div class="Unindented">
You can store the total nodal displacement for nodes 1 through 100, and all even numbered nodes 200 through 400 as follows:
</div>
<pre class="LyX-Code">
&lt;node_data data="ux;uy;uz"&gt;1:100:1,200:400:2&lt;/node_data&gt;
</pre>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-3.18.1.2">3.18.1.2</a> Element_Data Class<a class="Label" name="subsec:Element_Data-Class"> </a>
</h4>
<div class="Unindented">
The <i>element_data </i>class defines a set of element variables. The data is stored for each element that is listed in the item list of the <i>element_data </i>element or for all nodes if no list is defined. The following element variables are defined. Note that the actual value is the average over the element’s integration points values (if applicable).
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
<b>Element variables</b>
</td>
<td align="left" valign="top">
<b>Description</b> 
</td>

</tr>
<tr>
<td align="left" valign="top">
x
</td>
<td align="left" valign="top">
x-coordinate of current element centroid position 
</td>

</tr>
<tr>
<td align="left" valign="top">
y
</td>
<td align="left" valign="top">
y-coordinate of current element centroid position 
</td>

</tr>
<tr>
<td align="left" valign="top">
z
</td>
<td align="left" valign="top">
z-coordinate of current element centroid position 
</td>

</tr>
<tr>
<td align="left" valign="top">
sx
</td>
<td align="left" valign="top">
xx-component of the Cauchy stress 
</td>

</tr>
<tr>
<td align="left" valign="top">
sy
</td>
<td align="left" valign="top">
yy-component of the Cauchy stress 
</td>

</tr>
<tr>
<td align="left" valign="top">
sz
</td>
<td align="left" valign="top">
zz-component of the Cauchy stress 
</td>

</tr>
<tr>
<td align="left" valign="top">
sxy
</td>
<td align="left" valign="top">
xy-component of the Cauchy stress 
</td>

</tr>
<tr>
<td align="left" valign="top">
syz
</td>
<td align="left" valign="top">
yz-component of the Cauchy stress 
</td>

</tr>
<tr>
<td align="left" valign="top">
sxz
</td>
<td align="left" valign="top">
xz-component of the Cauchy stress 
</td>

</tr>
<tr>
<td align="left" valign="top">
s1
</td>
<td align="left" valign="top">
first eigenvalue of Cauchy stress tensor 
</td>

</tr>
<tr>
<td align="left" valign="top">
s2
</td>
<td align="left" valign="top">
second eigenvalue of Cauchy stress tensor 
</td>

</tr>
<tr>
<td align="left" valign="top">
s3
</td>
<td align="left" valign="top">
third eigenvalue of Cauchy stress tensor 
</td>

</tr>
<tr>
<td align="left" valign="top">
Ex
</td>
<td align="left" valign="top">
xx-component of the Green-Lagrange strain 
</td>

</tr>
<tr>
<td align="left" valign="top">
Ey
</td>
<td align="left" valign="top">
yy-component of the Green-Lagrange strain 
</td>

</tr>
<tr>
<td align="left" valign="top">
Ez
</td>
<td align="left" valign="top">
zz-component of the Green-Lagrange strain 
</td>

</tr>
<tr>
<td align="left" valign="top">
Exy
</td>
<td align="left" valign="top">
xy-component of the Green-Lagrange strain 
</td>

</tr>
<tr>
<td align="left" valign="top">
Eyz
</td>
<td align="left" valign="top">
yz-component of the Green-Lagrange strain 
</td>

</tr>
<tr>
<td align="left" valign="top">
Exz
</td>
<td align="left" valign="top">
xz-component of the Green-Lagrange strain 
</td>

</tr>
<tr>
<td align="left" valign="top">
E1
</td>
<td align="left" valign="top">
first eigenvalue of Green-Lagrange strain tensor 
</td>

</tr>
<tr>
<td align="left" valign="top">
E2
</td>
<td align="left" valign="top">
second eigenvalue of Green-Lagrange strain tensor 
</td>

</tr>
<tr>
<td align="left" valign="top">
E3
</td>
<td align="left" valign="top">
third eigenvalue of Green-Lagrange strain tensor 
</td>

</tr>
<tr>
<td align="left" valign="top">
Fxx
</td>
<td align="left" valign="top">
xx-component of the deformation gradient 
</td>

</tr>
<tr>
<td align="left" valign="top">
Fyy
</td>
<td align="left" valign="top">
yy-component of the deformation gradient 
</td>

</tr>
<tr>
<td align="left" valign="top">
Fzz
</td>
<td align="left" valign="top">
zz-component of the deformation gradient 
</td>

</tr>
<tr>
<td align="left" valign="top">
Fxy
</td>
<td align="left" valign="top">
xy-component of the deformation gradient 
</td>

</tr>
<tr>
<td align="left" valign="top">
Fyz
</td>
<td align="left" valign="top">
yz-component of the deformation gradient 
</td>

</tr>
<tr>
<td align="left" valign="top">
Fxz
</td>
<td align="left" valign="top">
xz-component of the deformation gradient 
</td>

</tr>
<tr>
<td align="left" valign="top">
Fyx
</td>
<td align="left" valign="top">
yx-component of the deformation gradient 
</td>

</tr>
<tr>
<td align="left" valign="top">
Fzy
</td>
<td align="left" valign="top">
zy-component of the deformation gradient 
</td>

</tr>
<tr>
<td align="left" valign="top">
Fzx
</td>
<td align="left" valign="top">
xz-component of the deformation gradient 
</td>

</tr>
<tr>
<td align="left" valign="top">
J
</td>
<td align="left" valign="top">
relative volume (determinant of deformation gradient) 
</td>

</tr>
<tr>
<td align="left" valign="top">
cxxxx
</td>
<td align="left" valign="top">
xxxx component of spatial elasticity tensor (a.k.a. c11) 
</td>

</tr>
<tr>
<td align="left" valign="top">
cxxyy
</td>
<td align="left" valign="top">
xxyy component of spatial elasticity tensor (a.k.a. c12) 
</td>

</tr>
<tr>
<td align="left" valign="top">
cyyyy
</td>
<td align="left" valign="top">
yyyy component of spatial elasticity tensor (a.k.a. c22) 
</td>

</tr>
<tr>
<td align="left" valign="top">
cxxzz
</td>
<td align="left" valign="top">
xxzz component of spatial elasticity tensor (a.k.a. c13) 
</td>

</tr>
<tr>
<td align="left" valign="top">
cyyzz
</td>
<td align="left" valign="top">
yyzz component of spatial elasticity tensor (a.k.a. c23) 
</td>

</tr>
<tr>
<td align="left" valign="top">
czzzz
</td>
<td align="left" valign="top">
zzzz component of spatial elasticity tensor (a.k.a. c33) 
</td>

</tr>
<tr>
<td align="left" valign="top">
cxxxy
</td>
<td align="left" valign="top">
xxxy component of spatial elasticity tensor (a.k.a. c14) 
</td>

</tr>
<tr>
<td align="left" valign="top">
cyyxy
</td>
<td align="left" valign="top">
yyxy component of spatial elasticity tensor (a.k.a. c24) 
</td>

</tr>
<tr>
<td align="left" valign="top">
czzxy
</td>
<td align="left" valign="top">
zzxy component of spatial elasticity tensor (a.k.a. c34) 
</td>

</tr>
<tr>
<td align="left" valign="top">
cxyxy
</td>
<td align="left" valign="top">
xyxy component of spatial elasticity tensor (a.k.a. c44) 
</td>

</tr>
<tr>
<td align="left" valign="top">
cxxyz
</td>
<td align="left" valign="top">
xxyz component of spatial elasticity tensor (a.k.a. c15) 
</td>

</tr>
<tr>
<td align="left" valign="top">
cyyyz
</td>
<td align="left" valign="top">
yyyz component of spatial elasticity tensor (a.k.a. c25) 
</td>

</tr>
<tr>
<td align="left" valign="top">
czzyz
</td>
<td align="left" valign="top">
zzyz component of spatial elasticity tensor (a.k.a. c35) 
</td>

</tr>
<tr>
<td align="left" valign="top">
cxyyz
</td>
<td align="left" valign="top">
xyyz component of spatial elasticity tensor (a.k.a. c45) 
</td>

</tr>
<tr>
<td align="left" valign="top">
cyzyz
</td>
<td align="left" valign="top">
yzyz component of spatial elasticity tensor (a.k.a. c55) 
</td>

</tr>
<tr>
<td align="left" valign="top">
cxxxz
</td>
<td align="left" valign="top">
xxxz component of spatial elasticity tensor (a.k.a. c16) 
</td>

</tr>
<tr>
<td align="left" valign="top">
cyyxz
</td>
<td align="left" valign="top">
yyxz component of spatial elasticity tensor (a.k.a. c26) 
</td>

</tr>
<tr>
<td align="left" valign="top">
czzxz
</td>
<td align="left" valign="top">
zzxz component of spatial elasticity tensor (a.k.a. c36) 
</td>

</tr>
<tr>
<td align="left" valign="top">
cxyxz
</td>
<td align="left" valign="top">
xyxz component of spatial elasticity tensor (a.k.a. c46) 
</td>

</tr>
<tr>
<td align="left" valign="top">
cyzyz
</td>
<td align="left" valign="top">
yzyz component of spatial elasticity tensor (a.k.a. c56) 
</td>

</tr>
<tr>
<td align="left" valign="top">
cxzxz
</td>
<td align="left" valign="top">
xzxz component of spatial elasticity tensor (a.k.a. c66) 
</td>

</tr>
<tr>
<td align="left" valign="top">
sed
</td>
<td align="left" valign="top">
strain energy density 
</td>

</tr>
<tr>
<td align="left" valign="top">
devsed
</td>
<td align="left" valign="top">
deviatoric strain energy density 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
For analyses using biphasic, biphasic-solute, and triphasic materials, the following additional variables can be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
<b>Element variables</b>
</td>
<td align="left" valign="top">
<b>Description</b> 
</td>

</tr>
<tr>
<td align="left" valign="top">
p
</td>
<td align="left" valign="top">
actual fluid pressure 
</td>

</tr>
<tr>
<td align="left" valign="top">
c<span class="MathJax_Preview"><script type="math/tex">
n
</script>
</span>
</td>
<td align="left" valign="top">
actual concentration of solute <span class="MathJax_Preview"><script type="math/tex">
n
</script>
</span> 
</td>

</tr>
<tr>
<td align="left" valign="top">
wx
</td>
<td align="left" valign="top">
x-component of fluid flux 
</td>

</tr>
<tr>
<td align="left" valign="top">
wy
</td>
<td align="left" valign="top">
y-component of fluid flux 
</td>

</tr>
<tr>
<td align="left" valign="top">
wz
</td>
<td align="left" valign="top">
z-component of fluid flux 
</td>

</tr>
<tr>
<td align="left" valign="top">
j<span class="MathJax_Preview"><script type="math/tex">
n
</script>
</span>x
</td>
<td align="left" valign="top">
x-component of flux of solute <span class="MathJax_Preview"><script type="math/tex">
n
</script>
</span> 
</td>

</tr>
<tr>
<td align="left" valign="top">
j<span class="MathJax_Preview"><script type="math/tex">
n
</script>
</span>y
</td>
<td align="left" valign="top">
y-component of flux of solute <span class="MathJax_Preview"><script type="math/tex">
n
</script>
</span> 
</td>

</tr>
<tr>
<td align="left" valign="top">
j<span class="MathJax_Preview"><script type="math/tex">
n
</script>
</span>z
</td>
<td align="left" valign="top">
z-component of flux of solute <span class="MathJax_Preview"><script type="math/tex">
n
</script>
</span> 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
For example, to store the (average) Cauchy stress for all elements, define the following data element:
</div>
<pre class="LyX-Code">
&lt;element_data data="sxx;syy;szz;sxy;syz;sxz" name="element stresses"&gt; &lt;/element_data&gt;
</pre>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-3.18.1.3">3.18.1.3</a> Rigid_Body_Data Class<a class="Label" name="subsec:Rigid_Body_Data-Class"> </a>
</h4>
<div class="Unindented">
The <i>rigid_body_data </i>class defines a set of variables for each rigid body. The data is stored for each rigid body that is listed in the item list of the <i>rigid_body_data </i>element or for all rigid bodies if no list is defined. The following variables are defined. Note that the item referenced in the item list is the material number of the rigid body.
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
<b>Rigid body variables</b>
</td>
<td align="left" valign="top">
<b>Description</b> 
</td>

</tr>
<tr>
<td align="left" valign="top">
x 
</td>
<td align="left" valign="top">
x-coordinate of center of mass position 
</td>

</tr>
<tr>
<td align="left" valign="top">
y 
</td>
<td align="left" valign="top">
y-coordinate of center of mass position 
</td>

</tr>
<tr>
<td align="left" valign="top">
z 
</td>
<td align="left" valign="top">
z-coordinate of center of mass position 
</td>

</tr>
<tr>
<td align="left" valign="top">
vx
</td>
<td align="left" valign="top">
x-component of center of mass velocity 
</td>

</tr>
<tr>
<td align="left" valign="top">
vy
</td>
<td align="left" valign="top">
y-component of center of mass velocity 
</td>

</tr>
<tr>
<td align="left" valign="top">
vz
</td>
<td align="left" valign="top">
z-component of center of mass velocity 
</td>

</tr>
<tr>
<td align="left" valign="top">
ax
</td>
<td align="left" valign="top">
x-component of center of mass acceleration 
</td>

</tr>
<tr>
<td align="left" valign="top">
ay
</td>
<td align="left" valign="top">
y-component of center of mass acceleration 
</td>

</tr>
<tr>
<td align="left" valign="top">
az
</td>
<td align="left" valign="top">
z-component of center of mass acceleration 
</td>

</tr>
<tr>
<td align="left" valign="top">
thx
</td>
<td align="left" valign="top">
x-component of rotation pseudo-vector 
</td>

</tr>
<tr>
<td align="left" valign="top">
thy
</td>
<td align="left" valign="top">
y-component of rotation pseudo-vector 
</td>

</tr>
<tr>
<td align="left" valign="top">
thz
</td>
<td align="left" valign="top">
z-component of rotation pseudo-vector 
</td>

</tr>
<tr>
<td align="left" valign="top">
omx
</td>
<td align="left" valign="top">
x-component of angular velocity 
</td>

</tr>
<tr>
<td align="left" valign="top">
omy
</td>
<td align="left" valign="top">
y-component of angular velocity 
</td>

</tr>
<tr>
<td align="left" valign="top">
omz
</td>
<td align="left" valign="top">
z-component of angular velocity 
</td>

</tr>
<tr>
<td align="left" valign="top">
alx
</td>
<td align="left" valign="top">
x-component of angular acceleration 
</td>

</tr>
<tr>
<td align="left" valign="top">
aly
</td>
<td align="left" valign="top">
y-component of angular acceleration 
</td>

</tr>
<tr>
<td align="left" valign="top">
alz
</td>
<td align="left" valign="top">
z-component of angular acceleration 
</td>

</tr>
<tr>
<td align="left" valign="top">
qx 
</td>
<td align="left" valign="top">
x-component of rotation quaternion 
</td>

</tr>
<tr>
<td align="left" valign="top">
qy 
</td>
<td align="left" valign="top">
y-component of rotation quaternion 
</td>

</tr>
<tr>
<td align="left" valign="top">
qz 
</td>
<td align="left" valign="top">
z-component of rotation quaternion 
</td>

</tr>
<tr>
<td align="left" valign="top">
qw 
</td>
<td align="left" valign="top">
w-component of rotation quaternion 
</td>

</tr>
<tr>
<td align="left" valign="top">
Fx 
</td>
<td align="left" valign="top">
x-component of the rigid body reaction force 
</td>

</tr>
<tr>
<td align="left" valign="top">
Fy 
</td>
<td align="left" valign="top">
y-component of the rigid body reaction force 
</td>

</tr>
<tr>
<td align="left" valign="top">
Fz 
</td>
<td align="left" valign="top">
z-component of the rigid body reaction force 
</td>

</tr>
<tr>
<td align="left" valign="top">
Mx 
</td>
<td align="left" valign="top">
x-component of the rigid body reaction torque 
</td>

</tr>
<tr>
<td align="left" valign="top">
My 
</td>
<td align="left" valign="top">
y-component of the rigid body reaction torque 
</td>

</tr>
<tr>
<td align="left" valign="top">
Mz 
</td>
<td align="left" valign="top">
z-component of the rigid body reaction torque 
</td>

</tr>
<tr>
<td align="left" valign="top">
KE
</td>
<td align="left" valign="top">
kinetic energy 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
For example, to store the rigid body reaction force of rigid body 2 and 4 add the following data element. Note that the 2 and 4 refer to the rigid body material number as defined in the <i>Material</i> section of the input file:
</div>
<pre class="LyX-Code">
&lt;rigid_body_data data="Fx;Fy;Fz"&gt;2,4&lt;/rigid_body_data&gt;
</pre>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-3.18.1.4">3.18.1.4</a> Rigid_Connector_Data Class<a class="Label" name="subsec:Rigid_Connector_Data-Class"> </a>
</h4>
<div class="Unindented">
The <i>rigid_connector_data </i>class defines a set of variables for each rigid joint or rigid connector. The data is stored for each rigid joint or rigid connector that is listed in the item list of the <i>rigid_connector_data </i>element or for all rigid connectors if no list is defined. The following variables are defined. Note that the item referenced in the item list is the rigid connector number in the order in which rigid connectors appear in the input file.
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
<b>Rigid body variables</b>
</td>
<td align="left" valign="top">
<b>Description</b> 
</td>

</tr>
<tr>
<td align="left" valign="top">
RCFx 
</td>
<td align="left" valign="top">
x-component of rigid connector force 
</td>

</tr>
<tr>
<td align="left" valign="top">
RCFy 
</td>
<td align="left" valign="top">
y-component of rigid connector force 
</td>

</tr>
<tr>
<td align="left" valign="top">
RCFz 
</td>
<td align="left" valign="top">
z-component of rigid connector force 
</td>

</tr>
<tr>
<td align="left" valign="top">
RCMx
</td>
<td align="left" valign="top">
x-component of rigid connector moment 
</td>

</tr>
<tr>
<td align="left" valign="top">
RCMy
</td>
<td align="left" valign="top">
y-component of rigid connector moment 
</td>

</tr>
<tr>
<td align="left" valign="top">
RCMz
</td>
<td align="left" valign="top">
z-component of rigid connector moment 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
For example, to store the reaction forces and moments at rigid joints 2 and 4 add the following data element:
</div>
<pre class="LyX-Code">
&lt;rigid_connector_data data="Fx;Fy;Fz;Mx;My;Mz"&gt;2,4&lt;/rigid_connector_data&gt;
</pre>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-3.18.2">3.18.2</a> Plotfile<a class="Label" name="subsec:Plotfile"> </a>
</h3>
<div class="Unindented">
By default, all the results are stored in a binary database, referred to as the <i>plotfile</i>. The preferred storage format is the FEBio bindary database format (referred to as the <i>xplt </i>format)<span class="FootOuter"><span class="SupFootMarker"> [H] </span><span class="HoverFoot"><span class="SupFootMarker"> [H] </span> As of FEBio version 2.0, the LSDYNA database is no longer supported. The FEBio database format is the only format that will be supported from now on.</span></span>. This section describes how to customize the data that is stored in the <i>xplt </i>format.
</div>
<div class="Indented">
To define the contents of the plotfile you need to define the <i>plotfile </i>element in the Output section of the FEBio input file.
</div>
<pre class="LyX-Code">
&lt;plotfile type="febio" [file="name.xplt"]/&gt;
</pre>
<div class="Unindented">
The <i>file</i> attribute is optional and allows the user to define the file name of the plotfile. If this attribute is omitted, FEBio will use a default file name for the plotfile.
</div>
<div class="Indented">
By default, FEBio will store the most common data variables to the plot file. However, it is advised to always specify the specific contents of the plotfile. This can be done by adding <i>var </i>elements in the <i>plotfile </i>section.
</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-3.18.2.1">3.18.2.1</a> Plotfile Variables<a class="Label" name="subsec:Plotfile-Variables"> </a>
</h4>
<div class="Unindented">
Plotfile variables are defined using the <i>var </i>keyword. This tag takes one parameter, namely the <i>type</i> of the variable.
</div>
<pre class="LyX-Code">
&lt;var type="&lt;name&gt;"/&gt;
</pre>
<div class="Unindented">
where <i>name </i>is the name of the variable. The following table lists the possible values for <i>name</i>.
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top" style="width: 2in;">
<b>Name</b>
</td>
<td align="left" valign="top">
<b>Variable</b>
</td>
<td align="left" valign="top" style="width: 3in;">
<b>Description</b> 
</td>

</tr>
<tr>
<td align="left" valign="top" style="width: 2in;">
Acceleration
</td>
<td align="left" valign="top">
Node
</td>
<td align="left" valign="top" style="width: 3in;">
Nodal accelerations 
</td>

</tr>
<tr>
<td align="left" valign="top" style="width: 2in;">
contact area
</td>
<td align="left" valign="top">
Surface
</td>
<td align="left" valign="top" style="width: 3in;">
Net contact area across contact interface. Evaluated by integrating the surface area at integration points where the contact pressure is not zero. 
</td>

</tr>
<tr>
<td align="left" valign="top" style="width: 2in;">
contact force
</td>
<td align="left" valign="top">
Surface
</td>
<td align="left" valign="top" style="width: 3in;">
Net contact force across contact interface. Evaluated by integrating the contact traction over the contact surface. 
</td>

</tr>
<tr>
<td align="left" valign="top" style="width: 2in;">
contact gap
</td>
<td align="left" valign="top">
Surface
</td>
<td align="left" valign="top" style="width: 3in;">
Contact gap distance, evaluated at contact surface nodes 
</td>

</tr>
<tr>
<td align="left" valign="top" style="width: 2in;">
contact pressure
</td>
<td align="left" valign="top">
Surface
</td>
<td align="left" valign="top" style="width: 3in;">
Contact pressure, evaluated at contact surface nodes 
</td>

</tr>
<tr>
<td align="left" valign="top" style="width: 2in;">
contact traction
</td>
<td align="left" valign="top">
Surface
</td>
<td align="left" valign="top" style="width: 3in;">
Contact traction vectors, evaluated at contact surface nodes 
</td>

</tr>
<tr>
<td align="left" valign="top" style="width: 2in;">
current density
</td>
<td align="left" valign="top">
Element
</td>
<td align="left" valign="top" style="width: 3in;">
Electric current density, Eq.<a class="Reference" href="#eq:mp-electric-current-density">(↓)</a> 
</td>

</tr>
<tr>
<td align="left" valign="top" style="width: 2in;">
damage
</td>
<td align="left" valign="top">
Element
</td>
<td align="left" valign="top" style="width: 3in;">
Damage variable <span class="MathJax_Preview"><script type="math/tex">
D
</script>
</span> (Section <a class="Reference" href="#sec:Reactive-Damage-Mechanics">4.5↓</a>) 
</td>

</tr>
<tr>
<td align="left" valign="top" style="width: 2in;">
deviatoric strain energy density
</td>
<td align="left" valign="top">
Element
</td>
<td align="left" valign="top" style="width: 3in;">
Deviatoric strain energy density <span class="MathJax_Preview"><script type="math/tex">
\tilde{\Psi}\left(\mathbf{\tilde{C}}\right)
</script>
</span>, Eq.<a class="Reference" href="#eq1">(↓)</a> 
</td>

</tr>
<tr>
<td align="left" valign="top" style="width: 2in;">
displacement
</td>
<td align="left" valign="top">
Node
</td>
<td align="left" valign="top" style="width: 3in;">
Nodal displacements 
</td>

</tr>
<tr>
<td align="left" valign="top" style="width: 2in;">
effective fluid pressure
</td>
<td align="left" valign="top">
Node
</td>
<td align="left" valign="top" style="width: 3in;">
Fluid pressure <span class="MathJax_Preview"><script type="math/tex">
p
</script>
</span> for biphasic materials, Eq.<a class="Reference" href="#eq:bp-stress">(↓)</a>, or <span class="MathJax_Preview"><script type="math/tex">
\tilde{p}
</script>
</span> for biphasic-solute, Eq.<a class="Reference" href="#eq:bs-effective-p-c">(↓)</a> and triphasic/multiphasic materials, Eq.<a class="Reference" href="#eq:mp-effective-p-c">(↓)</a> 
</td>

</tr>
<tr>
<td align="left" valign="top" style="width: 2in;">
effective solute concentration
</td>
<td align="left" valign="top">
Node
</td>
<td align="left" valign="top" style="width: 3in;">
Effective solute concentration <span class="MathJax_Preview"><script type="math/tex">
\tilde{c}
</script>
</span> for biphasic-solute materials, Eq.<a class="Reference" href="#eq:bs-effective-p-c">(↓)</a>, and triphasic/multiphasic materials, Eq.<a class="Reference" href="#eq:mp-effective-p-c">(↓)</a> 
</td>

</tr>
<tr>
<td align="left" valign="top" style="width: 2in;">
elasticity
</td>
<td align="left" valign="top">
Element
</td>
<td align="left" valign="top" style="width: 3in;">
Spatial elasticity tensor components 
</td>

</tr>
<tr>
<td align="left" valign="top" style="width: 2in;">
electric potential
</td>
<td align="left" valign="top">
Element
</td>
<td align="left" valign="top" style="width: 3in;">
Electric potential <span class="MathJax_Preview"><script type="math/tex">
\psi
</script>
</span> in triphasic/multiphasic materials, Section <a class="Reference" href="#sec:Triphasic-Multiphasic-Materials">4.9↓</a> 
</td>

</tr>
<tr>
<td align="left" valign="top" style="width: 2in;">
fixed charge density
</td>
<td align="left" valign="top">
Element
</td>
<td align="left" valign="top" style="width: 3in;">
Fixed charge density <span class="MathJax_Preview"><script type="math/tex">
c^{F}
</script>
</span> in current configuration, Eq.<a class="Reference" href="#eq:mp-CFD-mass-balance">(↓)</a> 
</td>

</tr>
<tr>
<td align="left" valign="top" style="width: 2in;">
fiber vector
</td>
<td align="left" valign="top">

</td>
<td align="left" valign="top" style="width: 3in;">
Material fiber vector 
</td>

</tr>
<tr>
<td align="left" valign="top" style="width: 2in;">
fluid flux
</td>
<td align="left" valign="top">
Element
</td>
<td align="left" valign="top" style="width: 3in;">
Fluid flux <span class="MathJax_Preview"><script type="math/tex">
\mathbf{w}
</script>
</span> in biphasic, Eq.<a class="Reference" href="#eq:bp-flux">(↓)</a>, biphasic-solute, Eq.<a class="Reference" href="#eq:bs-fluxes-w-j">(↓)</a>, and triphasic/multiphasic materials, Eq.<a class="Reference" href="#eq:mp-fluxes-w-j">(↓)</a> 
</td>

</tr>
<tr>
<td align="left" valign="top" style="width: 2in;">
fluid force
</td>
<td align="left" valign="top">
Surface
</td>
<td align="left" valign="top" style="width: 3in;">
Net fluid force across biphasic (sliding2), biphasic-solute (sliding3) and multiphasic (sliding-multiphasic) contact interface. Evaluated by integrating the fluid pressure <span class="MathJax_Preview"><script type="math/tex">
p
</script>
</span> over the contact surface. 
</td>

</tr>
<tr>
<td align="left" valign="top" style="width: 2in;">
fluid pressure
</td>
<td align="left" valign="top">
Element
</td>
<td align="left" valign="top" style="width: 3in;">
Fluid pressure <span class="MathJax_Preview"><script type="math/tex">
p
</script>
</span> in biphasic, Eq.<a class="Reference" href="#eq:bp-stress">(↓)</a>, biphasic-solute, Eq.<a class="Reference" href="#eq:bs-effective-p-c">(↓)</a>, and triphasic/multiphasic materials, Eq.<a class="Reference" href="#eq:mp-effective-p-c">(↓)</a> 
</td>

</tr>
<tr>
<td align="left" valign="top" style="width: 2in;">
osmolarity
</td>
<td align="left" valign="top">
Element
</td>
<td align="left" valign="top" style="width: 3in;">
Sum of all solute concentrations <span class="MathJax_Preview"><script type="math/tex">
c^{\alpha}
</script>
</span> in triphasic/multiphasic materials 
</td>

</tr>
<tr>
<td align="left" valign="top" style="width: 2in;">
pressure gap
</td>
<td align="left" valign="top">
Surface
</td>
<td align="left" valign="top" style="width: 3in;">
Fluid pressure jump across biphasic, biphasic-solute and multiphasic contact interfaces 
</td>

</tr>
<tr>
<td align="left" valign="top" style="width: 2in;">
reaction forces
</td>
<td align="left" valign="top">
Node
</td>
<td align="left" valign="top" style="width: 3in;">
Reaction force vectors 
</td>

</tr>
<tr>
<td align="left" valign="top" style="width: 2in;">
referential fixed charge density
</td>
<td align="left" valign="top">
Element
</td>
<td align="left" valign="top" style="width: 3in;">
Referential fixed charge density <span class="MathJax_Preview"><script type="math/tex">
c_{r}^{F}
</script>
</span>, Eq.<a class="Reference" href="#eq:mp-CFD-mass-balance">(↓)</a>, which may evolve with chemical reactions, Eq.<a class="Reference" href="#eq:cr-referential-FCD">(↓)</a> 
</td>

</tr>
<tr>
<td align="left" valign="top" style="width: 2in;">
referential solid volume fraction
</td>
<td align="left" valign="top">
Element
</td>
<td align="left" valign="top" style="width: 3in;">
Referential solid volume fraction <span class="MathJax_Preview"><script type="math/tex">
\varphi_{r}^{s}
</script>
</span>, which may evolve with chemical reactions, Eq.<a class="Reference" href="#eq:cr-referential-solid-vol-frac">(↓)</a> 
</td>

</tr>
<tr>
<td align="left" valign="top" style="width: 2in;">
relative volume
</td>
<td align="left" valign="top">
Element
</td>
<td align="left" valign="top" style="width: 3in;">
Relative volume <span class="MathJax_Preview"><script type="math/tex">
J=\det\mathbf{F}
</script>
</span> 
</td>

</tr>
<tr>
<td align="left" valign="top" style="width: 2in;">
rigid torque
</td>
<td align="left" valign="top">
Rigid body
</td>
<td align="left" valign="top" style="width: 3in;">
Rigid body moment 
</td>

</tr>
<tr>
<td align="left" valign="top" style="width: 2in;">
rigid position
</td>
<td align="left" valign="top">
Rigid body
</td>
<td align="left" valign="top" style="width: 3in;">
Rigid body center of mass position 
</td>

</tr>
<tr>
<td align="left" valign="top" style="width: 2in;">
rigid velocity
</td>
<td align="left" valign="top">
Rigid body
</td>
<td align="left" valign="top" style="width: 3in;">
Rigid body center of mass velocity 
</td>

</tr>
<tr>
<td align="left" valign="top" style="width: 2in;">
rigid acceleration
</td>
<td align="left" valign="top">
Rigid body
</td>
<td align="left" valign="top" style="width: 3in;">
Rigid body center of mass acceleration 
</td>

</tr>
<tr>
<td align="left" valign="top" style="width: 2in;">
rigid angular position
</td>
<td align="left" valign="top">
Rigid body
</td>
<td align="left" valign="top" style="width: 3in;">
Rigid body rotation pseudo-vector 
</td>

</tr>
<tr>
<td align="left" valign="top" style="width: 2in;">
rigid angular velocity
</td>
<td align="left" valign="top">
Rigid body
</td>
<td align="left" valign="top" style="width: 3in;">
Rigid body angular velocity 
</td>

</tr>
<tr>
<td align="left" valign="top" style="width: 2in;">
rigid angular acceleration
</td>
<td align="left" valign="top">
Rigid body
</td>
<td align="left" valign="top" style="width: 3in;">
Rigid body angular acceleration 
</td>

</tr>
<tr>
<td align="left" valign="top" style="width: 2in;">
rigid kinetic energy
</td>
<td align="left" valign="top">
Rigid body
</td>
<td align="left" valign="top" style="width: 3in;">
Rigid body kinetic energy 
</td>

</tr>
<tr>
<td align="left" valign="top" style="width: 2in;">
rigid Euler
</td>
<td align="left" valign="top">
Rigid body
</td>
<td align="left" valign="top" style="width: 3in;">
Rigid body Euler angles 
</td>

</tr>
<tr>
<td align="left" valign="top" style="width: 2in;">
shell thickness
</td>
<td align="left" valign="top">
Node
</td>
<td align="left" valign="top" style="width: 3in;">
Shell thickness 
</td>

</tr>
<tr>
<td align="left" valign="top" style="width: 2in;">
solute concentration
</td>
<td align="left" valign="top">
Element
</td>
<td align="left" valign="top" style="width: 3in;">
Solute concentration <span class="MathJax_Preview"><script type="math/tex">
c
</script>
</span> in biphasic-solute materials, or <span class="MathJax_Preview"><script type="math/tex">
c^{\alpha}
</script>
</span> in triphasic/multiphasic materials 
</td>

</tr>
<tr>
<td align="left" valign="top" style="width: 2in;">
solute flux
</td>
<td align="left" valign="top">
Element
</td>
<td align="left" valign="top" style="width: 3in;">
Solute flux <span class="MathJax_Preview"><script type="math/tex">
\mathbf{j}
</script>
</span> in biphasic-solute materials, Eq.<a class="Reference" href="#eq:bs-fluxes-w-j">(↓)</a>, or <span class="MathJax_Preview"><script type="math/tex">
\mathbf{j}^{\alpha}
</script>
</span> in triphasic/multiphasic materials, Eq.<a class="Reference" href="#eq:mp-fluxes-w-j">(↓)</a>. 
</td>

</tr>
<tr>
<td align="left" valign="top" style="width: 2in;">
strain energy density
</td>
<td align="left" valign="top">
Element
</td>
<td align="left" valign="top" style="width: 3in;">
Strain energy density <span class="MathJax_Preview"><script type="math/tex">
\Psi\left(\mathbf{C}\right)
</script>
</span> 
</td>

</tr>
<tr>
<td align="left" valign="top" style="width: 2in;">
stress
</td>
<td align="left" valign="top">
Element
</td>
<td align="left" valign="top" style="width: 3in;">
Cauchy stress 
</td>

</tr>
<tr>
<td align="left" valign="top" style="width: 2in;">
temperature
</td>
<td align="left" valign="top">
Node
</td>
<td align="left" valign="top" style="width: 3in;">
Nodal temperatures 
</td>

</tr>
<tr>
<td align="left" valign="top" style="width: 2in;">
velocity
</td>
<td align="left" valign="top">
Node
</td>
<td align="left" valign="top" style="width: 3in;">
Nodal velocities 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
The following example stores nodal displacements and element stresses.
</div>
<div class="Indented">
<i>Example:</i>
</div>
<pre class="LyX-Code">
&lt;plotfile type="febio"&gt;
  &lt;var type="displacement"/&gt;
  &lt;var type="stress"/&gt;
&lt;/plotfile&gt;
</pre>
<div class="Unindented">
As of FEBio 2.4, additional information can be added in the type description of the variable definition. The general format is as follows.
</div>
<pre class="LyX-Code">
&lt;var type="name[filter]=alias"/&gt;
</pre>
<div class="Unindented">
The plot filter is defined by appending the name of the plot variable with the filter inside square brackets. Some plot variables require this to resolve possible ambiguities. For example,
</div>
<pre class="LyX-Code">
&lt;var type="solute concentration[’solute1’]"/&gt;
</pre>
<div class="Unindented">
This example will store the solute concentration of a solute named ‘solute1’ to the plot file.
</div>
<div class="Indented">
The optional alias can be used to rename the variable. For example,
</div>
<pre class="LyX-Code">
&lt;var type="solute concentration[’Na’]=Na concentration"/&gt;
</pre>
<div class="Unindented">
This variable will store the solute concentration of a solute named ‘Na’ to the plot file using the name ‘Na concentration’. This is the name that will be shown in PostView for instance.
</div>
<div class="Indented">
<p><br/>
</p>

</div>
<h2 class="Section">
<a class="toc" name="toc-Section-3.19">3.19</a> Parameters Section<a class="Label" name="sec:Parameters-Section"> </a>
</h2>
<div class="Unindented">
The <i>Parameters </i>section<span class="FootOuter"><span class="SupFootMarker"> [I] </span><span class="HoverFoot"><span class="SupFootMarker"> [I] </span> Supported from FEBio version 2.3 and up.</span></span> can be used to define parameters for the input file. These parameters can then be used to define material parameters, loads, contact parameters, etc. Combined with the capability to split the model definition across multiple files, this provides an easy and efficient mechanism for parameterizing a model definition.
</div>
<div class="Indented">
The <i>Parameters </i>section can be placed anywhere in the input file at top level. However, parameters can only be referenced after this section is defined and therefore is most conventiently placed at the top of the file.
</div>
<div class="Indented">
Individual parameters are defined using the <i>param </i>keyword, which takes a <i>name </i>attribute that defines the parameter name, and a value. For example,
</div>
<pre class="LyX-Code">
&lt;Parameters&gt;
  &lt;param name="E0"&gt;1.0&lt;/param&gt;
  &lt;param name="v0"&gt;0.3&lt;/param&gt;
&lt;/Parameters&gt;
</pre>
<div class="Unindented">
Parameters are referenced in xml-values by prefixing the parameter’s name with the &ldquo;at&rdquo; (@) symbol. For instance, if the previously defined parameters are used in a material definition, then it will look something like this.
</div>
<pre class="LyX-Code">
&lt;Material id="1" type="neo-Hookean"&gt;
  &lt;E&gt;@E0&lt;/E&gt;
  &lt;v&gt;@v0&lt;/v&gt;
&lt;/Material&gt;
</pre>
<h1 class="Chapter">
<a class="toc" name="toc-Chapter-4">4</a> Materials<a class="Label" name="chap:Materials"> </a>
</h1>
<div class="Unindented">
The following sections describe the material parameters for each of the available constitutive models, along with a short description of each material. A more detailed theoretical description of the constitutive models can be found in the <a href="http://help.mrl.sci.utah.edu/help/index.jsp">FEBio Theory Manual</a>.
</div>
<h2 class="Section">
<a class="toc" name="toc-Section-4.1">4.1</a> Elastic Solids<a class="Label" name="sec:Elastic-Solids"> </a>
</h2>
<div class="Unindented">
This section describes the elastic materials, which are materials defined by a hyperelastic strain-enerygy function. A distinction will be made between so-called <i>compressible </i>and <i>uncoupled </i>materials. The former describe materials that can undergo volumetric compression. The latter are used for modeling (near-) incompressible materials.
</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-4.1.1">4.1.1</a> Specifying Fiber Orientation or Material Axes<a class="Label" name="subsec:Specifying-Fiber-Orientation"> </a>
</h3>
<div class="Unindented">
Some of the materials are transversely isotropic, requiring the specification of an initial material direction, which is called a <i>fiber</i> direction in FEBio. Other materials are orthotropic, requiring the specification of initial material axes that define the three planes of symmetry for those materials. Only one of these specifications should be provided. When specifying material axes, the first axis corresponds to the fiber direction. The fiber or material axes orientation may be specified in several ways. FEBio gives the option to automatically generate the orientation, based on some user-specified parameters. However, the user can override this feature and specify the fiber or axes directions for each element manually in the <i>ElementData</i> section. See Section <a class="Reference" href="#subsec:ElementData">3.9.1↑</a> for more details on how to do this.
</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.1.1.1">4.1.1.1</a> Transversely Isotropic Materials<a class="Label" name="subsec:Transversely-Isotropic-Materials"> </a>
</h4>
<div class="Unindented">
For transversely isotropic materials fiber orientation is specified with the <i>fiber </i>element. This element takes one attribute, namely <i>type</i>, which specifies the type of the fiber generator. The possible values are specified in the following table.
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
<b><i>type</i> Value</b>
</td>
<td align="left" valign="top">
<b>Description</b> 
</td>

</tr>
<tr>
<td align="left" valign="top">
local
</td>
<td align="left" valign="top">
Use local element numbering (1) 
</td>

</tr>
<tr>
<td align="left" valign="top">
spherical
</td>
<td align="left" valign="top">
Define the fiber orientation as a constant vector (2) 
</td>

</tr>
<tr>
<td align="left" valign="top">
vector
</td>
<td align="left" valign="top">
specifies a spherical fiber distribution (3) 
</td>

</tr>
<tr>
<td align="left" valign="top">
cylindrical
</td>
<td align="left" valign="top">
specifies a cylindrical fiber distribution (4) 
</td>

</tr>
<tr>
<td align="left" valign="top">
angles
</td>
<td align="left" valign="top">
Specifies the fiber direction using spherical angles (5) 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
If the <i>type </i>attribute is omitted, the fiber distribution will follow the local element nodes 1 and 2. This would be the same as setting the fiber attribute to <i>local </i>and setting the value to &ldquo;1,2&rdquo;.
</div>
<div class="Indented">
<i>Comments</i>:
</div>
<ol>
<li>
In this case, the fiber direction is determined by local element node numbering. The value is interpreted as the local node numbers of the nodes that define the direction of the fiber. The following example defines a local fiber axis by local element nodes 1 and 2. This option is very useful when the local fiber direction can be interpreted as following one of the mesh edges. <pre class="LyX-Code">
&lt;fiber type="local"&gt;1,2&lt;/fiber&gt;
</pre>
<div class="Unindented">
<div class="Frameless" style="width: 100%;">
<div class="PlainVisible">
<div class="center">
<img class="embedded" src="Figures/FigLocalFiberDirectionOption.png" alt="figure Figures/FigLocalFiberDirectionOption.png" style="max-width: 114px; max-height: 125px;"/>

</div>
<br/>
<div class="center">
<b><i>local</i> fiber direction option</b>
</div>

</div>

</div>

</div>

</li>
<li>
The fiber orientation is determined by a point in space and the global location of each element integration point. The value is the location of the point. The following example defines a spherical fiber distribution centered at [0,0,1]: <pre class="LyX-Code">
&lt;fiber type="spherical"&gt;0,0,1&lt;/fiber&gt;
</pre>
<div class="Unindented">
<div class="Frameless" style="width: 100%;">
<div class="PlainVisible">
<div class="center">
<img class="embedded" src="Figures/FigSphericalFiberDirectionOption.png" alt="figure Figures/FigSphericalFiberDirectionOption.png" style="max-width: 173px; max-height: 127px;"/>

</div>
<br/>
<div class="center">
<b><i>spherical</i> fiber direction option</b>
</div>

</div>

</div>

</div>

</li>
<li>
The fiber orientation is specified by a vector. The value is the direction of the fiber. The following defines all element fiber directions in the direction of the vector [1,0,0]: <pre class="LyX-Code">
&lt;fiber type="vector"&gt;1,0,0&lt;/fiber&gt;
</pre>
<div class="Unindented">
<div class="Frameless" style="width: 100%;">
<div class="PlainVisible">
<div class="center">
<img class="embedded" src="Figures/FigVectorFiberDirectionOption.png" alt="figure Figures/FigVectorFiberDirectionOption.png" style="max-width: 200px; max-height: 124px;"/>

</div>
<br/>
<div class="center">
<b><i>vector</i> fiber direction option</b>
</div>

</div>

</div>

</div>

</li>
<li>
<i>cylindrical</i>: This type generates a fiber distribution that is cylindrical. The following subparameters must be defined. <div class="Description">
<span class="Description-entry"><i><i>center</i></i></span> <i></i>defines the center of the cylinder 
</div>
<div class="Description">
<span class="Description-entry"><i><i>axis</i></i></span> defines the axis of the cylinder 
</div>
<div class="Description">
<span class="Description-entry"><i><i>vector</i></i></span> defines a vector that will be transported around the cylinder 
</div>
<pre class="LyX-Code">
&lt;fiber type="cylindrical"&gt;
  &lt;center&gt;0,0,0&lt;/center&gt;
  &lt;axis&gt;0,0,1&lt;/axis&gt;
  &lt;vector&gt;0,1,0&lt;/vector&gt;
&lt;/fiber&gt;
</pre>

</li>
<li>
<i>angles</i>: This type generates a fiber orientation via the specification of spherical angles (azimuth and declination) relative to the local material axes (or global coordinate system, if no local material axes are defined). The following subparameters must be defined.<div class="Description">
<span class="Description-entry"><i><i>theta</i></i></span> <i></i>azimuth angle (in degrees) 
</div>
<div class="Description">
<span class="Description-entry"><i><i>phi</i></i></span> declination angle (in degrees) 
</div>
<div class="Unindented">
<div class="Frameless" style="width: 100%;">
<div class="PlainVisible">
<div class="center">
<img class="embedded" src="Figures/FigSphericalAngles.png" alt="figure Figures/FigSphericalAngles.png" style="max-width: 108px; max-height: 106px;"/>

</div>
<br/>
<div class="center">
<b>Spherical angles</b>
</div>

</div>

</div>

</div>
<div class="Indented">
The fiber is oriented along <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\sin\varphi\cos\theta\,\mathbf{e}_{1}+\sin\varphi\sin\theta\,\mathbf{e}_{2}+\cos\varphi\,\mathbf{e}_{3},0\leqslant\theta<2\pi,\;0\leqslant\varphi\leqslant\pi,

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
\left(\mathbf{e}_{1},\mathbf{e}_{2},\mathbf{e}_{3}\right)
</script>
</span> are orthonormal vectors representing the local element coordinate system (when specified, Section <a class="Reference" href="#subsec:Orthotropic-Materials">4.1.1.2↓</a>), or global coordinate system.
</div>
<pre class="LyX-Code">
&lt;fiber type="angles"&gt;
  &lt;theta&gt;20&lt;/center&gt;
  &lt;phi&gt;90&lt;/phi&gt;
&lt;/fiber&gt;
</pre>
<div class="Unindented">
When specifying a fiber direction <span class="MathJax_Preview"><script type="math/tex">
\mathbf{a}
</script>
</span>, FEBio generates a set of orthogonal material axes as described in Section <a class="Reference" href="#subsec:Orthotropic-Materials">4.1.1.2↓</a>. generated with <span class="MathJax_Preview"><script type="math/tex">
\mathbf{d}=\mathbf{e}_{2}
</script>
</span>, or else <span class="MathJax_Preview"><script type="math/tex">
\mathbf{d}=\mathbf{e}_{3}
</script>
</span> if <span class="MathJax_Preview"><script type="math/tex">
\mathbf{a}
</script>
</span> is collinear with <span class="MathJax_Preview"><script type="math/tex">
\mathbf{e}_{2}
</script>
</span>. Because of the non-uniqueness of these material axes (only <span class="MathJax_Preview"><script type="math/tex">
\mathbf{e}_{1}
</script>
</span> is along a uniquely defined direction in a <i>fiber</i> element), caution should be used when material axes are compounded, as may occur in nested materials such as solid mixtures described in Sections <a class="Reference" href="#subsec:Uncoupled-Solid-Mixture">4.1.2.15↓</a> &amp; <a class="Reference" href="#subsec:Solid-Mixture">4.1.3.21↓</a>. To enforce uniqueness, use the <i>mat_axis</i> element instead of the <i>fiber</i> element.
</div>

</li>

</ol>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.1.1.2">4.1.1.2</a> Orthotropic Materials<a class="Label" name="subsec:Orthotropic-Materials"> </a>
</h4>
<div class="Unindented">
For orthotropic materials, the user needs to specify two fiber directions <b><span class="MathJax_Preview"><script type="math/tex">
\mathbf{a}
</script>
</span></b> and <span class="MathJax_Preview"><script type="math/tex">
\mathbf{d}
</script>
</span>. From these FEBio will generate an orthonormal set of fiber vectors as follows: <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\mathbf{e}_{1}=\frac{\mathbf{a}}{\left\Vert \mathbf{a}\right\Vert },\quad\mathbf{e}_{2}=\mathbf{e}_{3}\times\mathbf{e}_{1},\quad\mathbf{e}_{3}=\frac{\mathbf{a}\times\mathbf{d}}{\left\Vert \mathbf{a}\times\mathbf{d}\right\Vert }\,.

</script>

</span>
The vectors <b><span class="MathJax_Preview"><script type="math/tex">
\mathbf{a}
</script>
</span> </b>and <b><span class="MathJax_Preview"><script type="math/tex">
\mathbf{d}
</script>
</span> </b>are defined using the <i>mat_axis </i>element. This element takes a <i>type</i> attribute, which can take on the following values:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="none" valign="top" style="width: 68pt;">
<b>Value</b>
</td>
<td align="left" valign="top">
<b>Description</b> 
</td>

</tr>
<tr>
<td align="none" valign="top" style="width: 68pt;">
local
</td>
<td align="left" valign="top">
Use local element numbering (1) 
</td>

</tr>
<tr>
<td align="none" valign="top" style="width: 68pt;">
vector
</td>
<td align="left" valign="top">
Specify the vectors <b><span class="MathJax_Preview"><script type="math/tex">
\mathbf{a}
</script>
</span></b> and <b><span class="MathJax_Preview"><script type="math/tex">
\mathbf{d}
</script>
</span></b> directly. (2) 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
<i>Comments</i>:
</div>
<ol>
<li>
When specifying <i>local </i>as the material axis type, the value is interpreted as a list of three local element node numbers. When specifying zero for all three, the default (1,2,4) is used. <pre class="LyX-Code">
&lt;mat_axis type="local"&gt;0,0,0&lt;/mat_axis&gt;
</pre>

</li>
<li>
When using the <i>vector </i>type, you need to define the two generator vectors <span class="MathJax_Preview"><script type="math/tex">
a
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
d
</script>
</span>. These are specified as child elements of the <i>mat_axis </i>element: <pre class="LyX-Code">
&lt;mat_axis type="vector"&gt;
  &lt;a&gt;1,0,0&lt;/a&gt;
  &lt;d&gt;0,1,0&lt;/d&gt;
&lt;/mat_axis&gt;
</pre>

</li>

</ol>
<div class="Unindented">
<p><br/>
</p>

</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-4.1.2">4.1.2</a> Uncoupled Materials<a class="Label" name="subsec:Uncoupled-Materials"> </a>
</h3>
<div class="Unindented">
Uncoupled, nearly-incompressible hyperelastic materials are described by a strain energy function that features an additive decomposition of the hyperelastic strain energy into deviatoric and dilational parts <span class="bibcites">[<a class="bibliocite" name="cite-32" href="#biblio-32"><span class="bib-index">32</span></a>]</span>: <span class="MathJax_Preview">
<script type="math/tex;mode=display">
\begin{equation}
\Psi\left(\mathbf{C}\right)=\tilde{\Psi}\left(\tilde{\mathbf{C}}\right)+U\left(J\right),\label{eq1}
\end{equation}
</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
\mathbf{\tilde{C}}=\mathbf{\tilde{F}}\cdot\mathbf{\tilde{F}}^{T}
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
\mathbf{\tilde{F}}=J^{-1/3}\mathbf{F}
</script>
</span> is the deviatoric part of the deformation gradient. The resulting 2<span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{nd}}
</script>
</span> Piola-Kirchhoff stress is given by <span class="MathJax_Preview">
<script type="math/tex;mode=display">
\begin{equation}
\mathbf{S}=J^{-2/3}\Dev\left[\mathbf{\tilde{S}}\right]+pJ\mathbf{C}^{-1},\label{eq2}
\end{equation}
</script>

</span>
where <span class="MathJax_Preview">
<script type="math/tex;mode=display">
\begin{equation}
\mathbf{\tilde{S}}=2\frac{\partial\tilde{\Psi}}{\partial\mathbf{\tilde{C}}}\quad,\label{eq3}
\end{equation}
</script>

</span>
and <span class="MathJax_Preview">
<script type="math/tex;mode=display">
\begin{equation}
p:=\frac{dU}{dJ},\label{eq4}
\end{equation}
</script>

</span>
and <span class="MathJax_Preview"><script type="math/tex">
\Dev\left[\cdot\right]
</script>
</span> is the deviatoric operator in the material frame.
</div>
<div class="Indented">
The corresponding Cauchy stress is given by <span class="MathJax_Preview">
<script type="math/tex;mode=display">
\begin{equation}
\boldsymbol{\sigma}=\dev\left[\tilde{\boldsymbol{\sigma}}\right]+p\mathbf{I},\label{eq5}
\end{equation}
</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
\tilde{\boldsymbol{\sigma}}=J^{-1}\mathbf{\tilde{F}}\cdot\mathbf{\tilde{S}}\cdot\mathbf{\tilde{F}}^{T}
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
\dev\left[\cdot\right]
</script>
</span> is the deviatoric operator in the spatial frame.
</div>
<div class="Indented">
For these materials, the entire bulk (volumetric) behavior is determined by the function <span class="MathJax_Preview"><script type="math/tex">
U\left(J\right)
</script>
</span>, and <span class="MathJax_Preview"><script type="math/tex">
p
</script>
</span> represents the entire hydrostatic stress. The function <span class="MathJax_Preview"><script type="math/tex">
U\left(J\right)
</script>
</span> is constructed to have a value of 0 for <span class="MathJax_Preview"><script type="math/tex">
J=
</script>
</span>1 and to have a positive value for all other values of <span class="MathJax_Preview"><script type="math/tex">
J>
</script>
</span>0.
</div>
<div class="Indented">
All of these materials make use of the three-field element described by Simo and Taylor <span class="bibcites">[<a class="bibliocite" name="cite-32" href="#biblio-32"><span class="bib-index">32</span></a>]</span>. This element uses a trilinear interpolation of the displacement field and piecewise-constant interpolations for the pressure and volume ratio.
</div>
<div class="Indented">
The uncoupled materials and the associated three-field element are very effective for representing nearly incompressible material behavior. Fully incompressible behavior can be obtained using an augmented Lagrangian method. To use the augmented Lagrangian method for enforcement of the incompressibility constraint to a user-defined tolerance, the user must define two additional material parameters:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
<b>Parameter</b>
</td>
<td align="left" valign="top">
<b>Description</b>
</td>
<td align="left" valign="top">
<b>Default</b> 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;laugon&gt;
</td>
<td align="left" valign="top">
Turn augmented Lagrangian on for this material or off (1)
</td>
<td align="left" valign="top">
0 (off) 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;atol&gt;
</td>
<td align="left" valign="top">
Augmentation tolerance (2)
</td>
<td align="left" valign="top">
0.01 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
<i>Comments</i>:
</div>
<ol>
<li>
A value of <i>1 </i>(one) turns augmentation on, where a value of 0 (zero) turns it off. 
</li>
<li>
The augmentation tolerance determines the convergence condition that is used for the augmented Lagrangian method: convergence is reached when the relative ratio of the lagrange multiplier norm of the previous augmentation <span class="MathJax_Preview"><script type="math/tex">
\left\Vert \lambda_{k}\right\Vert 
</script>
</span> to the current one <span class="MathJax_Preview"><script type="math/tex">
\left\Vert \lambda_{k+1}\right\Vert 
</script>
</span> is less than the specified value: 
</li>

</ol>
<div class="Unindented">
<span class="MathJax_Preview">
<script type="math/tex;mode=display">

\left|\frac{\left\Vert \lambda_{k+1}\right\Vert -\left\Vert \lambda_{k}\right\Vert }{\left\Vert \lambda_{k+1}\right\Vert }\right|<\varepsilon.

</script>

</span>
Thus, a value of 0.01 implies that the change in norm between the previous augmentation loop and the current loop is less than 1%.
</div>
<div class="Indented">
The augmented Lagrangian method for incompressibility enforcement is available for all materials that are based on an uncoupled hyperelastic strain energy function.
</div>
<div class="Indented">
<i>Example</i>:
</div>
<pre class="LyX-Code">
&lt;material id="1" type="Mooney-Rivlin"&gt;
  &lt;c1&gt;5&lt;/c1&gt;
  &lt;c2&gt;0.4&lt;/c2&gt;
  &lt;k&gt;10000&lt;/k&gt;
  &lt;laugon&gt;1&lt;/laugon&gt; <span class="MathJax_Preview"><script type="math/tex">
\leftarrow
</script>
</span> turns on augmented Lagrangian iterations
  &lt;atol&gt;0.05&lt;/atol&gt; <span class="MathJax_Preview"><script type="math/tex">
\leftarrow
</script>
</span> sets the augmentation tolerance
&lt;/material&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.1.2.1">4.1.2.1</a> Arruda-Boyce<a class="Label" name="subsec:Arruda-Boyce"> </a>
</h4>
<div class="Unindented">
This material describes an incompressible Arruda-Boyce model <span class="bibcites">[<a class="bibliocite" name="cite-2" href="#biblio-2"><span class="bib-index">2</span></a>]</span>. The following material parameters are required:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;mu&gt;
</td>
<td align="left" valign="top">
initial modulus
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;N&gt;
</td>
<td align="left" valign="top">
number of links in chain
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;k&gt;
</td>
<td align="left" valign="top">
Bulk modulus
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
The uncoupled strain energy function for the Arruda-Boyce material is given by: <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\Psi=\mu\sum\limits _{i=1}^{5}\frac{C_{i}}{N^{i-1}}\left(\tilde{I}_{1}^{i}-3^{i}\right)+U\left(J\right),

</script>

</span>
where, <span class="MathJax_Preview"><script type="math/tex">
C_{1}=\frac{1}{2},C_{2}=\frac{1}{20},C_{3}=\frac{11}{1050},C_{4}=\frac{19}{7000},C_{5}=\frac{519}{673750}
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
I_{1}
</script>
</span>the first invariant of the right Cauchy-Green tensor. The volumetric strain function <span class="MathJax_Preview"><script type="math/tex">
U
</script>
</span> is defined as follows, <span class="MathJax_Preview">
<script type="math/tex;mode=display">

U\left(J\right)=\frac{1}{2}k\left(\ln J\right)^{2}\,.

</script>

</span>
This material model was proposed by Arruda and Boyce <span class="bibcites">[<a class="bibliocite" name="cite-2" href="#biblio-2"><span class="bib-index">2</span></a>]</span> and is based on an eight-chain representation of the macromolecular network structure of polymer chains. The strain energy form represents a truncated Taylor series of the inverse Langevin function, which arises in the statistical treatment of non-Gaussian chains. The parameter <span class="MathJax_Preview"><script type="math/tex">
N
</script>
</span> is related to the locking stretch <span class="MathJax_Preview"><script type="math/tex">
\lambda_{L}
</script>
</span>, the stretch at which the chains reach their full extended state, by <span class="MathJax_Preview"><script type="math/tex">
\lambda_{L}=\sqrt{N}
</script>
</span>.
</div>
<div class="Indented">
<i>Example:</i>
</div>
<pre class="LyX-Code">
&lt;material id="1" type="Arruda-Boyce"&gt;
  &lt;mu&gt;0.09&lt;/mu&gt;
  &lt;N&gt;26.5&lt;/N&gt;
  &lt;k&gt;100&lt;/k&gt;
&lt;/material&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.1.2.2">4.1.2.2</a> Ellipsoidal Fiber Distribution<a class="Label" name="subsec:EFD-Uncoupled"> </a>
</h4>
<div class="Unindented">
The material type for an ellipsoidal continuous fiber distribution in an uncoupled formulation is &ldquo;<i>EFD uncoupled</i>&rdquo;. Since fibers can only sustain tension, this material is not stable on its own. It must be combined with a stable compressible material that acts as a ground matrix, using a &ldquo;<i>uncoupled solid mixture</i>&rdquo; container as described in Section <a class="Reference" href="#subsec:Uncoupled-Solid-Mixture">4.1.2.15↓</a>. The following material parameters need to be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;beta&gt;
</td>
<td align="left" valign="top">
parameters <span class="MathJax_Preview"><script type="math/tex">
\left(\beta_{1},\beta_{2},\beta_{3}\right)
</script>
</span>
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;ksi&gt;
</td>
<td align="left" valign="top">
parameters <span class="MathJax_Preview"><script type="math/tex">
\left(\xi_{1},\xi_{2},\xi_{3}\right)
</script>
</span>
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
The stress <span class="MathJax_Preview"><script type="math/tex">
\tilde{\boldsymbol{\sigma}}
</script>
</span> for this material is given by <span class="bibcites">[<a class="bibliocite" name="cite-25" href="#biblio-25"><span class="bib-index">25</span></a>, <a class="bibliocite" name="cite-7" href="#biblio-7"><span class="bib-index">7</span></a>, <a class="bibliocite" name="cite-4" href="#biblio-4"><span class="bib-index">4</span></a>]</span>: <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\tilde{\boldsymbol{\sigma}}=\int_{0}^{2\pi}\int_{0}^{\pi}H\left(\tilde{I}_{n}-1\right)\tilde{\sigma}_{n}\left(\mathbf{n}\right)\sin\varphi\,d\varphi\,d\theta.

</script>

</span>
<span class="MathJax_Preview"><script type="math/tex">
\tilde{I}_{n}=\tilde{\lambda}_{n}^{2}=\mathbf{N}\cdot\mathbf{\tilde{C}}\cdot\mathbf{N}
</script>
</span> is the square of the fiber stretch <span class="MathJax_Preview"><script type="math/tex">
\tilde{\lambda}_{n}
</script>
</span>, <span class="MathJax_Preview"><script type="math/tex">
\mathbf{N}
</script>
</span> is the unit vector along the fiber direction (in the reference configuration), which in spherical angles is directed along <span class="MathJax_Preview"><script type="math/tex">
\left(\theta,\varphi\right)
</script>
</span>, <span class="MathJax_Preview"><script type="math/tex">
\mathbf{n}=\mathbf{\tilde{F}}\cdot\mathbf{N}/\tilde{\lambda}_{n}
</script>
</span>, and <span class="MathJax_Preview"><script type="math/tex">
H\left(.\right)
</script>
</span> is the unit step function that enforces the tension-only contribution. The fiber stress is determined from a fiber strain energy function in the usual manner, <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\tilde{\sigma}_{n}=\frac{2\tilde{I}_{n}}{J}\frac{\partial\tilde{\Psi}}{\partial\tilde{I}_{n}}\mathbf{n}\otimes\mathbf{n}\,,

</script>

</span>
where in this material, <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\tilde{\Psi}\left(\mathbf{n},\tilde{I}_{n}\right)=\xi\left(\mathbf{n}\right)\left(\tilde{I}_{n}-1\right)^{\beta\left(\mathbf{n}\right)}\,.

</script>

</span>
The materials parameters <span class="MathJax_Preview"><script type="math/tex">
\beta
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
\xi
</script>
</span> are determined from: <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\begin{aligned}\xi\left(\mathbf{n}\right) & =\left(\frac{\cos^{2}\theta\sin^{2}\varphi}{\xi_{1}^{2}}+\frac{\sin^{2}\theta\sin^{2}\varphi}{\xi_{2}^{2}}+\frac{\cos^{2}\varphi}{\xi_{3}^{2}}\right)^{-1/2}\\
\beta\left(\mathbf{n}\right) & =\left(\frac{\cos^{2}\theta\sin^{2}\varphi}{\beta_{1}^{2}}+\frac{\sin^{2}\theta\sin^{2}\varphi}{\beta_{2}^{2}}+\frac{\cos^{2}\varphi}{\beta_{3}^{2}}\right)^{-1/2}
\end{aligned}
\,.

</script>

</span>
The orientation of the material axis can be defined as explained in detail in Section <a class="Reference" href="#subsec:Specifying-Fiber-Orientation">4.1.1↑</a>.
</div>
<div class="Indented">
<i>Example</i>:
</div>
<pre class="LyX-Code">
&lt;material id="1" type="uncoupled solid mixture"&gt;
  &lt;mat_axis type="local"&gt;0,0,0&lt;/mat_axis&gt;
  &lt;solid type="Mooney-Rivlin"&gt;
    &lt;c1&gt;1&lt;/c1&gt;
    &lt;c2&gt;0&lt;/c2&gt;
    &lt;k&gt;1000&lt;/k&gt;
  &lt;/solid&gt;
  &lt;solid type="EFD uncoupled"&gt;
    &lt;ksi&gt;10, 12, 15&lt;/ksi&gt;
    &lt;beta&gt;2.5, 3, 3&lt;/beta&gt;
    &lt;k&gt;15000&lt;/k&gt;
  &lt;/solid&gt;
&lt;/material&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.1.2.3">4.1.2.3</a> Ellipsoidal Fiber Distribution Mooney-Rivlin<a class="Label" name="subsec:EFD-Mooney-Rivlin"> </a>
</h4>
<div class="Unindented">
The material type for a Mooney-Rivlin material with an ellipsoidal continuous fiber distribution is &ldquo;<i>EFD Mooney-Rivlin</i>&rdquo;. The following material parameters need to be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;c1&gt;
</td>
<td align="left" valign="top">
Mooney-Rivlin parameter c1
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;c2&gt;
</td>
<td align="left" valign="top">
Mooney-Rivlin parameter c2
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;k&gt;
</td>
<td align="left" valign="top">
bulk modulus
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;beta&gt;
</td>
<td align="left" valign="top">
parameters <span class="MathJax_Preview"><script type="math/tex">
\left(\beta_{1},\beta_{2},\beta_{3}\right)
</script>
</span>
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;ksi&gt;
</td>
<td align="left" valign="top">
parameters <span class="MathJax_Preview"><script type="math/tex">
\left(\xi_{1},\xi_{2},\xi_{3}\right)
</script>
</span>
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
The stress <span class="MathJax_Preview"><script type="math/tex">
\tilde{\boldsymbol{\sigma}}
</script>
</span> for this material is given by, <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\tilde{\boldsymbol{\sigma}}=\tilde{\boldsymbol{\sigma}}_{MR}+\tilde{\boldsymbol{\sigma}}_{f}\,.

</script>

</span>
Here, <span class="MathJax_Preview"><script type="math/tex">
\tilde{\boldsymbol{\sigma}}_{MR}
</script>
</span> is the stress from the Mooney-Rivlin basis (Section <a class="Reference" href="#subsec:Mooney-Rivlin">4.1.2.8↓</a>), and <span class="MathJax_Preview"><script type="math/tex">
\tilde{\boldsymbol{\sigma}}_{f}
</script>
</span> is the stress contribution from the ellipsoidal fiber distribution (Section <a class="Reference" href="#subsec:EFD-Uncoupled">4.1.2.2↑</a>). The orientation of the material axes can be defined as explained in detail in Section <a class="Reference" href="#subsec:Specifying-Fiber-Orientation">4.1.1↑</a>.
</div>
<div class="Indented">
<i>Example</i>:
</div>
<pre class="LyX-Code">
&lt;material id="1" type="EFD Mooney-Rivlin"&gt;
  &lt;c1&gt;1&lt;/c1&gt;
  &lt;c2&gt;0&lt;/c2&gt;
  &lt;beta&gt;4.5,4.5,4.5&lt;/beta&gt;
  &lt;ksi&gt;1,1,1&lt;/ksi&gt;
  &lt;k&gt;20000&lt;/k&gt;
  &lt;mat_axis type="local"&gt;0,0,0&lt;/mat_axis&gt;
&lt;/material&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.1.2.4">4.1.2.4</a> Ellipsoidal Fiber Distribution Veronda-Westmann<a class="Label" name="subsec:EFD-Veronda-Westmann"> </a>
</h4>
<div class="Unindented">
The material type for a Veronda-Westmann material with an ellipsoidal continuous fiber distribution is &ldquo;<i>EFD Veronda-Westmann</i>&rdquo;. The following material parameters need to be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;c1&gt;
</td>
<td align="left" valign="top">
First VW coefficient
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;c2&gt;
</td>
<td align="left" valign="top">
Second VW coefficient
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;k&gt;
</td>
<td align="left" valign="top">
Bulk modulus
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;beta&gt;
</td>
<td align="left" valign="top">
parameters <span class="MathJax_Preview"><script type="math/tex">
\left({\beta_{1},\beta_{2},\beta_{3}}\right)
</script>
</span>
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;ksi&gt;
</td>
<td align="left" valign="top">
parameters <span class="MathJax_Preview"><script type="math/tex">
\left({\xi_{1},\xi_{2},\xi_{3}}\right)
</script>
</span>
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
The stress <span class="MathJax_Preview"><script type="math/tex">
\tilde{\boldsymbol{\sigma}}
</script>
</span> for this material is given by, <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\tilde{\boldsymbol{\sigma}}=\tilde{\boldsymbol{\sigma}}_{VW}+\tilde{\boldsymbol{\sigma}}_{f}\,.

</script>

</span>
Here, <span class="MathJax_Preview"><script type="math/tex">
\tilde{\boldsymbol{\sigma}}_{VW}
</script>
</span> is the stress from the Veronda-Westmann basis (Section <a class="Reference" href="#subsec:Veronda-Westmann">4.1.2.16↓</a>), and <span class="MathJax_Preview"><script type="math/tex">
\tilde{\boldsymbol{\sigma}}_{f}
</script>
</span> is the stress contribution from the ellipsoidal fiber distribution (Section <a class="Reference" href="#subsec:EFD-Uncoupled">4.1.2.2↑</a>).
</div>
<div class="Indented">
<i>Example</i>:
</div>
<pre class="LyX-Code">
&lt;material id="1" type="EFD Veronda-Westmann"&gt;
  &lt;c1&gt;1&lt;/c1&gt;
  &lt;c2&gt;0.5&lt;/c2&gt;
  &lt;k&gt;1000&lt;/k&gt;
  &lt;beta&gt;4.5,4.5,4.5&lt;/beta&gt;
  &lt;ksi&gt;1,1,1&lt;/ksi&gt;
  &lt;mat_axis type="local"&gt;0,0,0&lt;/mat_axis&gt;
&lt;/material&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.1.2.5">4.1.2.5</a> Fiber with Exponential-Power Law, Uncoupled Formulation<a class="Label" name="subsec:fiber-exp-pow-uncoupled"> </a>
</h4>
<div class="Unindented">
The material type for a single fiber with an exponential-power law, in an uncoupled strain energy formulation, is &ldquo;<i>fiber-exp-pow-uncoupled</i>&rdquo;. Since fibers can only sustain tension, this material is not stable on its own. It must be combined with a stable uncoupled material that acts as a ground matrix, using a &ldquo;<i>uncoupled solid mixture</i>&rdquo; container as described in Section <a class="Reference" href="#subsec:Uncoupled-Solid-Mixture">4.1.2.15↓</a>. The following material parameters need to be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;ksi&gt;
</td>
<td align="left" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\xi,
</script>
</span> representing a measure of the fiber modulus
</td>
<td align="left" valign="top">
[<b>P</b>]
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;alpha&gt;
</td>
<td align="left" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\alpha,
</script>
</span> coefficient of exponential argument
</td>
<td align="left" valign="top">
[ ]
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;beta&gt;
</td>
<td align="left" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\beta,
</script>
</span> power of exponential argument
</td>
<td align="left" valign="top">
[ ]
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;theta&gt;
</td>
<td align="left" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\theta,
</script>
</span> spherical angle for fiber orientation in local coordinate system
</td>
<td align="left" valign="top">
[<b>deg</b>]
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;phi&gt;
</td>
<td align="left" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\varphi,
</script>
</span> spherical angle for fiber orientation in local coordinate system
</td>
<td align="left" valign="top">
[<b>deg</b>]
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
<div class="Frameless" style="width: 100%;">
<div class="PlainVisible">
<div class="center">
<img class="embedded" src="Figures/FigSphericalAngles.png" alt="figure Figures/FigSphericalAngles.png" style="max-width: 108px; max-height: 106px;"/>

</div>
<br/>
<div class="center">
<b>Spherical angles</b>
</div>

</div>

</div>

</div>
<div class="Indented">
The fiber is oriented along <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\mathbf{N}=\sin\varphi\cos\theta\,\mathbf{e}_{1}+\sin\varphi\sin\theta\,\mathbf{e}_{2}+\cos\varphi\,\mathbf{e}_{3}\,,

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
\left\{ \mathbf{e}_{1},\mathbf{e}_{2},\mathbf{e}_{3}\right\} 
</script>
</span> are orthonormal vectors representing the local element coordinate system (Section <a class="Reference" href="#subsec:Specifying-Fiber-Orientation">4.1.1↑</a>). The parameters &lt;theta&gt; and &lt;phi&gt; are optional, with default values of <span class="MathJax_Preview"><script type="math/tex">
\theta=
</script>
</span>0° and <span class="MathJax_Preview"><script type="math/tex">
\varphi=
</script>
</span>90°, such that <span class="MathJax_Preview"><script type="math/tex">
\mathbf{N}=\mathbf{e}_{1}
</script>
</span>. The stress <span class="MathJax_Preview"><script type="math/tex">
\tilde{\boldsymbol{\sigma}}
</script>
</span> for this fibrous material is given by <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\tilde{\boldsymbol{\sigma}}=H\left(\tilde{I}_{n}-1\right)\frac{2\tilde{I}_{n}}{J}\frac{\partial\tilde{\Psi}}{\partial\tilde{I}_{n}}\mathbf{n}\otimes\mathbf{n},

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
\tilde{I}_{n}=\tilde{\lambda}_{n}^{2}=\mathbf{N}\cdot\mathbf{\tilde{C}}\cdot\mathbf{N}
</script>
</span> is the square of the fiber stretch, <span class="MathJax_Preview"><script type="math/tex">
\mathbf{n}=\mathbf{\tilde{F}}\cdot\mathbf{N}/\tilde{\lambda}_{n}
</script>
</span>, and <span class="MathJax_Preview"><script type="math/tex">
H\left(.\right)
</script>
</span> is the unit step function that enforces the tension-only contribution.. The fiber strain energy density is given by <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\tilde{\Psi}=\frac{\xi}{\alpha\beta}\left(\exp\left[\alpha\left(\tilde{I}_{n}-1\right)^{\beta}\right]-1\right)\,,

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
\xi>0
</script>
</span>, <span class="MathJax_Preview"><script type="math/tex">
\alpha\geqslant0
</script>
</span>, and <span class="MathJax_Preview"><script type="math/tex">
\beta\geqslant2
</script>
</span>.
</div>
<div class="Indented">
Note: In the limit when <span class="MathJax_Preview"><script type="math/tex">
\alpha\to0
</script>
</span>, this expressions produces a power law, <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\lim\limits _{\alpha\to0}\tilde{\Psi}=\frac{\xi}{\beta}\left(\tilde{I}_{n}-1\right)^{\beta}.

</script>

</span>
Note: When <span class="MathJax_Preview"><script type="math/tex">
\beta>2
</script>
</span>, the fiber modulus is zero at the strain origin (<span class="MathJax_Preview"><script type="math/tex">
\tilde{I}_{n}=1)
</script>
</span>. Therefore, use <span class="MathJax_Preview"><script type="math/tex">
\beta>2
</script>
</span> when a smooth transition in the stress is desired from compression to tension.
</div>
<div class="Indented">
<i>Example</i>:
</div>
<div class="Indented">
Single fiber oriented along <span class="MathJax_Preview"><script type="math/tex">
\mathbf{e}_{1}
</script>
</span>, embedded in a neo-Hookean ground matrix.
</div>
<pre class="LyX-Code">
&lt;material id="1" type="uncoupled solid mixture"&gt;
  &lt;mat_axis type="local"&gt;0,0,0&lt;/mat_axis&gt;
  &lt;solid type="Mooney-Rivlin"&gt;
    &lt;c1&gt;10.0&lt;/c1&gt;
    &lt;c2&gt;0&lt;/c2&gt;
    &lt;k&gt;10e3&lt;/k&gt;
  &lt;/solid&gt;
  &lt;solid type="fiber-exp-pow-uncoupled"&gt;
    &lt;ksi&gt;5&lt;/ksi&gt;
    &lt;alpha&gt;20&lt;/alpha&gt;
    &lt;beta&gt;3&lt;/beta&gt;
    &lt;theta&gt;0&lt;/theta&gt;
    &lt;phi&gt;90&lt;/phi&gt;
    &lt;k&gt;5e3&lt;/k&gt;
  &lt;/solid&gt;
&lt;/material&gt;
</pre>
<div class="Unindented">
<i>Example</i>:
</div>
<div class="Indented">
Two fibers in the plane orthogonal to <span class="MathJax_Preview"><script type="math/tex">
\mathbf{e}_{1}
</script>
</span>, oriented at ±25 degrees relative to <span class="MathJax_Preview"><script type="math/tex">
\mathbf{e}_{3}
</script>
</span>, embedded in a Mooney-Rivlin ground matrix.
</div>
<pre class="LyX-Code">
&lt;material id="1" type="uncoupled solid mixture"&gt;
  &lt;mat_axis type="local"&gt;0,0,0&lt;/mat_axis&gt;
  &lt;solid type=”Mooney-Rivlin”&gt;
    &lt;c1&gt;10.0&lt;/c1&gt;
    &lt;c2&gt;0&lt;/c2&gt;
    &lt;k&gt;10e3&lt;/k&gt;
  &lt;/solid&gt;
  &lt;solid type="fiber-exp-pow"&gt;
    &lt;ksi&gt;5&lt;/ksi&gt;
    &lt;alpha&gt;20&lt;/alpha&gt;
    &lt;beta&gt;3&lt;/beta&gt;
    &lt;theta&gt;90&lt;/theta&gt;
    &lt;phi&gt;25&lt;/phi&gt;
    &lt;k&gt;5e3&lt;/k&gt;
  &lt;/solid&gt;
  &lt;solid type="fiber-exp-pow"&gt;
    &lt;ksi&gt;5&lt;/ksi&gt;
    &lt;alpha&gt;20&lt;/alpha&gt;
    &lt;beta&gt;3&lt;/beta&gt;
    &lt;theta&gt;-90&lt;/theta&gt;
    &lt;phi&gt;25&lt;/phi&gt;
    &lt;k&gt;5e3&lt;/k&gt;
  &lt;/solid&gt;
&lt;/material&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.1.2.6">4.1.2.6</a> Fiber with Toe-Linear Response, Uncoupled Formulation<a class="Label" name="subsec:fiber-pow-linear-uncoupled"> </a>
</h4>
<div class="Unindented">
This material type is &ldquo;<i>fiber-pow-linear-uncoupled</i>&rdquo;. The following material parameters need to be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;E&gt;
</td>
<td align="left" valign="top" style="width: 3in;">
<span class="MathJax_Preview"><script type="math/tex">
E,
</script>
</span> the fiber modulus in the linear range (<span class="MathJax_Preview"><script type="math/tex">
E\geqslant0)
</script>
</span>
</td>
<td align="left" valign="top">
[<b>P</b>]
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;beta&gt;
</td>
<td align="left" valign="top" style="width: 3in;">
<span class="MathJax_Preview"><script type="math/tex">
\beta,
</script>
</span> the power-law exponent in the toe region (<span class="MathJax_Preview"><script type="math/tex">
\beta\geqslant2)
</script>
</span>
</td>
<td align="left" valign="top">
[ ]
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;lam0&gt;
</td>
<td align="left" valign="top" style="width: 3in;">
<span class="MathJax_Preview"><script type="math/tex">
\lambda_{0},
</script>
</span> the stretch ratio when the toe region transitions to the linear region (<span class="MathJax_Preview"><script type="math/tex">
\lambda_{0}>1)
</script>
</span>
</td>
<td align="left" valign="top">
[ ]
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
The fiber strain energy density is given by <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\tilde{\Psi}_{n}\left(\tilde{I}_{n}\right)=\begin{cases}
0 & \tilde{I}_{n}<1\\
\frac{\xi}{2\beta}\left(\tilde{I}_{n}-1\right)^{\beta} & 1\leqslant\tilde{I}_{n}\leqslant I_{0}\\
E\left(I_{0}^{1/2}-\tilde{I}_{n}^{1/2}\right)+B\left(\tilde{I}_{n}-I_{0}\right)+\Psi_{0} & I_{0}<\tilde{I}_{n}
\end{cases}\,,

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
I_{0}=\lambda_{0}^{2}
</script>
</span>, <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\xi=\frac{E}{2\left(\beta-1\right)}\left(I_{0}-1\right)^{2-\beta},\,B=\frac{E}{2}\left[\frac{\left(I_{0}-1\right)}{2\left(\beta-1\right)}+I_{0}\right],\,\Psi_{0}=\frac{\xi}{2\beta}\left(I_{0}-1\right)^{\beta}

</script>

</span>
<i>Example</i>:
</div>
<pre class="LyX-Code">
&lt;material type="fiber-power-linear-uncoupled"&gt;
  &lt;fiber type="angles"&gt;
    &lt;theta&gt;20&lt;/center&gt;
    &lt;phi&gt;90&lt;/phi&gt;
  &lt;/fiber&gt;
  &lt;E&gt;1&lt;/E&gt;
  &lt;beta&gt;2.5&lt;/beta&gt;
  &lt;lam0&gt;1.06&lt;/lam0&gt;
&lt;/material&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.1.2.7">4.1.2.7</a> Fung Orthotropic<a class="Label" name="subsec:Fung-Orthotropic"> </a>
</h4>
<div class="Unindented">
The material type for orthotropic Fung elasticity <span class="bibcites">[<a class="bibliocite" name="cite-17" href="#biblio-17"><span class="bib-index">17</span></a>, <a class="bibliocite" name="cite-18" href="#biblio-18"><span class="bib-index">18</span></a>]</span> is &ldquo;<i>Fung orthotropic&rdquo;</i>. The following material parameters must be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;E1&gt;
</td>
<td align="left" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
E_{1}
</script>
</span> Young’s modulus
</td>
<td align="left" valign="top">
[<b>P</b>]
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;E2&gt;
</td>
<td align="left" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
E_{2}
</script>
</span> Young’s modulus
</td>
<td align="left" valign="top">
[<b>P</b>]
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;E3&gt;
</td>
<td align="left" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
E_{3}
</script>
</span> Young’s modulus
</td>
<td align="left" valign="top">
[<b>P</b>]
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;G12&gt;
</td>
<td align="left" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
G_{12}
</script>
</span> shear modulus
</td>
<td align="left" valign="top">
[<b>P]</b>
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;G23&gt;
</td>
<td align="left" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
G_{23}
</script>
</span> shear modulus
</td>
<td align="left" valign="top">
[<b>P</b>]
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;G13&gt;
</td>
<td align="left" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
G_{13}
</script>
</span> shear modulus
</td>
<td align="left" valign="top">
[<b>P</b>]
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;v12&gt;
</td>
<td align="left" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\nu_{12}
</script>
</span> Poisson’s ratio
</td>
<td align="left" valign="top">
[ ]
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;v23&gt;
</td>
<td align="left" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\nu_{23}
</script>
</span> Poisson’s ratio
</td>
<td align="left" valign="top">
[ ]
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;v31&gt;
</td>
<td align="left" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\nu_{31}
</script>
</span> Poisson’s ratio
</td>
<td align="left" valign="top">
[ ]
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;c&gt;
</td>
<td align="left" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
c
</script>
</span> coefficient
</td>
<td align="left" valign="top">
[<b>P</b>]
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;k&gt;
</td>
<td align="left" valign="top">
bulk modulus
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
The hyperelastic strain energy function is given by <span class="bibcites">[<a class="bibliocite" name="cite-3" href="#biblio-3"><span class="bib-index">3</span></a>]</span>, <span class="MathJax_Preview">
<script type="math/tex;mode=display">
\begin{equation}
\Psi=\frac{1}{2}c\left(e^{\tilde{Q}}-1\right)+U\left(J\right)\,,\label{eq6}
\end{equation}
</script>

</span>
where, <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\tilde{Q}=c^{-1}\sum\limits _{a=1}^{3}\left[2\mu_{a}\mathbf{M}_{a}:\mathbf{\tilde{E}}^{2}+\sum\limits _{b=1}^{3}\lambda_{ab}\left(\mathbf{M}_{a}:\mathbf{\tilde{E}}\right)\left(\mathbf{M}_{b}:\mathbf{\tilde{E}}\right)\right].

</script>

</span>
Here, <span class="MathJax_Preview"><script type="math/tex">
\mathbf{\tilde{E}}=\left(\mathbf{\tilde{C}}-\mathbf{I}\right)/2
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
\mathbf{M}_{a}=\mathbf{V}_{a}\otimes\mathbf{V}_{a}
</script>
</span> where <span class="MathJax_Preview"><script type="math/tex">
\mathbf{V}_{a}
</script>
</span> defines the initial direction of material axis <span class="MathJax_Preview"><script type="math/tex">
a
</script>
</span>. See Section <a class="Reference" href="#subsec:Orthotropic-Materials">4.1.1.2↑</a> on how to define the material axes for orthotropic materials. The Lamé constants <span class="MathJax_Preview"><script type="math/tex">
\mu_{a}
</script>
</span> (<span class="MathJax_Preview"><script type="math/tex">
a=1,2,3)
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
\lambda_{ab}
</script>
</span> (<span class="MathJax_Preview"><script type="math/tex">
a,b=1,2,3
</script>
</span>, <span class="MathJax_Preview"><script type="math/tex">
\lambda_{ba}=\lambda_{ab})
</script>
</span> are related to Young’s moduli <span class="MathJax_Preview"><script type="math/tex">
E_{a}
</script>
</span>, shear moduli <span class="MathJax_Preview"><script type="math/tex">
G_{ab}
</script>
</span> and Poisson’s ratios <span class="MathJax_Preview"><script type="math/tex">
\nu_{ab}
</script>
</span> via <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\begin{aligned} & \left[\begin{array}{cccccc}
\lambda_{11}+2\mu_{1} & \lambda_{12} & \lambda_{13} & 0 & 0 & 0\\
\lambda_{12} & \lambda_{22}+2\mu_{2} & \lambda_{23} & 0 & 0 & 0\\
\lambda_{13} & \lambda_{23} & \lambda_{33}+2\mu_{3} & 0 & 0 & 0\\
0 & 0 & 0 & \frac{1}{2}\left(\mu_{1}+\mu_{2}\right) & 0 & 0\\
0 & 0 & 0 & 0 & \frac{1}{2}\left(\mu_{2}+\mu_{3}\right) & 0\\
0 & 0 & 0 & 0 & 0 & \frac{1}{2}\left(\mu_{1}+\mu_{3}\right)
\end{array}\right]^{-1}\\
 & =\left[\begin{array}{cccccc}
\frac{1}{E_{1}} & -\frac{\nu_{12}}{E_{1}} & -\frac{\nu_{13}}{E_{1}} & 0 & 0 & 0\\
-\frac{\nu_{21}}{E_{2}} & \frac{1}{E_{2}} & -\frac{\nu_{23}}{E_{2}} & 0 & 0 & 0\\
-\frac{\nu_{31}}{E_{3}} & -\frac{\nu_{32}}{E_{3}} & \frac{1}{E_{3}} & 0 & 0 & 0\\
0 & 0 & 0 & \frac{1}{G_{12}} & 0 & 0\\
0 & 0 & 0 & 0 & \frac{1}{G_{23}} & 0\\
0 & 0 & 0 & 0 & 0 & \frac{1}{G_{13}}
\end{array}\right]
\end{aligned}
.

</script>

</span>
The orthotropic Lamé parameters should produce a positive definite stiffness matrix.
</div>
<div class="Indented">
<i>Example</i>:
</div>
<pre class="LyX-Code">
&lt;material id="3" type="Fung orthotropic"&gt;
  &lt;E1&gt;124&lt;/E1&gt;
  &lt;E2&gt;124&lt;/E2&gt;
  &lt;E3&gt;36&lt;/E3&gt;
  &lt;G12&gt;67&lt;/G12&gt;
  &lt;G23&gt;40&lt;/G23&gt;
  &lt;G13&gt;40&lt;/G13&gt;
  &lt;v12&gt;-0.075&lt;/v12&gt;
  &lt;v23&gt;0.87&lt;/v23&gt;
  &lt;v31&gt;0.26&lt;/v31&gt;
  &lt;c&gt;1&lt;/c&gt;
  &lt;k&gt;120000&lt;/k&gt;
&lt;/material&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.1.2.8">4.1.2.8</a> Mooney-Rivlin<a class="Label" name="subsec:Mooney-Rivlin"> </a>
</h4>
<div class="Unindented">
The material type for uncoupled Mooney-Rivlin materials is <i>Mooney-Rivlin</i>. The following material parameters must be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;c1&gt;
</td>
<td align="left" valign="top">
Coefficient of first invariant term
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;c2&gt;
</td>
<td align="left" valign="top">
Coefficient of second invariant term
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;k&gt;
</td>
<td align="left" valign="top">
Bulk modulus
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
This material model is a hyperelastic Mooney-Rivlin type with uncoupled deviatoric and volumetric behavior. The strain-energy function is given by: <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\Psi=C_{1}\left(\tilde{I}_{1}-3\right)+C_{2}\left(\tilde{I}_{2}-3\right)+\frac{1}{2}K\left(\ln J\right)^{2}\,.

</script>

</span>
<span class="MathJax_Preview"><script type="math/tex">
C_{1}
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
C_{2}
</script>
</span> are the Mooney-Rivlin material coefficients. The variables <span class="MathJax_Preview"><script type="math/tex">
\tilde{I}_{1}
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
\tilde{I}_{2}
</script>
</span> are the first and second invariants of the deviatoric right Cauchy-Green deformation tensor <span class="MathJax_Preview"><script type="math/tex">
\mathbf{\tilde{C}}
</script>
</span>. The coefficient <span class="MathJax_Preview"><script type="math/tex">
K
</script>
</span> is a bulk modulus-like penalty parameter and <span class="MathJax_Preview"><script type="math/tex">
J
</script>
</span> is the determinant of the deformation gradient tensor. When <span class="MathJax_Preview"><script type="math/tex">
C_{2}=0
</script>
</span>, this model reduces to an uncoupled version of the neo-Hookean constitutive model.
</div>
<div class="Indented">
This material model uses a three-field element formulation, interpolating displacements as linear field variables and pressure and volume ratio as piecewise constant on each element <span class="bibcites">[<a class="bibliocite" name="cite-32" href="#biblio-32"><span class="bib-index">32</span></a>]</span>.
</div>
<div class="Indented">
This material model is useful for modeling certain types of isotropic materials that exhibit some limited compressibility, i.e. 100 &lt; (<span class="MathJax_Preview"><script type="math/tex">
K
</script>
</span>/<span class="MathJax_Preview"><script type="math/tex">
C_{\mathrm{1}})
</script>
</span> &lt; 10000.
</div>
<div class="Indented">
<i>Example:</i>
</div>
<pre class="LyX-Code">
&lt;material id="2" type="Mooney-Rivlin"&gt;
  &lt;c1&gt;10.0&lt;/c1&gt;
  &lt;c2&gt;20.0&lt;/c2&gt;
  &lt;k&gt;1000&lt;/k&gt;
&lt;/material&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.1.2.9">4.1.2.9</a> Muscle Material<a class="Label" name="subsec:Muscle-Material"> </a>
</h4>
<div class="Unindented">
This material model implements the constitutive model developed by Silvia S. Blemker <span class="bibcites">[<a class="bibliocite" name="cite-11" href="#biblio-11"><span class="bib-index">11</span></a>]</span>. The material type for the muscle material is <i>muscle material</i>. The model is designed to simulate the passive and active material behavior of skeletal muscle. It defines the following parameters:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;g1&gt;
</td>
<td align="left" valign="top">
along fiber shear modulus
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;g2&gt;
</td>
<td align="left" valign="top">
cross fiber shear modulus
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;p1&gt;
</td>
<td align="left" valign="top">
exponential stress coefficients
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;p2&gt;
</td>
<td align="left" valign="top">
fiber uncrimping factor
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;Lofl&gt;
</td>
<td align="left" valign="top">
optimal fiber length
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;smax&gt;
</td>
<td align="left" valign="top">
maximum isometric stress
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;lambda&gt;
</td>
<td align="left" valign="top">
fiber stretch for straightened fibers
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;k&gt;
</td>
<td align="left" valign="top">
bulk modulus
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;active_contraction&gt;
</td>
<td align="left" valign="top">
activation level
</td>
<td align="left" valign="top">

</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
The main difference between this material formulation compared to other transversely hyperelastic materials is that it is formulated using a set of new invariants, originally due to Criscione <span class="bibcites">[<a class="bibliocite" name="cite-15" href="#biblio-15"><span class="bib-index">15</span></a>]</span>, instead of the usual five invariants proposed by A.J.M. Spencer <span class="bibcites">[<a class="bibliocite" name="cite-34" href="#biblio-34"><span class="bib-index">34</span></a>]</span>. For this particular material, only two of the five Criscione invariants are used. The strain energy function is defined as follows: <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\Psi\left(B_{1},B_{2},\lambda\right)=G_{1}\tilde{B}_{1}^{2}+G_{2}\tilde{B}_{2}^{2}+F_{m}\left(\tilde{\lambda}\right)+U\left(J\right).

</script>

</span>
The function <span class="MathJax_Preview"><script type="math/tex">
F_{m}
</script>
</span>is the strain energy contribution of the muscle fibers. It is defined as follows: <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\lambda\frac{\partial F_{m}}{\partial\lambda}=\sigma_{\max}\left(f_{m}^{\text{passive}}\left(\lambda\right)+\alpha f_{m}^{\text{active}}\left(\lambda\right)\right)\frac{\lambda}{\lambda_{ofl}},

</script>

</span>
where, <span class="MathJax_Preview">
<script type="math/tex;mode=display">

f_{m}^{\text{passive}}\left(\lambda\right)=\begin{cases}
0 & \lambda\leqslant\lambda_{ofl}\\
P_{1}\left(e^{P_{2}\left(\lambda/\lambda_{ofl}-1\right)}-1\right) & \lambda_{ofl}<\lambda<\lambda^{\ast}\\
P_{3}\lambda/\lambda_{ofl}+P_{4} & \lambda\geqslant\lambda^{\ast}
\end{cases}\,,

</script>

</span>
and <span class="MathJax_Preview">
<script type="math/tex;mode=display">

f_{m}^{\text{active}}\left(\lambda\right)=\begin{cases}
9\left(\lambda/\lambda_{ofl}-0.4\right)^{2} & \lambda\leqslant0.6\lambda_{ofl}\\
9\left(\lambda/\lambda_{ofl}-1.6\right)^{2} & \lambda\geqslant1.4\lambda_{ofl}\\
1-4\left(1-\lambda/\lambda_{ofl}\right)^{2} & 0.6\lambda_{ofl}<\lambda<1.4\lambda_{ofl}
\end{cases}\,.

</script>

</span>
The values <span class="MathJax_Preview"><script type="math/tex">
P_{3}
</script>
</span>and <span class="MathJax_Preview"><script type="math/tex">
P_{4}
</script>
</span> are determined by requiring <span class="MathJax_Preview"><script type="math/tex">
C^{0}
</script>
</span>and <span class="MathJax_Preview"><script type="math/tex">
C^{1}
</script>
</span>continuity at <span class="MathJax_Preview"><script type="math/tex">
\lambda=\lambda^{\ast}
</script>
</span>.
</div>
<div class="Indented">
The parameter <span class="MathJax_Preview"><script type="math/tex">
\alpha
</script>
</span> is the activation level and can be specified using the <i>active_contraction </i>element. You can specify a loadcurve using the <i>lc </i>attribute. The value is interpreted as a scale factor when a loadcurve is defined or as the constant activation level when no loadcurve is defined.
</div>
<div class="Indented">
The muscle fiber direction is specified similarly to the transversely isotropic Mooney-Rivlin model.
</div>
<div class="Indented">
<i>Example:</i>
</div>
<pre class="LyX-Code">
&lt;material id="1" type="muscle material"&gt;
  &lt;g1&gt;500&lt;/g1&gt;
  &lt;g2&gt;500&lt;/g2&gt;
  &lt;p1&gt;0.05&lt;/p1&gt;
  &lt;p2&gt;6.6&lt;/p2&gt;
  &lt;smax&gt;3e5&lt;/smax&gt;
  &lt;Lofl&gt;1.07&lt;/Lofl&gt;
  &lt;lambda&gt;1.4&lt;/lambda&gt;
  &lt;k&gt;1e6&lt;/k&gt;
  &lt;fiber type="vector"&gt;1,0,0&lt;/fiber&gt;
&lt;/material&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.1.2.10">4.1.2.10</a> Ogden<a class="Label" name="subsec:Ogden"> </a>
</h4>
<div class="Unindented">
This material describes an incompressible hyperelastic Ogden material <span class="bibcites">[<a class="bibliocite" name="cite-32" href="#biblio-32"><span class="bib-index">32</span></a>]</span>. The following material parameters must be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;c[n]&gt;
</td>
<td align="left" valign="top">
Coefficient of n<span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{th}}
</script>
</span> term, where n can range from 1 to 6
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;m[n]&gt;
</td>
<td align="left" valign="top">
Exponent of n<span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{th}}
</script>
</span> term, where n can range from 1 to 6 
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;k&gt;
</td>
<td align="left" valign="top">
Bulk modulus
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
The uncoupled hyperelastic strain energy function for this material is given in terms of the eigenvalues of the deformation tensor: <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\Psi=\sum\limits _{i=1}^{N}\frac{c_{i}}{m_{i}^{2}}\left(\tilde{\lambda}_{1}^{m_{i}}+\tilde{\lambda}_{2}^{m_{i}}+\tilde{\lambda}_{3}^{m_{i}}-3\right)+U\left(J\right).

</script>

</span>
Here, <span class="MathJax_Preview"><script type="math/tex">
\tilde{\lambda}_{i}^{2}
</script>
</span> are the eigenvalues of <span class="MathJax_Preview"><script type="math/tex">
\mathbf{\tilde{C}}
</script>
</span>, <span class="MathJax_Preview"><script type="math/tex">
c_{i}
</script>
</span>and <span class="MathJax_Preview"><script type="math/tex">
m_{i}
</script>
</span>are material coefficients and <span class="MathJax_Preview"><script type="math/tex">
N
</script>
</span> ranges from 1 to 6. Note that you only have to include the material parameters for the terms you intend to use.
</div>
<div class="Indented">
<i>Example</i>:
</div>
<pre class="LyX-Code">
&lt;material id="1" type="Ogden"&gt;
  &lt;m1&gt;2.4&lt;/m1&gt;
  &lt;c1&gt;1&lt;/c1&gt;
  &lt;k&gt;100&lt;/k&gt;
&lt;/material&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.1.2.11">4.1.2.11</a> Tendon Material<a class="Label" name="subsec:Tendon-Material"> </a>
</h4>
<div class="Unindented">
The material type for the tendon material is <i>tendon material</i>. The tendon material is similar to the muscle material. The only difference is the fiber function. For tendon material this is defined as: <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\lambda\frac{\partial F_{t}}{\partial\lambda}=\sigma\left(\lambda\right),

</script>

</span>
where <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\sigma\left(\lambda\right)=\begin{cases}
0 & \lambda\leqslant1\\
L_{1}\left(e^{L_{2}\left(\lambda-1\right)}-1\right) & 1<\lambda<\lambda^{\ast}\\
L_{3}\lambda+L_{4} & \lambda\geqslant\lambda^{\ast}
\end{cases}\,.

</script>

</span>
The parameters <span class="MathJax_Preview"><script type="math/tex">
L_{3}
</script>
</span>and <span class="MathJax_Preview"><script type="math/tex">
L_{4}
</script>
</span>are determined by requiring <span class="MathJax_Preview"><script type="math/tex">
C^{0}
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
C^{1}
</script>
</span> continuity at <span class="MathJax_Preview"><script type="math/tex">
\lambda^{\ast}
</script>
</span>.
</div>
<div class="Indented">
The material parameters for this material are listed below.
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;g1&gt;
</td>
<td align="left" valign="top">
along fiber shear modulus
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;g2&gt;
</td>
<td align="left" valign="top">
cross fiber shear modulus
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;l1&gt;
</td>
<td align="left" valign="top">
exponential stress coefficients
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;l2&gt;
</td>
<td align="left" valign="top">
fiber uncrimping factor
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;lambda&gt;
</td>
<td align="left" valign="top">
fiber stretch for straightened fibers
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;k&gt;
</td>
<td align="left" valign="top">
bulk modulus
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
The tendon fiber direction is specified similarly to the transversely isotropic Mooney-Rivlin model.
</div>
<div class="Indented">
<i>Example:</i>
</div>
<pre class="LyX-Code">
&lt;material id="1" type="tendon material"&gt;
  &lt;g1&gt;5e4&lt;/g1&gt;
  &lt;g2&gt;5e4&lt;/g2&gt;
  &lt;l1&gt;2.7e6/l1&gt;
  &lt;l2&gt;46.4&lt;/l2&gt;
  &lt;lambda&gt;1.03&lt;/lambda&gt;
  &lt;k&gt;1e7&lt;/k&gt;
  &lt;fiber type="vector"&gt;1,0,0&lt;/fiber&gt;
&lt;/material&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.1.2.12">4.1.2.12</a> Tension-Compression Nonlinear Orthotropic<a class="Label" name="subsec:Tension-Compression-Nonlinear-Ortho"> </a>
</h4>
<div class="Unindented">
The material type for the tension-compression nonlinear orthotropic material is &ldquo;<i>TC nonlinear orthotropic&rdquo;</i>. The following material parameters are defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;c1&gt;
</td>
<td align="left" valign="top">
First Mooney-Rivlin material parameter
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;c2&gt;
</td>
<td align="left" valign="top">
Second Mooney-Rivlin material parameter
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;k&gt;
</td>
<td align="left" valign="top">
bulk modulus
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;beta&gt;
</td>
<td align="left" valign="top">
the <span class="MathJax_Preview"><script type="math/tex">
\beta
</script>
</span> parameter (see below)
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;ksi&gt;
</td>
<td align="left" valign="top">
the <span class="MathJax_Preview"><script type="math/tex">
\xi
</script>
</span> parameter (see below)
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;mat_axis&gt;
</td>
<td align="left" valign="top">
defines the material axes
</td>
<td align="left" valign="top">

</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
This material is based on the following uncoupled hyperelastic strain energy function <span class="bibcites">[<a class="bibliocite" name="cite-9" href="#biblio-9"><span class="bib-index">9</span></a>]</span>: <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\Psi\left(\mathbf{C},\lambda_{1},\lambda_{2},\lambda_{3}\right)=\tilde{\Psi}_{iso}\left(\mathbf{\tilde{C}}\right)+\sum\limits _{i=1}^{3}\tilde{\Psi}_{i}^{TC}\left(\tilde{\lambda}_{i}\right)+U\left(J\right)\,.

</script>

</span>
The isotropic strain energy <span class="MathJax_Preview"><script type="math/tex">
\tilde{\Psi}_{iso}
</script>
</span>and the dilatational energy <span class="MathJax_Preview"><script type="math/tex">
U
</script>
</span> are the same as for the Mooney-Rivlin material. The tension-compression term is defined as follows: <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\tilde{\Psi}_{i}^{TC}\left(\tilde{\lambda}_{i}\right)=\begin{cases}
\xi_{i}\left(\tilde{\lambda}_{i}-1\right)^{\beta_{i}} & \tilde{\lambda}_{i}>1\\
0 & \tilde{\lambda}_{i}\leqslant1
\end{cases}\quad\xi_{i}\geqslant0\quad\left(\text{no sum over }i\right)\,.

</script>

</span>
The <span class="MathJax_Preview"><script type="math/tex">
\tilde{\lambda}_{i}
</script>
</span> parameters are the deviatoric fiber stretches of the local material fibers: <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\tilde{\lambda}_{i}=\left(\mathbf{a}_{i}^{0}\cdot\mathbf{\tilde{C}}\cdot\mathbf{a}_{i}^{0}\right)^{1/2}\,.

</script>

</span>
The local material fibers are defined (in the reference frame) as an orthonormal set of vectors <span class="MathJax_Preview"><script type="math/tex">
\mathbf{a}_{i}^{0}
</script>
</span>. See Section <a class="Reference" href="#subsec:Specifying-Fiber-Orientation">4.1.1↑</a> for more information. As with all uncoupled materials, this material uses the three-field element formulation.
</div>
<div class="Indented">
A complete example for this material follows.
</div>
<pre class="LyX-Code">
&lt;material id="7" name="cartilage" type="TC nonlinear orthotropic"&gt;
  &lt;c1&gt;1.0&lt;/c1&gt;
  &lt;c2&gt;0.0&lt;/c2&gt;
  &lt;k&gt;100&lt;/k&gt;
  &lt;beta&gt;4.3,4.3,4.3&lt;/beta&gt;
  &lt;ksi&gt;4525, 4525, 4525&lt;/ksi&gt;
  &lt;mat_axis type="local"&gt;0,0,0&lt;/mat_axis&gt;
&lt;/material&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.1.2.13">4.1.2.13</a> Transversely Isotropic Mooney-Rivlin<a class="Label" name="subsec:Transversely-Isotropic-Mooney-Rivlin"> </a>
</h4>
<div class="Unindented">
The material type for transversely isotropic Mooney-Rivlin materials is &ldquo;<i>trans iso Mooney-Rivlin&rdquo;</i>. The following material parameters must be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;c1&gt;
</td>
<td align="left" valign="top">
Mooney-Rivlin coefficient 1
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;c2&gt;
</td>
<td align="left" valign="top">
Mooney-Rivlin coefficient 2
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;c3&gt;
</td>
<td align="left" valign="top">
Exponential stress coefficient
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;c4&gt;
</td>
<td align="left" valign="top">
Fiber uncrimping coefficient
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;c5&gt;
</td>
<td align="left" valign="top">
Modulus of straightened fibers
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;k&gt;
</td>
<td align="left" valign="top">
Bulk modulus
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;lam_max&gt;
</td>
<td align="left" valign="top">
Fiber stretch for straightened fibers
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;fiber&gt;
</td>
<td align="left" valign="top">
Fiber distribution option
</td>
<td align="left" valign="top">

</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
This constitutive model can be used to represent a material that has a single preferred fiber direction and was developed for application to biological soft tissues <span class="bibcites">[<a class="bibliocite" name="cite-30" href="#biblio-30"><span class="bib-index">30</span></a>, <a class="bibliocite" name="cite-31" href="#biblio-31"><span class="bib-index">31</span></a>, <a class="bibliocite" name="cite-37" href="#biblio-37"><span class="bib-index">37</span></a>]</span>. It can be used to model tissues such as tendons, ligaments and muscle. The elastic response of the tissue is assumed to arise from the resistance of the fiber family and an isotropic matrix. It is assumed that the uncoupled strain energy function can be written as follows: <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\Psi=F_{1}\left(\tilde{I}_{1},\tilde{I}_{2}\right)+F_{2}\left(\tilde{\lambda}\right)+\frac{K}{2}\left[\ln\left(J\right)\right]^{2}.

</script>

</span>
Here <span class="MathJax_Preview"><script type="math/tex">
\tilde{I}_{1}
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
\tilde{I}_{2}
</script>
</span> are the first and second invariants of the deviatoric version of the right Cauchy Green deformation tensor <span class="MathJax_Preview"><script type="math/tex">
\mathbf{\tilde{C}}
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
\tilde{\lambda}
</script>
</span> is the deviatoric part of the stretch along the fiber direction (<span class="MathJax_Preview"><script type="math/tex">
\tilde{\lambda}^{2}=\mathbf{a}_{0}\cdot\mathbf{\tilde{C}}\cdot\mathbf{a}_{0}
</script>
</span>, where <span class="MathJax_Preview"><script type="math/tex">
\mathbf{a}_{0}
</script>
</span> is the initial fiber direction), and <span class="MathJax_Preview"><script type="math/tex">
J=\det\left(\mathbf{F}\right)
</script>
</span> is the Jacobian of the deformation (volume ratio). The function <span class="MathJax_Preview"><script type="math/tex">
F_{1}
</script>
</span> represents the material response of the isotropic ground substance matrix and is the same as the Mooney-Rivlin form specified above, while <span class="MathJax_Preview"><script type="math/tex">
F_{2}
</script>
</span> represents the contribution from the fiber family. The strain energy of the fiber family is as follows: <span class="MathJax_Preview">
<script type="math/tex;mode=display">

F_{2}\left(\tilde{\lambda}\right)=\begin{cases}
0 & \tilde{\lambda}\leqslant1\\
C_{3}\left(e^{-C_{4}}\left(\Ei\left(C_{4}\tilde{\lambda}\right)-\Ei\left(C_{4}\right)\right)-\ln\tilde{\lambda}\right) & 1<\tilde{\lambda}<\lambda_{m}\\
C_{5}\left(\tilde{\lambda}-1\right)+C_{6}\ln\tilde{\lambda} & \tilde{\lambda}\geqslant\lambda_{m}
\end{cases}\,

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
\Ei\left(\cdot\right)
</script>
</span> is the exponential integral function. The resulting fiber stress is evaluated from <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\tilde{\lambda}\frac{\partial F_{2}}{\partial\tilde{\lambda}}=\begin{cases}
0 & \tilde{\lambda}\leqslant1\\
C_{3}\left(e^{C_{4}\left(\tilde{\lambda}-1\right)}-1\right) & 1<\tilde{\lambda}<\lambda_{m}\\
C_{5}\tilde{\lambda}+C_{6} & \tilde{\lambda}\geqslant\lambda_{m}
\end{cases}\,.

</script>

</span>
Here, <span class="MathJax_Preview"><script type="math/tex">
C_{1}
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
C_{2}
</script>
</span> are the Mooney-Rivlin material coefficients,<i> lam_max</i> (<span class="MathJax_Preview"><script type="math/tex">
\lambda_{m})
</script>
</span> is the stretch at which the fibers are straightened, <span class="MathJax_Preview"><script type="math/tex">
C_{3}
</script>
</span>scales the exponential stresses, <span class="MathJax_Preview"><script type="math/tex">
C_{4}
</script>
</span> is the rate of uncrimping of the fibers, and <span class="MathJax_Preview"><script type="math/tex">
C_{5}
</script>
</span>is the modulus of the straightened fibers. <span class="MathJax_Preview"><script type="math/tex">
C_{6}
</script>
</span> is determined from the requirement that the stress is continuous at <span class="MathJax_Preview"><script type="math/tex">
\lambda_{m}
</script>
</span>.
</div>
<div class="Indented">
This material model uses a three-field element formulation, interpolating displacements as linear field variables and pressure and volume ratio as piecewise constant on each element <span class="bibcites">[<a class="bibliocite" name="cite-32" href="#biblio-32"><span class="bib-index">32</span></a>]</span>.
</div>
<div class="Indented">
The fiber orientation can be specified as explained in Section <a class="Reference" href="#subsec:Specifying-Fiber-Orientation">4.1.1↑</a>. Active stress along the fiber direction can be simulated using an active contraction model. To use this feature you need to define the <i>active_contraction </i>parameter. This parameter takes an optional attribute, <i>lc</i>, which defines the loadcurve. There are also several options:
</div>
<div class="Indented">
<div class="center">
<table>
<tr>
<td align="left" valign="top">
&lt;ca0&gt;
</td>
<td align="left" valign="top">
Intracellular calcium concentration 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;beta&gt;
</td>
<td align="left" valign="top">
tension-sarcomere length relation constant 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;l0&gt;
</td>
<td align="left" valign="top">
No tension sarcomere length 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;refl&gt;
</td>
<td align="left" valign="top">
Unloaded sarcomere length 
</td>

</tr>

</table>

</div>

</div>
<div class="Indented">
<i>Example:</i>
</div>
<div class="Indented">
This example defines a transversely isotropic material with a Mooney-Rivlin basis. It defines a homogeneous fiber direction and uses the active fiber contraction feature.
</div>
<pre class="LyX-Code">
&lt;material id="3" type="trans iso Mooney-Rivlin"&gt;
  &lt;c1&gt;13.85&lt;/c1&gt;
  &lt;c2&gt;0.0&lt;/c2&gt;
  &lt;c3&gt;2.07&lt;/c3&gt;
  &lt;c4&gt;61.44&lt;/c4&gt;
  &lt;c5&gt;640.7&lt;/c5&gt;
  &lt;k&gt;100.0&lt;/k&gt;
  &lt;lam_max&gt;1.03&lt;/lam_max&gt;
  &lt;fiber type="vector"&gt;1,0,0&lt;/fiber&gt;
  &lt;active_contraction lc="1"&gt;
    &lt;ca0&gt;4.35&lt;/ca0&gt;
    &lt;beta&gt;4.75&lt;/beta&gt;
    &lt;l0&gt;1.58&lt;/l0&gt;
    &lt;refl&gt;2.04&lt;/refl&gt;
  &lt;/active_contraction&gt;
&lt;/material&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.1.2.14">4.1.2.14</a> Transversely Isotropic Veronda-Westmann<a class="Label" name="subsec:Transversely-Isotropic-Veronda-Westmann"> </a>
</h4>
<div class="Unindented">
The material type for transversely isotropic Veronda-Westmann materials is &ldquo;<i>trans iso Veronda-Westmann&rdquo;</i>. The following material parameters must be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;c1&gt;
</td>
<td align="left" valign="top">
Veronda-Westmann coefficient 1
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;c2&gt;
</td>
<td align="left" valign="top">
Veronda-Westmann coefficient 2
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;c3&gt;
</td>
<td align="left" valign="top">
Exponential stress coefficient
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;c4&gt;
</td>
<td align="left" valign="top">
Fiber uncrimping coefficient
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;c5&gt;
</td>
<td align="left" valign="top">
Modulus of straightened fibers
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;k&gt;
</td>
<td align="left" valign="top">
Bulk modulus
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;lam_max&gt;
</td>
<td align="left" valign="top">
Fiber stretch for straightened fibers
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;fiber&gt;
</td>
<td align="left" valign="top">
Fiber distribution option.
</td>
<td align="left" valign="top">

</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
This uncoupled hyperelastic material differs from the Transversely Isotropic Mooney-Rivlin model in that it uses the Veronda-Westmann model for the isotropic matrix. The interpretation of the material parameters, except <span class="MathJax_Preview"><script type="math/tex">
C_{1}
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
C_{2}
</script>
</span>is identical to this material model.
</div>
<div class="Indented">
The fiber distribution option is explained in Section <a class="Reference" href="#subsec:Specifying-Fiber-Orientation">4.1.1↑</a>. An active contraction model can also be defined for this material. See the transversely isotropic Mooney-Rivlin model for more details (Section <a class="Reference" href="#subsec:Transversely-Isotropic-Mooney-Rivlin">4.1.2.13↑</a>).
</div>
<div class="Indented">
<i>Example:</i>
</div>
<div class="Indented">
This example defines a transversely isotropic material model with a Veronda-Westmann basis. The fiber direction is implicitly implied as <i>local</i>.
</div>
<pre class="LyX-Code">
&lt;material id="3" type="trans iso Veronda-Westmann"&gt;
  &lt;c1&gt;13.85&lt;/c1&gt;
  &lt;c2&gt;0.0&lt;/c2&gt;
  &lt;c3&gt;2.07&lt;/c3&gt;
  &lt;c4&gt;61.44&lt;/c4&gt;
  &lt;c5&gt;640.7&lt;/c5&gt;
  &lt;lam_max&gt;1.03&lt;/lam_max&gt;
&lt;/material&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.1.2.15">4.1.2.15</a> Uncoupled Solid Mixture<a class="Label" name="subsec:Uncoupled-Solid-Mixture"> </a>
</h4>
<div class="Unindented">
This material describes a mixture of quasi-incompressible elastic solids. It is a container for any combination of the materials described in Section <a class="Reference" href="#subsec:Uncoupled-Materials">4.1.2↑</a>.
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;solid&gt;
</td>
<td align="left" valign="top">
Container tag for compressible material
</td>
<td align="left" valign="top">

</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
The mixture may consist of any number of solids. The stress tensor for the solid mixture is the sum of the stresses for all the solids. The bulk modulus of the uncoupled solid mixture is the sum of the bulk moduli of the individual &lt;solid&gt; materials. A bulk modulus specified outside of the &lt;solid&gt; materials will be ignored.
</div>
<div class="Indented">
Material axes may be optionally specified within the &lt;material&gt; level, as well as within each &lt;solid&gt;. Within the &lt;material&gt; level, these represent the local element axes relative to the global coordinate system. Within the &lt;solid&gt;, they represent local material axes relative to the element. If material axes are specified at both levels, they are properly compounded to produce local material axes relative to the global coordinate system. Material axes specified in the &lt;ElementData&gt; section are equivalent to a specification at the &lt;material&gt; level: they correspond to local element axes relative to the global system.
</div>
<div class="Indented">
<i>Example</i>:
</div>
<pre class="LyX-Code">
&lt;material id="1" type="uncoupled solid mixture"&gt;
  &lt;mat_axis type="vector"&gt;
    &lt;a&gt;1,0,0&lt;/a&gt;
    &lt;d&gt;0,1,0&lt;/d&gt;
  &lt;/mat_axis&gt;
  &lt;solid type="Mooney-Rivlin"&gt;
    &lt;c1&gt;2.0&lt;/c1&gt;
    &lt;c2&gt;0.0&lt;/c2&gt;
    &lt;k&gt;2000&lt;/k&gt;
  &lt;/solid&gt;
  &lt;solid type="EFD uncoupled"&gt;
    &lt;mat_axis type="vector"&gt;
      &lt;a&gt;0.8660254,0.5,0&lt;/a&gt;
      &lt;d&gt;0,0,1&lt;/d&gt;
    &lt;/mat_axis&gt;
    &lt;ksi&gt;5, 1, 1&lt;/ksi&gt;
    &lt;beta&gt;2.5, 3, 3&lt;/beta&gt;
    &lt;k&gt;15e3&lt;/k&gt;
  &lt;/solid&gt;
  &lt;solid type="EFD uncoupled"&gt;
    &lt;mat_axis type="vector"&gt;
      &lt;a&gt;0.8660254,-0.5,0&lt;/a&gt;
      &lt;d&gt;0,0,1&lt;/d&gt;
    &lt;/mat_axis&gt;
    &lt;ksi&gt;5, 1, 1&lt;/ksi&gt;
    &lt;beta&gt;2.5, 3, 3&lt;/beta&gt;
    &lt;k&gt;15e3&lt;/k&gt;
  &lt;/solid&gt;
&lt;/material&gt;
</pre>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.1.2.16">4.1.2.16</a> Veronda-Westmann<a class="Label" name="subsec:Veronda-Westmann"> </a>
</h4>
<div class="Unindented">
The material type for incompressible Veronda-Westmann materials is <i>Veronda-Westmann</i> <span class="bibcites">[<a class="bibliocite" name="cite-35" href="#biblio-35"><span class="bib-index">35</span></a>]</span>. The following material parameters must be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;c1&gt;
</td>
<td align="left" valign="top">
First VW coefficient
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;c2&gt;
</td>
<td align="left" valign="top">
Second VW coefficient
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;k&gt;
</td>
<td align="left" valign="top">
Bulk modulus
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
This model is similar to the Mooney-Rivlin model in that it also uses an uncoupled deviatoric dilatational strain energy: <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\Psi=C_{1}\left[e^{\left(C_{2}\left(\tilde{I}_{1}-3\right)\right)}-1\right]-\frac{C_{1}C_{2}}{2}\left(\tilde{I}_{2}-3\right)+U\left(J\right)\,.

</script>

</span>
The dilatational term is identical to the one used in the Mooney-Rivlin model. This model can be used to describe certain types of biological materials that display exponential stiffening with increasing strain. It has been used to describe the response of skin tissue <span class="bibcites">[<a class="bibliocite" name="cite-35" href="#biblio-35"><span class="bib-index">35</span></a>]</span>.
</div>
<div class="Indented">
<i>Example:</i>
</div>
<pre class="LyX-Code">
&lt;material id="2" type="Veronda-Westmann"&gt;
  &lt;c1&gt;1000.0&lt;/c1&gt;
  &lt;c2&gt;2000.0&lt;/c2&gt;
  &lt;k&gt;1000&lt;/k&gt;
&lt;/material&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.1.2.17">4.1.2.17</a> Mooney-Rivlin Von Mises Distributed Fibers<a class="Label" name="subsec:Mooney-Rivlin-Von-Mises"> </a>
</h4>
<div class="Unindented">
<b>(Sclera and other thin soft tissues)</b>
</div>
<div class="Indented">
Authors: Cécile L.M. Gouget and Michaël J.A. Girard
</div>
<div class="Indented">
The material type for a thin material where fiber orientation follows a von Mises distribution is &ldquo;Mooney-Rivlin von Mises Fibers&rdquo;. The following parameters must be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;c1&gt;
</td>
<td align="left" valign="top" style="width: 3in;">
Mooney-Rivlin coefficient 1
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;c2&gt;
</td>
<td align="left" valign="top" style="width: 3in;">
Mooney-Rivlin coefficient 2
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;c3&gt;
</td>
<td align="left" valign="top" style="width: 3in;">
Exponential stress coefficient
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;c4&gt;
</td>
<td align="left" valign="top" style="width: 3in;">
Fiber uncrimping coefficient
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;c5&gt;
</td>
<td align="left" valign="top" style="width: 3in;">
Modulus of straightened fibers
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;k&gt;
</td>
<td align="left" valign="top" style="width: 3in;">
Bulk modulus
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;lam_max&gt;
</td>
<td align="left" valign="top" style="width: 3in;">
Fiber stretch for straightened fibers
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;tp&gt;
</td>
<td align="left" valign="top" style="width: 3in;">
Preferred fiber orientation in radian (angle within the plane of the fibers, defined with respect to the first direction given in mat_axis)
</td>
<td align="left" valign="top">
[rad] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;kf&gt;
</td>
<td align="left" valign="top" style="width: 3in;">
Fiber concentration factor 
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;vmc&gt;
</td>
<td align="left" valign="top" style="width: 3in;">
Choice of von Mises distribution
</td>
<td align="left" valign="top">

</td>

</tr>
<tr>
<td align="left" valign="top">

</td>
<td align="left" valign="top" style="width: 3in;">
=1 semi-circular von Mises distribution
</td>
<td align="left" valign="top">

</td>

</tr>
<tr>
<td align="left" valign="top">

</td>
<td align="left" valign="top" style="width: 3in;">
=2 constrained von Mises mixture distribution
</td>
<td align="left" valign="top">

</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;var_n&gt;
</td>
<td align="left" valign="top" style="width: 3in;">
Exponent (only for vmc=2)
</td>
<td align="left" valign="top">

</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;gipt&gt;
</td>
<td align="left" valign="top" style="width: 3in;">
Number of integration points (value is a multiple of 10)
</td>
<td align="left" valign="top">

</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;mat_axis&gt;
</td>
<td align="left" valign="top" style="width: 3in;">
Reference frame of the plane of the fibers
</td>
<td align="left" valign="top">

</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
This constitutive model is designed for thin soft tissues. Fibers are multi-directional: they are distributed within the plane tangent to the tissue surface and they follow a unimodal distribution. It is a constitutive model that is suitable for ocular tissues (e.g. sclera and cornea) but can be used for other thin soft tissues. The proposed strain energy function is as follows: <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\Psi=F_{1}\left(\tilde{I}_{1},\tilde{I}_{2}\right)+\int\limits _{\theta_{P}-\pi/2}^{\theta_{P}+\pi/2}P\left(\theta\right)F_{2}\left(\tilde{\lambda}\left[\theta\right]\right)d\theta+\frac{K}{2}\left[\ln\left(J\right)\right]^{2},

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
P
</script>
</span> is the 2D unimodal distribution function of the fibers which satisfies the normalization condition: <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\int\limits _{\theta_{P}-\pi/2}^{\theta_{P}+\pi/2}P\left(\theta\right)d\theta=1.

</script>

</span>
<span class="MathJax_Preview"><script type="math/tex">
\theta_{P}
</script>
</span> is the preferred fiber orientation relative to a local coordinate system (parameter tp). The functions <span class="MathJax_Preview"><script type="math/tex">
F_{1}
</script>
</span>and <span class="MathJax_Preview"><script type="math/tex">
F_{2}
</script>
</span> are described in the &ldquo;Transversely Isotropic Mooney-Rivlin&rdquo; model. The user can choose between 2 distribution functions using the parameter vmc.
</div>
<div class="Indented">
<b>1. Semi-circular von Mises distribution (vmc </b>=<b> 1) <span class="bibcites">[<a class="bibliocite" name="cite-20" href="#biblio-20"><span class="bib-index">20</span></a>]</span></b>
</div>
<div class="Indented">
The semi-circular von Mises distribution is one of the simplest unimodal distribution in circular statistics. It can be expressed as <span class="MathJax_Preview">
<script type="math/tex;mode=display">

P\left(\theta\right)=\frac{1}{\pi I_{0}\left(k_{f}\right)}\exp\left[k_{f}\cos\left(2\left(\theta-\theta_{p}\right)\right)\right],

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
I_{0}
</script>
</span> is the modified Bessel function of the first kind (order 0), and <span class="MathJax_Preview"><script type="math/tex">
k_{f}
</script>
</span> is the fiber concentration factor. <span class="MathJax_Preview"><script type="math/tex">
k_{f}
</script>
</span> controls the amount of fibers that are concentrated along the orientation <span class="MathJax_Preview"><script type="math/tex">
\theta_{P}
</script>
</span> as illustrated in the figure below.
</div>
<div class="Indented">
<div class="defskip"> </div><div class="Frameless" style="width: 100%;">
<div class="center">
<img class="embedded" src="Figures/FigMooneyRivlinVonMises.png" alt="figure Figures/FigMooneyRivlinVonMises.png" style="max-width: 360px; max-height: 180px;"/>

</div>
<div class="PlainVisible">
Polar representation of the semi-circular<b> </b>von-Mises distribution describing in-plane collagen fiber alignment. In this case, the preferred fiber orientation <span class="MathJax_Preview"><script type="math/tex">
\theta_{P}
</script>
</span> is equal to zero degrees. When the fiber concentration factor <span class="MathJax_Preview"><script type="math/tex">
k
</script>
</span> is equal to zero, the collagen fibers have an isotropic distribution in a plane tangent to the scleral wall. As <span class="MathJax_Preview"><script type="math/tex">
k
</script>
</span> increases, the collagen fibers align along the preferred fiber orientation <span class="MathJax_Preview"><script type="math/tex">
\theta_{P}
</script>
</span>. Note that the distributions were plotted on a circle of unit one to ease visualization.
</div>

</div>
<div class="defskip"> </div>
</div>
<div class="Indented">
<b>2. Constrained von Mises Mixture Distribution (vmc </b>=<b> 2) <span class="bibcites">[<a class="bibliocite" name="cite-21" href="#biblio-21"><span class="bib-index">21</span></a>]</span></b>
</div>
<div class="Indented">
The semi-circular von Mises distribution is ideal for its simplicity but in some instance it fails to accurately describe the isotropic subpopulation of fibers present in thin soft tissues. An improved mathematical description is proposed here as a weighted mixture of the semi-circular uniform distribution and the semi-circular von Mises distribution. It can be expressed as: <span class="MathJax_Preview">
<script type="math/tex;mode=display">

P\left(\theta\right)=\frac{1-\beta}{\pi}+\frac{\beta}{\pi I_{0}\left(k_{f}\right)}\exp\left[k_{f}\cos\left(2\left(\theta-\theta_{p}\right)\right)\right],

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
\beta
</script>
</span> needs to be constrained for uniqueness and stability. <span class="MathJax_Preview"><script type="math/tex">
\beta
</script>
</span> is expressed as: <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\beta=\left(\frac{I_{1}\left(k_{f}\right)}{I_{0}\left(k_{f}\right)}\right)^{n},

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
I_{1}
</script>
</span> is the modified Bessel function of the first kind (order 1), and n is an exponent to be determined experimentally (parameter var_n). n=2 has been found to be suitable for the sclera based on fiber distribution measurements using small angle light scattering.
</div>
<div class="Indented">
<b>Note about Numerical Integration</b>
</div>
<div class="Indented">
All numerical integrations are performed using a 10-point Gaussian quadrature rule. The number of Gaussian integration points can be increased for numerical stability. This is controlled through the parameter <i>gipt</i>. We recommend to use at least <i>gipt</i> = 20 (2<span class="MathJax_Preview"><script type="math/tex">
\times
</script>
</span>10 integration points). Note that the more integration points are used, the slower the model will run. By increasing the number of integration points, one should observe convergence in the numerical accuracy. The parameter gipt is required to be a multiple of 10.
</div>
<div class="Indented">
<b>Definition of the Fiber Plane</b>
</div>
<div class="Indented">
The user must specify two directions to define a local coordinate system of the plane in which the fibers lay. As explained in Section <a class="Reference" href="#subsec:Orthotropic-Materials">4.1.1.2↑</a>, this can be done by defining two directions with the parameter <i>mat_axis</i>. The first direction (vector <b><span class="MathJax_Preview"><script type="math/tex">
\mathbf{a}
</script>
</span></b> of <i>mat_axis</i>) must be the reference direction used to define the angle <i>tp</i> (<span class="MathJax_Preview"><script type="math/tex">
\theta_{P}
</script>
</span>). The second direction (vector <b><span class="MathJax_Preview"><script type="math/tex">
\mathbf{d}
</script>
</span></b> of mat_axis) can be any other direction in the plane of the fibers. Thus, a fiber at angle <span class="MathJax_Preview"><script type="math/tex">
\theta_{P}
</script>
</span> will be along the vector <span class="MathJax_Preview"><script type="math/tex">
\mathbf{v}=\cos\theta_{P}\mathbf{e}_{1}+\sin\theta_{P}\mathbf{e}_{2}
</script>
</span> where <span class="MathJax_Preview"><script type="math/tex">
\mathbf{e}_{1}=\mathbf{a}/\left\Vert \mathbf{a}\right\Vert 
</script>
</span>, <span class="MathJax_Preview"><script type="math/tex">
\mathbf{e}_{2}=\left(\mathbf{e}_{3}\times\mathbf{a}\right)/\left\Vert \mathbf{e}_{3}\times\mathbf{a}\right\Vert 
</script>
</span>, <span class="MathJax_Preview"><script type="math/tex">
\mathbf{e}_{3}=\left(\mathbf{a}\times\mathbf{d}\right)/\left\Vert \mathbf{a}\times\mathbf{d}\right\Vert 
</script>
</span>, as was defined in Section <a class="Reference" href="#subsec:Orthotropic-Materials">4.1.1.2↑</a>.
</div>
<div class="Indented">
<b>Note on parameters kf and tp</b>
</div>
<div class="Indented">
The parameters kf and tp can be specified either in the Material section or in the <i>ElementData</i> section with the tag MRVonMisesParameters. With this second option the user can define different fiber characteristics for each element separately, which can be useful if fiber orientations or concentrations vary spatially. The parameter mat_axis can also be defined either in the Material section or in the <i>ElementData</i> section.
</div>
<div class="Indented">
<b>Example</b>
</div>
<div class="Indented">
This example defines a thin soft tissue material where fibers are distributed according to a constrained von Mises mixture distribution.
</div>
<pre class="LyX-Code">
&lt;material id="1" name="Material 1" type="Mooney-Rivlin von Mises Fibers"&gt;
  &lt;c1&gt;10.0&lt;/c1&gt;
  &lt;c2&gt;0.0&lt;/c2&gt;
  &lt;c3&gt;50.0&lt;/c3&gt;
  &lt;c4&gt;5.0&lt;/c4&gt;
  &lt;c5&gt;1&lt;/c5&gt;
  &lt;lam_max&gt;10&lt;/lam_max&gt;
  &lt;k&gt;1000000.0&lt;/k&gt;
  &lt;kf&gt;1&lt;/kf&gt;
  &lt;vmc&gt;2&lt;/vmc&gt;
  &lt;var_n&gt;2.0&lt;/var_n&gt;
  &lt;tp&gt;0.0&lt;/tp&gt;
  &lt;gipt&gt;40&lt;/gipt&gt;
  &lt;mat_axis type="local"&gt;4,1,3&lt;/mat_axis&gt;
&lt;/material&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-4.1.3">4.1.3</a> Compressible Materials<a class="Label" name="subsec:Compressible-Materials"> </a>
</h3>
<div class="Unindented">
Unlike the materials in Section <a class="Reference" href="#subsec:Uncoupled-Materials">4.1.2↑</a>, these materials do not necessarily assume an additive decomposition of the bulk and deviatoric parts of the strain energy or stress. Further, these materials can only be used with the standard displacement-based finite element formulation, rather than the three-field element formulatoin. They should not be used for nearly-incompressible material behavior due to the potential for element locking.
</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.1.3.1">4.1.3.1</a> Carter-Hayes<a class="Label" name="subsec:Carter-Hayes"> </a>
</h4>
<div class="Unindented">
The material type for a Carter-Hayes material is <i>Carter-Hayes</i>. The following parameters must be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;E0&gt;
</td>
<td align="left" valign="top" style="width: 3in;">
Young’s modulus at reference density <span class="MathJax_Preview"><script type="math/tex">
E_{0}
</script>
</span> 
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;rho0&gt;
</td>
<td align="left" valign="top" style="width: 3in;">
reference density <span class="MathJax_Preview"><script type="math/tex">
\rho_{0}
</script>
</span> 
</td>
<td align="left" valign="top">
[<b>M</b>/<b>L</b><span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{3}}
</script>
</span>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;gamma&gt;
</td>
<td align="left" valign="top" style="width: 3in;">
exponent of solid-bound molecule density for calculation of Young’s modulus <span class="MathJax_Preview"><script type="math/tex">
\gamma
</script>
</span> 
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;v&gt;
</td>
<td align="left" valign="top" style="width: 3in;">
Poisson’s ratio <span class="MathJax_Preview"><script type="math/tex">
\nu
</script>
</span> 
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;sbm&gt;
</td>
<td align="left" valign="top" style="width: 3in;">
index of solid bound molecule
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
This model describes a compressible neo-Hookean material <span class="bibcites">[<a class="bibliocite" name="cite-12" href="#biblio-12"><span class="bib-index">12</span></a>]</span> whose Young’s modulus is a power-law function of the referential apparent density <span class="MathJax_Preview"><script type="math/tex">
\rho_{r}^{\sigma}
</script>
</span> of a solid-bound molecule. It is derived from the following hyperelastic strain-energy function: <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\Psi_{r}=\frac{E_{Y}}{2\left(1+\nu\right)}\left[\frac{1}{2}\left(\tr\mathbf{C}-3\right)-\ln J+\frac{\nu}{1-2\nu}\left(\ln J\right)^{2}\right].

</script>

</span>
Here, <span class="MathJax_Preview"><script type="math/tex">
\mathbf{C}
</script>
</span> is the right Cauchy-Green deformation tensor and <span class="MathJax_Preview"><script type="math/tex">
J
</script>
</span> is the determinant of the deformation gradient tensor.
</div>
<div class="Indented">
Young’s modulus depends on <span class="MathJax_Preview"><script type="math/tex">
\rho_{r}^{\sigma}
</script>
</span> according to a power law <span class="bibcites">[<a class="bibliocite" name="cite-13" href="#biblio-13"><span class="bib-index">13</span></a>, <a class="bibliocite" name="cite-14" href="#biblio-14"><span class="bib-index">14</span></a>]</span>, <span class="MathJax_Preview">
<script type="math/tex;mode=display">

E_{Y}=E_{0}\left(\frac{\rho_{r}^{\sigma}}{\rho_{0}}\right)^{\gamma}\,.

</script>

</span>
This type of material references a solid-bound molecule that belongs to a multiphasic mixture. Therefore this material may only be used as the solid (or a component of the solid) in a multiphasic mixture (Section <a class="Reference" href="#sec:Triphasic-Multiphasic-Materials">4.9↓</a>). The solid-bound molecule must be defined in the &lt;Globals&gt; section (Section <a class="Reference" href="#subsec:Solid-Bound-Molecules">3.6.3↑</a>) and must be included in the multiphasic mixture using a &lt;solid_bound&gt; tag. The parameter <i>sbm</i> must refer to the global index of that solid-bound molecule. The value of <span class="MathJax_Preview"><script type="math/tex">
\rho_{r}^{\sigma}
</script>
</span> is specified within the &lt;solid_bound&gt; tag. If a chemical reaction is defined within that multiphasic mixture that alters the value of <span class="MathJax_Preview"><script type="math/tex">
\rho_{r}^{\sigma}
</script>
</span>, lower and upper bounds may be specified for this referential density within the &lt;solid_bound&gt; tag to prevent <span class="MathJax_Preview"><script type="math/tex">
E_{Y}
</script>
</span> from reducing to zero or achieving excessively elevated values.
</div>
<div class="Indented">
<i>Example:</i>
</div>
<pre class="LyX-Code">
&lt;material id="1" name="solid matrix" type="multiphasic"&gt;
  &lt;phi0&gt;0&lt;/phi0&gt;
  &lt;solid_bound sbm="1"&gt;
    &lt;rho0&gt;1&lt;/rho0&gt;
    &lt;rhomin&gt;0.1&lt;/rhomin&gt;
    &lt;rhomax&gt;5&lt;/rhomax&gt;
  &lt;/solid_bound&gt;
  &lt;fixed_charge_density&gt;0&lt;/fixed_charge_density&gt;
  &lt;solid type="Carter-Hayes"&gt;
    &lt;sbm&gt;1&lt;/sbm&gt;
    &lt;E0&gt;10000&lt;/E0&gt;
    &lt;rho0&gt;1&lt;/rho0&gt;
    &lt;gamma&gt;2.0&lt;/gamma&gt;
    &lt;v&gt;0&lt;/v&gt;
  &lt;/solid&gt;
  &lt;permeability type="perm-const-iso"&gt;
    &lt;perm&gt;1&lt;/perm&gt;
  &lt;/permeability&gt;
  &lt;osmotic_coefficient type="osm-coef-const"&gt;
    &lt;osmcoef&gt;1&lt;/osmcoef&gt;
  &lt;/osmotic_coefficient&gt;
  &lt;reaction name="solid remodeling" type="mass-action-forward"&gt;
    &lt;Vbar&gt;0&lt;/Vbar&gt;
    &lt;vP sbm="1"&gt;1&lt;/vP&gt;
    &lt;forward_rate type="Huiskes reaction rate"&gt;
      &lt;B&gt;1&lt;/B&gt;
      &lt;psi0&gt;0.01&lt;/psi0&gt;
    &lt;/forward_rate&gt;
  &lt;/reaction&gt;
&lt;/material&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.1.3.2">4.1.3.2</a> Cell Growth<a class="Label" name="subsec:Cell-Growth"> </a>
</h4>
<div class="Unindented">
The material type for cell growth is &ldquo;<i>cell growth</i>&rdquo;. The following material parameters need to be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;phir&gt;
</td>
<td align="left" valign="top" style="width: 3in;">
intracellular solid volume fraction in reference (strain-free) configuration, <span class="MathJax_Preview"><script type="math/tex">
\varphi_{r}^{s}
</script>
</span>
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;cr&gt;
</td>
<td align="left" valign="top" style="width: 3in;">
intracellular molar content of membrane-impermeant solute (moles per volume of the cell in the reference configuration), <span class="MathJax_Preview"><script type="math/tex">
c_{r}
</script>
</span> 
</td>
<td align="left" valign="top">
[<b>n</b>/<b>L</b><span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{3}}
</script>
</span>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;ce&gt;
</td>
<td align="left" valign="top" style="width: 3in;">
extracellular osmolarity, <span class="MathJax_Preview"><script type="math/tex">
c_{e}
</script>
</span>
</td>
<td align="left" valign="top">
[<b>n</b>/<b>L</b><span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{3}}
</script>
</span>] 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
The Cauchy stress for this material is <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\boldsymbol{\sigma}=-\pi\mathbf{I},

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
\pi
</script>
</span> is the osmotic pressure, given by <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\pi=RT\left(\frac{c_{r}}{J-\varphi_{r}^{s}}-c_{e}\right),

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
J=\det\mathbf{F}
</script>
</span> is the relative volume. The values of the universal gas constant <span class="MathJax_Preview"><script type="math/tex">
R
</script>
</span> and absolute temperature <span class="MathJax_Preview"><script type="math/tex">
T
</script>
</span> must be specified as global constants.
</div>
<div class="Indented">
Cell growth may be modeled by simply increasing the mass of the intracellular solid matrix and membrane-impermeant solute. This is achieved by allowing the parameters <span class="MathJax_Preview"><script type="math/tex">
\varphi_{r}^{s}
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
c_{r}
</script>
</span> to increase over time as a result of growth, by associating them with user-defined load curves. Since cell growth is often accompanied by cell division, and since daughter cells typically achieve the same solid and solute content as their parent, it may be convenient to assume that <span class="MathJax_Preview"><script type="math/tex">
\varphi_{r}^{s}
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
c_{r}
</script>
</span> increase proportionally, though this is not an obligatory relationship. To ensure that the initial configuration is a stress-free reference configuration, let <span class="MathJax_Preview"><script type="math/tex">
c_{r}=\left(1-\varphi_{r}^{s}\right)c_{e}
</script>
</span> in the initial state prior to growth.
</div>
<div class="Indented">
<i>Example (using units of mm, N, s, nmol, K)</i>:
</div>
<pre class="LyX-Code">
&lt;Globals&gt;
  &lt;Constants&gt;
    &lt;T&gt;298&lt;/T&gt;
    &lt;R&gt;8.314e-06&lt;/R&gt;
    &lt;Fc&gt;0&lt;/Fc&gt;
  &lt;/Constants&gt;
&lt;/Globals&gt;
&lt;Material&gt;
  &lt;material id="1" name="Cell" type="cell growth"&gt;
    &lt;phir lc="1"&gt;1&lt;/phir&gt;
    &lt;cr lc="2"&gt;1&lt;/cr&gt;
    &lt;ce&gt;300&lt;/ce&gt;
  &lt;/material&gt;
&lt;/Material&gt;
&lt;LoadData&gt;
  &lt;loadcurve id="1" type="smooth"&gt;
    &lt;loadpoint&gt;0,0.3&lt;/loadpoint&gt;
    &lt;loadpoint&gt;1,0.6&lt;/loadpoint&gt;
  &lt;/loadcurve&gt;
  &lt;loadcurve id="2" type="smooth"&gt;
    &lt;loadpoint&gt;0,210&lt;/loadpoint&gt;
    &lt;loadpoint&gt;1,420&lt;/loadpoint&gt;
  &lt;/loadcurve&gt;
&lt;/LoadData&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.1.3.3">4.1.3.3</a> Cubic CLE<a class="Label" name="subsec:Cubic-CLE"> </a>
</h4>
<div class="Unindented">
The material type for a conewise linear elastic (CLE) material with cubic symmetry is <i>cubic CLE</i>. The following parameters must be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;lp1&gt;
</td>
<td align="left" valign="top">
Tensile diagonal first Lamé coefficient <span class="MathJax_Preview"><script type="math/tex">
\lambda_{+1}
</script>
</span>
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;lm1&gt;
</td>
<td align="left" valign="top">
Compressive diagonal first Lamé coefficient <span class="MathJax_Preview"><script type="math/tex">
\lambda_{-1}
</script>
</span>
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;l2&gt;
</td>
<td align="left" valign="top">
Off-diagonal first Lamé coefficient <span class="MathJax_Preview"><script type="math/tex">
\lambda_{2}
</script>
</span>
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;mu&gt;
</td>
<td align="left" valign="top">
Second Lamé coefficient <span class="MathJax_Preview"><script type="math/tex">
\mu
</script>
</span>
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
This bimodular elastic material is specialized from the orthotropic conewise linear elastic material described by Curnier et al. <span class="bibcites">[<a class="bibliocite" name="cite-16" href="#biblio-16"><span class="bib-index">16</span></a>]</span>, to the case of cubic symmetry. It is derived from the following hyperelastic strain-energy function: <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\Psi_{r}=\mu\mathbf{I}:\mathbf{E}^{2}+\sum\limits _{a=1}^{3}\frac{1}{2}\lambda_{1}\left[\mathbf{A}_{a}^{r}:\mathbf{E}\right]\left(\mathbf{A}_{a}^{r}:\mathbf{E}\right)^{2}+\frac{1}{2}\lambda_{2}\sum\limits _{\begin{array}{c}
b=1\\
b\ne a
\end{array}}^{3}\left(\mathbf{A}_{a}^{r}:\mathbf{E}\right)\left(\mathbf{A}_{b}^{r}:\mathbf{E}\right)\,,

</script>

</span>
where <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\lambda_{1}\left[\mathbf{A}_{a}^{r}:\mathbf{E}\right]=\begin{cases}
\lambda_{+1} & \mathbf{A}_{a}^{r}:\mathbf{E}\geqslant0\\
\lambda_{-1} & \mathbf{A}_{a}^{r}:\mathbf{\,}.E<0
\end{cases}

</script>

</span>
Here, <span class="MathJax_Preview"><script type="math/tex">
{\mathbf{E}\ensuremath{}}
</script>
</span> is the Lagrangian strain tensor and <span class="MathJax_Preview"><script type="math/tex">
\mathbf{A}_{a}^{r}=\mathbf{a}_{a}^{r}\otimes\mathbf{a}_{a}^{r}
</script>
</span>, where <span class="MathJax_Preview"><script type="math/tex">
\mathbf{a}_{a}^{r}
</script>
</span> (<span class="MathJax_Preview"><script type="math/tex">
a=1,2,3
</script>
</span> ) are orthonormal vectors aligned with the material axes. This material response was originally formulated for infinitesimal strain analyses; its behavior under finite strains may not be physically realistic.
</div>
<div class="Indented">
<i>Example:</i>
</div>
<pre class="LyX-Code">
&lt;material id="1" type="cubic CLE"&gt;
  &lt;density&gt;1&lt;/density&gt;
  &lt;lp1&gt;13.01&lt;/lp1&gt;
  &lt;lm1&gt;0.49&lt;/lm1&gt;
  &lt;l2&gt;0.66&lt;/l2&gt;
  &lt;mu&gt;0.16&lt;/mu&gt;
&lt;/material&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.1.3.4">4.1.3.4</a> Donnan Equilibrium Swelling<a class="Label" name="subsec:Donnan-Equilibrium-Swelling"> </a>
</h4>
<div class="Unindented">
The material type for a Donnan equilibrium swelling pressure is &ldquo;<i>Donnan equilibrium</i>&rdquo;. The swelling pressure is described by the equations for ideal Donnan equilibrium, assuming that the material is porous, with a charged solid matrix, and the external bathing environment consists of a salt solution of monovalent counter-ions <span class="bibcites">[<a class="bibliocite" name="cite-29" href="#biblio-29"><span class="bib-index">29</span></a>, <a class="bibliocite" name="cite-24" href="#biblio-24"><span class="bib-index">24</span></a>]</span>. Since osmotic swelling must be resisted by a solid matrix, this material is not stable on its own. It must be combined with an elastic material that resists the swelling, using a &ldquo;<i>solid mixture</i>&rdquo; container as described in Section <a class="Reference" href="#subsec:Solid-Mixture">4.1.3.21↓</a>. The following material parameters need to be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;phiw0&gt;
</td>
<td align="left" valign="top" style="width: 3in;">
gel porosity (fluid volume fraction) in reference (strain-free) configuration, <span class="MathJax_Preview"><script type="math/tex">
\varphi_{0}^{w}
</script>
</span>
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;cF0&gt;
</td>
<td align="left" valign="top" style="width: 3in;">
fixed-charge density in reference (strain-free) configuration, <span class="MathJax_Preview"><script type="math/tex">
c_{0}^{F}
</script>
</span>
</td>
<td align="left" valign="top">
[<b>n</b>/<b>L</b><span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{3}}
</script>
</span>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;bosm&gt;
</td>
<td align="left" valign="top" style="width: 3in;">
external bath osmolarity, <span class="MathJax_Preview"><script type="math/tex">
\bar{c}^{\ast}
</script>
</span>
</td>
<td align="left" valign="top">
[<b>n</b>/<b>L</b><span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{3}}
</script>
</span>] 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
The Cauchy stress for this material is the stress from the Donnan equilibrium response <span class="bibcites">[<a class="bibliocite" name="cite-4" href="#biblio-4"><span class="bib-index">4</span></a>]</span>: <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\boldsymbol{\sigma}=-\pi\mathbf{I},

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
\pi
</script>
</span> is the osmotic pressure, given by <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\pi=RT\left(\sqrt{\left(c^{F}\right)^{2}+\left(\bar{c}^{\ast}\right)^{2}}-\bar{c}^{\ast}\right),

</script>

</span>
and <span class="MathJax_Preview"><script type="math/tex">
c^{F}
</script>
</span> is the fixed-charge density in the current configuration, related to the reference configuration via <span class="MathJax_Preview">
<script type="math/tex;mode=display">

c^{F}=\frac{\varphi_{0}^{w}}{J-1+\varphi_{0}^{w}}c_{0}^{F},

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
J=\det\mathbf{F}
</script>
</span> is the relative volume. The values of the universal gas constant <span class="MathJax_Preview"><script type="math/tex">
R
</script>
</span> and absolute temperature <span class="MathJax_Preview"><script type="math/tex">
T
</script>
</span> must be specified as global constants.
</div>
<div class="Indented">
Note that <span class="MathJax_Preview"><script type="math/tex">
c_{0}^{F}
</script>
</span> may be negative or positive; the gel porosity is unitless and must be in the range <span class="MathJax_Preview"><script type="math/tex">
0<\varphi_{0}^{w}<1
</script>
</span>. A self-consistent set of units must be used for this model. For example:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">

</td>
<td align="left" valign="top">
(m, N, s, mol, K)
</td>
<td align="left" valign="top">
(mm, N, s, nmol, K) 
</td>

</tr>
<tr>
<td align="left" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
R
</script>
</span>
</td>
<td align="left" valign="top">
8.314 J/mol<span class="MathJax_Preview"><script type="math/tex">
\cdot
</script>
</span>K
</td>
<td align="left" valign="top">
8.314×10<span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{-6}}
</script>
</span> mJ/nmol<span class="MathJax_Preview"><script type="math/tex">
\cdot
</script>
</span>K 
</td>

</tr>
<tr>
<td align="left" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
T
</script>
</span>
</td>
<td align="left" valign="top">
K
</td>
<td align="left" valign="top">
K 
</td>

</tr>
<tr>
<td align="left" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
c_{0}^{F}
</script>
</span>
</td>
<td align="left" valign="top">
Eq/m<span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{3}}
</script>
</span>= mEq/L
</td>
<td align="left" valign="top">
nEq/mm<span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{3}}
</script>
</span>= mEq/L 
</td>

</tr>
<tr>
<td align="left" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\bar{c}^{\ast}
</script>
</span>
</td>
<td align="left" valign="top">
mol/m<span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{3}}
</script>
</span>= mM
</td>
<td align="left" valign="top">
nmol/mm<span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{3}}
</script>
</span>= mM 
</td>

</tr>
<tr>
<td align="left" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\xi_{i}
</script>
</span>
</td>
<td align="left" valign="top">
Pa
</td>
<td align="left" valign="top">
MPa 
</td>

</tr>
<tr>
<td align="left" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\pi
</script>
</span>
</td>
<td align="left" valign="top">
Pa
</td>
<td align="left" valign="top">
MPa 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
Though this material is porous, this is not a full-fledged biphasic material as described in Section <a class="Reference" href="#sec:Biphasic-Materials">4.7↓</a> for example. The behavior described by this material is strictly valid only after the transient response of interstitial fluid and ion fluxes has subsided (thus Donnan <i>equilibrium</i>).
</div>
<div class="Indented">
Donnan osmotic swelling reduces to zero when either <span class="MathJax_Preview"><script type="math/tex">
c_{0}^{F}=0
</script>
</span> or <span class="MathJax_Preview"><script type="math/tex">
\bar{c}^{\ast}\to\infty
</script>
</span>. Therefore, entering any other values for <span class="MathJax_Preview"><script type="math/tex">
c_{0}^{F}
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
\bar{c}^{\ast}
</script>
</span> at the initial time point of an analysis produces an instantaneous, non-zero swelling pressure. Depending on the magnitude of this pressure relative to the solid matrix stiffness, the nonlinear analysis may not converge due to this sudden swelling. Therefore, it is recommended to prescribe a load curve for either &lt;cF0&gt; or &lt;bosm&gt;, to ease into the initial swelling prior to the application of other loading conditions.
</div>
<div class="Indented">
<i>Example (using units of mm, N, s, nmol, K)</i>:
</div>
<pre class="LyX-Code">
&lt;material id="1" type="solid mixture"&gt;
  &lt;mat_axis type="local"&gt;0,0,0&lt;/mat_axis&gt;
  &lt;solid type="Donnan equilibrium"&gt;
    &lt;phiw0&gt;0.8&lt;/ phiw0&gt;
    &lt;cF0 lc="1"&gt;1&lt;/cF0&gt;
    &lt;bosm&gt;300&lt;/bosm&gt;
  &lt;/solid&gt;
  &lt;solid type="ellipsoidal fiber distribution"&gt;
    &lt;ksi&gt;0.01,0.01,0.01&lt;/ksi&gt;
    &lt;beta&gt;3,3,3&lt;/beta&gt;
  &lt;/solid&gt;
&lt;/material&gt;
&lt;LoadData&gt;
  &lt;loadcurve id="1"&gt;
    &lt;loadpoint&gt;0,0&lt;/loadpoint&gt;
    &lt;loadpoint&gt;1,150&lt;/loadpoint&gt;
  &lt;/loadcurve&gt;
&lt;/LoadData&gt;
&lt;Globals&gt;
  &lt;Constants&gt;
    &lt;R&gt;8.314e-6&lt;/R&gt;
    &lt;T&gt;310&lt;/T&gt;
  &lt;/Constants&gt;
&lt;/Globals&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.1.3.5">4.1.3.5</a> Ellipsoidal Fiber Distribution<a class="Label" name="subsec:Ellipsoidal-Fiber-Distribution"> </a>
</h4>
<div class="Unindented">
The material type for an ellipsoidal continuous fiber distribution is &ldquo;<i>ellipsoidal fiber distribution</i>&rdquo;. Since fibers can only sustain tension, this material is not stable on its own. It must be combined with a stable compressible material that acts as a ground matrix, using a &ldquo;<i>solid mixture</i>&rdquo; container as described in Section <a class="Reference" href="#subsec:Solid-Mixture">4.1.3.21↓</a>. The following material parameters need to be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;beta&gt;
</td>
<td align="left" valign="top">
parameters <span class="MathJax_Preview"><script type="math/tex">
\left({\beta_{1},\beta_{2},\beta_{3}}\right)
</script>
</span>
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;ksi&gt;
</td>
<td align="left" valign="top">
parameters <span class="MathJax_Preview"><script type="math/tex">
\left({\xi_{1},\xi_{2},\xi_{3}}\right)
</script>
</span>
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
The Cauchy stress for this fibrous material is given by <span class="bibcites">[<a class="bibliocite" name="cite-25" href="#biblio-25"><span class="bib-index">25</span></a>, <a class="bibliocite" name="cite-7" href="#biblio-7"><span class="bib-index">7</span></a>, <a class="bibliocite" name="cite-4" href="#biblio-4"><span class="bib-index">4</span></a>]</span>: <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\boldsymbol{\sigma}=\int_{0}^{2\pi}\int_{0}^{\pi}H\left(I_{n}-1\right)\sigma_{n}\left(\mathbf{n}\right)\sin\varphi\,d\varphi\,d\theta.

</script>

</span>
Here, <span class="MathJax_Preview"><script type="math/tex">
I_{n}=\lambda_{n}^{2}=\mathbf{N}\cdot\mathbf{C}\cdot\mathbf{N}
</script>
</span> is the square of the fiber stretch <span class="MathJax_Preview"><script type="math/tex">
\lambda_{n}
</script>
</span>, <span class="MathJax_Preview"><script type="math/tex">
\mathbf{N}
</script>
</span> is the unit vector along the fiber direction, in the reference configuration, which in spherical angles is directed along <span class="MathJax_Preview"><script type="math/tex">
\left(\theta,\varphi\right)
</script>
</span>, <span class="MathJax_Preview"><script type="math/tex">
\mathbf{n}=\mathbf{F}\cdot\mathbf{N}/\lambda_{n}
</script>
</span>, and <span class="MathJax_Preview"><script type="math/tex">
H\left(.\right)
</script>
</span>is the unit step function that enforces the tension-only contribution.
</div>
<div class="Indented">
The fiber stress is determined from a fiber strain energy function, <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\sigma_{n}=\frac{2I_{n}}{J}\frac{\partial\Psi}{\partial I_{n}}\mathbf{n}\otimes\mathbf{n},

</script>

</span>
where in this material, <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\Psi\left(\mathbf{n},I_{n}\right)=\xi\left(\mathbf{n}\right)\left(I_{n}-1\right)^{\beta\left(\mathbf{n}\right)}.

</script>

</span>
The materials parameters <span class="MathJax_Preview"><script type="math/tex">
\beta
</script>
</span>and <span class="MathJax_Preview"><script type="math/tex">
\xi
</script>
</span>are assumed to vary ellipsoidally with <span class="MathJax_Preview"><script type="math/tex">
\mathbf{n}
</script>
</span>, according to <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\begin{aligned}\xi\left(\mathbf{n}\right) & =\left(\frac{\cos^{2}\theta\sin^{2}\varphi}{\xi_{1}^{2}}+\frac{\sin^{2}\theta\sin^{2}\varphi}{\xi_{2}^{2}}+\frac{\cos^{2}\varphi}{\xi_{3}^{2}}\right)^{-1/2}\\
\beta\left(\mathbf{n}\right) & =\left(\frac{\cos^{2}\theta\sin^{2}\varphi}{\beta_{1}^{2}}+\frac{\sin^{2}\theta\sin^{2}\varphi}{\beta_{2}^{2}}+\frac{\cos^{2}\varphi}{\beta_{3}^{2}}\right)^{-1/2}
\end{aligned}
\,.

</script>

</span>
The orientation of the material axis can be defined as explained in detail in Section <a class="Reference" href="#subsec:Specifying-Fiber-Orientation">4.1.1↑</a>.
</div>
<div class="Indented">
<i>Example</i>:
</div>
<pre class="LyX-Code">
&lt;material id="1" type="solid mixture"&gt;
  &lt;mat_axis type="local"&gt;0,0,0&lt;/mat_axis&gt;
  &lt;solid type=”neo-Hookean”&gt;
    &lt;E&gt;1000.0&lt;/E&gt;
    &lt;v&gt;0.45&lt;/v&gt;
  &lt;/solid&gt;
  &lt;solid type="ellipsoidal fiber distribution"&gt;
    &lt;ksi&gt;10, 12, 15&lt;/ksi&gt;
    &lt;beta&gt;2.5, 3, 3&lt;/beta&gt;
  &lt;/solid&gt;
&lt;/material&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.1.3.6">4.1.3.6</a> Ellipsoidal Fiber Distribution Neo-Hookean<a class="Label" name="subsec:EFD-Neo-Hookean"> </a>
</h4>
<div class="Unindented">
The material type for a Neo-Hookean material with an ellipsoidal continuous fiber distribution is &ldquo;<i>EFD neo-Hookean</i>&rdquo;. The following material parameters need to be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;E&gt;
</td>
<td align="left" valign="top">
Young’s modulus
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;v&gt;
</td>
<td align="left" valign="top">
Poisson’s ratio
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;beta&gt;
</td>
<td align="left" valign="top">
parameters <span class="MathJax_Preview"><script type="math/tex">
\left(\beta_{1},\beta_{2},\beta_{3}\right)
</script>
</span>
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;ksi&gt;
</td>
<td align="left" valign="top">
parameters <span class="MathJax_Preview"><script type="math/tex">
\left(\xi_{1},\xi_{2},\xi_{3}\right)
</script>
</span>
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
The Cauchy stress for this material is given by, <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\boldsymbol{\sigma}=\boldsymbol{\sigma}_{NH}+\boldsymbol{\sigma}_{f}.

</script>

</span>
Here, <span class="MathJax_Preview"><script type="math/tex">
\boldsymbol{\sigma}_{NH}
</script>
</span> is the stress from the Neo-Hookean basis (Section <a class="Reference" href="#subsec:Neo-Hookean">4.1.3.16↓</a>), and <span class="MathJax_Preview"><script type="math/tex">
\boldsymbol{\sigma}_{f}
</script>
</span> is the stress contribution from the fibers (Section <a class="Reference" href="#subsec:Ellipsoidal-Fiber-Distribution">4.1.3.5↑</a>).
</div>
<div class="Indented">
<i>Example</i>:
</div>
<pre class="LyX-Code">
&lt;material id="1" type="EFD neo-Hookean"&gt;
  &lt;E&gt;1&lt;/E&gt;
  &lt;v&gt;0.3&lt;/v&gt;
  &lt;beta&gt;4.5,4.5,4.5&lt;/beta&gt;
  &lt;ksi&gt;1,1,1&lt;/ksi&gt;
  &lt;mat_axis type="local"&gt;0,0,0&lt;/mat_axis&gt;
&lt;/material&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.1.3.7">4.1.3.7</a> Ellipsoidal Fiber Distribution with Donnan Equilibrium Swelling<a class="Label" name="subsec:EFD-Donnan-Equilibrium"> </a>
</h4>
<div class="Unindented">
The material type for a swelling pressure combined with an ellipsoidal continuous fiber distribution is &ldquo;<i>EFD Donnan equilibrium</i>&rdquo;. The swelling pressure is described by the equations for ideal Donnan equilibrium, assuming that the material is porous, with a charged solid matrix, and the external bathing environment consists of a salt solution of monovalent counter-ions. The following material parameters need to be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;phiw0&gt;
</td>
<td align="left" valign="top" style="width: 3in;">
gel porosity (fluid volume fraction) in reference (strain-free) configuration, <span class="MathJax_Preview"><script type="math/tex">
\varphi_{0}^{w}
</script>
</span>
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;cF0&gt;
</td>
<td align="left" valign="top" style="width: 3in;">
fixed-charge density in reference (strain-free) configuration, <span class="MathJax_Preview"><script type="math/tex">
c_{0}^{F}
</script>
</span>
</td>
<td align="left" valign="top">
[<b>n</b>/<b>L</b><span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{3}}
</script>
</span>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;bosm&gt;
</td>
<td align="left" valign="top" style="width: 3in;">
external bath osmolarity, <span class="MathJax_Preview"><script type="math/tex">
\bar{c}^{\ast}
</script>
</span>
</td>
<td align="left" valign="top">
[<b>n</b>/<b>L</b><span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{3}}
</script>
</span>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;beta&gt;
</td>
<td align="left" valign="top" style="width: 3in;">
parameters <span class="MathJax_Preview"><script type="math/tex">
\left(\beta_{1},\beta_{2},\beta_{3}\right)
</script>
</span>
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;ksi&gt;
</td>
<td align="left" valign="top" style="width: 3in;">
parameters <span class="MathJax_Preview"><script type="math/tex">
\left(\xi_{1},\xi_{2},\xi_{3}\right)
</script>
</span>
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
The Cauchy stress for this material is given by, <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\boldsymbol{\sigma}=\boldsymbol{\sigma}_{DE}+\boldsymbol{\sigma}_{f}\,.

</script>

</span>
<span class="MathJax_Preview"><script type="math/tex">
\boldsymbol{\sigma}_{f}
</script>
</span> is the stress contribution from the fibers, as described in Section <a class="Reference" href="#subsec:Specifying-Fiber-Orientation">4.1.1↑</a>. <span class="MathJax_Preview"><script type="math/tex">
\boldsymbol{\sigma}_{DE}
</script>
</span> is the stress from the Donnan equilibrium response, as described in Section <a class="Reference" href="#subsec:Donnan-Equilibrium-Swelling">4.1.3.4↑</a>
</div>
<div class="Indented">
<i>Example (using units of mm, N, s, nmol, K)</i>:
</div>
<pre class="LyX-Code">
&lt;material id="1" type="EFD Donnan equilibrium"&gt;
  &lt;phiw0&gt;0.8&lt;/ phiw0&gt;
  &lt;cF0 lc="1"&gt;1&lt;/cF0&gt;
  &lt;bosm&gt;300&lt;/bosm&gt;
  &lt;beta&gt;3,3,3&lt;/beta&gt;
  &lt;ksi&gt;0.01,0.01,0.01&lt;/ksi&gt;
  &lt;mat_axis type="local"&gt;0,0,0&lt;/mat_axis&gt;
&lt;/material&gt;
&lt;LoadData&gt;
  &lt;loadcurve id="1"&gt;
    &lt;loadpoint&gt;0,0&lt;/loadpoint&gt;
    &lt;loadpoint&gt;1,150&lt;/loadpoint&gt;
  &lt;/loadcurve&gt;
&lt;/LoadData&gt;
&lt;Globals&gt;
  &lt;Constants&gt;
    &lt;R&gt;8.314e-6&lt;/R&gt;
    &lt;T&gt;310&lt;/T&gt;
  &lt;/Constants&gt;
&lt;/Globals&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.1.3.8">4.1.3.8</a> Fiber with Exponential-Power Law<a class="Label" name="subsec:fiber-exp-pow"> </a>
</h4>
<div class="Unindented">
The material type for a single fiber with an exponential-power law is &ldquo;<i>fiber-exp-pow</i>&rdquo;. Since fibers can only sustain tension, this material is not stable on its own. It must be combined with a stable compressible material that acts as a ground matrix, using a &ldquo;<i>solid mixture</i>&rdquo; container as described in Section <a class="Reference" href="#subsec:Solid-Mixture">4.1.3.21↓</a>. The following material parameters need to be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;ksi&gt;
</td>
<td align="left" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\xi,
</script>
</span> representing a measure of the fiber modulus
</td>
<td align="left" valign="top">
[<b>P</b>]
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;alpha&gt;
</td>
<td align="left" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\alpha,
</script>
</span> coefficient of exponential argument
</td>
<td align="left" valign="top">
[ ]
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;beta&gt;
</td>
<td align="left" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\beta,
</script>
</span> power of exponential argument
</td>
<td align="left" valign="top">
[ ]
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;theta&gt;
</td>
<td align="left" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\theta,
</script>
</span> spherical angle for fiber orientation in local coordinate system
</td>
<td align="left" valign="top">
[<b>deg</b>]
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;phi&gt;
</td>
<td align="left" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\varphi,
</script>
</span> spherical angle for fiber orientation in local coordinate system
</td>
<td align="left" valign="top">
[<b>deg</b>]
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
<div class="Frameless" style="width: 100%;">
<div class="PlainVisible">
<div class="center">
<img class="embedded" src="Figures/FigSphericalAngles.png" alt="figure Figures/FigSphericalAngles.png" style="max-width: 108px; max-height: 106px;"/>

</div>
<br/>
<div class="center">
<b>Spherical angles</b>
</div>

</div>

</div>

</div>
<div class="Indented">
The fiber is oriented along <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\mathbf{N}=\sin\varphi\cos\theta\,\mathbf{e}_{1}+\sin\varphi\sin\theta\,\mathbf{e}_{2}+\cos\varphi\,\mathbf{e}_{3},\quad0\leqslant\theta<2\pi,\;0\leqslant\varphi\leqslant\pi,

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
\left(\mathbf{e}_{1},\mathbf{e}_{2},\mathbf{e}_{3}\right)
</script>
</span> are orthonormal vectors representing the local element coordinate system (Section <a class="Reference" href="#subsec:Specifying-Fiber-Orientation">4.1.1↑</a>). The parameters &lt;theta&gt; and &lt;phi&gt; are optional, with default values of <span class="MathJax_Preview"><script type="math/tex">
\theta=
</script>
</span>0°and <span class="MathJax_Preview"><script type="math/tex">
\varphi=
</script>
</span>90°, such that <span class="MathJax_Preview"><script type="math/tex">
\mathbf{N}=\mathbf{e}_{1}
</script>
</span>. The Cauchy stress for this fibrous material is given by <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\boldsymbol{\sigma}=H\left(I_{n}-1\right)\frac{2I_{n}}{J}\frac{\partial\Psi}{\partial I_{n}}\mathbf{n}\otimes\mathbf{n},

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
I_{n}=\lambda_{n}^{2}=\mathbf{N}\cdot\mathbf{C}\cdot\mathbf{N}
</script>
</span> is the square of the fiber stretch, <span class="MathJax_Preview"><script type="math/tex">
\mathbf{n}=\mathbf{F}\cdot\mathbf{N}/\lambda_{n}
</script>
</span>, and <span class="MathJax_Preview"><script type="math/tex">
H\left(.\right)
</script>
</span> is the unit step function that enforces the tension-only contribution. The fiber strain energy density is given by <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\Psi=\frac{\xi}{\alpha\beta}\left(\exp\left[\alpha\left(I_{n}-1\right)^{\beta}\right]-1\right)\,,

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
\xi>0
</script>
</span>, <span class="MathJax_Preview"><script type="math/tex">
\alpha\geqslant0
</script>
</span>, and <span class="MathJax_Preview"><script type="math/tex">
\beta\geqslant2
</script>
</span>.
</div>
<div class="Indented">
Note: In the limit when <span class="MathJax_Preview"><script type="math/tex">
\alpha\to0
</script>
</span>, this expressions produces a power law, <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\lim\limits _{\alpha\to0}\,\Psi=\frac{\xi}{\beta}\left(I_{n}-1\right)^{\beta}

</script>

</span>
Note: When <span class="MathJax_Preview"><script type="math/tex">
\beta>2
</script>
</span>, the fiber modulus is zero at the strain origin (<span class="MathJax_Preview"><script type="math/tex">
I_{n}=1)
</script>
</span>. Therefore, use <span class="MathJax_Preview"><script type="math/tex">
\beta>2
</script>
</span> when a smooth transition in the stress is desired from compression to tension.
</div>
<div class="Indented">
<i>Example</i>:
</div>
<div class="Indented">
Single fiber oriented along <span class="MathJax_Preview"><script type="math/tex">
\mathbf{e}_{1}
</script>
</span>, embedded in a neo-Hookean ground matrix.
</div>
<pre class="LyX-Code">
&lt;material id="1" type="solid mixture"&gt;
  &lt;mat_axis type="local"&gt;0,0,0&lt;/mat_axis&gt;
  &lt;solid type="neo-Hookean"&gt;
    &lt;E&gt;1000.0&lt;/E&gt;
    &lt;v&gt;0.45&lt;/v&gt;
  &lt;/solid&gt;
  &lt;solid type="fiber-exp-pow"&gt;
    &lt;ksi&gt;5&lt;/ksi&gt;
    &lt;alpha&gt;20&lt;/alpha&gt;
    &lt;beta&gt;3&lt;/beta&gt;
    &lt;theta&gt;0&lt;/theta&gt;
    &lt;phi&gt;90&lt;/phi&gt;
  &lt;/solid&gt;
&lt;/material&gt;
</pre>
<div class="Unindented">
<i>Example</i>:
</div>
<div class="Indented">
Two fibers in the plane orthogonal to <span class="MathJax_Preview"><script type="math/tex">
\mathbf{e}_{1}
</script>
</span>, oriented at ±25 degrees relative to <span class="MathJax_Preview"><script type="math/tex">
\mathbf{e}_{3}
</script>
</span>, embedded in a neo-Hookean ground matrix.
</div>
<pre class="LyX-Code">
&lt;material id="1" type="solid mixture"&gt;
  &lt;mat_axis type="local"&gt;0,0,0&lt;/mat_axis&gt;
  &lt;solid type="neo-Hookean"&gt;
    &lt;E&gt;1000.0&lt;/E&gt;
    &lt;v&gt;0.45&lt;/v&gt;
  &lt;/solid&gt;
  &lt;solid type="fiber-exp-pow"
&lt;ksi&gt;5&lt;/ksi&gt;
&lt;alpha&gt;20&lt;/alpha&gt;
&lt;beta&gt;3&lt;/beta&gt;
&lt;theta&gt;90&lt;/theta&gt;
&lt;phi&gt;25&lt;/phi&gt;
&lt;/solid&gt;
&lt;solid type="fiber-exp-pow"&gt;
  &lt;ksi&gt;5&lt;/ksi&gt;
  &lt;alpha&gt;20&lt;/alpha&gt;
  &lt;beta&gt;3&lt;/beta&gt;
  &lt;theta&gt;-90&lt;/theta&gt;
  &lt;phi&gt;25&lt;/phi&gt;
&lt;/solid&gt;
&lt;/material&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.1.3.9">4.1.3.9</a> Fiber with Toe-Linear Response<a class="Label" name="subsec:Fiber-Pow-Linear"> </a>
</h4>
<div class="Unindented">
This material type is &ldquo;<i>fiber-pow-linear</i>&rdquo;. The following material parameters need to be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;E&gt;
</td>
<td align="left" valign="top" style="width: 3in;">
<span class="MathJax_Preview"><script type="math/tex">
E,
</script>
</span> the fiber modulus in the linear range (<span class="MathJax_Preview"><script type="math/tex">
E\geqslant0)
</script>
</span>
</td>
<td align="left" valign="top">
[<b>P</b>]
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;beta&gt;
</td>
<td align="left" valign="top" style="width: 3in;">
<span class="MathJax_Preview"><script type="math/tex">
\beta,
</script>
</span> the power-law exponent in the toe region (<span class="MathJax_Preview"><script type="math/tex">
\beta\geqslant2)
</script>
</span>
</td>
<td align="left" valign="top">
[ ]
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;lam0&gt;
</td>
<td align="left" valign="top" style="width: 3in;">
<span class="MathJax_Preview"><script type="math/tex">
\lambda_{0},
</script>
</span> the stretch ratio when the toe region transitions to the linear region (<span class="MathJax_Preview"><script type="math/tex">
\lambda_{0}>1)
</script>
</span>
</td>
<td align="left" valign="top">
[ ]
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
The fiber strain energy density is given by <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\Psi_{n}\left(I_{n}\right)=\begin{cases}
0 & I_{n}<1\\
\frac{\xi}{2\beta}\left(I_{n}-1\right)^{\beta} & 1\leqslant I_{n}\leqslant I_{0}\\
E\left(I_{0}^{1/2}-I_{n}^{1/2}\right)+B\left(I_{n}-I_{0}\right)+\Psi_{0} & I_{0}<I_{n}
\end{cases}\,,

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
I_{0}=\lambda_{0}^{2}
</script>
</span>, <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\xi=\frac{E}{2\left(\beta-1\right)}\left(I_{0}-1\right)^{2-\beta},\,B=\frac{E}{2}\left[\frac{\left(I_{0}-1\right)}{2\left(\beta-1\right)}+I_{0}\right],\,\Psi_{0}=\frac{\xi}{2\beta}\left(I_{0}-1\right)^{\beta}

</script>

</span>
<i>Example</i>:
</div>
<pre class="LyX-Code">
&lt;material type="fiber-power-linear"&gt;
  &lt;fiber type="angles"&gt;
    &lt;theta&gt;20&lt;/center&gt;
    &lt;phi&gt;90&lt;/phi&gt;
  &lt;/fiber&gt;
  &lt;E&gt;1&lt;/E&gt;
  &lt;beta&gt;2.5&lt;/beta&gt;
  &lt;lam0&gt;1.06&lt;/lam0&gt;
&lt;/material&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.1.3.10">4.1.3.10</a> Fung Orthotropic Compressible<a class="Label" name="subsec:Fung-Orthotropic-Compressible"> </a>
</h4>
<div class="Unindented">
The material type for unconstrained orthotropic Fung elasticity <span class="bibcites">[<a class="bibliocite" name="cite-17" href="#biblio-17"><span class="bib-index">17</span></a>, <a class="bibliocite" name="cite-18" href="#biblio-18"><span class="bib-index">18</span></a>]</span> is &ldquo;<i>Fung-ortho-compressible&rdquo;</i>. The following material parameters must be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;E1&gt;
</td>
<td align="left" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
E_{1}
</script>
</span> Young’s modulus
</td>
<td align="left" valign="top">
[<b>P</b>]
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;E2&gt;
</td>
<td align="left" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
E_{2}
</script>
</span> Young’s modulus
</td>
<td align="left" valign="top">
[<b>P</b>]
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;E3&gt;
</td>
<td align="left" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
E_{3}
</script>
</span> Young’s modulus
</td>
<td align="left" valign="top">
[<b>P</b>]
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;G12&gt;
</td>
<td align="left" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
G_{12}
</script>
</span> shear modulus
</td>
<td align="left" valign="top">
[<b>P</b>]
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;G23&gt;
</td>
<td align="left" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
G_{23}
</script>
</span> shear modulus
</td>
<td align="left" valign="top">
[<b>P</b>]
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;G13&gt;
</td>
<td align="left" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
G_{13}
</script>
</span> shear modulus
</td>
<td align="left" valign="top">
[<b>P</b>]
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;v12&gt;
</td>
<td align="left" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\nu_{12}
</script>
</span> Poisson’s ratio
</td>
<td align="left" valign="top">
[ ]
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;v23&gt;
</td>
<td align="left" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\nu_{23}
</script>
</span> Poisson’s ratio
</td>
<td align="left" valign="top">
[ ]
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;v31&gt;
</td>
<td align="left" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\nu_{31}
</script>
</span> Poisson’s ratio
</td>
<td align="left" valign="top">
[ ]
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;c&gt;
</td>
<td align="left" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
c
</script>
</span> coefficient
</td>
<td align="left" valign="top">
[<b>P</b>]
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;k&gt;
</td>
<td align="left" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\kappa
</script>
</span> bulk modulus
</td>
<td align="left" valign="top">
[<b>P</b>]
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
The hyperelastic strain energy function is given by <span class="bibcites">[<a class="bibliocite" name="cite-3" href="#biblio-3"><span class="bib-index">3</span></a>]</span>, <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\Psi=\frac{1}{2}c\left(e^{Q}-1\right)+U\left(J\right),

</script>

</span>
where, <span class="MathJax_Preview">
<script type="math/tex;mode=display">

Q=c^{-1}\sum\limits _{a=1}^{3}\left[2\mu_{a}\mathbf{M}_{a}:\mathbf{E}^{2}+\sum\limits _{b=1}^{3}\lambda_{ab}\left(\mathbf{M}_{a}:\mathbf{E}\right)\left(\mathbf{M}_{b}:\mathbf{E}\right)\right],

</script>

</span>
and <span class="MathJax_Preview">
<script type="math/tex;mode=display">

U\left(J\right)=\frac{\kappa}{2}\left(\ln J\right)^{2}\,.

</script>

</span>
Here, <span class="MathJax_Preview"><script type="math/tex">
\mathbf{E}=\left(\mathbf{C}-\mathbf{I}\right)/2
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
\mathbf{M}_{a}=\mathbf{V}_{a}\otimes\mathbf{V}_{a}
</script>
</span>where <span class="MathJax_Preview"><script type="math/tex">
\mathbf{V}_{a}
</script>
</span> defines the initial direction of material axis <span class="MathJax_Preview"><script type="math/tex">
a
</script>
</span>. See Section <a class="Reference" href="#subsec:Orthotropic-Materials">4.1.1.2↑</a> on how to define the material axes for orthotropic materials. The Lamé constants <span class="MathJax_Preview"><script type="math/tex">
\mu_{a}
</script>
</span> (<span class="MathJax_Preview"><script type="math/tex">
a=1,2,3)
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
\lambda_{ab}
</script>
</span> (<span class="MathJax_Preview"><script type="math/tex">
a,b=1,2,3
</script>
</span>, <span class="MathJax_Preview"><script type="math/tex">
\lambda_{ba}=\lambda_{ab})
</script>
</span> are related to Young’s moduli <span class="MathJax_Preview"><script type="math/tex">
E_{a}
</script>
</span>, shear moduli <span class="MathJax_Preview"><script type="math/tex">
G_{ab}
</script>
</span> and Poisson’s ratios <span class="MathJax_Preview"><script type="math/tex">
\nu_{ab}
</script>
</span> via <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\begin{aligned} & \left[\begin{array}{cccccc}
\lambda_{11}+2\mu_{1} & \lambda_{12} & \lambda_{13} & 0 & 0 & 0\\
\lambda_{12} & \lambda_{22}+2\mu_{2} & \lambda_{23} & 0 & 0 & 0\\
\lambda_{13} & \lambda_{23} & \lambda_{33}+2\mu_{3} & 0 & 0 & 0\\
0 & 0 & 0 & \frac{1}{2}\left(\mu_{1}+\mu_{2}\right) & 0 & 0\\
0 & 0 & 0 & 0 & \frac{1}{2}\left(\mu_{2}+\mu_{3}\right) & 0\\
0 & 0 & 0 & 0 & 0 & \frac{1}{2}\left(\mu_{1}+\mu_{3}\right)
\end{array}\right]^{-1}\\
 & =\left[\begin{array}{cccccc}
\frac{1}{E_{1}} & -\frac{\nu_{12}}{E_{1}} & -\frac{\nu_{13}}{E_{1}} & 0 & 0 & 0\\
-\frac{\nu_{21}}{E_{2}} & \frac{1}{E_{2}} & -\frac{\nu_{23}}{E_{2}} & 0 & 0 & 0\\
-\frac{\nu_{31}}{E_{3}} & -\frac{\nu_{32}}{E_{3}} & \frac{1}{E_{3}} & 0 & 0 & 0\\
0 & 0 & 0 & \frac{1}{G_{12}} & 0 & 0\\
0 & 0 & 0 & 0 & \frac{1}{G_{23}} & 0\\
0 & 0 & 0 & 0 & 0 & \frac{1}{G_{13}}
\end{array}\right]
\end{aligned}

</script>

</span>
The orthotropic Lamé parameters should produce a positive definite stiffness matrix.
</div>
<div class="Indented">
<i>Example</i>:
</div>
<pre class="LyX-Code">
&lt;material id="3" type="Fung-ortho-compressible"&gt;
  &lt;E1&gt;124&lt;/E1&gt;
  &lt;E2&gt;124&lt;/E2&gt;
  &lt;E3&gt;36&lt;/E3&gt;
  &lt;G12&gt;67&lt;/G12&gt;
  &lt;G23&gt;40&lt;/G23&gt;
  &lt;G13&gt;40&lt;/G13&gt;
  &lt;v12&gt;-0.075&lt;/v12&gt;
  &lt;v23&gt;0.87&lt;/v23&gt;
  &lt;v31&gt;0.26&lt;/v31&gt;
  &lt;c&gt;1&lt;/c&gt;
  &lt;k&gt;120&lt;/k&gt;
&lt;/material&gt;
</pre>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.1.3.11">4.1.3.11</a> Holmes-Mow<a class="Label" name="subsec:Holmes-Mow"> </a>
</h4>
<div class="Unindented">
The material type for the Holmes-Mow material <span class="bibcites">[<a class="bibliocite" name="cite-22" href="#biblio-22"><span class="bib-index">22</span></a>]</span> is <i>Holmes-Mow</i>. This isotropic hyperelastic material has been used to represent the solid matrix of articular cartilage <span class="bibcites">[<a class="bibliocite" name="cite-22" href="#biblio-22"><span class="bib-index">22</span></a>, <a class="bibliocite" name="cite-6" href="#biblio-6"><span class="bib-index">6</span></a>]</span> and intervertebral disc <span class="bibcites">[<a class="bibliocite" name="cite-23" href="#biblio-23"><span class="bib-index">23</span></a>]</span>. The following material parameters must be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;E&gt;
</td>
<td align="left" valign="top">
Young’s modulus
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;v&gt;
</td>
<td align="left" valign="top">
Poisson’s ratio
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;beta&gt;
</td>
<td align="left" valign="top">
Exponential stiffening coefficient
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
The coupled hyperelastic strain-energy function for this material is given by <span class="bibcites">[<a class="bibliocite" name="cite-22" href="#biblio-22"><span class="bib-index">22</span></a>]</span>: <span class="MathJax_Preview">
<script type="math/tex;mode=display">

W\left(I_{1},I_{2},J\right)=\frac{1}{2}c\left(e^{Q}-1\right),

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
I_{1}
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
I_{2}
</script>
</span> are the first and second invariants of the right Cauchy-Green tensor and <span class="MathJax_Preview"><script type="math/tex">
J
</script>
</span>is the jacobian of the deformation gradient. Furthermore, <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\begin{aligned}Q & =\frac{\beta}{\lambda+2\mu}\left[\left(2\mu-\lambda\right)\left(I_{1}-3\right)+\lambda\left(I_{2}-3\right)-\left(\lambda+2\mu\right)\ln J^{2}\right]\\
c & =\frac{\lambda+2\mu}{2\beta}
\end{aligned}
\,,

</script>

</span>
and <span class="MathJax_Preview"><script type="math/tex">
\lambda
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
\mu
</script>
</span> are the Lamé parameters which are related to the more familiar Young’s modulus and Poisson’s ratio in the usual manner: <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\begin{aligned}\lambda & =\frac{E}{\left(1+\nu\right)\left(1-2\nu\right)}\\
\mu & =\frac{E}{2\left(1+\nu\right)}
\end{aligned}
\,.

</script>

</span>
<i>Example:</i>
</div>
<pre class="LyX-Code">
&lt;material id="3" type="Holmes-Mow"&gt;
  &lt;E&gt;1&lt;/E&gt;
  &lt;v&gt;0.35&lt;/v&gt;
  &lt;beta&gt;0.25&lt;/beta&gt;
&lt;/material&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.1.3.12">4.1.3.12</a> Isotropic Elastic<a class="Label" name="subsec:Isotropic-Elastic"> </a>
</h4>
<div class="Unindented">
The material type for isotropic elasticity is <i>isotropic elastic</i><span class="FootOuter"><span class="SupFootMarker"> [J] </span><span class="HoverFoot"><span class="SupFootMarker"> [J] </span> This material replaces the now-obsolete <i>linear elastic </i>and <i>St.Venant-Kirchhoff</i> materials. These materials are still available for backward compatibility although it is recommended to use the <i>isotropic elastic</i> material instead.</span></span>. The following material parameters must be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;E&gt;
</td>
<td align="left" valign="top">
Young’s modulus
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;v&gt;
</td>
<td align="left" valign="top">
Poisson’s ratio
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
This material is an implementation of a hyperelastic constitutive material that reduces to the classical linear elastic material for small strains, but is objective for large deformations and rotations. The hyperelastic strain-energy function is given by: <span class="MathJax_Preview">
<script type="math/tex;mode=display">

W=\frac{1}{2}\lambda\left(\tr\mathbf{E}\right)^{2}+\mu\mathbf{E}:\mathbf{E}.

</script>

</span>
Here, <b><span class="MathJax_Preview"><script type="math/tex">
\mathbf{E}
</script>
</span></b> is the Euler-Lagrange strain tensor and <span class="MathJax_Preview"><script type="math/tex">
\lambda
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
\mu
</script>
</span> are the Lamé parameters, which are related to the more familiar Young’s modulus <span class="MathJax_Preview"><script type="math/tex">
E
</script>
</span> and Poisson’s ratio <span class="MathJax_Preview"><script type="math/tex">
\nu
</script>
</span> as follows: <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\lambda=\frac{\nu E}{\left(1+\nu\right)\left(1-2\nu\right)},\mu=\frac{E}{2\left(1+\nu\right)}\,.

</script>

</span>
It is often convenient to express the material properties using the bulk modulus <span class="MathJax_Preview"><script type="math/tex">
K
</script>
</span> and shear modulus <span class="MathJax_Preview"><script type="math/tex">
G
</script>
</span>. To convert to Young’s modulus and Poisson’s ratio, use the following formulas: <span class="MathJax_Preview">
<script type="math/tex;mode=display">

E=\frac{9KG}{3K+G},\quad\nu=\frac{3K-2G}{6K+2G}\,.

</script>

</span>
<i>Remark: </i>Note that although this material is objective, it is not advised to use this model for large strains since the behavior may be unphysical. For example, it can be shown that for a uniaxial tension the stress grows unbounded and the volume tends to zero for finite strains. Also for large strains, the Young’s modulus and Poisson’s ratio input values have little relationship to the actual material parameters. Therefore it is advisable to use this material only for small strains and/or large rotations. To represent isotropic elastic materials under large strain and rotation, it is best to use some of the other available nonlinear material models described in this chapter, such as the Holmes-Mow material in Section <a class="Reference" href="#subsec:Holmes-Mow">4.1.3.11↑</a>, the neo-Hookean material in Section <a class="Reference" href="#subsec:Neo-Hookean">4.1.3.16↓</a>, or the unconstrained Ogden material in Section <a class="Reference" href="#subsec:Ogden-Unconstrained">4.1.3.19↓</a>.
</div>
<div class="Indented">
<i>Example:</i>
</div>
<pre class="LyX-Code">
&lt;material id="1" type="isotropic elastic"
  &lt;E&gt;1000.0&lt;/E&gt;
  &lt;v&gt;0.45&lt;/v&gt;
&lt;/material&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.1.3.13">4.1.3.13</a> Orthotropic Elastic<a class="Label" name="subsec:Orthotropic-Elastic"> </a>
</h4>
<div class="Unindented">
The material type for orthotropic elasticity is &ldquo;<i>orthotropic elastic&rdquo;</i>. The following material parameters must be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;E1&gt;
</td>
<td align="left" valign="top">
Young’s modulus in the x-direction
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;E2&gt;
</td>
<td align="left" valign="top">
Young’s modulus in the y-direction
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;E3&gt;
</td>
<td align="left" valign="top">
Young’s modulus in the z-direction
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;G12&gt;
</td>
<td align="left" valign="top">
Shear modulus in the xy-plane
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;G23&gt;
</td>
<td align="left" valign="top">
Shear modulus in the yz-plane
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;G31&gt;
</td>
<td align="left" valign="top">
Shear modulus in the xz-plane
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;v12&gt;
</td>
<td align="left" valign="top">
Poisson’s ratio between x- and y-direction
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;v23&gt;
</td>
<td align="left" valign="top">
Poisson’s ratio between y- and z-direction
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;v31&gt;
</td>
<td align="left" valign="top">
Poisson’s ratio between z- and x-direction
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
The stress-strain relation for this material is given by <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\left[\begin{array}{c}
E_{11}\\
E_{22}\\
E_{33}\\
2E_{23}\\
2E_{31}\\
2E_{12}
\end{array}\right]=\left[\begin{array}{cccccc}
1/E_{1} & -\nu_{21}/E_{2} & -\nu_{31}/E_{3} & 0 & 0 & 0\\
-\nu_{12}/E_{1} & 1/E_{2} & -\nu_{32}/E_{3} & 0 & 0 & 0\\
-\nu_{13}/E_{1} & -\nu_{23}/E_{2} & 1/E_{3} & 0 & 0 & 0\\
0 & 0 & 0 & 1/G_{23} & 0 & 0\\
0 & 0 & 0 & 0 & 1/G_{31} & 0\\
0 & 0 & 0 & 0 & 0 & 1/G_{12}
\end{array}\right]\left[\begin{array}{c}
T_{11}\\
T_{22}\\
T_{33}\\
T_{23}\\
T_{31}\\
T_{12}
\end{array}\right]

</script>

</span>
Material axes may be specified as described in Section <a class="Reference" href="#subsec:Orthotropic-Materials">4.1.1.2↑</a>.
</div>
<div class="Indented">
<i>Example</i>:
</div>
<pre class="LyX-Code">
&lt;material id="3" type="orthotropic elastic"&gt;
  &lt;mat_axis type="vector"&gt;
    &lt;a&gt;0.866,0.5,0&lt;/a&gt;
    &lt;d&gt;-0.5,0.866,0&lt;/d&gt;
  &lt;/mat_axis&gt;
  &lt;E1&gt;1&lt;/E1&gt;
  &lt;E2&gt;2&lt;/E2&gt;
  &lt;E3&gt;3&lt;/E3&gt;
  &lt;v12&gt;0&lt;/v12&gt;
  &lt;v23&gt;0&lt;/v23&gt;
  &lt;v31&gt;0&lt;/v31&gt;
  &lt;G12&gt;1&lt;/G12&gt;
  &lt;G23&gt;1&lt;/G23&gt;
  &lt;G31&gt;1&lt;/G31&gt;
&lt;/material&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.1.3.14">4.1.3.14</a> Orthotropic CLE<a class="Label" name="subsec:Orthotropic-CLE"> </a>
</h4>
<div class="Unindented">
The material type for a conewise linear elastic (CLE) material with orthtropic symmetry is <i>orthotropic CLE</i>. The following parameters must be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;lp11&gt;
</td>
<td align="left" valign="top">
Tensile diagonal first Lamé coefficient along direction 1 <span class="MathJax_Preview"><script type="math/tex">
\lambda_{+11}
</script>
</span>
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;lp22&gt;
</td>
<td align="left" valign="top">
Tensile diagonal first Lamé coefficient along direction 2 <span class="MathJax_Preview"><script type="math/tex">
\lambda_{+22}
</script>
</span>
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;lp11&gt;
</td>
<td align="left" valign="top">
Tensile diagonal first Lamé coefficient along direction 3 <span class="MathJax_Preview"><script type="math/tex">
\lambda_{+33}
</script>
</span>
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;lm11&gt;
</td>
<td align="left" valign="top">
Compressive diagonal first Lamé coefficient along direction 1 <span class="MathJax_Preview"><script type="math/tex">
\lambda_{-11}
</script>
</span>
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;lm22&gt;
</td>
<td align="left" valign="top">
Compressive diagonal first Lamé coefficient along direction 2 <span class="MathJax_Preview"><script type="math/tex">
\lambda_{-22}
</script>
</span>
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;lm33&gt;
</td>
<td align="left" valign="top">
Compressive diagonal first Lamé coefficient along direction 3 <span class="MathJax_Preview"><script type="math/tex">
\lambda_{-33}
</script>
</span>
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;l12&gt;
</td>
<td align="left" valign="top">
Off-diagonal first Lamé coefficient in 1-2 plane <span class="MathJax_Preview"><script type="math/tex">
\lambda_{12}
</script>
</span>
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;l23&gt;
</td>
<td align="left" valign="top">
Off-diagonal first Lamé coefficient in 2-3 plane <span class="MathJax_Preview"><script type="math/tex">
\lambda_{23}
</script>
</span>
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;l31&gt;
</td>
<td align="left" valign="top">
Off-diagonal first Lamé coefficient in 3-1 plane <span class="MathJax_Preview"><script type="math/tex">
\lambda_{31}
</script>
</span>
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;mu1&gt;
</td>
<td align="left" valign="top">
Second Lamé coefficient along direction 1 <span class="MathJax_Preview"><script type="math/tex">
\mu_{1}
</script>
</span>
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;mu2&gt;
</td>
<td align="left" valign="top">
Second Lamé coefficient along direction 2 <span class="MathJax_Preview"><script type="math/tex">
\mu_{2}
</script>
</span>
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;mu3&gt;
</td>
<td align="left" valign="top">
Second Lamé coefficient along direction 3 <span class="MathJax_Preview"><script type="math/tex">
\mu_{3}
</script>
</span>
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
This bimodular elastic material is the orthotropic conewise linear elastic material described by Curnier et al. <span class="bibcites">[<a class="bibliocite" name="cite-16" href="#biblio-16"><span class="bib-index">16</span></a>]</span>. It is derived from the following hyperelastic strain-energy function: <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\Psi_{r}=\sum\limits _{a=1}^{3}\mu_{a}\mathbf{A}_{a}^{r}:\mathbf{E}^{2}+\frac{1}{2}\lambda_{aa}\left[\mathbf{A}_{a}^{r}:\mathbf{E}\right]\left(\mathbf{A}_{a}^{r}:\mathbf{E}\right)^{2}+\sum\limits _{\begin{array}{c}
b=1\\
b\ne a
\end{array}}^{3}\frac{1}{2}\lambda_{ab}\left(\mathbf{A}_{a}^{r}:\mathbf{E}\right)\left(\mathbf{A}_{b}^{r}:\mathbf{E}\right)

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
\lambda_{ba}=\lambda_{ab}
</script>
</span> and <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\lambda_{aa}\left[\mathbf{A}_{a}^{r}:\mathbf{E}\right]=\begin{cases}
\lambda_{+aa} & \mathbf{A}_{a}^{r}:\mathbf{E}\geqslant0\\
\lambda_{-aa} & \mathbf{A}_{a}^{r}:\mathbf{E}<0
\end{cases},\quad a=1,2,3

</script>

</span>
Here, <span class="MathJax_Preview"><script type="math/tex">
\mathbf{E}
</script>
</span> is the Lagrangian strain tensor and <span class="MathJax_Preview"><script type="math/tex">
\mathbf{A}_{a}^{r}=\mathbf{a}_{a}^{r}\otimes\mathbf{a}_{a}^{r}
</script>
</span>, where <span class="MathJax_Preview"><script type="math/tex">
\mathbf{a}_{a}^{r}
</script>
</span> (<span class="MathJax_Preview"><script type="math/tex">
a=1,2,3)
</script>
</span> are orthonormal vectors aligned with the material axes. This material response was originally formulated for infinitesimal strain analyses; its behavior under finite strains may not be physically realistic.
</div>
<div class="Indented">
<i>Example:</i>
</div>
<pre class="LyX-Code">
&lt;material id="1" type=" orthotropic CLE"&gt;
  &lt;density&gt;1&lt;/density&gt;
  &lt;lp11&gt;13.01&lt;/lp11&gt;
  &lt;lp22&gt;13.01&lt;/lp22&gt;
  &lt;lp33&gt;13.01&lt;/lp33&gt;
  &lt;lm11&gt;0.49&lt;/lm11&gt;
  &lt;lm22&gt;0.49&lt;/lm22&gt;
  &lt;lm33&gt;0.49&lt;/lm33&gt;
  &lt;l12&gt;0.66&lt;/l12&gt;
  &lt;l23&gt;0.66&lt;/l23&gt;
  &lt;l31&gt;0.66&lt;/l31&gt;
  &lt;mu1&gt;0.16&lt;/mu1&gt;
  &lt;mu2&gt;0.16&lt;/mu2&gt;
  &lt;mu3&gt;0.16&lt;/mu3&gt;
&lt;/material&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.1.3.15">4.1.3.15</a> Osmotic Pressure from Virial Expansion<a class="Label" name="subsec:Osmotic-Pressure-Virial"> </a>
</h4>
<div class="Unindented">
The material type for osmotic pressure from virial expansion is &ldquo;<i>osmotic virial expansion</i>&rdquo;. The following material parameters need to be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;phiw0&gt;
</td>
<td align="left" valign="top" style="width: 3in;">
Fluid volume fraction in reference (strain-free) configuration, <span class="MathJax_Preview"><script type="math/tex">
\varphi_{r}^{w}
</script>
</span> 
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;cr&gt;
</td>
<td align="left" valign="top" style="width: 3in;">
Concentration of interstitial solute causing the osmotic pressure (moles per volume of the mixture in the reference configuration), <span class="MathJax_Preview"><script type="math/tex">
c_{r}
</script>
</span> 
</td>
<td align="left" valign="top">
[<b>n</b>/<b>L</b><span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{3}}
</script>
</span>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;c1&gt;
</td>
<td align="left" valign="top" style="width: 3in;">
First virial coefficient <span class="MathJax_Preview"><script type="math/tex">
c_{1}
</script>
</span> 
</td>
<td align="left" valign="top">
[<b>F</b><span class="MathJax_Preview"><script type="math/tex">
\cdot
</script>
</span><b>L</b>/<b>n</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;c2&gt;
</td>
<td align="left" valign="top" style="width: 3in;">
Second virial coefficient <span class="MathJax_Preview"><script type="math/tex">
c_{2}
</script>
</span> 
</td>
<td align="left" valign="top">
[<b>F</b><span class="MathJax_Preview"><script type="math/tex">
\cdot
</script>
</span><b>L</b><span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{4}}
</script>
</span>/<b>n</b><span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{2}}
</script>
</span>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;c3&gt;
</td>
<td align="left" valign="top" style="width: 3in;">
Third virial coefficient <span class="MathJax_Preview"><script type="math/tex">
c_{3}
</script>
</span> 
</td>
<td align="left" valign="top">
[<b>F</b><span class="MathJax_Preview"><script type="math/tex">
\cdot
</script>
</span><b>L</b><span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{7}}
</script>
</span>/<b>n</b><span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{3}}
</script>
</span>] 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
The Cauchy stress for this material is <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\boldsymbol{\sigma}=-\pi\mathbf{I},

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
\pi
</script>
</span> is the osmotic pressure, given by <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\pi=c_{1}c+c_{2}c^{2}+c_{3}c^{3},\quad c=\frac{\varphi_{r}^{w}c_{r}}{J-1+\varphi_{r}^{w}}\,,

</script>

</span>
<span class="MathJax_Preview"><script type="math/tex">
c
</script>
</span> is the solute concentration in the current configuration, and <span class="MathJax_Preview"><script type="math/tex">
J=\det\mathbf{F}
</script>
</span> is the relative volume.
</div>
<div class="Indented">
This osmotic swelling pressure in the interstitial fluid of a porous material represents an entropic mechanism whose magnitude is independent of the external bath osmolarity. Typically, this material should be used in a solid mixture where the swelling pressure is resisted by a solid matrix in tension.
</div>
<div class="Indented">
<i>Example</i>:
</div>
<pre class="LyX-Code">
&lt;Material&gt;
  &lt;material id="1" type="solid mixture"&gt;
    &lt;solid type="osmotic virial expansion"&gt;
      &lt;phiw0&gt;0.8&lt;/phiw0&gt;
      &lt;cr lc="1"&gt;100&lt;/cr&gt;
      &lt;c1&gt;2.436e-6&lt;/c1&gt;
      &lt;c2&gt;0&lt;/c2&gt;
      &lt;c3&gt;0&lt;/c3&gt;
    &lt;/solid&gt;
    &lt;solid type="spherical fiber distribution"/&gt;
  &lt;/material&gt;
&lt;/Material&gt;
&lt;LoadData&gt;
  &lt;loadcurve id="1" type="smooth"&gt;
    &lt;loadpoint&gt;0,0&lt;/loadpoint&gt;
    &lt;loadpoint&gt;1,1&lt;/loadpoint&gt;
  &lt;/loadcurve&gt;
&lt;/LoadData&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.1.3.16">4.1.3.16</a> Neo-Hookean<a class="Label" name="subsec:Neo-Hookean"> </a>
</h4>
<div class="Unindented">
The material type for a Neo-Hookean material is <i>neo-Hookean</i>. The following parameters must be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;E&gt;
</td>
<td align="left" valign="top">
Young’s modulus
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;v&gt;
</td>
<td align="left" valign="top">
Poisson’s ratio
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
This model describes a compressible Neo-Hookean material <span class="bibcites">[<a class="bibliocite" name="cite-12" href="#biblio-12"><span class="bib-index">12</span></a>]</span>. It has a non-linear stress-strain behavior, but reduces to the classical linear elasticity model for small strains <i>and</i> small rotations. It is derived from the following hyperelastic strain-energy function: <span class="MathJax_Preview">
<script type="math/tex;mode=display">

W=\frac{\mu}{2}\left(I_{1}-3\right)-\mu\ln J+\frac{\lambda}{2}\left(\ln J\right)^{2}.

</script>

</span>
Here, <span class="MathJax_Preview"><script type="math/tex">
I_{1}
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
I_{2}
</script>
</span> are the first and second invariants of the right Cauchy-Green deformation tensor <b><span class="MathJax_Preview"><script type="math/tex">
\mathbf{C}
</script>
</span></b> and <span class="MathJax_Preview"><script type="math/tex">
J
</script>
</span> is the determinant of the deformation gradient tensor.
</div>
<div class="Indented">
This material model uses a standard displacement-based element formulation, so care must be taken when modeling materials with nearly-incompressible material behavior to avoid element locking. For this case, use the <i>Mooney-Rivlin </i>material described in Section <a class="Reference" href="#subsec:Mooney-Rivlin">4.1.2.8↑</a>.
</div>
<div class="Indented">
<i>Example:</i>
</div>
<pre class="LyX-Code">
&lt;material id="1" type="neo-Hookean"&gt;
  &lt;E&gt;1000.0&lt;/E&gt;
  &lt;v&gt;0.45&lt;/v&gt;
&lt;/material&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.1.3.17">4.1.3.17</a> Coupled Mooney-Rivlin<a class="Label" name="subsec:Coupled-Mooney-Rivlin"> </a>
</h4>
<div class="Unindented">
The coupled Mooney-Rivlin material describes a compressible formulation of the Mooney-Rivlin material. The material type for this material is <i>coupled Mooney-Rivlin</i>. The following material parameters can be defined.
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;c1&gt;
</td>
<td align="left" valign="top">
Mooney-Rivlin c1 parameter
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;c2&gt;
</td>
<td align="left" valign="top">
Mooney-Rivlin c2 parameter
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
k
</td>
<td align="left" valign="top">
&ldquo;Bulk-modulus&rdquo;
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
The strain-energy function is given by the following expression. <span class="MathJax_Preview">
<script type="math/tex;mode=display">

W=c_{1}\left(I_{1}-3\right)+c_{2}\left(I_{2}-3\right)-2\left(c_{1}+2c_{2}\right)\ln J+\frac{\lambda}{2}\left(\ln J\right)^{2}

</script>

</span>
Here, <span class="MathJax_Preview"><script type="math/tex">
I_{1}
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
I_{2}
</script>
</span> are the first and second invariants of the right Cauchy-Green deformation tensor <b><span class="MathJax_Preview"><script type="math/tex">
\mathbf{C}
</script>
</span></b> and <span class="MathJax_Preview"><script type="math/tex">
J
</script>
</span> is the determinant of the deformation gradient tensor.
</div>
<div class="Indented">
This material model uses a standard displacement-based element formulation, so care must be taken when modeling materials with nearly-incompressible material behavior to avoid element locking. For (nearly-) incompressible materials, use the <i>Mooney-Rivlin </i>material described in Section <a class="Reference" href="#subsec:Mooney-Rivlin">4.1.2.8↑</a>.
</div>
<div class="Indented">
<i>Example:</i>
</div>
<pre class="LyX-Code">
&lt;material id="1" type="coupled Mooney-Rivlin"&gt;
  &lt;c1&gt;10.0&lt;/c1&gt;
  &lt;c2&gt;1.0&lt;/c2&gt;
  &lt;k&gt;100.0&lt;/k&gt;
&lt;/material&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.1.3.18">4.1.3.18</a> Coupled Veronda-Westmann<a class="Label" name="subsec:Coupled-Veronda-Westmann"> </a>
</h4>
<div class="Unindented">
The material type for the coupled Veronda-Westmann material is <i>coupled Veronda-Westmann</i>. The following material parameters can be defined.
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;c1&gt;
</td>
<td align="left" valign="top">
Veronda-Westmann c1 parameter
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;c2&gt;
</td>
<td align="left" valign="top">
Veronda-Westmann c2 parameter
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
k
</td>
<td align="left" valign="top">
&ldquo;Bulk-modulus&rdquo;
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
The coupled Veronda-Westmann material is a compressible formulation of the Veronda-Westmann material and is defined by the following strain-energy function. <span class="MathJax_Preview">
<script type="math/tex;mode=display">

W=c_{1}\left(e^{c_{2}\left(I_{1}-3\right)}-1\right)-\frac{c_{1}c_{2}}{2}\left(I_{2}-3\right)+\frac{\lambda}{2}\left(\ln J\right)^{2}

</script>

</span>
Here, <span class="MathJax_Preview"><script type="math/tex">
I_{1}
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
I_{2}
</script>
</span> are the first and second invariants of the right Cauchy-Green deformation tensor <b>C</b> and <span class="MathJax_Preview"><script type="math/tex">
J
</script>
</span>is the determinant of the deformation gradient tensor.
</div>
<div class="Indented">
This material model uses a standard displacement-based element formulation, so care must be taken when modeling materials with nearly-incompressible material behavior to avoid element locking. For (nearly-) incompressible materials, use the <i>Veronda-Westmann </i>material described in Section <a class="Reference" href="#subsec:Veronda-Westmann">4.1.2.16↑</a>.
</div>
<div class="Indented">
<i>Example:</i>
</div>
<pre class="LyX-Code">
&lt;material id="1" type="coupled Veronda-Westmann"&gt;
  &lt;c1&gt;10.0&lt;/c1&gt;
  &lt;c2&gt;1.0&lt;/c2&gt;
  &lt;k&gt;100.0&lt;/k&gt;
&lt;/material&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.1.3.19">4.1.3.19</a> Ogden Unconstrained<a class="Label" name="subsec:Ogden-Unconstrained"> </a>
</h4>
<div class="Unindented">
This material describes a compressible (unconstrained) hyperelastic Ogden material<span class="small"> <span class="bibcites">[<a class="bibliocite" name="cite-32" href="#biblio-32"><span class="bib-index">32</span></a>]</span></span><span class="default">. The following material parameters must be defined:</span>
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;c[n]&gt;
</td>
<td align="left" valign="top">
Coefficient of n<span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{th}}
</script>
</span> term, where n can range from 1 to 6
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;m[n]&gt;
</td>
<td align="left" valign="top">
Exponent of n<span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{th\thinspace}}
</script>
</span>term, where n can range from 1 to 6 
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;cp&gt;
</td>
<td align="left" valign="top">
Bulk-like modulus
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
The hyperelastic strain energy function for this material is given in terms of the eigenvalues of the right or left stretch tensor: <span class="MathJax_Preview">
<script type="math/tex;mode=display">

W\left(\lambda_{1},\lambda_{2},\lambda_{3}\right)=\frac{1}{2}c_{p}\left(J-1\right)^{2}+\sum\limits _{i=1}^{N}\frac{c_{i}}{m_{i}^{2}}\left(\lambda_{1}^{m_{i}}+\lambda_{2}^{m_{i}}+\lambda_{3}^{m_{i}}-3-m_{i}\ln J\right).

</script>

</span>
Here, <span class="MathJax_Preview"><script type="math/tex">
\lambda_{i}^{2}
</script>
</span> are the eigenvalues of the right or left Cauchy deformation tensor, <span class="MathJax_Preview"><script type="math/tex">
c_{p}
</script>
</span>, <span class="MathJax_Preview"><script type="math/tex">
c_{i}
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
m_{i}
</script>
</span>are material coefficients and <span class="MathJax_Preview"><script type="math/tex">
N
</script>
</span> ranges from 1 to 6. Any material parameters that are not specified by the user are assumed to be zero.
</div>
<div class="Indented">
<i>Example</i>:
</div>
<pre class="LyX-Code">
&lt;material id="1" type="Ogden unconstrained"&gt;
  &lt;m1&gt;2.4&lt;/m1&gt;
  &lt;c1&gt;1&lt;/c1&gt;
  &lt;cp&gt;2&lt;/cp&gt;
&lt;/material&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.1.3.20">4.1.3.20</a> Perfect Osmometer Equilibrium Osmotic Pressure<a class="Label" name="subsec:Perfect-Osmometer-Equilibrium"> </a>
</h4>
<div class="Unindented">
The material type for a perfect osmometer equilibrium swelling pressure is &ldquo;<i>perfect osmometer</i>&rdquo;. The swelling pressure is described by the equations for a perfect osmometer, assuming that the material is porous, containing an interstitial solution whose solutes cannot be exchanged with the external bathing environment; similarly, solutes in the external bathing solution cannot be exchanged with the interstitial fluid of the porous material. Therefore, osmotic pressurization occurs when there is an imbalance between the interstitial and bathing solution osmolarities. Since osmotic swelling must be resisted by a solid matrix, this material is not stable on its own. It must be combined with an elastic material that resists the swelling, using a &ldquo;<i>solid mixture</i>&rdquo; container as described in Section <a class="Reference" href="#subsec:Solid-Mixture">4.1.3.21↓</a>. The following material parameters need to be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;phiw0&gt;
</td>
<td align="left" valign="top" style="width: 3in;">
gel porosity (fluid volume fraction) in reference (strain-free) configuration, <span class="MathJax_Preview"><script type="math/tex">
\varphi_{0}^{w}
</script>
</span>
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;iosm&gt;
</td>
<td align="left" valign="top" style="width: 3in;">
interstitial fluid osmolarity in reference configuration, <span class="MathJax_Preview"><script type="math/tex">
\bar{c}_{0}
</script>
</span>
</td>
<td align="left" valign="top">
[<b>n</b>/<b>L</b><span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{3}}
</script>
</span>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;bosm&gt;
</td>
<td align="left" valign="top" style="width: 3in;">
external bath osmolarity, <span class="MathJax_Preview"><script type="math/tex">
\bar{c}^{\ast}
</script>
</span>
</td>
<td align="left" valign="top">
[<b>n</b>/<b>L</b><span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{3}}
</script>
</span>] 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
The Cauchy stress for this material is the stress from the perfect osmometer equilibrium response: <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\boldsymbol{\sigma}=-\pi\mathbf{I},

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
\pi
</script>
</span> is the osmotic pressure, given by <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\pi=RT\left(\bar{c}-\bar{c}^{\ast}\right)\,.

</script>

</span>
<span class="MathJax_Preview"><script type="math/tex">
\bar{c}
</script>
</span> is the interstitial fluid in the current configuration, related to the reference configuration via <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\bar{c}=\frac{\varphi_{0}^{w}}{J-1+\varphi_{0}^{w}}\bar{c}_{0}\,,

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
J=\det\mathbf{F}
</script>
</span> is the relative volume. The values of the universal gas constant <span class="MathJax_Preview"><script type="math/tex">
R
</script>
</span> and absolute temperature <span class="MathJax_Preview"><script type="math/tex">
T
</script>
</span> must be specified as global constants.
</div>
<div class="Indented">
Though this material is porous, this is not a full-fledged biphasic material as described in Section <a class="Reference" href="#sec:Biphasic-Materials">4.7↓</a> for example. The behavior described by this material is strictly valid only after the transient response of interstitial fluid and solute fluxes has subsided.
</div>
<div class="Indented">
<i>Example (using units of mm, N, s, nmol, K)</i>:
</div>
<div class="Indented">
Hyperosmotic loading of a cell with a membrane-impermeant solute, starting from isotonic conditions.
</div>
<pre class="LyX-Code">
&lt;material id="1" type="solid mixture"&gt;
  &lt;solid type="perfect osmometer"&gt;
    &lt;phiw0&gt;0.8&lt;/ phiw0&gt;
    &lt;iosm&gt;300&lt;/cF0&gt;
    &lt;bosm lc="1"&gt;1&lt;/bosm&gt;
  &lt;/solid&gt;
  &lt;solid type="neo-Hookean"&gt;
    &lt;E&gt;1.0&lt;/E&gt;
    &lt;v&gt;0&lt;/v&gt;
  &lt;/solid&gt;
&lt;/material&gt;
&lt;LoadData&gt;
  &lt;loadcurve id="1"&gt;
    &lt;loadpoint&gt;0,300&lt;/loadpoint&gt;
    &lt;loadpoint&gt;1,1500&lt;/loadpoint&gt;
  &lt;/loadcurve&gt;
&lt;/LoadData&gt;
&lt;Globals&gt;
  &lt;Constants&gt;
    &lt;R&gt;8.314e-6&lt;/R&gt;
    &lt;T&gt;310&lt;/T&gt;
  &lt;/Constants&gt;
&lt;/Globals&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.1.3.21">4.1.3.21</a> Solid Mixture<a class="Label" name="subsec:Solid-Mixture"> </a>
</h4>
<div class="Unindented">
This material describes a mixture of compressible elastic solids. It is a container for any combination of the materials described in Section <a class="Reference" href="#subsec:Compressible-Materials">4.1.3↑</a>.
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;solid&gt;
</td>
<td align="left" valign="top">
Container tag for compressible material 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
The mixture may consist of any number of solids. The stress tensor for the solid mixture is the sum of the stresses for all the solids.
</div>
<div class="Indented">
Material axes may be optionally specified within the &lt;material&gt; level, as well as within each &lt;solid&gt;. Within the &lt;material&gt; level, these represent the local element axes relative to the global coordinate system. Within the &lt;solid&gt;, they represent local material axes relative to the element. If material axes are specified at both levels, they are properly compounded to produce local material axes relative to the global coordinate system. Material axes specified in the &lt;ElementData&gt; section are equivalent to a specification at the &lt;material&gt; level: they correspond to local element axes relative to the global system.
</div>
<div class="Indented">
<i>Example</i>:
</div>
<pre class="LyX-Code">
&lt;material id="1" type="solid mixture"&gt;
  &lt;solid type="neo-Hookean"&gt;
    &lt;E&gt;1000.0&lt;/E&gt;
    &lt;v&gt;0.45&lt;/v&gt;
  &lt;/solid&gt;
  &lt;solid type="ellipsoidal fiber distribution"&gt;
    &lt;mat_axis type=”vector”&gt;
      &lt;a&gt;0.8660254, 0.5, 0&lt;/a&gt;
      &lt;d&gt;0,0,1&lt;/d&gt;
    &lt;/mat_axis&gt;
    &lt;ksi&gt;5, 1, 1&lt;/ksi&gt;
    &lt;beta&gt;2.5, 3, 3&lt;/beta&gt;
  &lt;/solid&gt;
  &lt;solid type="ellipsoidal fiber distribution"&gt;
    &lt;mat_axis type=”vector”&gt;
      &lt;a&gt;0.8660254,-0.5, 0&lt;/a&gt;
      &lt;d&gt;0,0,1&lt;/d&gt;
    &lt;/mat_axis&gt;
    &lt;ksi&gt;5, 1, 1&lt;/ksi&gt;
    &lt;beta&gt;2.5, 3, 3&lt;/beta&gt;
  &lt;/solid&gt;
&lt;/material&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.1.3.22">4.1.3.22</a> Spherical Fiber Distribution<a class="Label" name="subsec:Spherical-Fiber-Distribution"> </a>
</h4>
<div class="Unindented">
The material type for a spherical (isotropic) continuous fiber distribution is &ldquo;<i>spherical fiber distribution</i>&rdquo;. Since fibers can only sustain tension, this material is not stable on its own. It must be combined with a stable compressible material that acts as a ground matrix, using a &ldquo;<i>solid mixture</i>&rdquo; container as described in Section <a class="Reference" href="#subsec:Solid-Mixture">4.1.3.21↑</a>. The following material parameters need to be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;alpha&gt;
</td>
<td align="left" valign="top">
parameter <span class="MathJax_Preview"><script type="math/tex">
\alpha
</script>
</span>
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;beta&gt;
</td>
<td align="left" valign="top">
parameter <span class="MathJax_Preview"><script type="math/tex">
\beta
</script>
</span>
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;ksi&gt;
</td>
<td align="left" valign="top">
parameters <span class="MathJax_Preview"><script type="math/tex">
\xi
</script>
</span>
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
The Cauchy stress for this fibrous material is given by <span class="bibcites">[<a class="bibliocite" name="cite-25" href="#biblio-25"><span class="bib-index">25</span></a>, <a class="bibliocite" name="cite-7" href="#biblio-7"><span class="bib-index">7</span></a>, <a class="bibliocite" name="cite-4" href="#biblio-4"><span class="bib-index">4</span></a>]</span>: <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\boldsymbol{\sigma}=\int_{0}^{2\pi}\int_{0}^{\pi}H\left(I_{n}-1\right)\sigma_{n}\left(\mathbf{n}\right)\sin\varphi\,d\varphi\,d\theta\,.

</script>

</span>
Here, <span class="MathJax_Preview"><script type="math/tex">
I_{n}=\lambda_{n}^{2}=\mathbf{N}\cdot\mathbf{C}\cdot\mathbf{N}
</script>
</span> is the square of the fiber stretch <span class="MathJax_Preview"><script type="math/tex">
\lambda_{n}
</script>
</span>, <span class="MathJax_Preview"><script type="math/tex">
\mathbf{N}
</script>
</span> is the unit vector along the fiber direction, in the reference configuration, which in spherical angles is directed along <span class="MathJax_Preview"><script type="math/tex">
\left(\theta,\varphi\right)
</script>
</span>, <span class="MathJax_Preview"><script type="math/tex">
\mathbf{n}=\mathbf{F}\cdot\mathbf{N}/\lambda_{n}
</script>
</span>, and <span class="MathJax_Preview"><script type="math/tex">
H\left(.\right)
</script>
</span> is the unit step function that enforces the tension-only contribution.
</div>
<div class="Indented">
The fiber stress is determined from a fiber strain energy function, <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\sigma_{n}=\frac{2I_{n}}{J}\frac{\partial\Psi}{\partial I_{n}}\mathbf{n}\otimes\mathbf{n}\,,

</script>

</span>
where in this material, the fiber strain energy density is given by <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\Psi=\frac{\xi}{\alpha}\left(\exp\left[\alpha\left(I_{n}-1\right)^{\beta}\right]-1\right)\,,

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
\xi>0
</script>
</span>, <span class="MathJax_Preview"><script type="math/tex">
\alpha\geqslant0
</script>
</span>, and <span class="MathJax_Preview"><script type="math/tex">
\beta\geqslant2
</script>
</span>.
</div>
<div class="Indented">
Note: In the limit when <span class="MathJax_Preview"><script type="math/tex">
\alpha\to0
</script>
</span>, this expressions produces a power law, <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\lim\limits _{\alpha\to0}\Psi=\xi\left(I_{n}-1\right)^{\beta}

</script>

</span>
Note: When <span class="MathJax_Preview"><script type="math/tex">
\beta>2
</script>
</span>, the fiber modulus is zero at the strain origin (<span class="MathJax_Preview"><script type="math/tex">
I_{n}=1)
</script>
</span>. Therefore, use <span class="MathJax_Preview"><script type="math/tex">
\beta>2
</script>
</span> when a smooth transition in the stress is desired from compression to tension. 
</div>
<div class="Indented">
<i>Example</i>:
</div>
<pre class="LyX-Code">
&lt;material id="1" type="solid mixture"&gt;
  &lt;solid type="neo-Hookean"&gt;
    &lt;E&gt;1000.0&lt;/E&gt;
    &lt;v&gt;0.45&lt;/v&gt;
  &lt;/solid&gt;
  &lt;solid type="spherical fiber distribution"&gt;
    &lt;ksi&gt;10&lt;/ksi&gt;
    &lt;alpha&gt;0&lt;/alpha&gt;
    &lt;beta&gt;2.5&lt;/beta&gt;
  &lt;/solid&gt;
&lt;/material&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.1.3.23">4.1.3.23</a> Spherical Fiber Distribution from Solid-Bound Molecule<a class="Label" name="subsec:Spherical-Fiber-Distribution-SBM"> </a>
</h4>
<div class="Unindented">
The material type for a spherical (isotropic) continuous fiber distribution with fiber modulus dependent on solid-bound molecule content is &ldquo;<i>spherical fiber distribution sbm</i>&rdquo;. Since fibers can only sustain tension, this material is not stable on its own. It must be combined with a stable compressible material that acts as a ground matrix, using a &ldquo;<i>solid mixture</i>&rdquo; container as described in Section <a class="Reference" href="#subsec:Solid-Mixture">4.1.3.21↑</a>. The following material parameters need to be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;alpha&gt;
</td>
<td align="left" valign="top">
parameter <span class="MathJax_Preview"><script type="math/tex">
\alpha
</script>
</span>
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;beta&gt;
</td>
<td align="left" valign="top">
parameter <span class="MathJax_Preview"><script type="math/tex">
\beta
</script>
</span>
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;ksi0&gt;
</td>
<td align="left" valign="top">
fiber modulus <span class="MathJax_Preview"><script type="math/tex">
\xi_{0}
</script>
</span> 
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;gamma&gt;
</td>
<td align="left" valign="top">
fiber modulus exponent <span class="MathJax_Preview"><script type="math/tex">
\gamma
</script>
</span>
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;rho0&gt;
</td>
<td align="left" valign="top">
fiber mass density <span class="MathJax_Preview"><script type="math/tex">
\rho_{0}
</script>
</span> 
</td>
<td align="left" valign="top">
[<b>M</b>/<b>L</b><span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{3}}
</script>
</span>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
sbm
</td>
<td align="left" valign="top">
index of solid-bound molecule <span class="MathJax_Preview"><script type="math/tex">
\sigma
</script>
</span> 
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
The Cauchy stress for this fibrous material is given by <span class="bibcites">[<a class="bibliocite" name="cite-25" href="#biblio-25"><span class="bib-index">25</span></a>, <a class="bibliocite" name="cite-7" href="#biblio-7"><span class="bib-index">7</span></a>, <a class="bibliocite" name="cite-4" href="#biblio-4"><span class="bib-index">4</span></a>]</span>: <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\boldsymbol{\sigma}=\int_{0}^{2\pi}\int_{0}^{\pi}H\left(I_{n}-1\right)\sigma_{n}\left(\mathbf{n}\right)\sin\varphi\,d\varphi\,d\theta\,.

</script>

</span>
Here, <span class="MathJax_Preview"><script type="math/tex">
I_{n}=\lambda_{n}^{2}=\mathbf{N}\cdot\mathbf{C}\cdot\mathbf{N}
</script>
</span> is the square of the fiber stretch <span class="MathJax_Preview"><script type="math/tex">
\lambda_{n}
</script>
</span>, <span class="MathJax_Preview"><script type="math/tex">
\mathbf{N}
</script>
</span> is the unit vector along the fiber direction, in the reference configuration, which in spherical angles is directed along <span class="MathJax_Preview"><script type="math/tex">
\left(\theta,\varphi\right)
</script>
</span>, <span class="MathJax_Preview"><script type="math/tex">
\mathbf{n}=\mathbf{F}\cdot\mathbf{N}/\lambda_{n}
</script>
</span>, and <span class="MathJax_Preview"><script type="math/tex">
H\left(.\right)
</script>
</span> is the unit step function that enforces the tension-only contribution.
</div>
<div class="Indented">
The fiber stress is determined from a fiber strain energy function, <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\sigma_{n}=\frac{2I_{n}}{J}\frac{\partial\Psi}{\partial I_{n}}\mathbf{n}\otimes\mathbf{n}\,,

</script>

</span>
where in this material, the fiber strain energy density is given by <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\Psi=\frac{\xi}{\alpha}\left(\exp\left[\alpha\left(I_{n}-1\right)^{\beta}\right]-1\right)\,,

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
\xi>0
</script>
</span>, <span class="MathJax_Preview"><script type="math/tex">
\alpha\geqslant0
</script>
</span>, and <span class="MathJax_Preview"><script type="math/tex">
\beta\geqslant2
</script>
</span>. The fiber modulus is dependent on the solid-bound molecule referential density <span class="MathJax_Preview"><script type="math/tex">
\rho_{r}^{\sigma}
</script>
</span> according to the power law relation <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\xi=\xi_{0}\left(\frac{\rho_{r}^{\sigma}}{\rho_{0}}\right)^{\gamma}\,,

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
\rho_{0}
</script>
</span> is the density at which <span class="MathJax_Preview"><script type="math/tex">
\xi=\xi_{0}
</script>
</span>.
</div>
<div class="Indented">
This type of material references a solid-bound molecule that belongs to a multiphasic mixture. Therefore this material may only be used as the solid (or a component of the solid) in a multiphasic mixture (Section <a class="Reference" href="#sec:Triphasic-Multiphasic-Materials">4.9↓</a>). The solid-bound molecule must be defined in the &lt;Globals&gt; section (Section <a class="Reference" href="#subsec:Solid-Bound-Molecules">3.6.3↑</a>) and must be included in the multiphasic mixture using a &lt;solid_bound&gt; tag. The parameter <i>sbm</i> must refer to the global index of that solid-bound molecule. The value of <span class="MathJax_Preview"><script type="math/tex">
\rho_{r}^{\sigma}
</script>
</span> is specified within the &lt;solid_bound&gt; tag. If a chemical reaction is defined within that multiphasic mixture that alters the value of <span class="MathJax_Preview"><script type="math/tex">
\rho_{r}^{\sigma}
</script>
</span>, lower and upper bounds may be specified for this referential density within the &lt;solid_bound&gt; tag to prevent <span class="MathJax_Preview"><script type="math/tex">
\xi
</script>
</span> from reducing to zero or achieving excessively elevated values.
</div>
<div class="Indented">
Note: In the limit when <span class="MathJax_Preview"><script type="math/tex">
\alpha\to0
</script>
</span>, the expression for <span class="MathJax_Preview"><script type="math/tex">
\Psi
</script>
</span> produces a power law, <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\lim\limits _{\alpha\to0}\Psi=\xi\left(I_{n}-1\right)^{\beta}

</script>

</span>
Note: When <span class="MathJax_Preview"><script type="math/tex">
\beta>2
</script>
</span>, the fiber modulus is zero at the strain origin (<span class="MathJax_Preview"><script type="math/tex">
I_{n}=1)
</script>
</span>. Therefore, use <span class="MathJax_Preview"><script type="math/tex">
\beta>2
</script>
</span> when a smooth transition in the stress is desired from compression to tension. 
</div>
<div class="Indented">
<i>Example</i>:
</div>
<pre class="LyX-Code">
&lt;solid type="solid mixture"&gt;
  &lt;solid type="neo-Hookean"&gt;
    &lt;E&gt;1000.0&lt;/E&gt;
    &lt;v&gt;0.45&lt;/v&gt;
  &lt;/solid&gt;
  &lt;solid type="spherical fiber distribution sbm"&gt;
    &lt;alpha&gt;0&lt;/alpha&gt;
    &lt;beta&gt;2.5&lt;/beta&gt;
    &lt;ksi0&gt;10&lt;/ksi0&gt;
    &lt;gamma&gt;2&lt;/gamma&gt;
    &lt;rho0&gt;1&lt;/rho0&gt;
    &lt;sbm&gt;1&lt;/sbm&gt;
  &lt;/solid&gt;
&lt;/solid&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.1.3.24">4.1.3.24</a> Coupled Transversely Isotropic Mooney-Rivlin<a class="Label" name="subsec:Coupled-Transversely-Isotropic-MR"> </a>
</h4>
<div class="Unindented">
This material describes a transversely isotropic Mooney-Rivlin material using a fully-coupled formulation. It is define through the <i>coupled trans-iso Mooney-Rivlin </i>material type. The following material parameters must be defined.
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
c1
</td>
<td align="left" valign="top">
Mooney-Rivlin <span class="MathJax_Preview"><script type="math/tex">
c_{1}
</script>
</span> parameter.
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
c2
</td>
<td align="left" valign="top">
Mooney-Rivlin <span class="MathJax_Preview"><script type="math/tex">
c_{2}
</script>
</span> parameter.
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
c3
</td>
<td align="left" valign="top">
exponential multiplier 
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
c4
</td>
<td align="left" valign="top">
fiber scale factor
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
c5
</td>
<td align="left" valign="top">
fiber modulus in linear region
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
lam_max
</td>
<td align="left" valign="top">
maximum fiber straightening stretch 
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
k
</td>
<td align="left" valign="top">
bulk-like modulus
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
The strain-energy function for this constitutive model is defined by <span class="MathJax_Preview">
<script type="math/tex;mode=display">

W=c_{1}\left(I_{1}-3\right)+c_{2}\left(I_{2}-3\right)-2\left(c_{1}+2c_{2}\right)\ln J+F\left(\lambda\right)+U\left(J\right)

</script>

</span>
The first three terms define the coupled Mooney-Rivlin matrix response. The third term is the fiber response which is a function of the fiber stretch <span class="MathJax_Preview"><script type="math/tex">
\lambda
</script>
</span> and is defined as in <span class="bibcites">[<a class="bibliocite" name="cite-37" href="#biblio-37"><span class="bib-index">37</span></a>]</span>. For <span class="MathJax_Preview"><script type="math/tex">
U
</script>
</span>, the following form is chosen in FEBio. <span class="MathJax_Preview">
<script type="math/tex;mode=display">

U\left(J\right)=\frac{1}{2}k\left(\ln J\right)^{2}

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
J=\det\mathbf{F}
</script>
</span>is the Jacobian of the deformation.
</div>
<div class="Indented">
<i>Example:</i>
</div>
<pre class="LyX-Code">
&lt;material id="1" type="coupled trans-iso Mooney-Rivlin"&gt;
  &lt;c1&gt;1&lt;/c1&gt;
  &lt;c2&gt;0.1&lt;/c2&gt;
  &lt;c3&gt;1&lt;/c3&gt;
  &lt;c4&gt;1&lt;/c4&gt;
  &lt;c5&gt;1.34&lt;/c5&gt;
  &lt;lam_max&gt;1.3&lt;/lam_max&gt;
  &lt;k&gt;100&lt;/k&gt;
&lt;/material&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.1.3.25">4.1.3.25</a> Coupled Transversely Isotropic Veronda-Westmann<a class="Label" name="subsec:Coupled-Transversely-Isotropic-VW"> </a>
</h4>
<div class="Unindented">
This material describes a transversely isotropic Veronda-Westmann material using a fully-coupled formulation. It is define through the <i>coupled trans-iso Veronda-Westmann </i>material type. The following material parameters must be defined.
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
c1
</td>
<td align="left" valign="top">
Veronda-Westmann <span class="MathJax_Preview"><script type="math/tex">
c_{1}
</script>
</span> parameter.
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
c2
</td>
<td align="left" valign="top">
Veronda-Westmann <span class="MathJax_Preview"><script type="math/tex">
c_{2}
</script>
</span> parameter.
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
c3
</td>
<td align="left" valign="top">
exponential multiplier 
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
c4
</td>
<td align="left" valign="top">
fiber scale factor
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
c5
</td>
<td align="left" valign="top">
fiber modulus in linear region
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
lam_max
</td>
<td align="left" valign="top">
maximum fiber straightening stretch 
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
k
</td>
<td align="left" valign="top">
bulk-like modulus
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
The strain-energy function for this constitutive model is defined by <span class="MathJax_Preview">
<script type="math/tex;mode=display">

W=c_{1}\left(e^{c_{2}\left(I_{1}-3\right)}-1\right)-\frac{1}{2}c_{1}c_{2}\left(I_{2}-3\right)+F\left(\lambda\right)+U\left(J\right)\,.

</script>

</span>
The first two terms define the coupled Veronda-Westmann matrix response. The third term is the fiber response which is a function of the fiber stretch <span class="MathJax_Preview"><script type="math/tex">
\lambda
</script>
</span> and is defined as in <span class="bibcites">[<a class="bibliocite" name="cite-37" href="#biblio-37"><span class="bib-index">37</span></a>]</span>. For <span class="MathJax_Preview"><script type="math/tex">
U
</script>
</span>, the following form is chosen in FEBio. <span class="MathJax_Preview">
<script type="math/tex;mode=display">

U\left(J\right)=\frac{1}{2}k\left(\ln J\right)^{2}

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
J=\det\mathbf{F}
</script>
</span>is the Jacobian of the deformation.
</div>
<div class="Indented">
<i>Example:</i>
</div>
<pre class="LyX-Code">
&lt;material id="1" type="coupled trans-iso Veronda-Westmann"&gt;
  &lt;c1&gt;1&lt;/c1&gt;
  &lt;c2&gt;0.1&lt;/c2&gt;
  &lt;c3&gt;1&lt;/c3&gt;
  &lt;c4&gt;1&lt;/c4&gt;
  &lt;c5&gt;1.34&lt;/c5&gt;
  &lt;lam_max&gt;1.3&lt;/lam_max&gt;
  &lt;k&gt;100&lt;/k&gt;
&lt;/material&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.1.3.26">4.1.3.26</a> Large Poisson’s Ratio Ligament<a class="Label" name="subsec:Large-Poisson's-Ratio"> </a>
</h4>
<div class="Unindented">
This material describes a coupled, transversely isotropic material that will conform to a particular Poisson’s ratio when stretched along the fiber direction. The following material parameters must be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
c1
</td>
<td align="left" valign="top">
Fiber coefficient <span class="MathJax_Preview"><script type="math/tex">
c_{\mathrm{1}}
</script>
</span> 
</td>

</tr>
<tr>
<td align="left" valign="top">
c2 
</td>
<td align="left" valign="top">
Fiber coefficient <span class="MathJax_Preview"><script type="math/tex">
c_{\mathrm{2}}
</script>
</span> 
</td>

</tr>
<tr>
<td align="left" valign="top">
mu
</td>
<td align="left" valign="top">
Matrix coefficient <span class="MathJax_Preview"><script type="math/tex">
\mu
</script>
</span> 
</td>

</tr>
<tr>
<td align="left" valign="top">
v0
</td>
<td align="left" valign="top">
Poisson’s ratio parameter <span class="MathJax_Preview"><script type="math/tex">
v_{\mathrm{0}}
</script>
</span> 
</td>

</tr>
<tr>
<td align="left" valign="top">
m
</td>
<td align="left" valign="top">
Poisson’s ratio parameter <span class="MathJax_Preview"><script type="math/tex">
m
</script>
</span> 
</td>

</tr>
<tr>
<td align="left" valign="top">
k
</td>
<td align="left" valign="top">
Volumetric penalty coefficient <span class="MathJax_Preview"><script type="math/tex">
\kappa
</script>
</span> 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
The strain energy function for this constitutive model is a three part expression: <span class="MathJax_Preview">
<script type="math/tex;mode=display">

W=W_{\text{fiber}}+W_{\text{matrix}}+W_{\text{vol}},

</script>

</span>
where: <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\begin{aligned}W_{\text{fiber}} & =\frac{1}{2}\frac{c_{1}}{c_{2}}\left(e^{c_{2}\left({\lambda-1}\right)^{2}-1}\right),\\
W_{\text{matrix}} & =\frac{\mu}{2}\left(I_{1}-3\right)-\mu\ln\left(\sqrt{I_{3}}\right),\\
W_{\text{vol}} & =\frac{\kappa}{2}\left(\ln\left(\frac{I_{5}-I_{1}I_{4}+I_{2}}{I_{4}^{2(m-v_{0})}e^{-4m\left(\lambda-1\right)}}\right)\right)^{2}.
\end{aligned}

</script>

</span>
In the equations above, <span class="MathJax_Preview"><script type="math/tex">
\lambda
</script>
</span> is the stretch ratio of the material along the fiber direction. The desired Poisson’s ratio must first be selected based on available data for uniaxial tension along the fiber direction. The function with which to fit the Poisson’s ratio data is: <span class="MathJax_Preview">
<script type="math/tex;mode=display">

v=-\frac{\lambda^{m-v_{0}}e^{-m\left(\lambda-1\right)}-1}{\lambda-1}\,.

</script>

</span>
The volumetric penalty coefficient <span class="MathJax_Preview"><script type="math/tex">
\kappa
</script>
</span> must be selected to be large enough to enforce the Poisson’s function above. If this material is to be used in a biphasic representation, <span class="MathJax_Preview"><script type="math/tex">
\kappa
</script>
</span> must be selected based on experimental stress-relaxation data, since <span class="MathJax_Preview"><script type="math/tex">
\kappa
</script>
</span> has an effect on the biphasic behavior of the material. Once <span class="MathJax_Preview"><script type="math/tex">
\kappa
</script>
</span>, <span class="MathJax_Preview"><script type="math/tex">
v_{0}
</script>
</span>, and <span class="MathJax_Preview"><script type="math/tex">
m
</script>
</span> are chosen, <span class="MathJax_Preview"><script type="math/tex">
c_{\mathrm{1}}
</script>
</span>, <span class="MathJax_Preview"><script type="math/tex">
c_{\mathrm{2}}
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
\mu
</script>
</span> should be selected by fitting the stress-strain behavior of the material to experimental data. The Cauchy stress of the material is given by: <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\boldsymbol{\sigma}=\frac{2}{J}\left(\left(W_{1}+I_{1}W_{2}\right)\mathbf{B}-W_{2}\mathbf{B}^{2}+W_{3}\left(I_{3}\mathbf{1}\right)+W_{4}I_{4}\left(\mathbf{a}\otimes\mathbf{a}\right)+W_{5}I_{4}\left(\mathbf{a}\otimes\mathbf{a}\cdot\mathbf{B}+\mathbf{B}\cdot\mathbf{a}\otimes\mathbf{a}\right)\right)

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
J
</script>
</span> is the jacobian of the deformation gradient <span class="MathJax_Preview"><script type="math/tex">
\mathbf{F}
</script>
</span>, <b><span class="MathJax_Preview"><script type="math/tex">
\mathbf{B}=\mathbf{F}\cdot\mathbf{F}^{T}
</script>
</span></b> is the left Cauchy-Green deformation tensor, <b><span class="MathJax_Preview"><script type="math/tex">
\mathbf{1}
</script>
</span></b> is the <span class="MathJax_Preview"><script type="math/tex">
3\times3
</script>
</span> identity tensor<b>, <span class="MathJax_Preview"><script type="math/tex">
\mathbf{a}
</script>
</span> </b>is the fiber orientation vector in the deformed configuration.
</div>
<div class="Indented">
<i>Example:</i>
</div>
<pre class="LyX-Code">
&lt;material id="1" name="Material1" type="PRLig"&gt;
  &lt;c1&gt;90&lt;/c1&gt;
  &lt;c2&gt;160&lt;/c2&gt;
  &lt;mu&gt;0.025&lt;/mu&gt;
  &lt;v0&gt;5.85&lt;/v0&gt;
  &lt;m&gt;-100&lt;/m&gt;
  &lt;k&gt;1.55&lt;/k&gt;
&lt;/material&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h2 class="Section">
<a class="toc" name="toc-Section-4.2">4.2</a> Continuous Fiber Distribution<a class="Label" name="sec:Continuous-Fiber-Distribution"> </a>
</h2>
<div class="Unindented">
A continuous fiber distribution has a strain energy density that integrates the contributions from fiber bundles oriented along all directions emanating from a point in the continuum,<span class="MathJax_Preview">
<script type="math/tex;mode=display">

\Psi_{r}\left(\mathbf{C}\right)=\int_{A}H\left(I_{n}-1\right)R\left(\mathbf{n}\right)\Psi_{n}\left(I_{n}\right)\,dA\,,

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
\mathbf{n}
</script>
</span> is the unit vector along the fiber orientation in the reference configuration, <span class="MathJax_Preview"><script type="math/tex">
I_{n}=\mathbf{n}\cdot\mathbf{C}\cdot\mathbf{n}
</script>
</span> is the normal component of <span class="MathJax_Preview"><script type="math/tex">
\mathbf{C}
</script>
</span> along <span class="MathJax_Preview"><script type="math/tex">
\mathbf{n}
</script>
</span> (also the square of the stretch ratio along that direction), and <span class="MathJax_Preview"><script type="math/tex">
A
</script>
</span> represents the unit sphere (for 3D fiber distributions) or unit circle (for 2D fiber distributions) over which the integration is performed. Thus, <span class="MathJax_Preview"><script type="math/tex">
\mathbf{n}
</script>
</span> spans all directions from the origin to points on the unit sphere or unit circle. In the integrand, <span class="MathJax_Preview"><script type="math/tex">
\Psi_{n}
</script>
</span> represents the strain energy density of the fiber bundle oriented along <span class="MathJax_Preview"><script type="math/tex">
\mathbf{n}
</script>
</span>; <span class="MathJax_Preview"><script type="math/tex">
H\left(\cdot\right)
</script>
</span> is the Heaviside unit step function that includes only fibers that are in tension; and <span class="MathJax_Preview"><script type="math/tex">
R\left(\mathbf{n}\right)
</script>
</span> is the fiber density distribution function that specifies the spatial fractional distribution of fibers. This function satisfies the constraint<span class="MathJax_Preview">
<script type="math/tex;mode=display">

\int_{A}R\left(\mathbf{n}\right)\,dA=1\,.

</script>

</span>
For a material with an uncoupled strain energy density the corresponding expression is<span class="MathJax_Preview">
<script type="math/tex;mode=display">

\tilde{\Psi}_{r}\left(\tilde{\mathbf{C}}\right)=\int_{A}H\left(\tilde{I}_{n}-1\right)R\left(\mathbf{n}\right)\tilde{\Psi}_{n}\left(\tilde{I}_{n}\right)\,dA\,,

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
\tilde{I}_{n}=\mathbf{n}\cdot\tilde{\mathbf{C}}\cdot\mathbf{n}
</script>
</span>.
</div>
<div class="Indented">
<p><br/>
</p>

</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-4.2.1">4.2.1</a> Compressible Continuous Fiber Distribution<a class="Label" name="subsec:Compressible-Continuous-Fiber"> </a>
</h3>
<div class="Unindented">
The material type for a compressible continuous fiber distribution material is <i>&ldquo;continuous fiber distribution&rdquo;</i>. The following parameters must be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;fibers&gt;
</td>
<td align="left" valign="top">
Specification of the fiber material response <span class="MathJax_Preview"><script type="math/tex">
\Psi_{n}\left(I_{n}\right)
</script>
</span>
</td>
<td align="left" valign="top">

</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;distribution&gt;
</td>
<td align="left" valign="top">
Specification of the fiber density distribution <span class="MathJax_Preview"><script type="math/tex">
R\left(\mathbf{n}\right)
</script>
</span>
</td>
<td align="left" valign="top">

</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;scheme&gt;
</td>
<td align="left" valign="top">
Numerical integration scheme
</td>
<td align="left" valign="top">

</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
The &lt;fibers&gt; tag encloses a description of the fiber constitutive relation and associated material properties, as may be selected from the list provided in Section <a class="Reference" href="#subsec:Fibers">4.2.3↓</a>. The &lt;distribution&gt; tag encloses a description of the fiber density distribution function, as may be selected from the list presented in Section <a class="Reference" href="#subsec:Distribution">4.2.4↓</a>. The &lt;scheme&gt; tag specifies the numerical integration scheme, as may be selected from the list presented in Section <a class="Reference" href="#subsec:Scheme">4.2.5↓</a>.
</div>
<div class="Indented">
<i>Example</i>:
</div>
<pre class="LyX-Code">
&lt;material id="1" name="Material" type="solid mixture"&gt;
  &lt;solid type="neo-Hookean"&gt;
    &lt;density&gt;1&lt;/density&gt;
    &lt;E&gt;1&lt;/E&gt;
    &lt;v&gt;0.3&lt;/v&gt;
  &lt;/solid&gt;
  &lt;solid type="continuous fiber distribution"&gt;
    &lt;fibers type="fiber-exponential-power-law"&gt;
      &lt;alpha&gt;0&lt;/alpha&gt;
      &lt;beta&gt;2&lt;/beta&gt;
      &lt;ksi&gt;1&lt;/ksi&gt;
    &lt;/fibers&gt;
    &lt;distribution type="spherical"&gt;
    &lt;/distribution&gt;
    &lt;scheme type="fibers-3d-gkt"&gt;
      &lt;nph&gt;7&lt;/nph&gt;
      &lt;nth&gt;11&lt;/nth&gt;
    &lt;/scheme&gt;
  &lt;/solid&gt;
&lt;/material&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-4.2.2">4.2.2</a> Uncoupled Continuous Fiber Distribution<a class="Label" name="subsec:Uncoupled-Continuous-Fiber"> </a>
</h3>
<div class="Unindented">
The material type for an uncoupled continuous fiber distribution material is <i>&ldquo;continuous fiber distribution uncoupled&rdquo;</i>. The following parameters must be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;fibers&gt;
</td>
<td align="left" valign="top">
Specification of the fiber material response <span class="MathJax_Preview"><script type="math/tex">
\tilde{\Psi}_{n}\left(\tilde{I}_{n}\right)
</script>
</span>
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;distribution&gt;
</td>
<td align="left" valign="top">
Specification of the fiber density distribution <span class="MathJax_Preview"><script type="math/tex">
R\left(\mathbf{n}\right)
</script>
</span>
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;scheme&gt;
</td>
<td align="left" valign="top">
Numerical integration scheme
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
The &lt;fibers&gt; tag encloses a description of the fiber constitutive relation and associated material properties, as may be selected from the list provided in Section <a class="Reference" href="#subsec:Fibers">4.2.3↓</a>. The &lt;distribution&gt; tag encloses a description of the fiber density distribution function, as may be selected from the list presented in Section <a class="Reference" href="#subsec:Distribution">4.2.4↓</a>. The &lt;scheme&gt; tag specifies the numerical integration scheme, as may be selected from the list presented in Section <a class="Reference" href="#subsec:Scheme">4.2.5↓</a>.
</div>
<div class="Indented">
<i>Example</i>:
</div>
<pre class="LyX-Code">
&lt;material id="1" name="Material" type="uncoupled solid mixture"&gt;
  &lt;solid type="Mooney-Rivlin"&gt;
    &lt;density&gt;1&lt;/density&gt;
    &lt;c1&gt;1&lt;/c1&gt;
    &lt;c2&gt;0.3&lt;/c2&gt;
  &lt;/solid&gt;
  &lt;solid type="continuous fiber distribution uncoupled"&gt;
    &lt;fibers type="fiber-exponential-power-law-uncoupled"&gt;
      &lt;alpha&gt;0&lt;/alpha&gt;
      &lt;beta&gt;2&lt;/beta&gt;
      &lt;ksi&gt;1&lt;/ksi&gt;
    &lt;/fibers&gt;
    &lt;distribution type="spherical"&gt;
    &lt;/distribution&gt;
    &lt;scheme type="fibers-3d-gkt-uncoupled"&gt;
      &lt;nph&gt;7&lt;/nph&gt;
      &lt;nth&gt;11&lt;/nth&gt;
    &lt;/scheme&gt;
  &lt;/solid&gt;
&lt;/material&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-4.2.3">4.2.3</a> Fibers<a class="Label" name="subsec:Fibers"> </a>
</h3>
<div class="Unindented">
A fiber material is needed in the specification of a continuous fiber distribution. Use the uncoupled version of the fiber material when modeling an uncoupled continuous fiber distribution.
</div>
<div class="Indented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.2.3.1">4.2.3.1</a> Fiber with Exponential-Power Law<a class="Label" name="subsec:Fiber-with-Exponential-Power"> </a>
</h4>
<div class="Unindented">
This material type is &ldquo;<i>fiber-exponential-power-law</i>&rdquo;. The following material parameters need to be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;ksi&gt;
</td>
<td align="left" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\xi,
</script>
</span> representing a measure of the fiber modulus
</td>
<td align="left" valign="top">
[<b>P</b>]
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;alpha&gt;
</td>
<td align="left" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\alpha,
</script>
</span> coefficient of exponential argument
</td>
<td align="left" valign="top">
[ ]
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;beta&gt;
</td>
<td align="left" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\beta,
</script>
</span> power of exponential argument
</td>
<td align="left" valign="top">
[ ]
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
The fiber strain energy density is given by <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\Psi_{n}\left(I_{n}\right)=\frac{\xi}{\alpha\beta}\left(\exp\left[\alpha\left(I_{n}-1\right)^{\beta}\right]-1\right)\,,

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
\xi>0
</script>
</span>, <span class="MathJax_Preview"><script type="math/tex">
\alpha\geqslant0
</script>
</span>, and <span class="MathJax_Preview"><script type="math/tex">
\beta\geqslant2
</script>
</span>.
</div>
<div class="Indented">
Note: In the limit when <span class="MathJax_Preview"><script type="math/tex">
\alpha\to0
</script>
</span>, this expressions produces a power law, <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\lim\limits _{\alpha\to0}\Psi_{n}\left(I_{n}\right)=\frac{\xi}{\beta}\left(I_{n}-1\right)^{\beta}\,.

</script>

</span>
Note: When <span class="MathJax_Preview"><script type="math/tex">
\beta>2
</script>
</span>, the fiber modulus is zero at the strain origin (<span class="MathJax_Preview"><script type="math/tex">
I_{n}=1)
</script>
</span>. Therefore, use <span class="MathJax_Preview"><script type="math/tex">
\beta>2
</script>
</span> when a smooth transition in the stress is desired from compression to tension.
</div>
<div class="Indented">
<i>Example</i>:
</div>
<pre class="LyX-Code">
&lt;fibers type="fiber-exponential-power-law"&gt;
  &lt;alpha&gt;5&lt;/alpha&gt;
  &lt;beta&gt;2&lt;/beta&gt;
  &lt;ksi&gt;1&lt;/ksi&gt;
&lt;/fibers&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.2.3.2">4.2.3.2</a> Fiber with Neo-Hookean Law<a class="Label" name="subsec:Fiber-with-Neo-Hookean"> </a>
</h4>
<div class="Unindented">
This material type is &ldquo;<i>fiber-NH</i>&rdquo;. The following material parameters need to be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;mu&gt;
</td>
<td align="left" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\mu,
</script>
</span> representing a measure of the fiber modulus
</td>
<td align="left" valign="top">
[<b>P</b>]
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
The fiber strain energy density is given by <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\Psi_{n}\left(I_{n}\right)=\frac{\mu}{4}\left(I_{n}-1\right)^{2}\,,

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
\mu>0
</script>
</span>.
</div>
<div class="Indented">
<i>Example</i>:
</div>
<pre class="LyX-Code">
&lt;fibers type="fiber-NH"&gt;
  &lt;mu&gt;1&lt;/mu&gt;
&lt;/fibers&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.2.3.3">4.2.3.3</a> Fiber with Toe-Linear Response<a class="Label" name="subsec:Fiber-with-Toe-Linear"> </a>
</h4>
<div class="Unindented">
This material type is &ldquo;<i>fiber-power-linear</i>&rdquo;. The following material parameters need to be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;E&gt;
</td>
<td align="left" valign="top" style="width: 3in;">
<span class="MathJax_Preview"><script type="math/tex">
E,
</script>
</span> the fiber modulus in the linear range (<span class="MathJax_Preview"><script type="math/tex">
E\geqslant0)
</script>
</span>
</td>
<td align="left" valign="top">
[<b>P</b>]
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;beta&gt;
</td>
<td align="left" valign="top" style="width: 3in;">
<span class="MathJax_Preview"><script type="math/tex">
\beta,
</script>
</span> the power-law exponent in the toe region (<span class="MathJax_Preview"><script type="math/tex">
\beta\geqslant2)
</script>
</span>
</td>
<td align="left" valign="top">
[ ]
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;lam0&gt;
</td>
<td align="left" valign="top" style="width: 3in;">
<span class="MathJax_Preview"><script type="math/tex">
\lambda_{0},
</script>
</span> the stretch ratio when the toe region transitions to the linear region (<span class="MathJax_Preview"><script type="math/tex">
\lambda_{0}>1)
</script>
</span>
</td>
<td align="left" valign="top">
[ ]
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
The fiber strain energy density is given by <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\Psi_{n}\left(I_{n}\right)=\begin{cases}
0 & I_{n}<1\\
\frac{\xi}{2\beta}\left(I_{n}-1\right)^{\beta} & 1\leqslant I_{n}\leqslant I_{0}\\
E\left(I_{0}^{1/2}-I_{n}^{1/2}\right)+B\left(I_{n}-I_{0}\right)+\Psi_{0} & I_{0}<I_{n}
\end{cases}\,,

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
I_{0}=\lambda_{0}^{2}
</script>
</span>, <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\xi=\frac{E}{2\left(\beta-1\right)}I_{0}^{-3/2}\left(I_{0}-1\right)^{2-\beta},\,B=\frac{EI_{0}^{-3/2}}{2}\left[\frac{\left(I_{0}-1\right)}{2\left(\beta-1\right)}+I_{0}\right],\,\Psi_{0}=\frac{\xi}{2\beta}\left(I_{0}-1\right)^{\beta}

</script>

</span>
<i>Example</i>:
</div>
<pre class="LyX-Code">
&lt;fibers type="fiber-power-linear"&gt;
  &lt;E&gt;1&lt;/E&gt;
  &lt;beta&gt;2.5&lt;/beta&gt;
  &lt;lam0&gt;1.06&lt;/lam0&gt;
&lt;/fibers&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.2.3.4">4.2.3.4</a> Fiber with Exponential-Power Law Uncoupled<a class="Label" name="subsec:Fiber-Exponential-Power-Uncoupled"> </a>
</h4>
<div class="Unindented">
This material type is &ldquo;<i>fiber-exponential-power-law-uncoupled</i>&rdquo;. The following material parameters need to be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;ksi&gt;
</td>
<td align="left" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\xi,
</script>
</span> representing a measure of the fiber modulus
</td>
<td align="left" valign="top">
[<b>P</b>]
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;alpha&gt;
</td>
<td align="left" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\alpha,
</script>
</span> coefficient of exponential argument
</td>
<td align="left" valign="top">
[ ]
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;beta&gt;
</td>
<td align="left" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\beta,
</script>
</span> power of exponential argument
</td>
<td align="left" valign="top">
[ ]
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
The fiber strain energy density is given by <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\tilde{\Psi}_{n}\left(\tilde{I}_{n}\right)=\frac{\xi}{\alpha\beta}\left(\exp\left[\alpha\left(\tilde{I}_{n}-1\right)^{\beta}\right]-1\right)\,,

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
\xi>0
</script>
</span>, <span class="MathJax_Preview"><script type="math/tex">
\alpha\geqslant0
</script>
</span>, and <span class="MathJax_Preview"><script type="math/tex">
\beta\geqslant2
</script>
</span>.
</div>
<div class="Indented">
Note: In the limit when <span class="MathJax_Preview"><script type="math/tex">
\alpha\to0
</script>
</span>, this expressions produces a power law, <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\lim\limits _{\alpha\to0}\tilde{\Psi}_{n}\left(\tilde{I}_{n}\right)=\frac{\xi}{\beta}\left(\tilde{I}_{n}-1\right)^{\beta}\,.

</script>

</span>
Note: When <span class="MathJax_Preview"><script type="math/tex">
\beta>2
</script>
</span>, the fiber modulus is zero at the strain origin (<span class="MathJax_Preview"><script type="math/tex">
\tilde{I}_{n}=1)
</script>
</span>. Therefore, use <span class="MathJax_Preview"><script type="math/tex">
\beta>2
</script>
</span> when a smooth transition in the stress is desired from compression to tension.
</div>
<div class="Indented">
<i>Example</i>:
</div>
<pre class="LyX-Code">
&lt;fibers type="fiber-exponential-power-law-uncoupled"&gt;
  &lt;alpha&gt;5&lt;/alpha&gt;
  &lt;beta&gt;2&lt;/beta&gt;
  &lt;ksi&gt;1&lt;/ksi&gt;
&lt;/fibers&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.2.3.5">4.2.3.5</a> Fiber with Neo-Hookean Law Uncoupled<a class="Label" name="subsec:Fiber-Neo-Hookean-Uncoupled"> </a>
</h4>
<div class="Unindented">
This material type is &ldquo;<i>fiber-NH-uncoupled</i>&rdquo;. The following material parameters need to be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;mu&gt;
</td>
<td align="left" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\mu,
</script>
</span> representing a measure of the fiber modulus
</td>
<td align="left" valign="top">
[<b>P</b>]
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
The fiber strain energy density is given by <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\tilde{\Psi}_{n}\left(I_{n}\right)=\frac{\mu}{4}\left(\tilde{I}_{n}-1\right)^{2}\,,

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
\mu>0
</script>
</span>.
</div>
<div class="Indented">
<i>Example</i>:
</div>
<pre class="LyX-Code">
&lt;fibers type="fiber-NH-uncoupled"&gt;
  &lt;mu&gt;1&lt;/mu&gt;
&lt;/fibers&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-4.2.4">4.2.4</a> Distribution<a class="Label" name="subsec:Distribution"> </a>
</h3>
<div class="Unindented">
A fiber density distribution function is needed in the specification of a continuous fiber distribution.
</div>
<div class="Indented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.2.4.1">4.2.4.1</a> Spherical<a class="Label" name="subsec:Spherical"> </a>
</h4>
<div class="Unindented">
The fiber density distribution type &ldquo;<i>spherical</i>&rdquo; models an isotropic 3D distribution. This distribution corresponds to <span class="MathJax_Preview">
<script type="math/tex;mode=display">

R\left(\mathbf{n}\right)=\frac{1}{4\pi}\,.

</script>

</span>
It requires no additional parameters.
</div>
<div class="Indented">
<div class="center">
<img class="embedded" src="Figures/FigSphericalDistribution.png" alt="figure Figures/FigSphericalDistribution.png" style="max-width: 211px; max-height: 217px;"/>

</div>

</div>
<div class="Indented">
<i>Example</i>:
</div>
<pre class="LyX-Code">
&lt;distribution type="spherical"&gt;
&lt;/distribution&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.2.4.2">4.2.4.2</a> Ellipsoidal<a class="Label" name="subsec:Ellipsoidal"> </a>
</h4>
<div class="Unindented">
The fiber density distribution type &ldquo;<i>ellipsoidal</i>&rdquo; models a generally orthotropic 3D distribution. It corresponds to <span class="MathJax_Preview">
<script type="math/tex;mode=display">

R\left(\mathbf{n}\right)=C^{-1}\left[\left(\frac{n_{1}}{a}\right)^{2}+\left(\frac{n_{2}}{b}\right)^{2}+\left(\frac{n_{3}}{c}\right)^{2}\right]^{-1/2}\,,

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
\left(n_{1},n_{2},n_{3}\right)
</script>
</span> are the components of <span class="MathJax_Preview"><script type="math/tex">
\mathbf{n}
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
C
</script>
</span> is calculated to satisfy the integration constraint on <span class="MathJax_Preview"><script type="math/tex">
R\left(\mathbf{n}\right)
</script>
</span>. The parameters <span class="MathJax_Preview"><script type="math/tex">
\left(a,b,c\right)
</script>
</span> represents the semi-principal axes of the ellipsoid and must be positive. The following material parameters need to be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;spa&gt;
</td>
<td align="left" valign="top">
The semi-principal axes <span class="MathJax_Preview"><script type="math/tex">
\left(a,b,c\right)
</script>
</span> of the ellipsoid
</td>
<td align="left" valign="top">
[ ]
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
The value of <span class="MathJax_Preview"><script type="math/tex">
C
</script>
</span> is automatically adjusted to account for the values of the semi-principal axes <span class="MathJax_Preview"><script type="math/tex">
\left(a,b,c\right)
</script>
</span>. Therefore, only the relative ratios of these parameters matter.
</div>
<div class="Indented">
<div class="center">
<img class="embedded" src="Figures/FigEllipsoidalDistribution.png" alt="figure Figures/FigEllipsoidalDistribution.png" style="max-width: 430px; max-height: 221px;"/>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
<i>Example</i>:
</div>
<pre class="LyX-Code">
&lt;distribution type="ellipsoidal"&gt;
  &lt;spa&gt;3,2,1&lt;/spa&gt;
&lt;/distribution&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.2.4.3">4.2.4.3</a> <span class="MathJax_Preview"><script type="math/tex">
\pi-
</script>
</span>Periodic von Mises Distribution<a class="Label" name="subsec:Periodic-von-Mises"> </a>
</h4>
<div class="Unindented">
The fiber density distribution type &ldquo;<i>von-Mises-3d</i>&rdquo; models a transversely isotropic 3D distribution. It corresponds to <span class="MathJax_Preview">
<script type="math/tex;mode=display">

R\left(\mathbf{n}\right)=\frac{1}{\pi}\sqrt{\frac{b}{2\pi}}\frac{\exp\left(2bn_{1}^{2}\right)}{\mbox{erfi}\left(\sqrt{2b}\right)}\,,

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
\left(n_{1},n_{2},n_{3}\right)
</script>
</span> are the components of <span class="MathJax_Preview"><script type="math/tex">
\mathbf{n}
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
b
</script>
</span> is the concentration parameter (<span class="MathJax_Preview"><script type="math/tex">
b>0)
</script>
</span>. The following material parameters need to be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;b&gt;
</td>
<td align="left" valign="top">
The concentration parameter <span class="MathJax_Preview"><script type="math/tex">
b
</script>
</span> 
</td>
<td align="left" valign="top">
[ ]
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
<div class="center">
<img class="embedded" src="Figures/FigPiPeriodicVonMisesDistribution.png" alt="figure Figures/FigPiPeriodicVonMisesDistribution.png" style="max-width: 471px; max-height: 233px;"/>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
<i>Example</i>:
</div>
<pre class="LyX-Code">
&lt;distribution type="von-Mises-3d"&gt;
  &lt;b&gt;0.5&lt;/b&gt;
&lt;/distribution&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.2.4.4">4.2.4.4</a> Circular<a class="Label" name="subsec:Circular"> </a>
</h4>
<div class="Unindented">
The fiber density distribution type &ldquo;<i>circular</i>&rdquo; models a transversely isotropic 2D distribution. This distribution corresponds to <span class="MathJax_Preview">
<script type="math/tex;mode=display">

R\left(\mathbf{n}\right)=\frac{1}{2\pi}\,.

</script>

</span>
It requires no additional parameters.
</div>
<div class="Indented">
<i>Example</i>:
</div>
<pre class="LyX-Code">
&lt;distribution type="circular"&gt;
&lt;/distribution&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.2.4.5">4.2.4.5</a> Elliptical<a class="Label" name="subsec:Elliptical"> </a>
</h4>
<div class="Unindented">
The fiber density distribution type &ldquo;<i>elliptical</i>&rdquo; models an orthotropic 2D distribution. This distribution corresponds to <span class="MathJax_Preview">
<script type="math/tex;mode=display">

R\left(\mathbf{n}\right)=C^{-1}\left[\left(\frac{n_{1}}{a}\right)^{2}+\left(\frac{n_{2}}{b}\right)^{2}\right]^{-1/2}

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
\left(n_{1},n_{2},n_{3}\right)
</script>
</span> are the components of <span class="MathJax_Preview"><script type="math/tex">
\mathbf{n}
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
\left(a,b\right)
</script>
</span> are the semi-principal axes of the ellipse. Here, <span class="MathJax_Preview"><script type="math/tex">
C=4bK\left(e\right)
</script>
</span> where <span class="MathJax_Preview"><script type="math/tex">
K
</script>
</span> is the complete elliptic integral of the first kind and <span class="MathJax_Preview">
<script type="math/tex;mode=display">

e=\sqrt{1-\frac{b^{2}}{a^{2}}}

</script>

</span>
is the ellipse eccentricity. The following material parameters need to be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;spa1&gt;
</td>
<td align="left" valign="top">
The semi-principal axis <span class="MathJax_Preview"><script type="math/tex">
a
</script>
</span> of the ellipse
</td>
<td align="left" valign="top">
[ ]
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;spa2&gt;
</td>
<td align="left" valign="top">
The semi-principal axis <span class="MathJax_Preview"><script type="math/tex">
b
</script>
</span> of the ellipse
</td>
<td align="left" valign="top">
[ ]
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
<div class="center">
<img class="embedded" src="Figures/FigEllipticalDistribution.png" alt="figure Figures/FigEllipticalDistribution.png" style="max-width: 430px; max-height: 360px;"/>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
<i>Example</i>:
</div>
<pre class="LyX-Code">
&lt;distribution type="elliptical"&gt;
  &lt;spa1&gt;8&lt;/spa1&gt;
  &lt;spa2&gt;1&lt;/spa2&gt;
&lt;/distribution&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.2.4.6">4.2.4.6</a> von Mises Distribution<a class="Label" name="subsec:von-Mises-Distribution"> </a>
</h4>
<div class="Unindented">
The fiber density distribution type &ldquo;<i>von-Mises-2d</i>&rdquo; models an orthotropic 2D distribution. This distribution corresponds to <span class="MathJax_Preview">
<script type="math/tex;mode=display">

R\left(\mathbf{n}\right)=\frac{\exp\left[b\left(2n_{1}^{2}-1\right)\right]}{2\pi I_{0}\left(b\right)}

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
\left(n_{1},n_{2},n_{3}\right)
</script>
</span> are the components of <span class="MathJax_Preview"><script type="math/tex">
\mathbf{n}
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
b
</script>
</span> is the concentration parameter (<span class="MathJax_Preview"><script type="math/tex">
b>0)
</script>
</span>. <span class="MathJax_Preview"><script type="math/tex">
I_{0}
</script>
</span> is the modified Bessel function of the first kind of order 0. The following material parameters need to be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;b&gt;
</td>
<td align="left" valign="top">
The concentration parameter <span class="MathJax_Preview"><script type="math/tex">
b
</script>
</span> 
</td>
<td align="left" valign="top">
[ ]
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
<div class="center">
<img class="embedded" src="Figures/FigVonMisesDistribution.png" alt="figure Figures/FigVonMisesDistribution.png" style="max-width: 431px; max-height: 337px;"/>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
<i>Example</i>:
</div>
<pre class="LyX-Code">
&lt;distribution type="von-Mises-2d"&gt;
  &lt;b&gt;3&lt;/b&gt;
&lt;/distribution&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-4.2.5">4.2.5</a> Scheme<a class="Label" name="subsec:Scheme"> </a>
</h3>
<div class="Unindented">
A numerical integration scheme is needed in the specification of a continuous fiber distribution to perform the integration over the unit sphere (3D) or the unit circle (2D). Use the uncoupled version of the scheme when modeling an uncoupled continuous fiber distribution.
</div>
<div class="Indented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.2.5.1">4.2.5.1</a> Gauss-Kronrod Trapezoidal Rule<a class="Label" name="subsec:Gauss-Kronrod-Trapezoidal-Rule"> </a>
</h4>
<div class="Unindented">
The scheme type for the Gauss-Kronrod trapezoidal rule is <i>&ldquo;fibers-3d-gkt&rdquo;</i> for compressible continuous fiber distributions, and <i>&ldquo;fibers-3d-gkt-uncoupled&rdquo;</i> for uncoupled continuous fiber distributions. This integration rule should only be used with 3D fiber density distributions. This scheme automatically limits the range of integration to fibers that are in tension. A Gauss-Kronrod quadrature rule is employed for integration across latitudes of the unit sphere. A trapezoidal rule is used for integration across longitudes. The following material parameters need to be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;nph&gt;
</td>
<td align="left" valign="top">
Number of integration points across latitudes
</td>
<td align="left" valign="top">
[ ]
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;nth&gt;
</td>
<td align="left" valign="top">
Number of integration points across longitudes
</td>
<td align="left" valign="top">
[ ]
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
The parameter &lt;nph&gt; must be one of the values 7, 11, 15, 19, 23 and 27. The parameter &lt;nth&gt; may be any number greater than 0. Odd values for &lt;nth&gt; produce more accurate results than even values. A recommended combination is nph=7 and nth=31. The total number of integration points is <span class="MathJax_Preview"><script type="math/tex">
N=
</script>
</span>nph ×nth. Increasing values of <span class="MathJax_Preview"><script type="math/tex">
N
</script>
</span> require increasing computational time.
</div>
<div class="Indented">
<i>Example (compressible)</i>:
</div>
<pre class="LyX-Code">
&lt;scheme type="fibers-3d-gkt"&gt;
  &lt;nph&gt;7&lt;/nph&gt;
  &lt;nth&gt;31&lt;/nth&gt;
&lt;/scheme&gt;
</pre>
<div class="Unindented">
<i>Example (uncoupled)</i>:
</div>
<pre class="LyX-Code">
&lt;scheme type="fibers-3d-gkt-uncoupled"&gt;
  &lt;nph&gt;7&lt;/nph&gt;
  &lt;nth&gt;31&lt;/nth&gt;
&lt;/scheme&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.2.5.2">4.2.5.2</a> Finite Element Integration Rule<a class="Label" name="subsec:Finite-Element-Integration"> </a>
</h4>
<div class="Unindented">
The scheme type for the finite element integration rule is <i>&ldquo;fibers-3d-fei&rdquo;</i> for compressible continuous fiber distributions, and <i>&ldquo;fibers-3d-fei-uncoupled&rdquo;</i> for uncoupled continuous fiber distributions. This integration rule should only be used with 3D fiber density distributions. This scheme discretizes the unit sphere into a set of <span class="MathJax_Preview"><script type="math/tex">
N
</script>
</span> spherical triangles of nearly identical surface areas. The unit normal <span class="MathJax_Preview"><script type="math/tex">
\mathbf{n}
</script>
</span> passes through the centroid of each surface element. The integration is performed as a summation over <span class="MathJax_Preview"><script type="math/tex">
N
</script>
</span>. For each direction <span class="MathJax_Preview"><script type="math/tex">
\mathbf{n}
</script>
</span> the stress is evaluated only if the fiber bundle is in tension along that direction. The following material parameters need to be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;resolution&gt;
</td>
<td align="left" valign="top">
the number of integration points <span class="MathJax_Preview"><script type="math/tex">
N
</script>
</span>
</td>
<td align="left" valign="top">
[ ]
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
The parameter &lt;resolution&gt; must be one of the values 20, 34, 60, 74, 196, 210, 396, 410, 596, 610, 796, 810, 996, 1010, 1196, 1210, 1396, 1410, 1596, 1610, and 1796. A recommended combination is nph=7 and nth=31. A conservative choice for producing accurate results under general loading conditions is <span class="MathJax_Preview"><script type="math/tex">
N=
</script>
</span>1610. Increasing values of <span class="MathJax_Preview"><script type="math/tex">
N
</script>
</span> require increasing computational time.
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><img class="embedded" src="Figures/FigFiniteElementIntegration.png" alt="figure Figures/FigFiniteElementIntegration.png" style="max-width: 163px; max-height: 193px;"/>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
<i>Example (compressible)</i>:
</div>
<pre class="LyX-Code">
&lt;scheme type="fibers-3d-fei"&gt;
  &lt;resolution&gt;1610&lt;/resolution&gt;
&lt;/scheme&gt;
</pre>
<div class="Unindented">
<i>Example (uncoupled)</i>:
</div>
<pre class="LyX-Code">
&lt;scheme type="fibers-3d-fei-uncoupled"&gt;
  &lt;resolution&gt;1610&lt;/resolution&gt;
&lt;/scheme&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.2.5.3">4.2.5.3</a> Trapezoidal Rule<a class="Label" name="subsec:Trapezoidal-Rule"> </a>
</h4>
<div class="Unindented">
The scheme type for the trapezoidal integration rule is <i>&ldquo;fibers-2d-trapezoidal&rdquo;</i> for compressible continuous fiber distributions, and <i>&ldquo;fibers-2d-trapezoidal-uncoupled&rdquo;</i> for uncoupled continuous fiber distributions. This integration rule should only be used with 2D fiber density distributions. This scheme discretizes the unit circle into a set of <span class="MathJax_Preview"><script type="math/tex">
N
</script>
</span> circular arcs of identical lengths. The unit normal <span class="MathJax_Preview"><script type="math/tex">
\mathbf{n}
</script>
</span> passes through the centroid of each arc element. The integration is performed as a summation over <span class="MathJax_Preview"><script type="math/tex">
N
</script>
</span>. For each direction <span class="MathJax_Preview"><script type="math/tex">
\mathbf{n}
</script>
</span> the stress is evaluated only if the fiber bundle is in tension along that direction. The following material parameters need to be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;nth&gt;
</td>
<td align="left" valign="top">
Number of integration points <span class="MathJax_Preview"><script type="math/tex">
N
</script>
</span>
</td>
<td align="left" valign="top">
[ ]
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
The parameter &lt;nth&gt; may be any number greater than 0. Odd values for &lt;nth&gt; produce more accurate results than even values.
</div>
<div class="Indented">
<i>Example (compressible)</i>:
</div>
<pre class="LyX-Code">
&lt;scheme type="fibers-2d-trapezoidal"&gt;
  &lt;nth&gt;31&lt;/nth&gt;
&lt;/scheme&gt;
</pre>
<div class="Unindented">
<i>Example (uncoupled)</i>:
</div>
<pre class="LyX-Code">
&lt;scheme type="fibers-2d-trapezoidal-uncoupled"&gt;
  &lt;nth&gt;31&lt;/nth&gt;
&lt;/scheme&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h2 class="Section">
<a class="toc" name="toc-Section-4.3">4.3</a> Viscoelastic Solids<a class="Label" name="sec:Viscoelastic-Solids"> </a>
</h2>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-4.3.1">4.3.1</a> Uncoupled Viscoelastic Materials<a class="Label" name="subsec:Uncoupled-Viscoelastic-Materials"> </a>
</h3>
<div class="Unindented">
These materials produce a viscoelastic response only for the deviatoric stress response. They must be used whenever the elastic response is uncoupled, as in the materials described in Section <a class="Reference" href="#subsec:Uncoupled-Materials">4.1.2↑</a>.
</div>
<div class="Indented">
The material type for these materials is &ldquo;uncoupled viscoelastic&rdquo;. The following parameters need to be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;t1&gt;-&lt;t6&gt;
</td>
<td align="left" valign="top">
relaxation times
</td>
<td align="left" valign="top">
[<b>t</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;g1&gt;-&lt;g6&gt;
</td>
<td align="left" valign="top">
viscoelastic coefficients
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;elastic&gt;
</td>
<td align="left" valign="top">
elastic component (must be an uncoupled elastic solid)
</td>
<td align="left" valign="top">

</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
<span class="MathJax_Preview">
<script type="math/tex;mode=display">

\mathbf{S}\left(t\right)=\int\limits _{-\infty}^{t}G\left(t-s\right)\frac{d\mathbf{S}^{e}}{ds}\,ds

</script>

</span>
For a uncoupled viscoelastic material, the second Piola Kirchhoff stress can be written as follows <span class="bibcites">[<a class="bibliocite" name="cite-30" href="#biblio-30"><span class="bib-index">30</span></a>]</span>: <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\mathbf{S}\left(t\right)=pJ\,\mathbf{C}^{-1}+J^{-2/3}\int\limits _{-\infty}^{t}G\left(t-s\right)\frac{d\left(\Dev\left[\mathbf{\tilde{S}}^{e}\right]\right)}{ds}\,ds\,,

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
\mathbf{\tilde{S}}^{e}
</script>
</span> is the elastic stress derived from <span class="MathJax_Preview"><script type="math/tex">
\tilde{W}\left(\mathbf{\tilde{C}}\right)
</script>
</span> (see Section <a class="Reference" href="#subsec:Uncoupled-Materials">4.1.2↑</a>) and <span class="MathJax_Preview"><script type="math/tex">
G
</script>
</span> is the relaxation function. It is assumed that the relaxation function is given by the following discrete relaxation spectrum: <span class="MathJax_Preview">
<script type="math/tex;mode=display">

G\left(t\right)=1+\sum\limits _{i=1}^{N}\gamma_{i}\exp\left(-t/\tau_{i}\right),

</script>

</span>
Note that the user does not have to enter all the <span class="MathJax_Preview"><script type="math/tex">
\tau_{i}
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
\gamma_{i}
</script>
</span> coefficients. Instead, only the values that are used need to be entered. So, if <span class="MathJax_Preview"><script type="math/tex">
N
</script>
</span> is 2, only <span class="MathJax_Preview"><script type="math/tex">
\tau_{1}
</script>
</span>, <span class="MathJax_Preview"><script type="math/tex">
\tau_{2}
</script>
</span>, <span class="MathJax_Preview"><script type="math/tex">
\gamma_{1}
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
\gamma_{2}
</script>
</span>have to be entered.
</div>
<div class="Indented">
The <i>elastic </i>parameter describes the elastic material as given in Section <a class="Reference" href="#subsec:Uncoupled-Materials">4.1.2↑</a>.
</div>
<div class="Indented">
<i>Example</i>:
</div>
<pre class="LyX-Code">
&lt;material id="1" name="Material 1" type="uncoupled viscoelastic"&gt;
  &lt;g1&gt;0.95&lt;/g1&gt;
  &lt;t1&gt;0.01&lt;/t1&gt;
  &lt;elastic type="Mooney-Rivlin"&gt;
    &lt;c1&gt;1&lt;/c1&gt;
    &lt;c2&gt;0.0&lt;/c2&gt;
    &lt;k&gt;100&lt;/k&gt;
  &lt;/elastic&gt;
&lt;/material&gt;
</pre>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-4.3.2">4.3.2</a> Compressible Viscoelastic Materials<a class="Label" name="subsec:Compressible-Viscoelastic-Materi"> </a>
</h3>
<div class="Unindented">
The material type for viscoelastic materials is &ldquo;<i>viscoelastic&rdquo;</i>. The following parameters need to be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;t1&gt;-&lt;t6&gt;
</td>
<td align="left" valign="top">
relaxation times
</td>
<td align="left" valign="top">
[<b>t</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;g1&gt;-&lt;g6&gt;
</td>
<td align="left" valign="top">
viscoelastic coefficients
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;elastic&gt;
</td>
<td align="left" valign="top">
elastic component (must be a compressible elastic solid)
</td>
<td align="left" valign="top">

</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
For a viscoelastic material, the second Piola Kirchhoff stress can be written as follows <span class="bibcites">[<a class="bibliocite" name="cite-30" href="#biblio-30"><span class="bib-index">30</span></a>]</span>: <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\mathbf{S}\left(t\right)=\int\limits _{-\infty}^{t}G\left(t-s\right)\frac{d\mathbf{S}^{e}}{ds}\,ds\,,

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
\mathbf{S}^{e}
</script>
</span> is the elastic stress and <span class="MathJax_Preview"><script type="math/tex">
G
</script>
</span> is the relaxation function. It is assumed that the relaxation function is given by the following discrete relaxation spectrum: <span class="MathJax_Preview">
<script type="math/tex;mode=display">

G\left(t\right)=1+\sum\limits _{i=1}^{N}\gamma_{i}\exp\left(-t/\tau_{i}\right)\,,

</script>

</span>
Note that the user does not have to enter all the <span class="MathJax_Preview"><script type="math/tex">
\tau_{i}
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
\gamma_{i}
</script>
</span> coefficients. Instead, only the values that are used need to be entered. So, if <span class="MathJax_Preview"><script type="math/tex">
N
</script>
</span> is 2, only <span class="MathJax_Preview"><script type="math/tex">
\tau_{1}
</script>
</span>, <span class="MathJax_Preview"><script type="math/tex">
\tau_{2}
</script>
</span>, <span class="MathJax_Preview"><script type="math/tex">
\gamma_{1}
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
\gamma_{2}
</script>
</span>have to be entered.
</div>
<div class="Indented">
The <i>elastic </i>parameter describes the elastic material as given in Section <a class="Reference" href="#subsec:Compressible-Materials">4.1.3↑</a>.
</div>
<div class="Indented">
<i>Example</i>:
</div>
<pre class="LyX-Code">
&lt;material id="1" name="Material 1" type="viscoelastic"&gt;
  &lt;g1&gt;0.95&lt;/g1&gt;
  &lt;t1&gt;0.01&lt;/t1&gt;
  &lt;elastic type="neo-Hookean"&gt;
    &lt;E&gt;1&lt;/E&gt;
    &lt;v&gt;0.0&lt;/v&gt;
  &lt;/elastic&gt;
&lt;/material&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h2 class="Section">
<a class="toc" name="toc-Section-4.4">4.4</a> Reactive Viscoelastic Solid<a class="Label" name="sec:Reactive-Viscoelastic-Solid"> </a>
</h2>
<div class="Unindented">
Reactive viscoelasticity models a material as a mixture of strong bonds, which are permanent, and weak bonds, which break and reform in response to loading <span class="bibcites">[<a class="bibliocite" name="cite-10" href="#biblio-10"><span class="bib-index">10</span></a>]</span>. Strong bonds produce the equilibrium elastic response, whereas weak bonds produce the transient viscous response. For a compressive reactive viscoelastic solid, the strain energy density is given by <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\Psi_{r}\left(\mathbf{F}\right)=\Psi_{r}^{e}\left(\mathbf{F}\right)+\sum\limits _{u}w^{u}\Psi_{0}^{b}\left(\mathbf{F}^{u}\right)

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
\Psi_{r}^{e}
</script>
</span> is the strain energy density of strong bonds and <span class="MathJax_Preview"><script type="math/tex">
\Psi_{0}^{b}
</script>
</span> is the strain energy density of weak bonds, when they all belong to the same generation. <span class="MathJax_Preview"><script type="math/tex">
\mathbf{F}
</script>
</span> is the deformation gradient of the strong bonds and the initial weak bond generation, wherease <span class="MathJax_Preview"><script type="math/tex">
\mathbf{F}^{u}
</script>
</span> is the relative deformation gradient for the <span class="MathJax_Preview"><script type="math/tex">
u-
</script>
</span>generation weak bonds, such that <span class="MathJax_Preview"><script type="math/tex">
\mathbf{F}^{u}=\mathbf{I}
</script>
</span> at time <span class="MathJax_Preview"><script type="math/tex">
u
</script>
</span>. In this expression, <span class="MathJax_Preview"><script type="math/tex">
w^{u}\left(\mathbf{X},t\right)
</script>
</span> is the mass fraction of <span class="MathJax_Preview"><script type="math/tex">
u-
</script>
</span>generation weak bonds, which evolves over time as described next. The summation is taken over all generations <span class="MathJax_Preview"><script type="math/tex">
u
</script>
</span> that were created prior to the current time <span class="MathJax_Preview"><script type="math/tex">
t
</script>
</span>.
</div>
<div class="Indented">
Any number of valid solutions may exist for <span class="MathJax_Preview"><script type="math/tex">
w^{u}
</script>
</span>, based on constitutive assumptions for the weak bond mass fraction supply <span class="MathJax_Preview"><script type="math/tex">
\hat{w}^{u}
</script>
</span>. In particular, for <span class="MathJax_Preview"><script type="math/tex">
u-
</script>
</span>generation bonds reforming in an unloaded state during the time interval <span class="MathJax_Preview"><script type="math/tex">
u\leqslant t<v
</script>
</span>, and subsequently breaking in response to loading at <span class="MathJax_Preview"><script type="math/tex">
t=v
</script>
</span>, Type I bond kinetics provides a solution of the form <span class="MathJax_Preview">
<script type="math/tex;mode=display">

w^{u}\left(\mathbf{X},t\right)=\begin{cases}
0 & t<u\\
f^{u}\left(\mathbf{X},t\right) & u\leqslant t<v\\
f^{u}\left(\mathbf{X},v\right)g\left(\mathbf{F}^{u}\left(v\right);\mathbf{X},t-v\right) & v\leqslant t
\end{cases}

</script>

</span>
where <span class="MathJax_Preview">
<script type="math/tex;mode=display">

f^{u}\left(\mathbf{X},t\right)=1-\sum\limits _{\gamma<u}w^{\gamma}\left(\mathbf{X},t\right)

</script>

</span>
and <span class="MathJax_Preview"><script type="math/tex">
g\left(\mathbf{F}^{u}\left(v\right);\mathbf{X},t-v\right)
</script>
</span> is a reduced relaxation function which may assume any number of valid forms. (A reduced relaxation function <span class="MathJax_Preview"><script type="math/tex">
g\left(t\right)
</script>
</span> satisfies <span class="MathJax_Preview"><script type="math/tex">
g\left(0\right)=1
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
g\left(t\to\infty\right)=0
</script>
</span>, and decreases monotonically with <span class="MathJax_Preview"><script type="math/tex">
t
</script>
</span>.) In particular, <span class="MathJax_Preview"><script type="math/tex">
g
</script>
</span> may depend on the strain at time <span class="MathJax_Preview"><script type="math/tex">
v
</script>
</span> relative to the reference configuration of the <span class="MathJax_Preview"><script type="math/tex">
u-
</script>
</span>generation. In the recursive expression above, the earliest generation <span class="MathJax_Preview"><script type="math/tex">
u=-\infty
</script>
</span>, which is initially at rest, produces <span class="MathJax_Preview"><script type="math/tex">
w^{u}\left(t\right)=1
</script>
</span> for <span class="MathJax_Preview"><script type="math/tex">
t<v
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
w^{u}\left(t\right)=g\left(\mathbf{F}^{u}\left(v\right);\mathbf{X},t-v\right)
</script>
</span> for <span class="MathJax_Preview"><script type="math/tex">
t\geqslant v
</script>
</span>; this latter expression seeds the recursion for subsequent generations. Therefore, providing a functional form for <span class="MathJax_Preview"><script type="math/tex">
g
</script>
</span> suffices to produce the solution for all bond generations <span class="MathJax_Preview"><script type="math/tex">
u
</script>
</span>.
</div>
<div class="Indented">
For Type II bond kinetics, the solution for the mass fractions is given by <span class="MathJax_Preview">
<script type="math/tex;mode=display">

w^{u}\left(t\right)=\begin{cases}
0 & t<u\\
1-g\left(t-u\right) & u\leqslant t<v\\
g\left(t-v\right)-g\left(t-u\right) & v\leqslant t
\end{cases}\,.

</script>

</span>
For this type of bond kinetics, the reduced relaxation function <span class="MathJax_Preview"><script type="math/tex">
g
</script>
</span> cannot depend on the magnitude of the strain, because strain-dependence might violate the constraint <span class="MathJax_Preview"><script type="math/tex">
0\leqslant w^{u}\leqslant1
</script>
</span>.
</div>
<div class="Indented">
For all bond kinetics, it is also possible to constrain the occurrence of the breaking-and-reforming reaction to specific forms of the strain. For example, the reaction may be allowed to proceed only in the case of dilatational strain, or only in the case of distortional strain.
</div>
<div class="Indented">
For a material with an uncoupled formulation, the strain energy density has the form <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\Psi_{r}\left(\mathbf{F}\right)=U\left(J\right)+\tilde{\Psi}_{r}^{e}\left(\mathbf{\tilde{F}}\right)+\sum\limits _{u}w^{u}\tilde{\Psi}_{0}^{b}\left(\mathbf{\tilde{F}}^{u}\right)

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
\mathbf{\tilde{F}}=J^{-1/3}\mathbf{F}
</script>
</span>.
</div>
<div class="Indented">
The material type for a compressive reactive viscoelastic solid is &ldquo;reactive viscoelastic&rdquo;. For the uncoupled formulation the material type is &ldquo;uncoupled reactive viscoelastic&rdquo;. The following parameters need to be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;kinetics&gt;
</td>
<td align="left" valign="top">
Bond kinetics type
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;trigger&gt;
</td>
<td align="left" valign="top">
Strain invariants that trigger weak bond breakage and reformation
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;elastic&gt;
</td>
<td align="left" valign="top">
Elastic (strong bond) material
</td>
<td align="left" valign="top">

</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;bond&gt;
</td>
<td align="left" valign="top">
Weak bond material
</td>
<td align="left" valign="top">

</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;relaxation&gt;
</td>
<td align="left" valign="top">
Reduced relaxation function
</td>
<td align="left" valign="top">

</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
The &lt;kinetics&gt; parameter should be set to 1 for Type I bond kinetics or 2 for Type II bond kinetics. The &lt;trigger&gt; parameter should be set 0 when weak bonds break and reform in response to any form of the strain; it should be set to 1 when the trigger is distortional strain; and it should be set to 2 when the trigger is dilatational strain. The &lt;elastic&gt; and &lt;bond&gt; materials may be selected from the list of compressible elastic materials given in Section <a class="Reference" href="#subsec:Compressible-Materials">4.1.3↑</a> (for &ldquo;reactive viscoelastic&rdquo;) or from the list of uncoupled elastic materials in Section <a class="Reference" href="#subsec:Uncoupled-Materials">4.1.2↑</a> (for &ldquo;uncoupled reactive viscoelastic&rdquo;). The &lt;relaxation&gt; material may be selected from the list provided in Section <a class="Reference" href="#subsec:Relaxation-Functions">4.4.1↓</a>.
</div>
<div class="Indented">
<i>Example</i>:
</div>
<pre class="LyX-Code">
&lt;material id="1" name="RV solid" type="reactive viscoelastic"&gt;
  &lt;kinetics&gt;1&lt;/kinetics&gt;
  &lt;trigger&gt;0&lt;/trigger&gt;
  &lt;elastic type="Holmes-Mow"&gt;
    &lt;density&gt;1&lt;/density&gt;
    &lt;E&gt;1&lt;/E&gt;
    &lt;v&gt;0.3&lt;/v&gt;
    &lt;beta&gt;0.5&lt;/beta&gt;
  &lt;/elastic&gt;
  &lt;bond type="Holmes-Mow"&gt;
    &lt;density&gt;1&lt;/density&gt;
    &lt;E&gt;1&lt;/E&gt;
    &lt;v&gt;0.3&lt;/v&gt;
    &lt;beta&gt;0.5&lt;/beta&gt;
  &lt;/bond&gt;
  &lt;relaxation type="relaxation-exponential"&gt;
    &lt;tau&gt;4&lt;/tau&gt;
  &lt;/relaxation&gt;
&lt;/material&gt;
</pre>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-4.4.1">4.4.1</a> Relaxation Functions<a class="Label" name="subsec:Relaxation-Functions"> </a>
</h3>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.4.1.1">4.4.1.1</a> Exponential<a class="Label" name="subsec:Exponential"> </a>
</h4>
<div class="Unindented">
The material type for this relaxation function is &ldquo;relaxation-exponential&rdquo;. The following material parameters need to be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;tau&gt;
</td>
<td align="left" valign="top">
Characteristic relaxation time <span class="MathJax_Preview"><script type="math/tex">
\tau
</script>
</span> 
</td>
<td align="left" valign="top">
[<b>t</b>] 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
The reduced relaxation function for this material type is given by <span class="MathJax_Preview">
<script type="math/tex;mode=display">

g\left(t\right)=e^{-t/\tau}

</script>

</span>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.4.1.2">4.4.1.2</a> Exponential Distortional<a class="Label" name="subsec:Exponential-Distortional"> </a>
</h4>
<div class="Unindented">
The material type for this relaxation function is &ldquo;relaxation-exp-distortion&rdquo;. The following material parameters need to be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;tau0&gt;
</td>
<td align="left" valign="top">
Characteristic relaxation time <span class="MathJax_Preview"><script type="math/tex">
\tau_{0}
</script>
</span>
</td>
<td align="left" valign="top">
[<b>t</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;tau1&gt;
</td>
<td align="left" valign="top">
Characteristic time <span class="MathJax_Preview"><script type="math/tex">
\tau_{1}
</script>
</span> 
</td>
<td align="left" valign="top">

</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;alpha&gt;
</td>
<td align="left" valign="top">
Power exponent <span class="MathJax_Preview"><script type="math/tex">
\alpha
</script>
</span> 
</td>
<td align="left" valign="top">

</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
The reduced relaxation function for this material type is given by <span class="MathJax_Preview">
<script type="math/tex;mode=display">

g\left(\mathbf{F}^{u}\left(v\right);t-v\right)=e^{-\left(t-v\right)/\tau\left[K_{2}^{u}\left(v\right)\right]}

</script>

</span>
where <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\tau\left[K_{2}^{u}\left(v\right)\right]=\tau_{0}+\tau_{1}\cdot\left(K_{2}^{u}\left(v\right)\right)^{\alpha}

</script>

</span>
In general, <span class="MathJax_Preview"><script type="math/tex">
K_{2}=\left|\dev\boldsymbol{\eta}\right|
</script>
</span> where <span class="MathJax_Preview"><script type="math/tex">
\boldsymbol{\eta}=\ln\mathbf{V}
</script>
</span> is the spatial natural (Hencky) strain tensor and <span class="MathJax_Preview"><script type="math/tex">
\mathbf{V}
</script>
</span> is the left stretch tensor. In this expression, <span class="MathJax_Preview"><script type="math/tex">
K_{2}^{u}
</script>
</span> is the second invariant of the natural strain tensor evaluated from the relative deformation gradient <span class="MathJax_Preview"><script type="math/tex">
\mathbf{F}^{u}
</script>
</span>. <span class="MathJax_Preview"><script type="math/tex">
K_{2}^{u}
</script>
</span> is evaluated at the time <span class="MathJax_Preview"><script type="math/tex">
v
</script>
</span> when weak bonds from the <span class="MathJax_Preview"><script type="math/tex">
u-
</script>
</span>generation start breaking.
</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.4.1.3">4.4.1.3</a> Fung<a class="Label" name="subsec:Fung"> </a>
</h4>
<div class="Unindented">
The material type for this relaxation function is &ldquo;relaxation-Fung&rdquo;. The following material parameters need to be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;tau1&gt;
</td>
<td align="left" valign="top">
Characteristic relaxation time <span class="MathJax_Preview"><script type="math/tex">
\tau_{1}
</script>
</span>
</td>
<td align="left" valign="top">
[<b>t</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;tau2&gt;
</td>
<td align="left" valign="top">
Characteristic time <span class="MathJax_Preview"><script type="math/tex">
\tau_{2}
</script>
</span> 
</td>
<td align="left" valign="top">
[<b>t</b>] 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
The reduced relaxation function for this material type is given by <span class="MathJax_Preview">
<script type="math/tex;mode=display">

g\left(t\right)=\tau_{2}e^{-t/\tau_{2}}-\tau_{1}e^{-t/\tau_{1}}+t\left[\Ei\left(-\frac{t}{\tau_{2}}\right)-\Ei\left(-\frac{t}{\tau_{1}}\right)\right]

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
\Ei\left(\cdot\right)
</script>
</span> is the exponential integral function.
</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.4.1.4">4.4.1.4</a> Park<a class="Label" name="subsec:Park"> </a>
</h4>
<div class="Unindented">
The material type for this relaxation function is &ldquo;relaxation-Park&rdquo;. The following material parameters need to be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;tau&gt;
</td>
<td align="left" valign="top">
Characteristic relaxation time <span class="MathJax_Preview"><script type="math/tex">
\tau
</script>
</span>
</td>
<td align="left" valign="top">
[<b>t</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;beta&gt;
</td>
<td align="left" valign="top">
Power exponent <span class="MathJax_Preview"><script type="math/tex">
\beta
</script>
</span> 
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
The reduced relaxation function for this material type is given by <span class="MathJax_Preview">
<script type="math/tex;mode=display">

g\left(t\right)=\frac{1}{1+\left(\frac{t}{\tau}\right)^{\beta}}

</script>

</span>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.4.1.5">4.4.1.5</a> Park Distortional<a class="Label" name="subsec:Park-Distortional"> </a>
</h4>
<div class="Unindented">
The material type for this relaxation function is &ldquo;relaxation-Park-distortion&rdquo;. The following material parameters need to be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;tau0&gt;
</td>
<td align="left" valign="top">
Characteristic relaxation time <span class="MathJax_Preview"><script type="math/tex">
\tau_{0}
</script>
</span>
</td>
<td align="left" valign="top">
[<b>t</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;beta0&gt;
</td>
<td align="left" valign="top">
Power exponent at zero strain <span class="MathJax_Preview"><script type="math/tex">
\beta_{0}
</script>
</span> 
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;tau1&gt;
</td>
<td align="left" valign="top">
Characteristic relaxation time <span class="MathJax_Preview"><script type="math/tex">
\tau_{1}
</script>
</span> 
</td>
<td align="left" valign="top">

</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;beta1&gt;
</td>
<td align="left" valign="top">
Power exponent at zero strain <span class="MathJax_Preview"><script type="math/tex">
\beta_{1}
</script>
</span> 
</td>
<td align="left" valign="top">

</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;alpha&gt;
</td>
<td align="left" valign="top">
Power exponent <span class="MathJax_Preview"><script type="math/tex">
\alpha
</script>
</span>
</td>
<td align="left" valign="top">

</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
The reduced relaxation function for this material type is given by <span class="MathJax_Preview">
<script type="math/tex;mode=display">

g\left(\mathbf{F}^{u}\left(v\right);t-v\right)=\frac{1}{1+\left(\frac{t-v}{\tau}\right)^{\beta}}

</script>

</span>
where <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\tau=\tau_{0}+\tau_{1}\cdot\left(K_{2}^{u}\left(v\right)\right)^{\alpha}

</script>

</span>
and <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\beta=\beta_{0}+\beta_{1}\cdot\left(K_{2}^{u}\left(v\right)\right)^{\alpha}

</script>

</span>
The definition of <span class="MathJax_Preview"><script type="math/tex">
K_{2}^{u}\left(v\right)
</script>
</span> is given in Section <a class="Reference" href="#subsec:Exponential-Distortional">4.4.1.2↑</a>.
</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.4.1.6">4.4.1.6</a> Power<a class="Label" name="subsec:Power"> </a>
</h4>
<div class="Unindented">
The material type for this relaxation function is &ldquo;relaxation-power&rdquo;. The following material parameters need to be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;tau&gt;
</td>
<td align="left" valign="top">
Characteristic relaxation time <span class="MathJax_Preview"><script type="math/tex">
\tau
</script>
</span>
</td>
<td align="left" valign="top">
[<b>t</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;beta&gt;
</td>
<td align="left" valign="top">
Power exponent <span class="MathJax_Preview"><script type="math/tex">
\beta
</script>
</span> 
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
The reduced relaxation function for this material type is given by <span class="MathJax_Preview">
<script type="math/tex;mode=display">

g\left(t\right)=\frac{1}{\left(1+\frac{t}{\tau}\right)^{\beta}}

</script>

</span>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.4.1.7">4.4.1.7</a> Power Distortional<a class="Label" name="subsec:Power-Distortional"> </a>
</h4>
<div class="Unindented">
The material type for this relaxation function is &ldquo;relaxation-power-distortion&rdquo;. The following material parameters need to be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;tau0&gt;
</td>
<td align="left" valign="top">
Characteristic relaxation time <span class="MathJax_Preview"><script type="math/tex">
\tau_{0}
</script>
</span>
</td>
<td align="left" valign="top">
[<b>t</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;beta0&gt;
</td>
<td align="left" valign="top">
Power exponent at zero strain <span class="MathJax_Preview"><script type="math/tex">
\beta_{0}
</script>
</span> 
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;tau1&gt;
</td>
<td align="left" valign="top">
Characteristic relaxation time <span class="MathJax_Preview"><script type="math/tex">
\tau_{1}
</script>
</span> 
</td>
<td align="left" valign="top">

</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;beta1&gt;
</td>
<td align="left" valign="top">
Power exponent at zero strain <span class="MathJax_Preview"><script type="math/tex">
\beta_{1}
</script>
</span> 
</td>
<td align="left" valign="top">

</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;alpha&gt;
</td>
<td align="left" valign="top">
Power exponent <span class="MathJax_Preview"><script type="math/tex">
\alpha
</script>
</span>
</td>
<td align="left" valign="top">

</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
The reduced relaxation function for this material type is given by <span class="MathJax_Preview">
<script type="math/tex;mode=display">

g\left(\mathbf{F}^{u}\left(v\right);t-v\right)=\frac{1}{\left(1+\frac{t-v}{\tau}\right)^{\beta}}

</script>

</span>
where <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\tau=\tau_{0}+\tau_{1}\cdot\left(K_{2}^{u}\left(v\right)\right)^{\alpha}

</script>

</span>
and <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\beta=\beta_{0}+\beta_{1}\cdot\left(K_{2}^{u}\left(v\right)\right)^{\alpha}

</script>

</span>
The definition of <span class="MathJax_Preview"><script type="math/tex">
K_{2}^{u}\left(v\right)
</script>
</span> is given in Section <a class="Reference" href="#subsec:Exponential-Distortional">4.4.1.2↑</a>.
</div>
<div class="Indented">
<p><br/>
</p>

</div>
<h2 class="Section">
<a class="toc" name="toc-Section-4.5">4.5</a> Reactive Damage Mechanics<a class="Label" name="sec:Reactive-Damage-Mechanics"> </a>
</h2>
<div class="Unindented">
A material may accumulate damage over a single cycle or multiple cycles of loading which alters its properties. In the classical framework of damage mechanics this attenuation of the material properties is described by a single scalar damage variable <span class="MathJax_Preview"><script type="math/tex">
D
</script>
</span> when the material is isotropic (<span class="MathJax_Preview"><script type="math/tex">
0\leqslant D\leqslant1)
</script>
</span>. For anisotropic materials however, classical frameworks require that we introduce a function of the fourth-order damage tensor <span class="MathJax_Preview"><script type="math/tex">
\mathcal{D}
</script>
</span> to account for anisotropic damage. In FEBio, we use a reactive damage mechanics framework where the elastic response is proportional to the total number of intact bonds in the material and where, at any given time in the loading history, <span class="MathJax_Preview"><script type="math/tex">
D
</script>
</span> represents the mass fraction of bonds that have broken. In this reactive framework, it is possible to also model damage in anisotropic materials by assuming that multiple bond types exist in the material, each of which may get damaged under different circumstances. Each bond type <span class="MathJax_Preview"><script type="math/tex">
b
</script>
</span> may be described by a distinct solid constituent within a solid mixture (see Sections <a class="Reference" href="#subsec:Uncoupled-Solid-Mixture">4.1.2.15↑</a> and <a class="Reference" href="#subsec:Solid-Mixture">4.1.3.21↑</a>), each having its own scalar damage variable <span class="MathJax_Preview"><script type="math/tex">
D^{b}
</script>
</span>.
</div>
<div class="Indented">
For a given bond type, the strain energy density <span class="MathJax_Preview"><script type="math/tex">
\Psi_{r}\left(D,\mathbf{F}\right)
</script>
</span> of a damaged material is given by <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\Psi_{r}=\left(1-D\right)\Psi_{0}\,,

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
\Psi_{0}\left(\mathbf{F}\right)
</script>
</span> is the strain energy density when all bonds of that type are intact. Here, <span class="MathJax_Preview"><script type="math/tex">
1-D
</script>
</span> represents the mass fraction of bonds that remains intact. Similarly, the Cauchy stress <span class="MathJax_Preview"><script type="math/tex">
\boldsymbol{\sigma}\left(D,\mathbf{F}\right)
</script>
</span> of the damaged material is given by <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\boldsymbol{\sigma}=\left(1-D\right)\boldsymbol{\sigma}_{0}\,,

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
\boldsymbol{\sigma}_{0}\left(\mathbf{F}\right)
</script>
</span> is the stress in the intact material, at a given strain, as derived from <span class="MathJax_Preview"><script type="math/tex">
\Psi_{0}\left(\mathbf{F}\right)
</script>
</span>. The intact material may be based on any of the elastic materials described in Sections <a class="Reference" href="#subsec:Uncoupled-Materials">4.1.2↑</a> and <a class="Reference" href="#subsec:Compressible-Materials">4.1.3↑</a>.
</div>
<div class="Indented">
The evolution of the damage variable <span class="MathJax_Preview"><script type="math/tex">
D
</script>
</span> is determined by a user-selected scalar damage criterion measure <span class="MathJax_Preview"><script type="math/tex">
\Xi\left(\mathbf{F}\right)
</script>
</span> (<span class="MathJax_Preview"><script type="math/tex">
\Xi
</script>
</span> is the capital form of <span class="MathJax_Preview"><script type="math/tex">
\xi)
</script>
</span>. For example, <span class="MathJax_Preview"><script type="math/tex">
\Xi\left(\mathbf{F}\right)
</script>
</span> may represent the strain energy density, or von Mises stress, or maximum principal normal strain, etc. If <span class="MathJax_Preview"><script type="math/tex">
\Xi\left(\mathbf{F}\right)
</script>
</span> exceeds a given threshold at some state of deformation <span class="MathJax_Preview"><script type="math/tex">
\mathbf{F}
</script>
</span>, then damage may initiate or progress further. If all bonds fail at a single threshold value <span class="MathJax_Preview"><script type="math/tex">
\Xi_{m}
</script>
</span>, the material undergoes fracture. More commonly, bonds may fail with increasing probability as <span class="MathJax_Preview"><script type="math/tex">
\Xi
</script>
</span> increases over a given range. Consequently, the evolution of damage may be based on a user-selected cumulative distribution function (c.d.f.) <span class="MathJax_Preview"><script type="math/tex">
F\left(\Xi\right)
</script>
</span>, such that <span class="MathJax_Preview"><script type="math/tex">
D\left(t\right)=F\left(\Xi_{m}\right)
</script>
</span> where <span class="MathJax_Preview"><script type="math/tex">
\Xi_{m}
</script>
</span> is the maximum value of <span class="MathJax_Preview"><script type="math/tex">
\Xi
</script>
</span> achieved over the loading history up until the current time <span class="MathJax_Preview"><script type="math/tex">
t
</script>
</span>.
</div>
<div class="Indented">
<p><br/>
</p>

</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-4.5.1">4.5.1</a> General Specification of Damage Materials<a class="Label" name="subsec:General-Specification-Damage"> </a>
</h3>
<div class="Unindented">
The material types for damage materials are <i>&ldquo;elastic damage&rdquo;</i> and <i>&ldquo;uncoupled elastic damage&rdquo;</i>. The following parameters must be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;elastic&gt;
</td>
<td align="left" valign="top">
Specification of the elastic material
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;damage&gt;
</td>
<td align="left" valign="top">
Specification of the cumulative distribution function <span class="MathJax_Preview"><script type="math/tex">
F\left(\Xi\right)
</script>
</span>
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;criterion&gt;
</td>
<td align="left" valign="top">
Specification of the damage criterion <span class="MathJax_Preview"><script type="math/tex">
\Xi
</script>
</span> 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
The &lt;elastic&gt; tag encloses a description of the constitutive relation of the intact elastic material and associated material properties, as may be selected from the list provided in Section <a class="Reference" href="#subsec:Compressible-Materials">4.1.3↑</a> for compressible materials (used with <i>&ldquo;elastic damage&rdquo;</i>) and Section <a class="Reference" href="#subsec:Uncoupled-Materials">4.1.2↑</a> for uncoupled materials (used with <i>&ldquo;uncoupled elastic damage&rdquo;</i>). The &lt;damage&gt; tag encloses a description of the cumulative distribution function and associated material properties, as may be selected from the list presented in Section <a class="Reference" href="#subsec:Cumulative-Distribution-Function">4.5.2↓</a>. The &lt;criterion&gt; tag encloses a description of the damage criterion, as may be selected from the list presented in Section <a class="Reference" href="#subsec:Damage-Criterion">4.5.3↓</a>.
</div>
<div class="Indented">
<i>Example:</i>
</div>
<pre class="LyX-Code">
&lt;material id=”1” type="elastic damage"&gt;
  &lt;elastic type="neo-Hookean"&gt;
    &lt;density&gt;1&lt;/density&gt;
    &lt;E&gt;0.13&lt;/E&gt;
    &lt;v&gt;0.3&lt;/v&gt;
  &lt;/elastic&gt;
  &lt;damage type="CDF Weibull"&gt;
    &lt;alpha&gt;8&lt;/alpha&gt;
    &lt;mu&gt;0.3&lt;/mu&gt;
    &lt;Dmax&gt;1&lt;/Dmax&gt;
  &lt;/damage&gt;
  &lt;criterion type="DC max normal Lagrange strain"&gt;
  &lt;/criterion&gt;
&lt;/material&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-4.5.2">4.5.2</a> Cumulative Distribution Functions<a class="Label" name="subsec:Cumulative-Distribution-Function"> </a>
</h3>
<div class="Unindented">
Cumulative distribution functions provide the function <span class="MathJax_Preview"><script type="math/tex">
F\left(\Xi\right)
</script>
</span> that determines the evolution of the damage variable <span class="MathJax_Preview"><script type="math/tex">
D
</script>
</span> based on the maximum value of the failure criterion <span class="MathJax_Preview"><script type="math/tex">
\Xi
</script>
</span> up until the current time.
</div>
<div class="Indented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.5.2.1">4.5.2.1</a> Simo<a class="Label" name="subsec:Simo"> </a>
</h4>
<div class="Unindented">
<a class="Label" name="para:mylabel47"> </a> The material type for Simo’s c.d.f. <span class="bibcites">[<a class="bibliocite" name="cite-33" href="#biblio-33"><span class="bib-index">33</span></a>]</span> is &ldquo;<i>CDF Simo&rdquo;</i>. The following material parameters must be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;a&gt;
</td>
<td align="left" valign="top">
Parameter <span class="MathJax_Preview"><script type="math/tex">
\alpha
</script>
</span> (same units as <span class="MathJax_Preview"><script type="math/tex">
\Xi
</script>
</span>, <span class="MathJax_Preview"><script type="math/tex">
\alpha>0)
</script>
</span>
</td>
<td align="left" valign="top">
[<span class="MathJax_Preview"><script type="math/tex">
\Xi
</script>
</span>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;b&gt;
</td>
<td align="left" valign="top">
Parameter <span class="MathJax_Preview"><script type="math/tex">
\beta
</script>
</span> (<span class="MathJax_Preview"><script type="math/tex">
0\leqslant\beta\leqslant1)
</script>
</span>
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
For this material the c.d.f. is given by <span class="MathJax_Preview">
<script type="math/tex;mode=display">

F\left(\Xi\right)=1-\beta-\left(1-\beta\right)\frac{\alpha}{\Xi}\left(1-e^{-\Xi/\alpha}\right)\,.

</script>

</span>
Note that <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\lim\limits _{\Xi\to\infty}F\left(\Xi\right)=1-\beta

</script>

</span>
represents the maximum allowable damage. Therefore, <span class="MathJax_Preview"><script type="math/tex">
\beta
</script>
</span> regulates the maximum allowable damage, whereas <span class="MathJax_Preview"><script type="math/tex">
\alpha
</script>
</span> controls the rate at which <span class="MathJax_Preview"><script type="math/tex">
F\left(\Xi\right)
</script>
</span> increases with increasing <span class="MathJax_Preview"><script type="math/tex">
\Xi
</script>
</span>.
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><img class="embedded" src="Figures/FigDamageCDFSimo.png" alt="figure Figures/FigDamageCDFSimo.png" style="max-width: 352px; max-height: 167px;"/>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
<i>Example:</i>
</div>
<pre class="LyX-Code">
&lt;damage type="CDF Simo"&gt;
  &lt;a&gt;0.1&lt;/a&gt;
  &lt;b&gt;0&lt;/b&gt;
  &lt;Dmax&gt;1&lt;/Dmax&gt;
&lt;/damage&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.5.2.2">4.5.2.2</a> Log-Normal<a class="Label" name="subsec:Log-Normal"> </a>
</h4>
<div class="Unindented">
The material type for a log-normal c.d.f. is &ldquo;<i>CDF log-normal&rdquo;</i>. The following material parameters must be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;mu&gt;
</td>
<td align="left" valign="top">
Parameter <span class="MathJax_Preview"><script type="math/tex">
\mu
</script>
</span> (same units as <span class="MathJax_Preview"><script type="math/tex">
\Xi
</script>
</span>, <span class="MathJax_Preview"><script type="math/tex">
\mu>0)
</script>
</span>
</td>
<td align="left" valign="top">
[<span class="MathJax_Preview"><script type="math/tex">
\Xi
</script>
</span>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;sigma&gt;
</td>
<td align="left" valign="top">
Parameter <span class="MathJax_Preview"><script type="math/tex">
\sigma
</script>
</span> (<span class="MathJax_Preview"><script type="math/tex">
\sigma>0)
</script>
</span>
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;Dmax&gt;
</td>
<td align="left" valign="top">
Maximum allowable damage (optional, default is 1)
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
For this material the c.d.f. is given by <span class="MathJax_Preview">
<script type="math/tex;mode=display">

F\left(\Xi\right)=\frac{1}{2}\text{erfc}\left[-\frac{\ln\left(\Xi/\mu\right)}{\sigma\sqrt{2}}\right]\,.

</script>

</span>
Note that <span class="MathJax_Preview">
<script type="math/tex;mode=display">

F\left(\mu\right)=1/2,

</script>

</span>
which shows that <span class="MathJax_Preview"><script type="math/tex">
\mu
</script>
</span> is the value of <span class="MathJax_Preview"><script type="math/tex">
\Xi
</script>
</span> at which half of the bonds break. Here, <span class="MathJax_Preview"><script type="math/tex">
\sigma
</script>
</span> regulates the rate at which damage increases with increasing <span class="MathJax_Preview"><script type="math/tex">
\Xi
</script>
</span>, with smaller values of <span class="MathJax_Preview"><script type="math/tex">
\sigma
</script>
</span> producing a more rapid increase.
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><img class="embedded" src="Figures/FigDamageCDFLogNormal.png" alt="figure Figures/FigDamageCDFLogNormal.png" style="max-width: 344px; max-height: 166px;"/>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
<i>Example:</i>
</div>
<pre class="LyX-Code">
&lt;damage type="CDF log-normal"&gt;
  &lt;mu&gt;1&lt;/mu&gt;
  &lt;sigma&gt;0.5&lt;/sigma&gt;
  &lt;Dmax&gt;1&lt;/Dmax&gt;
&lt;/damage&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.5.2.3">4.5.2.3</a> Weibull<a class="Label" name="subsec:Weibull"> </a>
</h4>
<div class="Unindented">
The material type for a Weibull c.d.f. is &ldquo;<i>CDF Weibull&rdquo;</i>. The following material parameters must be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;mu&gt;
</td>
<td align="left" valign="top">
Parameter <span class="MathJax_Preview"><script type="math/tex">
\mu
</script>
</span> (same units as <span class="MathJax_Preview"><script type="math/tex">
\Xi
</script>
</span>, <span class="MathJax_Preview"><script type="math/tex">
\mu>0)
</script>
</span>
</td>
<td align="left" valign="top">
[<span class="MathJax_Preview"><script type="math/tex">
\Xi
</script>
</span>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;alpha&gt;
</td>
<td align="left" valign="top">
Parameter <span class="MathJax_Preview"><script type="math/tex">
\alpha
</script>
</span> (<span class="MathJax_Preview"><script type="math/tex">
\alpha>0)
</script>
</span>
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;Dmax&gt;
</td>
<td align="left" valign="top">
Maximum allowable damage (optional, default is 1)
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
For this material the c.d.f. is given by <span class="MathJax_Preview">
<script type="math/tex;mode=display">

F\left(\Xi\right)=1-\exp\left[-\left(\Xi/\mu\right)^{\alpha}\right]\,.

</script>

</span>
Note that <span class="MathJax_Preview">
<script type="math/tex;mode=display">

F\left(\mu\right)=1-e^{-1}\approx0.63\,,

</script>

</span>
which shows that <span class="MathJax_Preview"><script type="math/tex">
\mu
</script>
</span> is the value of <span class="MathJax_Preview"><script type="math/tex">
\Xi
</script>
</span> at which the fraction <span class="MathJax_Preview"><script type="math/tex">
1-e^{-1}
</script>
</span> of bonds break. Here, <span class="MathJax_Preview"><script type="math/tex">
\alpha
</script>
</span> regulates the rate at which damage increases with increasing <span class="MathJax_Preview"><script type="math/tex">
\Xi
</script>
</span>, with higher values of <span class="MathJax_Preview"><script type="math/tex">
\alpha
</script>
</span> producing a more rapid increase.
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><img class="embedded" src="Figures/FigDamageCDFWeibull.png" alt="figure Figures/FigDamageCDFWeibull.png" style="max-width: 342px; max-height: 168px;"/>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
<i>Example:</i>
</div>
<pre class="LyX-Code">
&lt;damage type="CDF Weibull"&gt;
  &lt;mu&gt;1&lt;/mu&gt;
  &lt;alpha&gt;5.0&lt;/alpha&gt;
  &lt;Dmax&gt;1&lt;/Dmax&gt;
&lt;/damage&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.5.2.4">4.5.2.4</a> Quintic Polynomial<a class="Label" name="subsec:Quintic-Polynomial"> </a>
</h4>
<div class="Unindented">
The material type for a quintic polynomial c.d.f. is &ldquo;<i>CDF quintic&rdquo;</i>. The following material parameters must be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;mumin&gt;
</td>
<td align="left" valign="top">
Parameter <span class="MathJax_Preview"><script type="math/tex">
\mu_{\min}
</script>
</span> (same units as <span class="MathJax_Preview"><script type="math/tex">
\Xi
</script>
</span>, <span class="MathJax_Preview"><script type="math/tex">
\mu_{\min}>0)
</script>
</span>
</td>
<td align="left" valign="top">
[<span class="MathJax_Preview"><script type="math/tex">
\Xi
</script>
</span>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;mumax&gt;
</td>
<td align="left" valign="top">
Parameter <span class="MathJax_Preview"><script type="math/tex">
\mu_{\max}
</script>
</span> (same units as <span class="MathJax_Preview"><script type="math/tex">
\Xi
</script>
</span>, <span class="MathJax_Preview"><script type="math/tex">
\mu_{\max}>\mu_{\min})
</script>
</span>
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;Dmax&gt;
</td>
<td align="left" valign="top">
Maximum allowable damage (optional, default is 1)
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
For this material the c.d.f. is given by <span class="MathJax_Preview">
<script type="math/tex;mode=display">

F\left(\Xi\right)=\begin{cases}
0 & \Xi\leqslant\mu_{\min}\\
x^{3}\left(10-15x+6x^{2}\right) & \mu_{\min}<\Xi\leqslant\mu_{\max}\\
1 & \mu_{\max}<\Xi
\end{cases}\,,\quad x=\frac{\Xi-\mu_{\min}}{\mu_{\max}-\mu_{\min}}\,.

</script>

</span>
Note that <span class="MathJax_Preview">
<script type="math/tex;mode=display">

F\left(\frac{1}{2}\left(\mu_{\min}+\mu_{\max}\right)\right)=\frac{1}{2}\,,

</script>

</span>
which shows that <span class="MathJax_Preview"><script type="math/tex">
\left(\mu_{\min}+\mu_{\max}\right)/2
</script>
</span> is the value of <span class="MathJax_Preview"><script type="math/tex">
\Xi
</script>
</span> at which half of the bonds break. The range <span class="MathJax_Preview"><script type="math/tex">
\mu_{\max}-\mu_{\min}
</script>
</span> regulates the rate at which damage increases with increasing <span class="MathJax_Preview"><script type="math/tex">
\Xi
</script>
</span>, with a narrower range producing a more rapid increase.
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><img class="embedded" src="Figures/FigDamageCDFQuintic.png" alt="figure Figures/FigDamageCDFQuintic.png" style="max-width: 373px; max-height: 167px;"/>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
<i>Example:</i>
</div>
<pre class="LyX-Code">
&lt;damage type="CDF quintic"&gt;
  &lt;mumin&gt;0.3&lt;/mumin&gt;
  &lt;mumax&gt;1.7&lt;/mumax&gt;
  &lt;Dmax&gt;1&lt;/Dmax&gt;
&lt;/damage&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.5.2.5">4.5.2.5</a> Step<a class="Label" name="subsec:Step"> </a>
</h4>
<div class="Unindented">
The material type for a step c.d.f. is &ldquo;<i>CDF step&rdquo;</i>. The following material parameters must be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;mu&gt;
</td>
<td align="left" valign="top">
Parameter <span class="MathJax_Preview"><script type="math/tex">
\mu
</script>
</span> (same units as <span class="MathJax_Preview"><script type="math/tex">
\Xi)
</script>
</span>
</td>
<td align="left" valign="top">
[<span class="MathJax_Preview"><script type="math/tex">
\Xi
</script>
</span>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;Dmax&gt;
</td>
<td align="left" valign="top">
Maximum allowable damage (optional, default is 1)
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
For this material the c.d.f. is given by <span class="MathJax_Preview">
<script type="math/tex;mode=display">

F\left(\Xi\right)=H\left(\Xi\right)\quad,

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
H\left(\cdot\right)
</script>
</span> is the Heaviside unit step function. The step c.d.f. may be used to model fracture.
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><img class="embedded" src="Figures/FigDamageCDFStep.png" alt="figure Figures/FigDamageCDFStep.png" style="max-width: 311px; max-height: 169px;"/>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
<i>Example:</i>
</div>
<pre class="LyX-Code">
&lt;damage type="CDF step"&gt;
  &lt;mu&gt;1.0&lt;/mu&gt;
  &lt;Dmax&gt;1&lt;/Dmax&gt;
&lt;/damage&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-4.5.3">4.5.3</a> Damage Criterion<a class="Label" name="subsec:Damage-Criterion"> </a>
</h3>
<div class="Unindented">
The damage criterion provides the functional form of <span class="MathJax_Preview"><script type="math/tex">
\Xi\left(\mathbf{F}\right)
</script>
</span> that determines the evolution of damage. There are no material parameters associated with these functions. All the functions currently modeled in FEBio are defined over the range <span class="MathJax_Preview"><script type="math/tex">
\Xi\in\left[0,\infty\right[
</script>
</span>.
</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.5.3.1">4.5.3.1</a> Simo<a class="Label" name="subsec:DC-Simo"> </a>
</h4>
<div class="Unindented">
The material type for Simo’s damage criterion <span class="bibcites">[<a class="bibliocite" name="cite-33" href="#biblio-33"><span class="bib-index">33</span></a>]</span> is &ldquo;<i>DC Simo&rdquo;</i>. For this criterion, <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\Xi\left(\mathbf{F}\right)=\sqrt{2\Psi_{0}\left(\mathbf{F}\right)}

</script>

</span>
<i>Example:</i>
</div>
<pre class="LyX-Code">
&lt;criterion type="DC Simo"/&gt;
</pre>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.5.3.2">4.5.3.2</a> Strain Energy Density<a class="Label" name="subsec:Strain-Energy-Density"> </a>
</h4>
<div class="Unindented">
The material type for strain energy density damage criterion is &ldquo;<i>DC strain energy density&rdquo;</i>. For this criterion, <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\Xi\left(\mathbf{F}\right)=\Psi_{0}\left(\mathbf{F}\right)

</script>

</span>
<i>Example:</i>
</div>
<pre class="LyX-Code">
&lt;criterion type="DC strain energy density"/&gt;
</pre>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.5.3.3">4.5.3.3</a> Specific Strain Energy<a class="Label" name="subsec:Specific-Strain-Energy"> </a>
</h4>
<div class="Unindented">
The material type for specific strain energy damage criterion is <i>&ldquo;DC specific strain energy&rdquo;</i>. For this criterion, <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\Xi\left(\mathbf{F}\right)=\Psi_{0}\left(\mathbf{F}\right)/\rho

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
\rho
</script>
</span> is the elastic material’s density.
</div>
<div class="Indented">
<i>Example:</i>
</div>
<pre class="LyX-Code">
&lt;criterion type="DC specific strain energy"/&gt;
</pre>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.5.3.4">4.5.3.4</a> Von Mises Stress<a class="Label" name="subsec:Von-Mises-Stress"> </a>
</h4>
<div class="Unindented">
The material type for von Mises stress damage criterion is <i>&ldquo;DC von Mises stress&rdquo;</i>. For this criterion, <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\Xi\left(\mathbf{F}\right)=\sqrt{\frac{1}{2}\left[\left(\sigma_{1}-\sigma_{2}\right)^{2}+\left(\sigma_{2}-\sigma_{3}\right)^{2}+\left(\sigma_{3}-\sigma_{1}\right)^{2}\right]}

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
\sigma_{1},\sigma_{2},\sigma_{3}
</script>
</span> are the principal values of <span class="MathJax_Preview"><script type="math/tex">
\boldsymbol{\sigma}_{0}\left(\mathbf{F}\right)
</script>
</span>.
</div>
<div class="Indented">
<i>Example:</i>
</div>
<pre class="LyX-Code">
&lt;criterion type="DC von Mises stress"/&gt;
</pre>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.5.3.5">4.5.3.5</a> Maximum Shear Stress<a class="Label" name="subsec:Maximum-Shear-Stress"> </a>
</h4>
<div class="Unindented">
The material type for maximum shear stress damage criterion is <i>&ldquo;DC max shear stress&rdquo;</i>. For this criterion, <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\Xi\left(\mathbf{F}\right)=\max\left(\frac{\left|\sigma_{1}-\sigma_{2}\right|}{2},\frac{\left|\sigma_{2}-\sigma_{3}\right|}{2},\frac{\left|\sigma_{3}-\sigma_{1}\right|}{2}\right)

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
\sigma_{1},\sigma_{2},\sigma_{3}
</script>
</span> are the principal values of <span class="MathJax_Preview"><script type="math/tex">
\boldsymbol{\sigma}_{0}\left(\mathbf{F}\right)
</script>
</span>.
</div>
<div class="Indented">
<i>Example:</i>
</div>
<pre class="LyX-Code">
&lt;criterion type="DC max shear stress"/&gt;
</pre>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.5.3.6">4.5.3.6</a> Maximum Normal Stress<a class="Label" name="subsec:Maximum-Normal-Stress"> </a>
</h4>
<div class="Unindented">
The material type for maximum normal stress damage criterion is <i>&ldquo;DC max normal stress&rdquo;</i>. For this criterion, <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\Xi\left(\mathbf{F}\right)=\max\left(\sigma_{1},\sigma_{2},\sigma_{3}\right)

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
\sigma_{1},\sigma_{2},\sigma_{3}
</script>
</span> are the principal values of <span class="MathJax_Preview"><script type="math/tex">
\boldsymbol{\sigma}_{0}\left(\mathbf{F}\right)
</script>
</span>.
</div>
<div class="Indented">
<i>Example:</i>
</div>
<pre class="LyX-Code">
&lt;criterion type="DC max normal stress"/&gt;
</pre>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.5.3.7">4.5.3.7</a> Maximum Normal Lagrange Strain<a class="Label" name="subsec:Maximum-Normal-Lagrange"> </a>
</h4>
<div class="Unindented">
The material type for maximum normal Lagrange strain damage criterion is <i>&ldquo;DC max normal Lagrange strain&rdquo;</i>. For this criterion, <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\Xi\left(\mathbf{F}\right)=\max\left(E_{1},E_{2},E_{3}\right)

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
E_{1},E_{2},E_{3}
</script>
</span> are the principal values of <span class="MathJax_Preview"><script type="math/tex">
\mathbf{E}=\left(\mathbf{F}^{T}\cdot\mathbf{F}-\mathbf{I}\right)/2
</script>
</span>.
</div>
<div class="Indented">
<i>Example:</i>
</div>
<pre class="LyX-Code">
&lt;criterion type="DC max normal Lagrange strain"/&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h2 class="Section">
<a class="toc" name="toc-Section-4.6">4.6</a> Multigeneration Solids<a class="Label" name="sec:Multigeneration-Solids"> </a>
</h2>
<div class="Unindented">
This type of material <span class="bibcites">[<a class="bibliocite" name="cite-5" href="#biblio-5"><span class="bib-index">5</span></a>]</span> implements a mechanism for multigenerational interstitial growth of solids whereby each growth generation <span class="MathJax_Preview"><script type="math/tex">
\gamma
</script>
</span> has a distinct reference configuration <span class="MathJax_Preview"><script type="math/tex">
\mathbf{X}^{\gamma}
</script>
</span> determined at the time <span class="MathJax_Preview"><script type="math/tex">
t^{\gamma}
</script>
</span> of its deposition. Therefore, the solid matrix of a growing material consists of a multiplicity of intermingled porous bodies, each representing a generation <span class="MathJax_Preview"><script type="math/tex">
\gamma
</script>
</span>, all of which are constrained to move together in the current configuration <span class="MathJax_Preview"><script type="math/tex">
\mathbf{x}
</script>
</span>. The deformation gradient of each generation is <span class="MathJax_Preview"><script type="math/tex">
\mathbf{F}^{\gamma}=\partial\mathbf{x}/\partial\mathbf{X}^{\gamma}
</script>
</span>. The first generation (<span class="MathJax_Preview"><script type="math/tex">
\gamma=1)
</script>
</span> is assumed to be present at time <span class="MathJax_Preview"><script type="math/tex">
t^{1}=0
</script>
</span>, therefore its reference configuration is <span class="MathJax_Preview"><script type="math/tex">
\mathbf{X}^{1}\equiv\mathbf{X}
</script>
</span> and its deformation gradient <span class="MathJax_Preview"><script type="math/tex">
\mathbf{F}^{1}=\partial\mathbf{x}/\partial\mathbf{X}^{1}
</script>
</span> is equivalent to <span class="MathJax_Preview"><script type="math/tex">
\mathbf{F}=\partial\mathbf{x}/\partial\mathbf{X}
</script>
</span>. Each generation’s reference configuration <span class="MathJax_Preview"><script type="math/tex">
\mathbf{X}^{\gamma}
</script>
</span> has a one-to-one mapping <span class="MathJax_Preview"><script type="math/tex">
\mathbf{F}^{\gamma1}=\partial\mathbf{X}^{\gamma}/\partial\mathbf{X}^{1}
</script>
</span> with the master reference configuration <span class="MathJax_Preview"><script type="math/tex">
\mathbf{X}^{1}
</script>
</span>, which is that of the first generation. This mapping is postulated based on a constitutive assumption with regard to that generation’s state of stress at the time of its deposition. In the current implementation, the newly deposited generation is assumed to be in a stress-free state, even though the underlying material is in a loaded configuration. Therefore, the mapping between generation <span class="MathJax_Preview"><script type="math/tex">
\gamma
</script>
</span> and the first generation is simply <span class="MathJax_Preview"><script type="math/tex">
\mathbf{F}^{\gamma1}=\mathbf{F}^{1}\left(\mathbf{X}^{1},t^{\gamma}\right)\equiv\mathbf{F}\left(\mathbf{X},t^{\gamma}\right)
</script>
</span>. In other words, when generation <span class="MathJax_Preview"><script type="math/tex">
\gamma
</script>
</span> first comes into existence, its reference configuration is the current configuration at time <span class="MathJax_Preview"><script type="math/tex">
t^{\gamma}
</script>
</span>. Note that <span class="MathJax_Preview"><script type="math/tex">
\mathbf{F}^{\gamma1}
</script>
</span> is a time-invariant (though not necessarily homogeneous) quantity that is determined uniquely at the birth of a generation.
</div>
<div class="Indented">
The state of stress in a multigeneration solid is given by <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\boldsymbol{\sigma}=\sum\limits _{\gamma}\frac{1}{J^{\gamma1}}\boldsymbol{\sigma}^{\gamma}\left(\mathbf{F}^{\gamma}\right)

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
\boldsymbol{\sigma}^{\gamma}\left(\mathbf{F}^{\gamma}\right)
</script>
</span> is the state of stress in the generation <span class="MathJax_Preview"><script type="math/tex">
\gamma
</script>
</span>, as would be evaluated from a strain energy density function whose reference configuration is <span class="MathJax_Preview"><script type="math/tex">
\mathbf{X}^{\gamma}
</script>
</span>. In the above equation, <span class="MathJax_Preview"><script type="math/tex">
J^{\gamma1}=\det\mathbf{F}^{\gamma1}
</script>
</span> and the factor <span class="MathJax_Preview"><script type="math/tex">
1/J^{\gamma1}
</script>
</span> ensures that the strain energy density of each generation is properly normalized the volume of the material in the master reference configuration <span class="MathJax_Preview"><script type="math/tex">
\mathbf{X}^{1}
</script>
</span>, when summing up the stresses in all the generations.
</div>
<div class="Indented">
Multigeneration solids typically exhibit residual stresses when <span class="MathJax_Preview"><script type="math/tex">
\mathbf{F}^{\gamma1}
</script>
</span> is inhomogeneous.
</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-4.6.1">4.6.1</a> General Specification of Multigeneration Solids<a class="Label" name="subsec:General-Specification-Multigen"> </a>
</h3>
<div class="Unindented">
The material type for a multigeneration solid is <i>&ldquo;multigeneration&rdquo;</i><span class="FootOuter"><span class="SupFootMarker"> [K] </span><span class="HoverFoot"><span class="SupFootMarker"> [K] </span> As of FEBio version 2.0, the format for definining multi-generation materials has changed. The previous format where the generations are defined in the <i>Globals </i>section is no longer supported.</span></span>. This material describes a mixture of elastic solids, each created in a specific generation. It is a container for any combination of the elastic materials described.
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;generation&gt;
</td>
<td align="left" valign="top">
Definition of a generation. 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
The &lt;generation&gt; tag defines a new generation. It takes the following child elements.
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;start_time&gt;
</td>
<td align="left" valign="top">
&ldquo;birth&rdquo;-time for this generation
</td>
<td align="left" valign="top">
[<b>t</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;solid&gt;
</td>
<td align="left" valign="top">
Specification of the constitutive model for this generation
</td>
<td align="left" valign="top">

</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
The <i>solid </i>element defins the solid matrix constitutive relation and associated material properties.
</div>
<div class="Indented">
<i>Example:</i>
</div>
<pre class="LyX-Code">
&lt;material id="1" name="Growing Solid" type="multigeneration"&gt;
  &lt;generation id="1"&gt;
    &lt;start_time&gt;0.0&lt;/start_time&gt;
    &lt;solid type="Holmes-Mow"&gt;
      &lt;density&gt;1&lt;/density&gt;
      &lt;E&gt;1&lt;/E&gt;
      &lt;v&gt;0&lt;/v&gt;
      &lt;beta&gt;0.1&lt;/beta&gt;
    &lt;/solid&gt;
  &lt;/generation&gt;
  &lt;generation id="2"&gt;
    &lt;start_time&gt;1.0&lt;/start_time&gt;
    &lt;solid type="Holmes-Mow"&gt;
      &lt;density&gt;1&lt;/density&gt;
      &lt;E&gt;1&lt;/E&gt;
      &lt;v&gt;0&lt;/v&gt;
      &lt;beta&gt;0.1&lt;/beta&gt;
    &lt;/solid&gt;
  &lt;/generation&gt;
&lt;/material&gt;
</pre>
<div class="Unindented">
The corresponding value of <span class="MathJax_Preview"><script type="math/tex">
t^{\gamma}
</script>
</span> for each of the generations is provided in the &lt;Globals&gt; section.
</div>
<div class="Indented">
<i>Example:</i>
</div>
<pre class="LyX-Code">
&lt;Globals&gt;
  &lt;Generations&gt;
    &lt;gen id="1"&gt;0.0&lt;/gen&gt;
    &lt;gen id="2"&gt;1.0&lt;/gen&gt;
  &lt;/Generations&gt;
&lt;/Globals&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h2 class="Section">
<a class="toc" name="toc-Section-4.7">4.7</a> Biphasic Materials<a class="Label" name="sec:Biphasic-Materials"> </a>
</h2>
<div class="Unindented">
Biphasic materials may be used to model a porous medium consisting of a mixture of a porous-permeable solid matrix and an interstitial fluid. Each of these mixture constituents is assumed to be intrinsically incompressible. This means that the true densities of the solid and fluid are invariant in space and time; this assumption further implies that a biphasic mixture will undergo zero volume change when subjected to a hydrostatic fluid pressure. Yet the mixture is compressible because the pores of the solid matrix may gain or lose fluid under general loading conditions. The Cauchy stress <span class="MathJax_Preview"><script type="math/tex">
{\rm \boldsymbol{\sigma}}
</script>
</span> in a biphasic material is given by <span class="MathJax_Preview">
<script type="math/tex;mode=display">
\begin{equation}
\boldsymbol{\sigma}=-p\mathbf{I}+{\rm \boldsymbol{\sigma}}^{e}\,,\label{eq:bp-stress}
\end{equation}
</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
p
</script>
</span> is the interstitial fluid pressure and <span class="MathJax_Preview"><script type="math/tex">
\boldsymbol{\sigma}^{e}
</script>
</span> is the stress resulting from the deformation of the porous solid matrix. Therefore, the constitutive relation of the solid matrix should be chosen from the list of compressible materials provided in Section <a class="Reference" href="#subsec:Compressible-Materials">4.1.3↑</a>. The user is referred to the <a href="http://help.mrl.sci.utah.edu/help/index.jsp">FEBio Theory Manual</a> for a general description of the biphasic theory.
</div>
<div class="Indented">
In addition to selecting a constitutive relation for the solid matrix, a constitutive relation must also be selected for the hydraulic permeability of the interstitial fluid flowing within the porous deformable solid matrix. The hydraulic permeability relates the volumetric flux of the fluid relative to the solid, <span class="MathJax_Preview"><script type="math/tex">
\mathbf{w}
</script>
</span>, to the interstitial fluid pressure gradient, <span class="MathJax_Preview"><script type="math/tex">
\nabla p
</script>
</span>, according to<span class="MathJax_Preview">
<script type="math/tex;mode=display">
\begin{equation}
\mathbf{w}=-\mathbf{k}\cdot\grad p\,,\label{eq:bp-flux}
\end{equation}
</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
\mathbf{k}
</script>
</span> is the hydraulic permeability tensor. (Note that this expression does not account for the contribution of external body forces on the fluid.)
</div>
<div class="Indented">
The governing equations for biphasic materials are the mixture momentum balance under quasi-static conditions, in the absence of external body force, <span class="MathJax_Preview">
<script type="math/tex;mode=display">
\begin{equation}
\divg{\rm \boldsymbol{\sigma}}=-\grad p+\divg\boldsymbol{\sigma}^{e}=\mathbf{0}\,,\label{eq:bp-momentum-balance}
\end{equation}
</script>

</span>
and the mixture mass balance,<span class="MathJax_Preview">
<script type="math/tex;mode=display">
\begin{equation}
\divg\left(\mathbf{v}^{s}+\mathbf{w}\right)=0\,,\label{eq:bp-mixture-mass-balance}
\end{equation}
</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
\mathbf{v}^{s}
</script>
</span> is the solid velocity.
</div>
<div class="Indented">
<p><br/>
</p>

</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-4.7.1">4.7.1</a> General Specification of Biphasic Materials<a class="Label" name="subsec:General-Specification-Biphasic"> </a>
</h3>
<div class="Unindented">
The material type for a biphasic material is <i>&ldquo;biphasic&rdquo;</i>. The following parameters must be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;solid&gt;
</td>
<td align="left" valign="top">
Specification of the solid matrix
</td>
<td align="left" valign="top">

</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;phi0&gt;
</td>
<td align="left" valign="top">
solid volume fraction <span class="MathJax_Preview"><script type="math/tex">
\varphi_{r}^{s}
</script>
</span> in the reference configuration (<span class="MathJax_Preview"><script type="math/tex">
0<\varphi_{r}^{s}<1)
</script>
</span>
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;fluid_density&gt;
</td>
<td align="left" valign="top">
Fluid density <span class="MathJax_Preview"><script type="math/tex">
\rho_{T}^{w}
</script>
</span> 
</td>
<td align="left" valign="top">

</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;permeability&gt;
</td>
<td align="left" valign="top">
Specification of the hydraulic permeability
</td>
<td align="left" valign="top">

</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;solvent_supply&gt;
</td>
<td align="left" valign="top">
Specification of the fluid supply <span class="MathJax_Preview"><script type="math/tex">
\hat{\varphi}^{w}
</script>
</span>
</td>
<td align="left" valign="top">

</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
The &lt;solid&gt; tag encloses a description of the solid matrix constitutive relation and associated material properties, as may be selected from the list provided in Section <a class="Reference" href="#subsec:Compressible-Materials">4.1.3↑</a>. The &lt;permeability&gt; tag encloses a description of the permeability constitutive relation and associated material properties, as may be selected from the list presented in Section <a class="Reference" href="#subsec:Permeability-Materials">4.7.2↓</a>. The parameter &lt;phi0&gt; must be greater than 0 (no solid) and less than 1 (no porosity). The volume fraction of fluid (also known as the porosity) in the reference configuration is given by <span class="MathJax_Preview"><script type="math/tex">
1-\varphi_{r}^{s}
</script>
</span>. The fluid density <span class="MathJax_Preview"><script type="math/tex">
\rho_{T}^{w}
</script>
</span> specified in &lt;fluid_density&gt; and the solid density <span class="MathJax_Preview"><script type="math/tex">
\rho_{T}^{s}
</script>
</span> specified in &lt;density&gt; within the &lt;solid&gt; tag are needed only when body forces are prescribed.
</div>
<div class="Indented">
<i>Example:</i>
</div>
<pre class="LyX-Code">
&lt;material id="1" name="Biphasic tissue" type="biphasic"&gt;
  &lt;solid name="Elasticity" type="neo-Hookean"&gt;
    &lt;E&gt;1.0&lt;/E&gt;
    &lt;v&gt;0.3&lt;/v&gt;
  &lt;/solid&gt;
  &lt;phi0&gt;0.2&lt;/phi0&gt;
  &lt;permeability name="Permeability" type="perm-const-iso"&gt;
    ... (description of permeability material)
  &lt;/permeability&gt;
&lt;/material&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-4.7.2">4.7.2</a> Permeability Materials<a class="Label" name="subsec:Permeability-Materials"> </a>
</h3>
<div class="Unindented">
Permeability materials provide a constitutive relation for the hydraulic permeability of a biphasic material.
</div>
<div class="Indented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.7.2.1">4.7.2.1</a> Constant Isotropic Permeability<a class="Label" name="subsec:Constant-Isotropic-Permeability"> </a>
</h4>
<div class="Unindented">
The material type for constant isotropic permeability is &ldquo;<i>perm-const-iso&rdquo;</i>. The following material parameters must be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;perm&gt;
</td>
<td align="left" valign="top">
hydraulic permeability <span class="MathJax_Preview"><script type="math/tex">
k
</script>
</span>
</td>
<td align="left" valign="top">
[<b>L</b><span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{4}}
</script>
</span>/<b>F</b><span class="MathJax_Preview"><script type="math/tex">
\cdot
</script>
</span><b>t</b>] 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
This isotropic material model uses the biphasic theory for describing the time-dependent material behavior of materials that consist of both a solid and fluid phase <span class="bibcites">[<a class="bibliocite" name="cite-28" href="#biblio-28"><span class="bib-index">28</span></a>]</span>.
</div>
<div class="Indented">
When the permeability is isotropic, <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\mathbf{k}=k\,\mathbf{I}

</script>

</span>
For this material model, <span class="MathJax_Preview"><script type="math/tex">
k
</script>
</span> is constant. Generally, this assumption is only reasonable when strains are small.
</div>
<div class="Indented">
<i>Example:</i>
</div>
<pre class="LyX-Code">
&lt;permeability name="Permeability" type="perm-const-iso "&gt;
  &lt;perm&gt;0.001&lt;/perm&gt;
&lt;/permeability&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.7.2.2">4.7.2.2</a> Holmes-Mow<a class="Label" name="subsec:perm-Holmes-Mow"> </a>
</h4>
<div class="Unindented">
The material type for Holmes-Mow permeability is <i>&ldquo;perm-Holmes-Mow&rdquo;</i>. The following material parameters need to be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;perm&gt;
</td>
<td align="left" valign="top">
isotropic hydraulic permeability <span class="MathJax_Preview"><script type="math/tex">
k_{0}
</script>
</span> in the reference state
</td>
<td align="left" valign="top">
[<b>L</b><span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{4}}
</script>
</span>/<b>F</b><span class="MathJax_Preview"><script type="math/tex">
\cdot
</script>
</span><b>t</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;M&gt;
</td>
<td align="left" valign="top">
exponential strain-dependence coefficient <span class="MathJax_Preview"><script type="math/tex">
M
</script>
</span> (<span class="MathJax_Preview"><script type="math/tex">
M\ge0
</script>
</span>)
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;alpha&gt;
</td>
<td align="left" valign="top">
power-law exponent <span class="MathJax_Preview"><script type="math/tex">
\alpha
</script>
</span> (<span class="MathJax_Preview"><script type="math/tex">
\alpha\ge0
</script>
</span>)
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
This isotropic material is similar to the constant isotropic permeability material described above, except that it uses a strain-dependent permeability tensor <span class="bibcites">[<a class="bibliocite" name="cite-22" href="#biblio-22"><span class="bib-index">22</span></a>]</span>: <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\mathbf{k}=k\left(J\right)\mathbf{I},

</script>

</span>
where, <span class="MathJax_Preview">
<script type="math/tex;mode=display">

k\left(J\right)=k_{0}\left(\frac{J-\varphi_{0}}{1-\varphi_{0}}\right)^{\alpha}e^{\frac{1}{2}M\left(J^{2}-1\right)}\,,

</script>

</span>
and <span class="MathJax_Preview"><script type="math/tex">
J
</script>
</span>is the Jacobian of the deformation, i.e. <span class="MathJax_Preview"><script type="math/tex">
J=\det\mathbf{F}
</script>
</span> where<b> <span class="MathJax_Preview"><script type="math/tex">
\mathbf{F}
</script>
</span> </b>is the deformation gradient.
</div>
<div class="Indented">
<i>Example:</i>
</div>
<div class="Indented">
This example defines a permeability material of the Holmes-Mow type.
</div>
<pre class="LyX-Code">
&lt;permeability type="perm-Holmes-Mow"&gt;
  &lt;perm&gt;0.001&lt;/perm&gt;
  &lt;M&gt;1.5&lt;/M&gt;
  &lt;alpha&gt;2&lt;/alpha&gt;
&lt;/permeability&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.7.2.3">4.7.2.3</a> Referentially Isotropic Permeability<a class="Label" name="subsec:Referentially-Isotropic-Permeabi"> </a>
</h4>
<div class="Unindented">
The material type for a biphasic material with strain-dependent permeability which is isotropic in the reference configuration is <i>&ldquo;perm-ref-iso&rdquo;</i>. The following material parameters need to be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;perm0&gt;
</td>
<td align="left" valign="top">
hydraulic permeability <span class="MathJax_Preview"><script type="math/tex">
k_{0r}
</script>
</span>
</td>
<td align="left" valign="top">
[<b>L</b><span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{4}}
</script>
</span>/<b>F</b><span class="MathJax_Preview"><script type="math/tex">
\cdot
</script>
</span><b>t</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;perm1&gt;
</td>
<td align="left" valign="top">
hydraulic permeability <span class="MathJax_Preview"><script type="math/tex">
k_{1r}
</script>
</span>
</td>
<td align="left" valign="top">
[<b>L</b><span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{4}}
</script>
</span>/<b>F</b><span class="MathJax_Preview"><script type="math/tex">
\cdot
</script>
</span><b>t</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;perm2&gt;
</td>
<td align="left" valign="top">
hydraulic permeability <span class="MathJax_Preview"><script type="math/tex">
k_{2r}
</script>
</span>
</td>
<td align="left" valign="top">
[<b>L</b><span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{4}}
</script>
</span>/<b>F</b><span class="MathJax_Preview"><script type="math/tex">
\cdot
</script>
</span><b>t</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;M&gt;
</td>
<td align="left" valign="top">
exponential strain-dependence coefficient <span class="MathJax_Preview"><script type="math/tex">
M
</script>
</span> (<span class="MathJax_Preview"><script type="math/tex">
M\geqslant0)
</script>
</span>
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;alpha&gt;
</td>
<td align="left" valign="top">
power-law exponent <span class="MathJax_Preview"><script type="math/tex">
\alpha
</script>
</span> (<span class="MathJax_Preview"><script type="math/tex">
\alpha\geqslant0
</script>
</span>)
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
This material uses a strain-dependent permeability tensor that accommodates strain-induced anisotropy: <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\mathbf{k}=\left(k_{0r}\mathbf{I}+\frac{k_{1r}}{J^{2}}\mathbf{b}+\frac{k_{2r}}{J^{4}}\mathbf{b}^{2}\right)\left(\frac{J-\varphi_{r}^{s}}{1-\varphi_{r}^{s}}\right)e^{M\left(J^{2}-1\right)/2},

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
J
</script>
</span> is the Jacobian of the deformation, i.e. <span class="MathJax_Preview"><script type="math/tex">
J=\det\mathbf{F}
</script>
</span> where <span class="MathJax_Preview"><script type="math/tex">
\mathbf{F}
</script>
</span> is the deformation gradient, and <span class="MathJax_Preview"><script type="math/tex">
\mathbf{b}=\mathbf{F}\cdot\mathbf{F}^{T}
</script>
</span> is the left Cauchy-Green tensor. Note that the permeability in the reference state (<span class="MathJax_Preview"><script type="math/tex">
\mathbf{F}=\mathbf{I})
</script>
</span> is isotropic and given by <span class="MathJax_Preview"><script type="math/tex">
\mathbf{k}=\left(k_{0r}+k_{1r}+k_{2r}\right)\mathbf{I}
</script>
</span>.
</div>
<div class="Indented">
<i>Example:</i>
</div>
<pre class="LyX-Code">
&lt;permeability name="Permeability" type="perm-ref-iso"&gt;
  &lt;perm0&gt;0.001&lt;/perm0&gt;
  &lt;perm1&gt;0.005&lt;/perm1&gt;
  &lt;perm2&gt;0.002&lt;/perm2&gt;
  &lt;M&gt;1.5&lt;/M&gt;
  &lt;alpha&gt;2&lt;/alpha&gt;
&lt;/permeability&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.7.2.4">4.7.2.4</a> Referentially Orthotropic Permeability<a class="Label" name="subsec:Referentially-Orthotropic-Permea"> </a>
</h4>
<div class="Unindented">
The material type for a poroelastic material with strain-dependent permeability which is orthotropic in the reference configuration is <i>&ldquo;perm-ref-ortho&rdquo;</i>. The following material parameters need to be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;perm0&gt;
</td>
<td align="left" valign="top" style="width: 3in;">
isotropic hydraulic permeability <span class="MathJax_Preview"><script type="math/tex">
k_{0r}
</script>
</span>
</td>
<td align="left" valign="top">
[<b>L</b><span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{4}}
</script>
</span>/<b>F</b><span class="MathJax_Preview"><script type="math/tex">
\cdot
</script>
</span><b>t</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;perm1&gt; 
</td>
<td align="left" valign="top" style="width: 3in;">
hydraulic permeabilities <span class="MathJax_Preview"><script type="math/tex">
k_{1r}^{a}
</script>
</span> along orthogonal directions (<span class="MathJax_Preview"><script type="math/tex">
a=1,2,3
</script>
</span>)
</td>
<td align="left" valign="top">
[<b>L</b><span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{4}}
</script>
</span>/<b>F</b><span class="MathJax_Preview"><script type="math/tex">
\cdot
</script>
</span><b>t</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;perm2&gt; 
</td>
<td align="left" valign="top" style="width: 3in;">
hydraulic permeabilities <span class="MathJax_Preview"><script type="math/tex">
k_{2r}^{a}
</script>
</span> along orthogonal directions (<span class="MathJax_Preview"><script type="math/tex">
a=1,2,3
</script>
</span>)
</td>
<td align="left" valign="top">
[<b>L</b><span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{4}}
</script>
</span>/<b>F</b><span class="MathJax_Preview"><script type="math/tex">
\cdot
</script>
</span><b>t</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;M0&gt;
</td>
<td align="left" valign="top" style="width: 3in;">
isotropic exponential strain-dependence coefficient <span class="MathJax_Preview"><script type="math/tex">
M_{0}
</script>
</span> (<span class="MathJax_Preview"><script type="math/tex">
M_{0}\geqslant0
</script>
</span>)
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;M&gt; 
</td>
<td align="left" valign="top" style="width: 3in;">
orthotropic exponential strain-dependence coefficient <span class="MathJax_Preview"><script type="math/tex">
M_{a}
</script>
</span> (<span class="MathJax_Preview"><script type="math/tex">
a=1,2,3
</script>
</span>, <span class="MathJax_Preview"><script type="math/tex">
M_{a}\geqslant0
</script>
</span>)
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;alpha0&gt;
</td>
<td align="left" valign="top" style="width: 3in;">
isotropic power-law exponent <span class="MathJax_Preview"><script type="math/tex">
\alpha_{0}
</script>
</span> (<span class="MathJax_Preview"><script type="math/tex">
\alpha_{0}\geqslant0
</script>
</span>)
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;alpha&gt;
</td>
<td align="left" valign="top" style="width: 3in;">
power-law exponent <span class="MathJax_Preview"><script type="math/tex">
\alpha_{a}
</script>
</span> (<span class="MathJax_Preview"><script type="math/tex">
a=1,2,3
</script>
</span>, <span class="MathJax_Preview"><script type="math/tex">
\alpha_{a}\geqslant0
</script>
</span>)
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
This material uses a strain-dependent permeability tensor that accommodates strain-induced anisotropy: <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\mathbf{k}=k_{0}\mathbf{I}+\sum\limits _{a=1}^{3}k_{1}^{a}\mathbf{m}_{a}+k_{2}^{a}\left(\mathbf{m}_{a}\cdot\mathbf{b}+\mathbf{b}\cdot\mathbf{m}_{a}\right)\,,

</script>

</span>
where, <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\begin{aligned}k_{0} & =k_{0r}\left(\frac{J-\varphi_{r}^{s}}{1-\varphi_{r}^{s}}\right)^{\alpha_{^{0}}}e^{M_{^{0}}\left(J^{2}-1\right)/2}\\
k_{1}^{a} & =\frac{k_{1r}^{a}}{J^{2}}\left(\frac{J-\varphi_{r}^{s}}{1-\varphi_{r}^{s}}\right)^{\alpha_{^{a}}}e^{M_{^{a}}\left(J^{2}-1\right)/2}\\
k_{2}^{a} & =\frac{k_{2r}^{a}}{2J^{4}}\left(\frac{J-\varphi_{r}^{s}}{1-\varphi_{r}^{s}}\right)^{\alpha_{^{a}}}e^{M_{a}\left(J^{2}-1\right)/2}
\end{aligned}
,\quad a=1,2,3\,.

</script>

</span>
<span class="MathJax_Preview"><script type="math/tex">
J
</script>
</span> is the Jacobian of the deformation, i.e. <span class="MathJax_Preview"><script type="math/tex">
J=\det\mathbf{F}
</script>
</span> where <span class="MathJax_Preview"><script type="math/tex">
\mathbf{F}
</script>
</span> is the deformation gradient. <span class="MathJax_Preview"><script type="math/tex">
\mathbf{m}_{a}
</script>
</span> are second order tensors representing the spatial structural tensors describing the orthogonal planes of symmetry, given by <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\mathbf{m}_{a}=\mathbf{F}\cdot\left(\mathbf{V}_{a}\otimes\mathbf{V}_{a}\right)\cdot\mathbf{F}^{T},\quad a=1-3,

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
\mathbf{V}_{a}
</script>
</span> are orthonormal vectors normal to the planes of symmetry (defined as described in Section <a class="Reference" href="#subsec:Orthotropic-Materials">4.1.1.2↑</a>). Note that the permeability in the reference state (<span class="MathJax_Preview"><script type="math/tex">
\mathbf{F}=\mathbf{I})
</script>
</span> is given by <span class="MathJax_Preview"><script type="math/tex">
\mathbf{k}=k_{0r}\mathbf{I}+\sum\limits _{a=1}^{3}\left(k_{1r}^{a}+k_{2r}^{a}\right)\mathbf{V}_{a}\otimes\mathbf{V}_{a}
</script>
</span>.
</div>
<div class="Indented">
<i>Example:</i>
</div>
<pre class="LyX-Code">
&lt;permeability name="Permeability" type="perm-ref-ortho"&gt;
  &lt;perm0&gt;0.001&lt;/perm0&gt;
  &lt;perm1&gt;0.01, 0.02, 0.03&lt;/perm1&gt;
  &lt;perm2&gt;0.001, 0.002, 0.003&lt;/perm2&gt;
  &lt;M0&gt;0.5&lt;/M0&gt;
  &lt;M&gt;1.5, 2.0, 2.5&lt;/M&gt;
  &lt;alpha0&gt;1.5&lt;/alpha0&gt;
  &lt;alpha&gt;2, 2.5, 3&lt;/alpha&gt;
&lt;/permeability&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.7.2.5">4.7.2.5</a> Referentially Transversely Isotropic Permeability<a class="Label" name="subsec:Referentially-Trans-Iso-Perm"> </a>
</h4>
<div class="Unindented">
The material type for a biphasic material with strain-dependent permeability which is transversely isotropic in the reference configuration is <i>&ldquo;perm-ref-trans-iso&rdquo;</i>. The following material parameters need to be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;perm0&gt;
</td>
<td align="left" valign="top">
isotropic hydraulic permeability <span class="MathJax_Preview"><script type="math/tex">
k_{0r}
</script>
</span>
</td>
<td align="left" valign="top">
[<b>L</b><span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{4}}
</script>
</span>/<b>F</b><span class="MathJax_Preview"><script type="math/tex">
\cdot
</script>
</span><b>t</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;perm1A&gt;
</td>
<td align="left" valign="top">
axial hydraulic permeability <span class="MathJax_Preview"><script type="math/tex">
k_{1r}^{A}
</script>
</span>
</td>
<td align="left" valign="top">
[<b>L</b><span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{4}}
</script>
</span>/<b>F</b><span class="MathJax_Preview"><script type="math/tex">
\cdot
</script>
</span><b>t</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;perm2A&gt;
</td>
<td align="left" valign="top">
axial hydraulic permeability <span class="MathJax_Preview"><script type="math/tex">
k_{2r}^{A}
</script>
</span>
</td>
<td align="left" valign="top">
[<b>L</b><span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{4}}
</script>
</span>/<b>F</b><span class="MathJax_Preview"><script type="math/tex">
\cdot
</script>
</span><b>t</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;perm1T&gt;
</td>
<td align="left" valign="top">
transverse hydraulic permeability <span class="MathJax_Preview"><script type="math/tex">
k_{1r}^{T}
</script>
</span>
</td>
<td align="left" valign="top">
[<b>L</b><span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{4}}
</script>
</span>/<b>F</b><span class="MathJax_Preview"><script type="math/tex">
\cdot
</script>
</span><b>t</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;perm2T&gt;
</td>
<td align="left" valign="top">
transverse hydraulic permeability <span class="MathJax_Preview"><script type="math/tex">
k_{2r}^{T}
</script>
</span>
</td>
<td align="left" valign="top">
[<b>L</b><span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{4}}
</script>
</span>/<b>F</b><span class="MathJax_Preview"><script type="math/tex">
\cdot
</script>
</span><b>t</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;M0&gt;
</td>
<td align="left" valign="top">
isotropic exponential strain-dependence coefficient <span class="MathJax_Preview"><script type="math/tex">
M_{0}
</script>
</span> (<span class="MathJax_Preview"><script type="math/tex">
M_{0}\geqslant0
</script>
</span>)
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;MA&gt;
</td>
<td align="left" valign="top">
axial exponential strain-dependence coefficient <span class="MathJax_Preview"><script type="math/tex">
M_{A}
</script>
</span> (<span class="MathJax_Preview"><script type="math/tex">
M_{A}\geqslant0
</script>
</span>)
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;MT&gt;
</td>
<td align="left" valign="top">
transverse exponential strain-dependence coefficient <span class="MathJax_Preview"><script type="math/tex">
M_{T}
</script>
</span> (<span class="MathJax_Preview"><script type="math/tex">
M_{T}\geqslant0
</script>
</span>)
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;alpha0&gt;
</td>
<td align="left" valign="top">
isotropic power-law exponent <span class="MathJax_Preview"><script type="math/tex">
\alpha_{0}
</script>
</span> (<span class="MathJax_Preview"><script type="math/tex">
\alpha_{0}\geqslant0
</script>
</span>)
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;alphaA&gt;
</td>
<td align="left" valign="top">
axial power-law exponent <span class="MathJax_Preview"><script type="math/tex">
\alpha_{A}
</script>
</span> (<span class="MathJax_Preview"><script type="math/tex">
\alpha_{A}\geqslant0
</script>
</span>)
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;alphaT&gt;
</td>
<td align="left" valign="top">
transverse power-law exponent <span class="MathJax_Preview"><script type="math/tex">
\alpha_{T}
</script>
</span> (<span class="MathJax_Preview"><script type="math/tex">
\alpha_{T}\geqslant0
</script>
</span>)
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
This material uses a strain-dependent permeability tensor that accommodates strain-induced anisotropy: <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\begin{aligned}\mathbf{k} & =k_{0r}\left(\frac{J-\varphi_{r}^{s}}{1-\varphi_{r}^{s}}\right)^{\alpha_{0}}e^{M_{^{0}}\left(J^{2}-1\right)/2}\mathbf{I}\\
 & +\left(\frac{k_{1r}^{T}}{J^{2}}\left(\mathbf{b}-\mathbf{m}\right)+\frac{k_{2r}^{T}}{2J^{4}}\left[2\mathbf{b}^{2}-\left(\mathbf{m}\cdot\mathbf{b}+\mathbf{b}\cdot\mathbf{m}\right)\right]\right)\left(\frac{J-\varphi_{r}^{s}}{1-\varphi_{r}^{s}}\right)^{\alpha_{T}}e^{M_{T}\left(J^{2}-1\right)/2}\\
 & +\left(\frac{1}{J^{2}}k_{1r}^{A}\mathbf{m}+\frac{1}{2J^{4}}k_{2r}^{A}\left(\mathbf{m}\cdot\mathbf{b}+\mathbf{b}\cdot\mathbf{m}\right)\right)\left(\frac{J-\varphi_{r}^{s}}{1-\varphi_{r}^{s}}\right)^{\alpha_{A}}e^{M_{A}\left(J^{2}-1\right)/2}
\end{aligned}
,

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
J
</script>
</span> is the Jacobian of the deformation, i.e. <span class="MathJax_Preview"><script type="math/tex">
J=\det\mathbf{F}
</script>
</span> where <span class="MathJax_Preview"><script type="math/tex">
\mathbf{F}
</script>
</span> is the deformation gradient, and <span class="MathJax_Preview"><script type="math/tex">
\mathbf{b}=\mathbf{F}\cdot\mathbf{F}^{T}
</script>
</span> is the left Cauchy-Green tensor. <span class="MathJax_Preview"><script type="math/tex">
\mathbf{m}
</script>
</span> is a second order tensor representing the spatial structural tensor describing the axial direction, given by <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\mathbf{m}=\mathbf{F}\cdot\left(\mathbf{V}\otimes\mathbf{V}\right)\cdot\mathbf{F}^{T}\,,

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
\mathbf{V}
</script>
</span> is a unit vector along the axial direction (defined as described in Section <a class="Reference" href="#subsec:Specifying-Fiber-Orientation">4.1.1↑</a>). Note that the permeability in the reference state (<span class="MathJax_Preview"><script type="math/tex">
\mathbf{F}=\mathbf{I})
</script>
</span> is given by <span class="MathJax_Preview"><script type="math/tex">
\mathbf{k}=\left(k_{0r}+k_{1r}^{T}+k_{2r}^{T}\right)\mathbf{I}+\left(k_{1r}^{A}-k_{1r}^{T}+k_{2r}^{A}-k_{2r}^{T}\right)\left(\mathbf{V}\otimes\mathbf{V}\right)
</script>
</span>.
</div>
<div class="Indented">
<i>Example:</i>
</div>
<pre class="LyX-Code">
&lt;permeability name="Permeability" type="perm-ref-trans-iso"&gt;
  &lt;perm0&gt;0.002&lt;/perm0&gt;
  &lt;perm1A&gt;0.01&lt;/perm1A&gt;
  &lt;perm2A&gt;0.01&lt;/perm2A&gt;
  &lt;perm1T&gt;0.001&lt;/perm1T&gt;
  &lt;perm2T&gt;0.05&lt;/perm2T&gt;
  &lt;M0&gt;1.0&lt;/M0&gt;
  &lt;MA&gt;0.5&lt;/MA&gt;
  &lt;MT&gt;1.5&lt;/MT&gt;
  &lt;alpha0&gt;1.0&lt;/alpha0&gt;
  &lt;alphaA&gt;0.5&lt;/alphaA&gt;
  &lt;alphaT&gt;2.0&lt;/alphaT&gt;
&lt;/permeability&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-4.7.3">4.7.3</a> Fluid Supply Materials<a class="Label" name="subsec:Fluid-Supply-Materials"> </a>
</h3>
<div class="Unindented">
Fluid supply materials may be used to simulate an external source of fluid, such as supply from microvasculature that is not modeled explicitly. The fluid supply term, <span class="MathJax_Preview"><script type="math/tex">
\hat{\varphi}^{w}
</script>
</span>, appears in the mass balance relation for the mixture, <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\divg\left(\mathbf{v}^{s}+\mathbf{w}\right)=\hat{\varphi}^{w}\,.

</script>

</span>
<span class="MathJax_Preview"><script type="math/tex">
\hat{\varphi}^{w}
</script>
</span> has units of reciprocal time [<b>t</b><span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{-1}}
</script>
</span>]; it represents the rate at which the volume fraction of fluid changes with time.
</div>
<div class="Indented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.7.3.1">4.7.3.1</a> Starling Equation<a class="Label" name="subsec:Starling-Equation"> </a>
</h4>
<div class="Unindented">
The material type for Starling’s equation for fluid supply is <i>&ldquo;Starling&rdquo;</i>. The following material parameters need to be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;kp&gt;
</td>
<td align="left" valign="top">
hydraulic filtration coefficient, <span class="MathJax_Preview"><script type="math/tex">
k_{p}
</script>
</span>
</td>
<td align="left" valign="top">
[<b>L</b><span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{2}}
</script>
</span>/<b>F</b><span class="MathJax_Preview"><script type="math/tex">
\cdot
</script>
</span><b>t</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;pv&gt;
</td>
<td align="left" valign="top">
fluid pressure in external source, <span class="MathJax_Preview"><script type="math/tex">
p_{v}
</script>
</span>
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
The fluid supply is given by Starling’s equation, <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\hat{\varphi}^{w}=k_{p}\left(p_{v}-p\right)\,,

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
p
</script>
</span> is the fluid pressure in the biphasic material.
</div>
<div class="Indented">
<i>Example:</i>
</div>
<div class="Indented">
This example defines a fluid supply material of the Starling type.
</div>
<pre class="LyX-Code">
&lt;solvent_supply type="Starling"&gt;
  &lt;kp&gt;0.001&lt;/kp&gt;
  &lt;pv&gt;0.1&lt;/pv&gt;
&lt;/solvent_supply&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h2 class="Section">
<a class="toc" name="toc-Section-4.8">4.8</a> Biphasic-Solute Materials<a class="Label" name="sec:Biphasic-Solute-Materials"> </a>
</h2>
<div class="Unindented">
Biphasic-solute materials may be used to model the transport of a solvent and a solute in a neutral porous solid matrix, under isothermal conditions. Each of these mixture constituents is assumed to be intrinsically incompressible. This means that their true densities are invariant in space and time; this assumption further implies that a biphasic-solute mixture will undergo zero volume change when subjected to a hydrostatic fluid pressure. Yet the mixture is compressible because the pores of the solid matrix may gain or lose fluid under general loading conditions. Therefore, the constitutive relation of the solid matrix should be chosen from the list of compressible materials provided in Section <a class="Reference" href="#subsec:Compressible-Materials">4.1.3↑</a>. The volume fraction of the solute is assumed to be negligible relative to the volume fractions of the solid or solvent. This means that the mixture will not change in volume as the solute concentration changes. As the solute transports through the mixture, it may experience frictional interactions with the solvent and the solid. This friction may act as a hindrance to the solute transport, or may help convect the solute through the mixture. The distinction between frictional exchanges with the solvent and solid is embodied in the specification of two diffusivities for the solute: The free diffusivity, which represents diffusivity in the absence of a solid matrix (frictional exchange only with the solvent) and the mixture diffusivity, which represents the combined frictional interactions with the solvent and solid matrix. The user is referred to the <a href="http://help.mrl.sci.utah.edu/help/index.jsp">FEBio Theory Manual</a> for a more detailed description of the biphasic-solute theory.
</div>
<div class="Indented">
Due to steric volume exclusion and short-range electrostatic interactions, the solute may not have access to all of the pores of the solid matrix. In other words, only a fraction <span class="MathJax_Preview"><script type="math/tex">
\kappa
</script>
</span> of the pores is able to accommodate a solute of a particular size (<span class="MathJax_Preview"><script type="math/tex">
0<\kappa\leqslant1)
</script>
</span>. Furthermore, the activity <span class="MathJax_Preview"><script type="math/tex">
\gamma
</script>
</span> of the solute (the extent by which the solute concentration influences its chemical potential) may be similarly altered by the surrounding porous solid matrix. Therefore, the combined effects of volume exclusion and attenuation of activity may be represented by the effective solubility <span class="MathJax_Preview"><script type="math/tex">
\tilde{\kappa}=\kappa/\gamma
</script>
</span>, such that the chemical potential <span class="MathJax_Preview"><script type="math/tex">
\mu
</script>
</span> of the solute is given by <span class="MathJax_Preview">
<script type="math/tex;mode=display">
\begin{equation}
\mu=\mu_{0}\left(\theta\right)+\frac{R\theta}{M}\ln\frac{c}{\tilde{\kappa}}\,.\label{eq:bs-solute-chemical-potential}
\end{equation}
</script>

</span>
In this expression, <span class="MathJax_Preview"><script type="math/tex">
\mu_{0}
</script>
</span> is the solute chemical potential at some reference temperature <span class="MathJax_Preview"><script type="math/tex">
\theta
</script>
</span>; <span class="MathJax_Preview"><script type="math/tex">
c
</script>
</span> is the solute concentration on a solution-volume basis (number of moles of solute per volume of interstitial fluid in the mixture); <span class="MathJax_Preview"><script type="math/tex">
M
</script>
</span> is the solute molecular weight (an invariant quantity); and <span class="MathJax_Preview"><script type="math/tex">
R
</script>
</span> is the universal gas constant. In a biphasic-solute material, a constitutive relation is needed for <span class="MathJax_Preview"><script type="math/tex">
\tilde{\kappa}
</script>
</span>; in general, <span class="MathJax_Preview"><script type="math/tex">
\tilde{\kappa}
</script>
</span> may be a function of the solid matrix strain and the solute concentration. In FEBio, the dependence of the effective solubility on the solid matrix strain is currently constrained to a dependence on <span class="MathJax_Preview"><script type="math/tex">
J=\det\mathbf{F}
</script>
</span>.
</div>
<div class="Indented">
In a biphasic-solute material, the interstitial fluid pressure <span class="MathJax_Preview"><script type="math/tex">
p
</script>
</span> is influenced by both mechanical and chemical environments. In other words, this pressure includes both mechanical and osmotic contributions, the latter arising from the presence of the solute. The solvent mechano-chemical potential <span class="MathJax_Preview"><script type="math/tex">
\tilde{\mu}^{w}
</script>
</span> is given by <span class="MathJax_Preview">
<script type="math/tex;mode=display">
\begin{equation}
\tilde{\mu}^{w}=\mu_{0}^{w}\left(\theta\right)+\frac{1}{\rho_{T}^{w}}\left(p-R\theta\Phi c\right)\,,\label{eq:bs-solvent-chemical-potential}
\end{equation}
</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
\mu_{0}^{w}
</script>
</span> is the solvent chemical potential at some reference temperature <span class="MathJax_Preview"><script type="math/tex">
\theta
</script>
</span>; <span class="MathJax_Preview"><script type="math/tex">
\rho_{T}^{w}
</script>
</span> is the true density of the solvent (an invariant property for an intrinsically incompressible fluid); and <span class="MathJax_Preview"><script type="math/tex">
\Phi
</script>
</span> is the osmotic coefficient which represents the extent by which the solute concentration influences the solvent chemical potential. In a biphasic-solute material, a constitutive relation is needed for <span class="MathJax_Preview"><script type="math/tex">
\Phi
</script>
</span>; in general, <span class="MathJax_Preview"><script type="math/tex">
\Phi
</script>
</span> may be a function of the solid matrix strain and the solute concentration. In FEBio, the dependence of the osmotic coefficient on the solid matrix strain is currently constrained to a dependence on <span class="MathJax_Preview"><script type="math/tex">
J=\det\mathbf{F}
</script>
</span>.
</div>
<div class="Indented">
The solute mechano-chemical potential is nearly equal to its chemical potential because the solute volume fraction is assumed to be negligible. In general, momentum and energy balances evaluated across a boundary surface in a biphasic-solute mixture require that the mechano-chemical potentials of solvent and solute be continuous across that surface. These continuity requirements are enforced automatically in FEBio by defining the effective fluid pressure <span class="MathJax_Preview"><script type="math/tex">
\tilde{p}
</script>
</span> and solute concentration <span class="MathJax_Preview"><script type="math/tex">
\tilde{c}
</script>
</span> as <span class="MathJax_Preview">
<script type="math/tex;mode=display">
\begin{equation}
\begin{aligned}\tilde{p} & =p-R\theta\Phi c\\
\tilde{c} & =\frac{c}{\tilde{\kappa}}
\end{aligned}
\,.\label{eq:bs-effective-p-c}
\end{equation}
</script>

</span>
Therefore, nodal variables in FEBio consist of the solid matrix displacement <span class="MathJax_Preview"><script type="math/tex">
\mathbf{u}
</script>
</span>, the effective fluid pressure <span class="MathJax_Preview"><script type="math/tex">
\tilde{p}
</script>
</span>, and the effective solute concentration <span class="MathJax_Preview"><script type="math/tex">
\tilde{c}
</script>
</span>. Essential boundary conditions must be imposed on these variables, and not on the actual pressure <span class="MathJax_Preview"><script type="math/tex">
p
</script>
</span> or concentration <span class="MathJax_Preview"><script type="math/tex">
c
</script>
</span>. (In a biphasic material however, since <span class="MathJax_Preview"><script type="math/tex">
c=0
</script>
</span>, the effective and actual fluid pressures are the same, <span class="MathJax_Preview"><script type="math/tex">
p=\tilde{p}
</script>
</span>.)
</div>
<div class="Indented">
The mixture stress in a biphasic-solute material is given by <span class="MathJax_Preview"><script type="math/tex">
\boldsymbol{\sigma}=-p\mathbf{I}+\boldsymbol{\sigma}^{e}
</script>
</span>, where <span class="MathJax_Preview"><script type="math/tex">
\boldsymbol{\sigma}^{e}
</script>
</span> is the stress arising from the solid matrix strain. The mixture traction on a surface with unit outward normal <span class="MathJax_Preview"><script type="math/tex">
\mathbf{n}
</script>
</span> is <span class="MathJax_Preview"><script type="math/tex">
\mathbf{t}=\boldsymbol{\sigma}\cdot\mathbf{n}
</script>
</span>. This traction is continuous across the boundary surface. Therefore, the corresponding natural boundary condition for a biphasic-solute mixture is <span class="MathJax_Preview"><script type="math/tex">
\mathbf{t}=\mathbf{0}
</script>
</span>. (In other words, if no boundary condition is imposed on the solid matrix displacement or mixture traction, the natural boundary condition is in effect.)
</div>
<div class="Indented">
The natural boundary conditions for the solvent and solute are similarly <span class="MathJax_Preview"><script type="math/tex">
\mathbf{w}\cdot\mathbf{n}=0
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
\mathbf{j}\cdot\mathbf{n}=0
</script>
</span>, where <span class="MathJax_Preview"><script type="math/tex">
\mathbf{w}
</script>
</span> is the volumetric flux of solvent relative to the solid and <span class="MathJax_Preview"><script type="math/tex">
\mathbf{j}
</script>
</span> is the molar flux of solute relative to the solid. In general, <span class="MathJax_Preview"><script type="math/tex">
\mathbf{w}
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
\mathbf{j}
</script>
</span> are given by <span class="MathJax_Preview">
<script type="math/tex;mode=display">
\begin{equation}
\begin{aligned}\mathbf{w} & =-\mathbf{\tilde{k}}\cdot\left(\nabla\tilde{p}+R\theta\frac{\tilde{\kappa}}{d_{0}}\mathbf{d}\cdot\nabla\tilde{c}\right)\\
\mathbf{j} & =\tilde{\kappa}\mathbf{d}\cdot\left(-\varphi^{w}\nabla\tilde{c}+\frac{\tilde{c}}{d_{0}}\mathbf{w}\right)
\end{aligned}
\,,\label{eq:bs-fluxes-w-j}
\end{equation}
</script>

</span>
where<span class="MathJax_Preview">
<script type="math/tex;mode=display">
\begin{equation}
\tilde{\mathbf{k}}=\left[\mathbf{k}^{-1}+\frac{R\theta}{\varphi^{w}}\frac{\tilde{\kappa}c}{d_{0}}\left(\mathbf{I}-\frac{\mathbf{d}}{d_{0}}\right)\right]^{-1}\label{eq:bs-effective-perm}
\end{equation}
</script>

</span>
is the effective hydraulic permeability of the interstitial fluid solution (solvent and solute) through the porous solid matrix; <span class="MathJax_Preview"><script type="math/tex">
\mathbf{k}
</script>
</span> is the hydraulic permeability of the solvent through the porous solid matrix; <span class="MathJax_Preview"><script type="math/tex">
\mathbf{d}
</script>
</span> is the solute diffusivity through the mixture (frictional interactions with solvent and solid); and <span class="MathJax_Preview"><script type="math/tex">
d_{0}
</script>
</span> is the solute free diffusivity (frictional interactions with solvent only). <span class="MathJax_Preview"><script type="math/tex">
\varphi^{w}\approx1-\varphi^{s}
</script>
</span> is the solid matrix porosity in the current configuration. The above expressions for the solvent and solute flux do not account for external body forces.
</div>
<div class="Indented">
The governing equations for a biphasic-solute material are the momentum balance for the mixture, Eq.<a class="Reference" href="#eq:bp-momentum-balance">(↓)</a>, the mass balance for the mixture, which reduces to Eq.<a class="Reference" href="#eq:bp-mixture-mass-balance">(↓)</a> under the assumption of dilute solutions, and the mass balance for the solute, <span class="MathJax_Preview">
<script type="math/tex;mode=display">
\begin{equation}
\frac{\partial\left(\varphi^{w}c\right)}{\partial t}+\divg\left(\mathbf{j}+\varphi^{w}c\mathbf{v}^{s}\right)=0\,.\label{eq:bs-solute-mass-balance}
\end{equation}
</script>

</span>

</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-4.8.1">4.8.1</a> Guidelines for Biphasic-Solute Analyses<a class="Label" name="subsec:Guidelines-for-Biphasic-Solute"> </a>
</h3>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.8.1.1">4.8.1.1</a> Prescribed Boundary Conditions<a class="Label" name="subsec:Prescribed-Boundary-Conditions"> </a>
</h4>
<div class="Unindented">
In most analyses, it may be assumed that the ambient fluid pressure in the external environment is zero, thus <span class="MathJax_Preview"><script type="math/tex">
p_{\ast}=0
</script>
</span>, where the subscripted asterisk is used to denote environmental conditions. The ambient solute concentration may be represented by <span class="MathJax_Preview"><script type="math/tex">
c_{\ast}
</script>
</span>. It follows that the effective fluid pressure in the external environment is <span class="MathJax_Preview"><script type="math/tex">
\tilde{p}_{\ast}=-R\theta\Phi_{\ast}c_{\ast}
</script>
</span> and the effective concentration is <span class="MathJax_Preview"><script type="math/tex">
\tilde{c}_{\ast}=c_{\ast}/\tilde{\kappa}_{\ast}
</script>
</span>. Therefore, in biphasic-solute analyses, whenever the external environment contains a solute at a concentration of <span class="MathJax_Preview"><script type="math/tex">
c_{\ast}
</script>
</span>, the user must remember to prescribe non-zero boundary conditions for the effective solute concentration <i>and</i> the effective fluid pressure.
</div>
<div class="Indented">
Letting <span class="MathJax_Preview"><script type="math/tex">
p_{\ast}=0
</script>
</span> also implies that prescribed mixture normal tractions (Section <a class="Reference" href="#subsec:Mixture-Normal-Traction">3.12.2.3↑</a>) represent only the traction above ambient conditions. Note that users are not obligated to assume that <span class="MathJax_Preview"><script type="math/tex">
p_{\ast}=0
</script>
</span>. However, if a non-zero value is assumed for the ambient pressure, then users must remember to incorporate this non-zero value whenever prescribing mixture normal tractions.
</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.8.1.2">4.8.1.2</a> Prescribed Initial Conditions<a class="Label" name="subsec:Prescribed-Initial-Conditions"> </a>
</h4>
<div class="Unindented">
When a biphasic-solute material is initially exposed to a given external environment with effective pressure <span class="MathJax_Preview"><script type="math/tex">
\tilde{p}_{\ast}
</script>
</span> and effective concentration <span class="MathJax_Preview"><script type="math/tex">
\tilde{c}_{\ast}
</script>
</span>, the initial conditions inside the material should be set to <span class="MathJax_Preview"><script type="math/tex">
\tilde{p}=\tilde{p}_{\ast}
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
\tilde{c}=\tilde{c}_{\ast}
</script>
</span> in order to produce the correct initial state. The values of <span class="MathJax_Preview"><script type="math/tex">
\tilde{p}_{\ast}
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
\tilde{c}_{\ast}
</script>
</span> should be evaluated as described in Section <a class="Reference" href="#subsec:Prescribed-Boundary-Conditions-1">8.5.2↓</a>.
</div>
<div class="Indented">
<p><br/>
</p>

</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-4.8.2">4.8.2</a> General Specification of Biphasic-Solute Materials<a class="Label" name="subsec:General-Specification-BS-Materials"> </a>
</h3>
<div class="Unindented">
The material type for a biphasic-solute material is <i>&ldquo;biphasic-solute&rdquo;</i>. Constitutive relations must be provided for the solid matrix, the hydraulic permeability <span class="MathJax_Preview"><script type="math/tex">
\mathbf{k}
</script>
</span>, the solute diffusivities <span class="MathJax_Preview"><script type="math/tex">
\mathbf{d}
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
d_{0}
</script>
</span>, the effective solubility <span class="MathJax_Preview"><script type="math/tex">
\tilde{{\kappa}}
</script>
</span> and the osmotic coefficient <span class="MathJax_Preview"><script type="math/tex">
\Phi
</script>
</span>. Therefore, the following parameters must be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;solid&gt;
</td>
<td align="left" valign="top">
specification of the solid matrix 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;phi0&gt;
</td>
<td align="left" valign="top">
solid volume fraction <span class="MathJax_Preview"><script type="math/tex">
\varphi_{r}^{s}
</script>
</span> in the reference configuration 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;permeability&gt;
</td>
<td align="left" valign="top">
specification of the hydraulic permeability <span class="MathJax_Preview"><script type="math/tex">
\mathbf{k}
</script>
</span> 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;osmotic_coefficient&gt;
</td>
<td align="left" valign="top">
specification of the osmotic coefficient <span class="MathJax_Preview"><script type="math/tex">
\Phi\quad\mathbf{d}d_{0}
</script>
</span> 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;solute&gt;
</td>
<td align="left" valign="top">
specification of the solute properties 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
The &lt;solid&gt; tag encloses a description of the solid matrix constitutive relation and associated material properties, as may be selected from the list provided in Section <a class="Reference" href="#subsec:Compressible-Materials">4.1.3↑</a>. The solid volume fraction in the reference configuration, &lt;phi0&gt;, must be greater than 0 (no solid) and less than 1 (only solid). The volume fraction of fluid (also known as the porosity) in the reference configuration is given by <span class="MathJax_Preview"><script type="math/tex">
1-\varphi_{0}
</script>
</span>. The &lt;permeability&gt; tag encloses a description of the permeability constitutive relation and associated material properties, as may be selected from the list presented in Section <a class="Reference" href="#subsec:Permeability-Materials">4.7.2↑</a>.
</div>
<div class="Indented">
The &lt;solute&gt; tag provides a description of the solute in the biphasic-solute mixture. This tag includes the required <i>sol</i> attribute, which should reference a solute <i>id</i> from the &lt;Solutes&gt; description in the &lt;Globals&gt; section (Section <a class="Reference" href="#subsec:Solutes">3.6.2↑</a>). The following parameters must be defined in this description:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;diffusivity&gt;
</td>
<td align="left" valign="top">
specification of the solute diffusivities <span class="MathJax_Preview"><script type="math/tex">
\mathbf{d}
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
d_{0}
</script>
</span> 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;solubility&gt;
</td>
<td align="left" valign="top">
specification of the solute effective solubility <span class="MathJax_Preview"><script type="math/tex">
\tilde{{\kappa}}
</script>
</span> 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
The &lt;diffusivity&gt; and &lt;solubility&gt; tags enclose descriptions of materials that may be selected from the lists presented in Sections <a class="Reference" href="#subsec:Diffusivity-Materials">4.8.3↓</a> and <a class="Reference" href="#subsec:Solubility-Materials">4.8.4↓</a>, respectively. Each solute tag must include a &ldquo;sol&rdquo; attribute.
</div>
<div class="Indented">
<i>Example:</i>
</div>
<pre class="LyX-Code">
&lt;material id="1" name="Biological tissue" type="biphasic-solute"&gt;
  &lt;solid name="Elasticity" type="neo-Hookean"&gt;
    &lt;E&gt;1.0&lt;/E&gt;
    &lt;v&gt;0.3&lt;/v&gt;
  &lt;/solid&gt;
  &lt;phi0&gt;0.2&lt;/phi0&gt;
  &lt;permeability name="Permeability" type="perm-const-iso"&gt;
    ... (description of permeability material)
  &lt;/permeability&gt;
  &lt;osmotic_coefficient name="Osmotic" type="osm-coef-const"&gt;
    ... (description of osmotic coefficient material)
  &lt;/osmotic_coefficient&gt;
  &lt;solute sol="1"&gt;
    &lt;diffusivity name="Diffusivity" type="diff-const-iso"&gt;
      ... (description of diffusivity material)
    &lt;/diffusivity&gt;
    &lt;solubility name="Solubility" type="solub-const"&gt;
      ... (description of solubility material)
    &lt;/solubility&gt;
  &lt;/solute&gt;
&lt;/material&gt;
</pre>
<div class="Unindented">
When a biphasic-solute material is employed in an analysis, it is also necessary to specify the values of the universal gas constant <span class="MathJax_Preview"><script type="math/tex">
R
</script>
</span> [<b>F</b><span class="MathJax_Preview"><script type="math/tex">
\cdot
</script>
</span><b>L</b>/<b>n</b><span class="MathJax_Preview"><script type="math/tex">
\cdot
</script>
</span><b>T</b>] and absolute temperature <span class="MathJax_Preview"><script type="math/tex">
\theta
</script>
</span> [<b>T</b>] under &lt;Constants&gt; in the &lt;Globals&gt; section, using a self-consistent set of units. A solute must also be defined in the &lt;Solutes&gt; section, whose id should be associated with the &ldquo;sol&rdquo; attribute in the solute material description.
</div>
<div class="Indented">
<i>Example:</i>
</div>
<pre class="LyX-Code">
&lt;Globals&gt;
  &lt;Constants&gt;
    &lt;R&gt;8.314&lt;/R&gt;
    &lt;T&gt;298&lt;/T&gt;
  &lt;/Constants&gt;
  &lt;Solutes&gt;
    &lt;solute id="1" name="neutral"&gt;
      &lt;charge_number&gt;0&lt;/charge_number&gt;
    &lt;/solute&gt;
  &lt;/Solutes&gt;
&lt;/Globals&gt;
</pre>
<div class="Unindented">
It is also possible to create models with biphasic-solute materials that use different solutes in different regions. In that case, introduce additional solute entries in the &lt;Solutes&gt; section and refer to those solute ids in the biphasic-solute material descriptions.
</div>
<div class="Indented">
<p><br/>
</p>

</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-4.8.3">4.8.3</a> Diffusivity Materials<a class="Label" name="subsec:Diffusivity-Materials"> </a>
</h3>
<div class="Unindented">
Diffusivity materials provide a constitutive relation for the solute diffusivity in a biphasic-solute material. In general, the diffusivity tensor <span class="MathJax_Preview"><script type="math/tex">
\mathbf{d}
</script>
</span> may be a function of strain and solute concentration.
</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.8.3.1">4.8.3.1</a> Constant Isotropic Diffusivity<a class="Label" name="subsec:Constant-Isotropic-Diffusivity"> </a>
</h4>
<div class="Unindented">
The material type for constant isotropic diffusivity materials is &ldquo;<i>diff-const-iso&rdquo;</i>. The following material parameters must be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;free_diff&gt;
</td>
<td align="left" valign="top" style="width: 3in;">
free diffusivity <span class="MathJax_Preview"><script type="math/tex">
d_{0}
</script>
</span> of solute (diffusivity in solution)
</td>
<td align="left" valign="top">
[<b>L</b><span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{2}}
</script>
</span>/<b>t</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;diff&gt;
</td>
<td align="left" valign="top" style="width: 3in;">
constant isotropic diffusivity <span class="MathJax_Preview"><script type="math/tex">
d
</script>
</span> of solute in biphasic-solute mixture
</td>
<td align="left" valign="top">
[<b>L</b><span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{2}}
</script>
</span>/<b>t</b>] 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
When the permeability is isotropic, <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\mathbf{d}=d\,\mathbf{I}

</script>

</span>
For this material model, <span class="MathJax_Preview"><script type="math/tex">
d
</script>
</span> is constant. This assumption is only true when strains are small. Note that the user must specify <span class="MathJax_Preview"><script type="math/tex">
d\leqslant d_{0}
</script>
</span>, since a solute cannot diffuse through the biphasic-solute mixture faster than in free solution.
</div>
<div class="Indented">
<i>Example:</i>
</div>
<pre class="LyX-Code">
&lt;diffusivity name="Permeability" type="diff-const-iso"&gt;
  &lt;free_diff&gt;1e-9&lt;/ free_diff &gt;
  &lt;diff&gt;0.5e-9&lt;/diff&gt;
&lt;/diffusivity&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.8.3.2">4.8.3.2</a> Constant Orthotropic Diffusivity<a class="Label" name="subsec:Constant-Orthotropic-Diffusivity"> </a>
</h4>
<div class="Unindented">
The material type for constant orthotropic diffusivity materials is &ldquo;<i>diff-const-ortho&rdquo;</i>. The following material parameters must be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;free_diff&gt;
</td>
<td align="left" valign="top">
free diffusivity <span class="MathJax_Preview"><script type="math/tex">
d_{0}
</script>
</span> of solute (diffusivity in solution)
</td>
<td align="left" valign="top">
[<b>L</b><span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{2}}
</script>
</span>/<b>t</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;diff&gt;
</td>
<td align="left" valign="top">
diffusivities <span class="MathJax_Preview"><script type="math/tex">
d^{a}
</script>
</span> along orthogonal directions (<span class="MathJax_Preview"><script type="math/tex">
a=1,2,3)
</script>
</span>
</td>
<td align="left" valign="top">
[<b>L</b><span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{2}}
</script>
</span>/<b>t</b>] 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
When the permeability is orhotropic, <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\mathbf{d}=\sum\limits _{a=1}^{3}d^{a}\mathbf{V}_{a}\otimes\mathbf{V}_{a}

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
\mathbf{V}_{a}
</script>
</span> are orthonormal vectors normal to the planes of symmetry (defined as described in Section <a class="Reference" href="#subsec:Specifying-Fiber-Orientation">4.1.1↑</a>). For this material model, <span class="MathJax_Preview"><script type="math/tex">
d^{a}
</script>
</span>’s are constant. Therefore this model should be used only when strains are small. Note that the user must specify <span class="MathJax_Preview"><script type="math/tex">
d^{a}\leqslant d_{0}
</script>
</span>, since a solute cannot diffuse through the biphasic-solute mixture faster than in free solution.
</div>
<div class="Indented">
<i>Example:</i>
</div>
<pre class="LyX-Code">
&lt;diffusivity name="Permeability" type="diff-const-ortho"&gt;
  &lt;free_diff&gt;0.005&lt;/ free_diff &gt;
  &lt;diff&gt;0.002,0.001,0.003&lt;/diff&gt;
&lt;/diffusivity&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.8.3.3">4.8.3.3</a> Referentially Isotropic Diffusivity<a class="Label" name="subsec:Referentially-Isotropic-Diffusiv"> </a>
</h4>
<div class="Unindented">
The material type for a strain-dependent diffusivity tensor which is isotropic in the reference configuration is <i>&ldquo;diff-ref-iso&rdquo;</i>. The following material parameters need to be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;free_diff&gt;
</td>
<td align="left" valign="top">
free diffusivity <span class="MathJax_Preview"><script type="math/tex">
d_{0}
</script>
</span>
</td>
<td align="left" valign="top">
[<b>L</b><span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{2}}
</script>
</span>/<b>t</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;diff0&gt;
</td>
<td align="left" valign="top">
diffusivity <span class="MathJax_Preview"><script type="math/tex">
d_{0r}
</script>
</span>
</td>
<td align="left" valign="top">
[<b>L</b><span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{2}}
</script>
</span>/<b>t</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;diff1&gt;
</td>
<td align="left" valign="top">
diffusivity <span class="MathJax_Preview"><script type="math/tex">
d_{1r}
</script>
</span>
</td>
<td align="left" valign="top">
[<b>L</b><span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{2}}
</script>
</span>/<b>t</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;diff2&gt;
</td>
<td align="left" valign="top">
diffusivity <span class="MathJax_Preview"><script type="math/tex">
d_{2r}
</script>
</span>
</td>
<td align="left" valign="top">
[<b>L</b><span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{2}}
</script>
</span>/<b>t</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;M&gt;
</td>
<td align="left" valign="top">
exponential strain-dependence coefficient <span class="MathJax_Preview"><script type="math/tex">
M
</script>
</span> (<span class="MathJax_Preview"><script type="math/tex">
M\geqslant0
</script>
</span>)
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;alpha&gt;
</td>
<td align="left" valign="top">
power-law exponent <span class="MathJax_Preview"><script type="math/tex">
\alpha
</script>
</span> (<span class="MathJax_Preview"><script type="math/tex">
\alpha\geqslant0
</script>
</span>)
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
This material uses a strain-dependent diffusivity tensor that accommodates strain-induced anisotropy: <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\mathbf{d}=\left(d_{0r}\mathbf{I}+\frac{d_{1r}}{J^{2}}\mathbf{b}+\frac{d_{2r}}{J^{4}}\mathbf{b}^{2}\right)\left(\frac{J-\varphi_{r}^{s}}{1-\varphi_{r}^{s}}\right)e^{M\left(J^{2}-1\right)/2},

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
J
</script>
</span>is the jacobian of the deformation, i.e. <span class="MathJax_Preview"><script type="math/tex">
J=\det\mathbf{F}
</script>
</span> where <span class="MathJax_Preview"><script type="math/tex">
\mathbf{F}
</script>
</span> is the deformation gradient, and <span class="MathJax_Preview"><script type="math/tex">
\mathbf{b}=\mathbf{F}\cdot\mathbf{F}^{T}
</script>
</span> is the left Cauchy-Green tensor. Note that the diffusivity in the reference state (<span class="MathJax_Preview"><script type="math/tex">
\mathbf{F}=\mathbf{I})
</script>
</span> is isotropic and given by <span class="MathJax_Preview"><script type="math/tex">
\mathbf{d}=\left(d_{0r}+d_{1r}+d_{2r}\right)\mathbf{I}
</script>
</span>.
</div>
<div class="Indented">
<i>Example:</i>
</div>
<pre class="LyX-Code">
&lt;diffusivity name="Diffusivity" type="diff-ref-iso"&gt;
  &lt;phi0&gt;0.2&lt;/phi0&gt;
  &lt;free_diff&gt;0.005&lt;/free_diff&gt;
  &lt;diff0&gt;0.001&lt;/diff0&gt;
  &lt;diff1&gt;0.005&lt;/diff1&gt;
  &lt;diff2&gt;0.002&lt;/diff2&gt;
  &lt;M&gt;1.5&lt;/M&gt;
  &lt;alpha&gt;2&lt;/alpha&gt;
&lt;/diffusivity&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.8.3.4">4.8.3.4</a> Referentially Orthotropic Diffusivity<a class="Label" name="subsec:Referentially-Orthotropic-Diffus"> </a>
</h4>
<div class="Unindented">
The material type for a strain-dependent diffusivity which is orthotropic in the reference configuration is <i>&ldquo;diff-ref-ortho&rdquo;</i>. The following material parameters need to be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;free_diff&gt;
</td>
<td align="left" valign="top" style="width: 3in;">
free diffusivity <span class="MathJax_Preview"><script type="math/tex">
d_{0}
</script>
</span>
</td>
<td align="left" valign="top">
[<b>L</b><span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{2}}
</script>
</span>/<b>t</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;diff0&gt;
</td>
<td align="left" valign="top" style="width: 3in;">
isotropic diffusivity <span class="MathJax_Preview"><script type="math/tex">
d_{0r}
</script>
</span>
</td>
<td align="left" valign="top">
[<b>L</b><span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{2}}
</script>
</span>/<b>t</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;diff1&gt; 
</td>
<td align="left" valign="top" style="width: 3in;">
diffusivities <span class="MathJax_Preview"><script type="math/tex">
d_{1r}^{a}
</script>
</span> along orthogonal directions (<span class="MathJax_Preview"><script type="math/tex">
a=1,2,3
</script>
</span>)
</td>
<td align="left" valign="top">
[<b>L</b><span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{2}}
</script>
</span>/<b>t</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;diff2&gt; 
</td>
<td align="left" valign="top" style="width: 3in;">
diffusivities <span class="MathJax_Preview"><script type="math/tex">
d_{2r}^{a}
</script>
</span> along orthogonal directions (<span class="MathJax_Preview"><script type="math/tex">
a=1,2,3
</script>
</span>)
</td>
<td align="left" valign="top">
[<b>L</b><span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{2}}
</script>
</span>/<b>t</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;M0&gt;
</td>
<td align="left" valign="top" style="width: 3in;">
isotropic exponential strain-dependence coefficient <span class="MathJax_Preview"><script type="math/tex">
M_{0}
</script>
</span> (<span class="MathJax_Preview"><script type="math/tex">
M_{0}\geqslant0
</script>
</span>)
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;M&gt; 
</td>
<td align="left" valign="top" style="width: 3in;">
orthotropic exponential strain-dependence coefficient <span class="MathJax_Preview"><script type="math/tex">
M_{a}
</script>
</span> (<span class="MathJax_Preview"><script type="math/tex">
a=1,2,3
</script>
</span>, <span class="MathJax_Preview"><script type="math/tex">
M_{a}\geqslant0
</script>
</span>)
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;alpha0&gt;
</td>
<td align="left" valign="top" style="width: 3in;">
isotropic power-law exponent <span class="MathJax_Preview"><script type="math/tex">
\alpha_{0}
</script>
</span> (<span class="MathJax_Preview"><script type="math/tex">
\alpha_{0}\geqslant0
</script>
</span>)
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;alpha&gt;
</td>
<td align="left" valign="top" style="width: 3in;">
power-law exponent <span class="MathJax_Preview"><script type="math/tex">
\alpha_{a}
</script>
</span> (<span class="MathJax_Preview"><script type="math/tex">
a=1,2,3
</script>
</span>, <span class="MathJax_Preview"><script type="math/tex">
\alpha_{a}\geqslant0
</script>
</span>)
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
This material uses a strain-dependent diffusivity tensor that accommodates strain-induced anisotropy: <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\mathbf{d}=d_{0}\mathbf{I}+\sum\limits _{a=1}^{3}d_{1}^{a}\mathbf{m}_{a}+d_{2}^{a}\left(\mathbf{m}_{a}\cdot\mathbf{b}+\mathbf{b}\cdot\mathbf{m}_{a}\right),

</script>

</span>
where, <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\begin{aligned}d_{0} & =d_{0r}\left(\frac{J-\varphi_{r}^{s}}{1-\varphi_{r}^{s}}\right)^{\alpha_{^{0}}}e^{M_{^{0}}\left(J^{2}-1\right)/2}\\
d_{1}^{a} & =\frac{d_{1r}^{a}}{J^{2}}\left(\frac{J-\varphi_{r}^{s}}{1-\varphi_{r}^{s}}\right)^{\alpha_{^{a}}}e^{M_{^{a}}\left(J^{2}-1\right)/2}\\
d_{2}^{a} & =\frac{d_{2r}^{a}}{2J^{4}}\left(\frac{J-\varphi_{r}^{s}}{1-\varphi_{r}^{s}}\right)^{\alpha_{^{a}}}e^{M_{a}\left(J^{2}-1\right)/2}
\end{aligned}
,\quad a=1,2,3

</script>

</span>
<span class="MathJax_Preview"><script type="math/tex">
J
</script>
</span> is the Jacobian of the deformation, i.e. <span class="MathJax_Preview"><script type="math/tex">
J=\det\mathbf{F}
</script>
</span> where <span class="MathJax_Preview"><script type="math/tex">
\mathbf{F}
</script>
</span> is the deformation gradient. <span class="MathJax_Preview"><script type="math/tex">
\mathbf{m}_{a}
</script>
</span> are second order tensors representing the spatial structural tensors describing the orthogonal planes of symmetry, given by <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\mathbf{m}_{a}=\mathbf{F}\cdot\left(\mathbf{V}_{a}\otimes\mathbf{V}_{a}\right)\cdot\mathbf{F}^{T},\quad a=1-3,

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
\mathbf{V}_{a}
</script>
</span> are orthonormal vectors normal to the planes of symmetry (defined as described in Section <a class="Reference" href="#subsec:Specifying-Fiber-Orientation">4.1.1↑</a>). Note that the diffusivity in the reference state (<span class="MathJax_Preview"><script type="math/tex">
\mathbf{F}=\mathbf{I})
</script>
</span> is given by <span class="MathJax_Preview"><script type="math/tex">
\mathbf{d}=d_{0r}\mathbf{I}+\sum\limits _{a=1}^{3}\left(d_{1r}^{a}+d_{2r}^{a}\right)\mathbf{V}_{a}\otimes\mathbf{V}_{a}
</script>
</span>.
</div>
<div class="Indented">
<i>Example:</i>
</div>
<pre class="LyX-Code">
&lt;diffusivity name="Diffusivity" type="diff-ref-ortho"&gt;
  &lt;phi0&gt;0.2&lt;/phi0&gt;
  &lt;free_diff&gt;0.005&lt;/free_diff&gt;
  &lt;diff00&gt;0.001&lt;/diff00&gt;
  &lt;diff1&gt;0.01, 0.02, 0.03&lt;/diff1&gt;
  &lt;diff2&gt;0.001, 0.002, 0.003&lt;/diff2&gt;
  &lt;M0&gt;0.5&lt;/M0&gt;
  &lt;M&gt;1.5, 2.0, 2.5&lt;/M&gt;
  &lt;alpha0&gt;1.5&lt;/alpha0&gt;
  &lt;alpha&gt;2, 2.5, 3&lt;/alpha&gt;
&lt;/diffusivity&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.8.3.5">4.8.3.5</a> Albro Isotropic Diffusivity<a class="Label" name="subsec:Albro-Isotropic-Diffusivity"> </a>
</h4>
<div class="Unindented">
The material type for a porosity and concentration-dependent diffusivity which is isotropic is <i>&ldquo;diff-Albro-iso&rdquo;</i>. The following material parameters need to be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;free_diff&gt;
</td>
<td align="left" valign="top" style="width: 3in;">
free diffusivity <span class="MathJax_Preview"><script type="math/tex">
d_{0}
</script>
</span>
</td>
<td align="left" valign="top">
[<b>L</b><span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{2}}
</script>
</span>/<b>t</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;cdinv&gt;
</td>
<td align="left" valign="top" style="width: 3in;">
inverse of characteristic concentration for concentration-dependence <span class="MathJax_Preview"><script type="math/tex">
c_{D}^{-1}
</script>
</span>
</td>
<td align="left" valign="top">
[<b>L</b><span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{3}}
</script>
</span>/<b>n</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;alphad&gt; 
</td>
<td align="left" valign="top" style="width: 3in;">
coefficient of porosity-dependence <span class="MathJax_Preview"><script type="math/tex">
\alpha_{D}
</script>
</span>
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
This material uses a porosity and concentration-dependent diffusivity tensor that remains isotropic with deformation: <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\mathbf{d}=d_{0}\exp\left(-\alpha_{D}\frac{1-\varphi^{w}}{\varphi^{w}}-\frac{c}{c_{D}}\right)\mathbf{I},

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
c_{D}^{-1}=1/c_{D}
</script>
</span> and the porosity <span class="MathJax_Preview"><script type="math/tex">
\varphi^{w}
</script>
</span> varies with deformation according to the kinematic constraint <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\varphi^{w}=1-\frac{\varphi_{r}^{s}}{J}\,.

</script>

</span>
<span class="MathJax_Preview"><script type="math/tex">
J
</script>
</span> is the Jacobian of the deformation, i.e. <span class="MathJax_Preview"><script type="math/tex">
J=\det\mathbf{F}
</script>
</span> where <span class="MathJax_Preview"><script type="math/tex">
\mathbf{F}
</script>
</span> is the deformation gradient and <span class="MathJax_Preview"><script type="math/tex">
\varphi_{r}^{s}
</script>
</span> is the referential solid volume fraction. Here, <span class="MathJax_Preview"><script type="math/tex">
c
</script>
</span> represents the actual concentration of the solute whose diffusivity is given by <span class="MathJax_Preview"><script type="math/tex">
\mathbf{d}
</script>
</span>. This constitutive relation is based on the experimental findings reported by Albro et al. <span class="bibcites">[<a class="bibliocite" name="cite-1" href="#biblio-1"><span class="bib-index">1</span></a>]</span>.
</div>
<div class="Indented">
<i>Example:</i>
</div>
<pre class="LyX-Code">
&lt;solute sol="1"&gt;
  &lt;diffusivity type="diff-Albro-iso"&gt;
    &lt;free_diff&gt;123e-6&lt;/free_diff&gt;
    &lt;alphad&gt;18&lt;/alphad&gt;
    &lt;cdinv&gt;0.0625&lt;/cdinv&gt;
  &lt;/diffusivity&gt;
  &lt;solubility type="solub-const"&gt;
    &lt;solub&gt;1&lt;/solub&gt;
  &lt;/solubility&gt;
&lt;/solute&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-4.8.4">4.8.4</a> Solubility Materials<a class="Label" name="subsec:Solubility-Materials"> </a>
</h3>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.8.4.1">4.8.4.1</a> Constant Solubility<a class="Label" name="subsec:Constant-Solubility"> </a>
</h4>
<div class="Unindented">
The material type for constant solubility materials is &ldquo;<i>solub-const&rdquo;</i>. The following material parameters must be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;solub&gt;
</td>
<td align="left" valign="top">
solubility <span class="MathJax_Preview"><script type="math/tex">
\tilde{\kappa}
</script>
</span>
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
For this material model, <span class="MathJax_Preview"><script type="math/tex">
\tilde{\kappa}
</script>
</span> is constant.
</div>
<div class="Indented">
<i>Example:</i>
</div>
<pre class="LyX-Code">
&lt;solubility name="Solubility" type="solub-const"&gt;
  &lt;solub&gt;1&lt;/solub&gt;
&lt;/solubility&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-4.8.5">4.8.5</a> Osmotic Coefficient Materials<a class="Label" name="subsec:Osmotic-Coefficient-Materials"> </a>
</h3>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.8.5.1">4.8.5.1</a> Constant Osmotic Coefficient<a class="Label" name="subsec:Constant-Osmotic-Coefficient"> </a>
</h4>
<div class="Unindented">
The material type for constant osmotic coefficient materials is &ldquo;<i>osm-coef-const&rdquo;</i>. The following material parameters must be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;osmcoef&gt;
</td>
<td align="left" valign="top">
Osmotic coefficient <span class="MathJax_Preview"><script type="math/tex">
\Phi
</script>
</span>
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
For this material model, <span class="MathJax_Preview"><script type="math/tex">
\Phi
</script>
</span> is constant.
</div>
<div class="Indented">
<i>Example:</i>
</div>
<pre class="LyX-Code">
&lt;osmotic_coefficient name="Osmotic coefficient" type="osm-coef-const"&gt;
  &lt;osmcoef&gt;1&lt;/osmcoef&gt;
&lt;/osmotic_coefficient&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h2 class="Section">
<a class="toc" name="toc-Section-4.9">4.9</a> Triphasic and Multiphasic Materials<a class="Label" name="sec:Triphasic-Multiphasic-Materials"> </a>
</h2>
<div class="Unindented">
Triphasic materials may be used to model the transport of a solvent and a pair of monovalent salt counter-ions (two solutes with charge numbers <span class="MathJax_Preview"><script type="math/tex">
+
</script>
</span>1 and -1) in a charged porous solid matrix, under isothermal conditions. Multiphasic materials may be used to model the transport of a solvent and any number of neutral or charged solutes; a triphasic mixture is a special case of a multiphasic mixture. Each of the mixture constituents is assumed to be intrinsically incompressible. This means that their true densities are invariant in space and time; this assumption further implies that a multiphasic mixture will undergo zero volume change when subjected to a hydrostatic fluid pressure. Yet the mixture is compressible because the pores of the solid matrix may gain or lose fluid under general loading conditions. Therefore, the constitutive relation of the solid matrix should be chosen from the list of compressible materials provided in Section <a class="Reference" href="#subsec:Compressible-Materials">4.1.3↑</a>. The volume fraction of the solutes is assumed to be negligible relative to the volume fractions of the solid or solvent. This means that the mixture will not change in volume as the solute concentrations change. As the solutes transport through the mixture, they may experience frictional interactions with the solvent and the solid. This friction may act as a hindrance to the solute transport, or may help convect the solutes through the mixture. The distinction between frictional exchanges with the solvent and solid is embodied in the specification of two diffusivities for each solute: The free diffusivity, which represents diffusivity in the absence of a solid matrix (frictional exchange only with the solvent) and the mixture diffusivity, which represents the combined frictional interactions with the solvent and solid matrix. The user is referred to the <a href="http://help.mrl.sci.utah.edu/help/index.jsp">FEBio Theory Manual</a> for a more detailed description of triphasic and multiphasic theory.
</div>
<div class="Indented">
Due to steric volume exclusion and short-range electrostatic interactions, a solute <span class="MathJax_Preview"><script type="math/tex">
\alpha
</script>
</span> may not have access to all of the pores of the solid matrix. In other words, only a fraction <span class="MathJax_Preview"><script type="math/tex">
\kappa^{\alpha}
</script>
</span> of the pores is able to accommodate solute <span class="MathJax_Preview"><script type="math/tex">
\alpha
</script>
</span> (<span class="MathJax_Preview"><script type="math/tex">
0<\kappa^{\alpha}\leqslant1)
</script>
</span>. Furthermore, the activity <span class="MathJax_Preview"><script type="math/tex">
\gamma^{\alpha}
</script>
</span> of solute <span class="MathJax_Preview"><script type="math/tex">
\alpha
</script>
</span> (the extent by which the solute concentration influences its chemical potential) may be similarly altered by the surrounding porous solid matrix. Therefore, the combined effects of volume exclusion and attenuation of activity may be represented by the effective solubility <span class="MathJax_Preview"><script type="math/tex">
\hat{\kappa}^{\alpha}=\kappa^{\alpha}/\gamma^{\alpha}
</script>
</span>, such that the chemical potential <span class="MathJax_Preview"><script type="math/tex">
\mu
</script>
</span> of the solute is given by <span class="MathJax_Preview">
<script type="math/tex;mode=display">
\begin{equation}
\mu^{\alpha}=\mu_{0}^{\alpha}\left(\theta\right)+\frac{R\theta}{M^{\alpha}}\ln\frac{c^{\alpha}}{\hat{\kappa}^{\alpha}}\,.\label{eq:mp-solute-chemical-potential}
\end{equation}
</script>

</span>
In this expression, <span class="MathJax_Preview"><script type="math/tex">
\mu_{0}^{\alpha}
</script>
</span> is the solute chemical potential at some reference temperature <span class="MathJax_Preview"><script type="math/tex">
\theta
</script>
</span>; <span class="MathJax_Preview"><script type="math/tex">
c^{\alpha}
</script>
</span> is the solute concentration on a solution-volume basis (number of moles of solute per volume of interstitial fluid in the mixture); <span class="MathJax_Preview"><script type="math/tex">
M^{\alpha}
</script>
</span> is the solute molecular weight (an invariant quantity); and <span class="MathJax_Preview"><script type="math/tex">
R
</script>
</span> is the universal gas constant. In a triphasic material, a constitutive relation is needed for <span class="MathJax_Preview"><script type="math/tex">
\hat{\kappa}^{\alpha}
</script>
</span>; in general, <span class="MathJax_Preview"><script type="math/tex">
\hat{\kappa}^{\alpha}
</script>
</span> may be a function of the solid matrix strain and the solute concentration. In FEBio, the dependence of the effective solubility on the solid matrix strain is currently constrained to a dependence on <span class="MathJax_Preview"><script type="math/tex">
J=\det\mathbf{F}
</script>
</span>.
</div>
<div class="Indented">
The solid matrix of a multiphasic material may be charged and its charge density is given by <span class="MathJax_Preview"><script type="math/tex">
c^{F}
</script>
</span>. This charge density may be either negative or positive. The charge density varies with the deformation, increasing when the pore volume decreases. Based on the balance of mass for the solid, <span class="MathJax_Preview">
<script type="math/tex;mode=display">
\begin{equation}
c^{F}=\frac{1-\varphi_{r}^{s}}{J-\varphi_{r}^{s}}c_{r}^{F},\label{eq:mp-CFD-mass-balance}
\end{equation}
</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
\varphi_{r}^{s}
</script>
</span> is the solid volume fraction and <span class="MathJax_Preview"><script type="math/tex">
c_{r}^{F}
</script>
</span> is the fixed charge density in the reference configuration.
</div>
<div class="Indented">
In the multiphasic theory it is assumed that electroneutrality is satisfied at all times. In other words, the net charge of the mixture is always zero (neutral). This electroneutrality condition is represented by a constraint equation on the ion concentrations, <span class="MathJax_Preview">
<script type="math/tex;mode=display">
\begin{equation}
c^{F}+\sum\limits _{\alpha}z^{\alpha}c^{\alpha}=0\,,\label{eq:mp-electroneutrality}
\end{equation}
</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
z^{\alpha}
</script>
</span> is the charge number of solute <span class="MathJax_Preview"><script type="math/tex">
\alpha z^{-}=-1
</script>
</span>. Since the concentrations of the cation and anion inside the triphasic material are not the same, an electrical potential difference is produced between the interstitial and external environments. The electric potential in the triphasic mixture is denoted by <span class="MathJax_Preview"><script type="math/tex">
\psi
</script>
</span> and its effect combines with the chemical potential of each solute to produce the electrochemical potential <span class="MathJax_Preview"><script type="math/tex">
\tilde{\mu}^{\alpha}
</script>
</span>, where <span class="MathJax_Preview">
<script type="math/tex;mode=display">
\begin{equation}
\tilde{\mu}^{\alpha}=\mu_{0}^{\alpha}\left(\theta\right)+\frac{R\theta}{M^{\alpha}}\ln\frac{c^{\alpha}}{\hat{\kappa}^{\alpha}}+\frac{z^{\alpha}}{M^{\alpha}}F_{c}\psi\,.\label{eq:mp-solute-ecp}
\end{equation}
</script>

</span>
In this expression, <span class="MathJax_Preview"><script type="math/tex">
F_{c}
</script>
</span> represents Faraday’s constant. It is also possible to rearrange this expression as <span class="MathJax_Preview">
<script type="math/tex;mode=display">
\begin{equation}
\tilde{\mu}^{\alpha}=\mu_{0}^{\alpha}\left(\theta\right)+\frac{R\theta}{M^{\alpha}}\ln\left[\exp\left(z^{\alpha}\frac{F_{c}\psi}{R\theta}\right)\frac{c^{\alpha}}{\hat{\kappa}^{\alpha}}\right]\,.\label{eq:mp-solute-ecp-redux}
\end{equation}
</script>

</span>
In a multiphasic material, the interstitial fluid pressure <span class="MathJax_Preview"><script type="math/tex">
p
</script>
</span> is influenced by both mechanical and chemical environments. In other words, this pressure includes both mechanical and osmotic contributions, the latter arising from the presence of the solutes. The solvent mechano-chemical potential <span class="MathJax_Preview"><script type="math/tex">
\tilde{\mu}^{w}
</script>
</span> is given by <span class="MathJax_Preview">
<script type="math/tex;mode=display">
\begin{equation}
\tilde{\mu}^{w}=\mu_{0}^{w}\left(\theta\right)+\frac{1}{\rho_{T}^{w}}\left(p-R\theta\Phi\sum\limits _{\alpha}c^{\alpha}\right)\,,\label{eq:mp-solven-mcp}
\end{equation}
</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
\mu_{0}^{w}
</script>
</span> is the solvent chemical potential at some reference temperature <span class="MathJax_Preview"><script type="math/tex">
\theta
</script>
</span>; <span class="MathJax_Preview"><script type="math/tex">
\rho_{T}^{w}
</script>
</span> is the true density of the solvent (an invariant property for an intrinsically incompressible fluid); and <span class="MathJax_Preview"><script type="math/tex">
\Phi
</script>
</span> is the osmotic coefficient which represents the extent by which the solute concentrations influence the solvent chemical potential. In a multiphasic material, a constitutive relation is needed for <span class="MathJax_Preview"><script type="math/tex">
\Phi
</script>
</span>; in general, <span class="MathJax_Preview"><script type="math/tex">
\Phi
</script>
</span> may be a function of the solid matrix strain and the solute concentrations. In FEBio, the dependence of the osmotic coefficient on the solid matrix strain is currently constrained to a dependence on <span class="MathJax_Preview"><script type="math/tex">
J=\det\mathbf{F}
</script>
</span>.
</div>
<div class="Indented">
The solute mechano-electrochemical potential is nearly equal to its electrochemical potential because the solute volume fraction is assumed to be negligible. The solvent mechano-electrochemical potential is the same as its mechano-chemical potential, since the solvent is neutral in a multiphasic mixture. In general, momentum and energy balances evaluated across a boundary surface in a multiphasic mixture require that the mechano-electrochemical potentials of solvent and solutes be continuous across that surface. These continuity requirements are enforced automatically in FEBio by defining the effective fluid pressure <span class="MathJax_Preview"><script type="math/tex">
\tilde{p}
</script>
</span> and solute concentration <span class="MathJax_Preview"><script type="math/tex">
\tilde{c}^{\alpha}
</script>
</span> as <span class="MathJax_Preview">
<script type="math/tex;mode=display">
\begin{equation}
\begin{aligned}\tilde{p} & =p-R\theta\Phi\sum\nolimits _{\alpha}c^{\alpha}\\
\tilde{c}^{\alpha} & =c^{\alpha}/\tilde{\kappa}^{\alpha}
\end{aligned}
\,,\label{eq:mp-effective-p-c}
\end{equation}
</script>

</span>
where
</div>
<div class="Indented">
<span class="MathJax_Preview">
<script type="math/tex;mode=display">
\begin{equation}
\tilde{\kappa}^{\alpha}=\hat{\kappa}^{\alpha}\exp\left(-z^{\alpha}\frac{F_{c}\psi}{R\theta}\right)\label{eq:mp-partition-coeff}
\end{equation}
</script>

</span>
is the partition coefficient for solute <span class="MathJax_Preview"><script type="math/tex">
\alpha
</script>
</span>. The partition coefficient incorporates the combined effects of solubility and long-range electrostatic interactions to determine the ratio of interstitial to external concentration for that solute. Therefore, the effective concentration represents a measure of the <i>activity</i> of the solute, as understood in chemistry. The effective fluid pressure represents that part of the pressure which is over and above osmotic effects.
</div>
<div class="Indented">
In FEBio, nodal variables consist of the solid matrix displacement <span class="MathJax_Preview"><script type="math/tex">
\mathbf{u}
</script>
</span>, the effective fluid pressure <span class="MathJax_Preview"><script type="math/tex">
\tilde{p}
</script>
</span>, and the effective solute concentrations <span class="MathJax_Preview"><script type="math/tex">
\tilde{c}^{\alpha}
</script>
</span>. Essential boundary conditions must be imposed on these variables, and not on the actual pressure <span class="MathJax_Preview"><script type="math/tex">
p
</script>
</span> or concentrations <span class="MathJax_Preview"><script type="math/tex">
c^{\alpha}
</script>
</span>. (In a biphasic material however, since <span class="MathJax_Preview"><script type="math/tex">
c^{\alpha}=0
</script>
</span>, the effective and actual fluid pressures are the same, <span class="MathJax_Preview"><script type="math/tex">
p=\tilde{p}
</script>
</span>.)
</div>
<div class="Indented">
The mixture stress in a triphasic material is given by <span class="MathJax_Preview"><script type="math/tex">
\boldsymbol{\sigma}=-p\mathbf{I}+\boldsymbol{\sigma}^{e}
</script>
</span>, where <span class="MathJax_Preview"><script type="math/tex">
\boldsymbol{\sigma}^{e}
</script>
</span> is the stress arising from the solid matrix strain. The mixture traction on a surface with unit outward normal <span class="MathJax_Preview"><script type="math/tex">
\mathbf{n}
</script>
</span> is <span class="MathJax_Preview"><script type="math/tex">
\mathbf{t}=\boldsymbol{\sigma}\cdot\mathbf{n}
</script>
</span>. This traction is continuous across the boundary surface. Therefore, the corresponding natural boundary condition for a multiphasic mixture is <span class="MathJax_Preview"><script type="math/tex">
\mathbf{t}=\mathbf{0}
</script>
</span>. (In other words, if no boundary condition is imposed on the solid matrix displacement or mixture traction, the natural boundary condition is in effect.)
</div>
<div class="Indented">
The natural boundary conditions for the solvent and solutes are similarly <span class="MathJax_Preview"><script type="math/tex">
\mathbf{w}\cdot\mathbf{n}=0
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
\mathbf{j}^{\alpha}\cdot\mathbf{n}=0
</script>
</span>, where <span class="MathJax_Preview"><script type="math/tex">
\mathbf{w}
</script>
</span> is the volumetric flux of solvent relative to the solid and <span class="MathJax_Preview"><script type="math/tex">
\mathbf{j}^{\alpha}
</script>
</span> is the molar flux of solute <span class="MathJax_Preview"><script type="math/tex">
\alpha
</script>
</span> relative to the solid. In general, <span class="MathJax_Preview"><script type="math/tex">
\mathbf{w}
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
\mathbf{j}^{\alpha}
</script>
</span> are given by
</div>
<div class="Indented">
<span class="MathJax_Preview">
<script type="math/tex;mode=display">
\begin{equation}
\begin{aligned}\mathbf{w} & =-\mathbf{\tilde{k}}\cdot\left(\nabla\tilde{p}+R\theta\sum\limits _{\alpha}\frac{\tilde{\kappa}^{\alpha}}{d_{0}^{\alpha}}\mathbf{d}^{\alpha}\cdot\nabla\tilde{c}^{\alpha}\right),\\
\mathbf{j}^{\alpha} & =\tilde{\kappa}^{\alpha}\,\mathbf{d}^{\alpha}\cdot\left(-\varphi^{w}\nabla\tilde{c}^{\alpha}+\frac{\tilde{c}^{\alpha}}{d_{0}^{\alpha}}\mathbf{w}\right),
\end{aligned}
\label{eq:mp-fluxes-w-j}
\end{equation}
</script>

</span>
where<span class="MathJax_Preview">
<script type="math/tex;mode=display">
\begin{equation}
\mathbf{\tilde{k}}=\left[\mathbf{k}^{-1}+\frac{R\theta}{\varphi^{w}}\sum\limits _{\alpha}\frac{\tilde{\kappa}^{\alpha}c^{\alpha}}{d_{0}^{\alpha}}\left(\mathbf{I}-\frac{\mathbf{d}^{\alpha}}{d_{0}^{\alpha}}\right)\right]^{-1}\label{eq:mp-effective-perm}
\end{equation}
</script>

</span>
is the effective hydraulic permeability of the interstitial fluid solution (solvent and solutes) through the porous solid matrix; <span class="MathJax_Preview"><script type="math/tex">
\mathbf{k}
</script>
</span> is the hydraulic permeability of the solvent through the porous solid matrix; <span class="MathJax_Preview"><script type="math/tex">
\mathbf{d}^{\alpha}
</script>
</span> is the diffusivity of solute <span class="MathJax_Preview"><script type="math/tex">
\alpha
</script>
</span> through the mixture (frictional interactions with solvent and solid); and <span class="MathJax_Preview"><script type="math/tex">
d_{0}^{\alpha}
</script>
</span> is its free diffusivity (frictional interactions with solvent only). <span class="MathJax_Preview"><script type="math/tex">
\varphi^{w}\approx1-\varphi^{s}
</script>
</span> is the solid matrix porosity in the current configuration. The above expressions for the solvent and solute flux do not account for external body forces.
</div>
<div class="Indented">
Also see Section <a class="Reference" href="#sec:Guidelines-for-Multiphasic">8.5↓</a> for additional guidelines for running multiphasic materials.
</div>
<div class="Indented">
<p><br/>
</p>

</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-4.9.1">4.9.1</a> Guidelines for Multiphasic Analyses<a class="Label" name="subsec:Guidelines-Multiphasic-Analyses"> </a>
</h3>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.9.1.1">4.9.1.1</a> Initial State of Swelling<a class="Label" name="subsec:Initial-State-Swelling"> </a>
</h4>
<div class="Unindented">
Under traction-free conditions, a multiphasic material is usually in a state of swelling due to the osmotic pressure difference between the interstitial fluid and the external environment. This osmotic pressure arises from the difference in interstitial versus external concentrations of cations and anions, caused by the charged solid matrix and the requirement to satisfy electroneutrality. An osmotic pressure difference arising from such electrostatic interactions is known as the <i>Donnan osmotic pressure</i>. When the Donnan pressure is non-zero, traction-free conditions do not produce stress-free conditions for the solid matrix, since the matrix must expand until its stressed state resists the swelling pressure.
</div>
<div class="Indented">
The Donnan pressure reduces to zero when the fixed charged density is zero, or when the external environment is infinitely hypertonic (having ion concentrations infinitely greater than the interstitial fixed charge density). Since these two conditions represent special cases, it is generally necessary to devise methods for achieving the desired initial state of swelling, in an analysis where loads or displacements need to be prescribed over and above this swollen state. Swelling occurs as a result of the influx of solvent into the porous solid matrix. This influx is a time-dependent process that could require extensive analysis time. Therefore, it is computationally efficacious to achieve the initial state of swelling by using a multi-step analysis (Chapter <a class="Reference" href="#chap:Multi-step-Analysis">6↓</a>) where the first step is a steady-state analysis (Section <a class="Reference" href="#subsec:Common-Parameters">3.5.1↑</a>). In this steady-state step, the fixed charge density may be ramped up from zero to the desired value using a load curve for that property or, alternatively, the external environmental conditions may be reduced from a very high hypertonic state down to the desired level. In the second step, prescribed displacement boundary conditions (when needed) may be specified to be of type <i>relative</i> (Section <a class="Reference" href="#subsec:Prescribed-Nodal-Degrees">3.11.1↑</a>), so that they become superposed over and above the initial swelling state.
</div>
<div class="Indented">
<i>Example:</i>
</div>
<pre class="LyX-Code">
&lt;Step&gt;
  &lt;Module type="multiphasic"/&gt;
  &lt;Control&gt;
    &lt;analysis type="steady-state"/&gt;
    ...
  &lt;/Control&gt;
&lt;/Step&gt;
&lt;Step&gt;
  &lt;Module type="multiphasic"/&gt;
  &lt;Control&gt;
    ...
  &lt;/Control&gt;
  &lt;Boundary&gt;
    &lt;prescribe type="relative"&gt;
      &lt;node id="22" bc="z" lc="4"&gt;1&lt;/node&gt;
      ...
    &lt;/prescribe&gt;
  &lt;/Boundary&gt;
&lt;/Step&gt;
</pre>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.9.1.2">4.9.1.2</a> Prescribed Boundary Conditions<a class="Label" name="subsec:Prescribed-BC-Multiphasic"> </a>
</h4>
<div class="Unindented">
In most analyses, it may be assumed that the ambient fluid pressure and electric potential in the external environment are zero, thus <span class="MathJax_Preview"><script type="math/tex">
p_{\ast}=0
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
\psi_{\ast}=0
</script>
</span>, where the subscripted asterisk is used to denote environmental conditions. Since the external environment does not include a solid matrix, the fixed charge density there is zero. For example, in a triphasic analysis, <span class="MathJax_Preview"><script type="math/tex">
c_{\ast}^{+}=c_{\ast}^{-}\equiv c_{\ast}
</script>
</span>. It follows that the effective fluid pressure in the external environment is <span class="MathJax_Preview"><script type="math/tex">
\tilde{p}_{\ast}=-R\theta\Phi_{\ast}\sum\nolimits _{\alpha}c_{\ast}^{\alpha}
</script>
</span> and the effective concentrations are <span class="MathJax_Preview"><script type="math/tex">
\tilde{c}_{\ast}^{\alpha}=c_{\ast}^{\alpha}/\hat{\kappa}_{\ast}^{\alpha}\tilde{c}_{\ast}^{\alpha}
</script>
</span>. Therefore, in multiphasic analyses, whenever the external environment contains solutes with non-zero concentrations <span class="MathJax_Preview"><script type="math/tex">
c_{\ast}^{\alpha}
</script>
</span>, the user must remember to prescribe non-zero boundary conditions for the effective solute concentrations <i>and</i> the effective fluid pressure.
</div>
<div class="Indented">
Letting <span class="MathJax_Preview"><script type="math/tex">
p_{\ast}=0
</script>
</span> also implies that prescribed mixture normal tractions (Section <a class="Reference" href="#subsec:Mixture-Normal-Traction">3.12.2.3↑</a>) represent only the traction above ambient conditions. Note that users are not obligated to assume that <span class="MathJax_Preview"><script type="math/tex">
p_{\ast}=0
</script>
</span>. However, if a non-zero value is assumed for the ambient pressure, then users must remember to incorporate this non-zero value whenever prescribing mixture normal tractions. Similarly, users are not required to assume that <span class="MathJax_Preview"><script type="math/tex">
\psi_{\ast}=0
</script>
</span>; when a non-zero value is assumed for the electric potential of the external environment, the prescribed boundary conditions for the effective concentrations should be evaluated using the corresponding partition coefficient, <span class="MathJax_Preview"><script type="math/tex">
\tilde{c}_{\ast}^{\alpha}=c_{\ast}^{\alpha}/\tilde{\kappa}_{\ast}^{\alpha}\tilde{c}_{\ast}^{\alpha}
</script>
</span>.
</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.9.1.3">4.9.1.3</a> Prescribed Initial Conditions<a class="Label" name="subsec:Prescribed-IC-Multiphasic"> </a>
</h4>
<div class="Unindented">
When a multiphasic material is initially exposed to a given external environment with effective pressure <span class="MathJax_Preview"><script type="math/tex">
\tilde{p}_{\ast}
</script>
</span> and effective concentrations <span class="MathJax_Preview"><script type="math/tex">
\tilde{c}_{\ast}^{\alpha}
</script>
</span>, the initial conditions inside the material should be set to <span class="MathJax_Preview"><script type="math/tex">
\tilde{p}=\tilde{p}_{\ast}
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
\tilde{c}^{\alpha}=\tilde{c}_{\ast}^{\alpha}
</script>
</span> in order to expedite the evaluation of the initial state of swelling. The values of <span class="MathJax_Preview"><script type="math/tex">
\tilde{p}_{\ast}
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
\tilde{c}_{\ast}^{\alpha}
</script>
</span> should be evaluated as described in Section <a class="Reference" href="#subsec:Prescribed-Boundary-Conditions-1">8.5.2↓</a>.
</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.9.1.4">4.9.1.4</a> Prescribed Effective Solute Flux<a class="Label" name="subsec:Prescribed-Effective-Solute-Flux"> </a>
</h4>
<div class="Unindented">
The finite element formulation for multiphasic materials in FEBio requires that the natural boundary condition for solute <span class="MathJax_Preview"><script type="math/tex">
\alpha
</script>
</span> be prescribed as <span class="MathJax_Preview"><script type="math/tex">
\tilde{j}_{n}^{\alpha}\equiv j_{n}^{\alpha}+\sum\nolimits _{\beta}z^{\beta}j_{n}^{\beta}
</script>
</span>, where <span class="MathJax_Preview"><script type="math/tex">
\tilde{j}_{n}^{\alpha}
</script>
</span> is the effective solute flux. For a mixture containing only neutral solutes (<span class="MathJax_Preview"><script type="math/tex">
z^{\beta}=0,\,\forall\beta
</script>
</span> ), it follows that <span class="MathJax_Preview"><script type="math/tex">
\tilde{j}_{n}^{\alpha}=j_{n}^{\alpha}
</script>
</span>.
</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.9.1.5">4.9.1.5</a> Prescribed Electric Current Density<a class="Label" name="subsec:Prescribed-Electric-Current"> </a>
</h4>
<div class="Unindented">
The electric current density in a mixture is a linear superposition of the ion fluxes, <span class="MathJax_Preview">
<script type="math/tex;mode=display">
\begin{equation}
\mathbf{I}_{e}=F_{c}\sum\limits _{\alpha}z^{\alpha}\mathbf{j}^{\alpha}\,.\label{eq:mp-electric-current-density}
\end{equation}
</script>

</span>
Since only the normal component <span class="MathJax_Preview"><script type="math/tex">
j_{n}^{\alpha}=\mathbf{j}^{\alpha}\cdot\mathbf{n}
</script>
</span> of ion fluxes may be prescribed at a boundary, it follows that only the normal component <span class="MathJax_Preview"><script type="math/tex">
I_{n}=\mathbf{I}_{e}\cdot\mathbf{n}
</script>
</span> of the current density may be prescribed. To prescribe <span class="MathJax_Preview"><script type="math/tex">
I_{n}
</script>
</span>, it is necessary to know the nature of the ion species in the mixture, and how the current is being applied. For example, if the ions in the triphasic mixture consist of Na<span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{+}}
</script>
</span> and Cl<span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{-}}
</script>
</span>, and if the current is being applied using silver/silver chloride (Ag/AgCl) electrodes, a chemical reaction occurs at the anode where Ag combines with Cl<span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{-}}
</script>
</span> to produce AgCl, donating an electron to the electrode to transport the current. At the cathode, the reverse process takes place. Therefore, in this system, there is only flux of Cl<span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{-}}
</script>
</span> and no flux of Na<span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{+}}
</script>
</span> (<span class="MathJax_Preview"><script type="math/tex">
j_{n}^{+}=0
</script>
</span>) at the electrode-mixture interface, so that the prescribed boundary condition should be <span class="MathJax_Preview"><script type="math/tex">
j_{n}^{-}=-I_{n}/F_{c}
</script>
</span>. Since <span class="MathJax_Preview"><script type="math/tex">
z^{+}=+1
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
z^{-}=-1
</script>
</span> in a triphasic mixture, the corresponding effective fluxes are given by <span class="MathJax_Preview"><script type="math/tex">
\tilde{j}_{n}^{+}=2j_{n}^{+}-j_{n}^{-}=I_{n}/F_{c}
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
\tilde{j}_{n}^{-}=j_{n}^{+}=0
</script>
</span>.
</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.9.1.6">4.9.1.6</a> Electrical Grounding<a class="Label" name="subsec:Electrical-Grounding"> </a>
</h4>
<div class="Unindented">
If a multiphasic mixture containing ions is completely surrounded by ion-impermeant boundaries it is necessary to ground the mixture to prevent unconstrained fluctuations of the electric potential. Grounding is performed by prescribing the effective concentration of one or more ions, at a location inside the mixture or on one of its boundaries corresponding to the location of the grounding electrode. The choice of ion(s) to constrain may be guided by the type of grounding electrode and the reference electrolyte bath in which it is inserted.
</div>
<div class="Indented">
<p><br/>
</p>

</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-4.9.2">4.9.2</a> General Specification of Multiphasic Materials<a class="Label" name="subsec:General-Specification-Multiphasic-Mat"> </a>
</h3>
<div class="Unindented">
The material type for a multiphasic material is &ldquo;<i>multiphasic</i>&rdquo;. Constitutive relations must be provided for the solid matrix, the mixture fixed charge density, the hydraulic permeability <span class="MathJax_Preview"><script type="math/tex">
\mathbf{k}
</script>
</span>, the osmotic coefficient <span class="MathJax_Preview"><script type="math/tex">
\Phi
</script>
</span>, and the properties of each solute: the solute diffusivity in the mixture <span class="MathJax_Preview"><script type="math/tex">
\mathbf{d}^{\alpha}
</script>
</span>, the solute free diffusivity <span class="MathJax_Preview"><script type="math/tex">
d_{0}^{\alpha}
</script>
</span>, and the solute effective solubility <span class="MathJax_Preview"><script type="math/tex">
\hat{\kappa}^{\alpha}
</script>
</span>. Therefore, the following parameters must be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;solid&gt;
</td>
<td align="left" valign="top">
specification of the solid matrix
</td>
<td align="left" valign="top">

</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;phi0&gt;
</td>
<td align="left" valign="top">
solid volume fraction <span class="MathJax_Preview"><script type="math/tex">
\varphi_{r}^{s}
</script>
</span> in the reference configuration
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;fixed_charge_density&gt;
</td>
<td align="left" valign="top">
fixed charge density <span class="MathJax_Preview"><script type="math/tex">
c_{r}^{F}
</script>
</span> in the reference configuration
</td>
<td align="left" valign="top">
[<b>n</b>/<b>L</b><span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{3}}
</script>
</span>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;permeability&gt;
</td>
<td align="left" valign="top">
specification of the hydraulic permeability <span class="MathJax_Preview"><script type="math/tex">
\mathbf{k}
</script>
</span>
</td>
<td align="left" valign="top">

</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;solvent_supply&gt;
</td>
<td align="left" valign="top">
specification of the solvent supply <span class="MathJax_Preview"><script type="math/tex">
\hat{\varphi}^{w}
</script>
</span>
</td>
<td align="left" valign="top">

</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;osmotic_coefficient&gt;
</td>
<td align="left" valign="top">
specification of the osmotic coefficient <span class="MathJax_Preview"><script type="math/tex">
\Phi
</script>
</span>
</td>
<td align="left" valign="top">

</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;solute&gt;
</td>
<td align="left" valign="top">
specification of the solute properties
</td>
<td align="left" valign="top">

</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;solid_bound&gt;
</td>
<td align="left" valign="top">
specification of solid-bound molecule
</td>
<td align="left" valign="top">

</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
The &lt;solid&gt; tag encloses a description of the solid matrix constitutive relation and associated material properties, as may be selected from the list provided in Section <a class="Reference" href="#subsec:Compressible-Materials">4.1.3↑</a>. The solid volume fraction in the reference configuration, &lt;phi0&gt;, must be greater than 0 (no solid) and less than 1 (only solid). The volume fraction of fluid (also known as the porosity) in the reference configuration is given by <span class="MathJax_Preview"><script type="math/tex">
1-\varphi_{0}
</script>
</span>. The &lt;fixed_charge_density&gt; may be negative, positive, or zero. The &lt;permeability&gt; and &lt;osmotic_coefficient&gt; tags enclose descriptions of the permeability and osmotic coefficient constitutive relations and their associated material properties, as may be selected from the list presented in Sections <a class="Reference" href="#subsec:Permeability-Materials">4.7.2↑</a> and <a class="Reference" href="#subsec:Osmotic-Coefficient-Materials">4.8.5↑</a>.
</div>
<div class="Indented">
The optional &lt;solute&gt; tag provides a description of each solute in the multiphasic mixture. Multiple solutes may be defined. Each tag includes the required <i>sol</i> attribute, which should reference a solute <i>id</i> from the &lt;Solutes&gt; description in the &lt;Globals&gt; section (Section <a class="Reference" href="#subsec:Solutes">3.6.2↑</a>). The following parameters must be defined in this description:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;diffusivity&gt;
</td>
<td align="left" valign="top">
specification of the solute diffusivities <span class="MathJax_Preview"><script type="math/tex">
\mathbf{d}^{\alpha}
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
d_{0}^{\alpha}
</script>
</span> 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;solubility&gt;
</td>
<td align="left" valign="top">
specification of the solute effective solubility <span class="MathJax_Preview"><script type="math/tex">
\hat{\kappa}^{\alpha}
</script>
</span> 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
The &lt;diffusivity&gt; and &lt;solubility&gt; tags enclose descriptions of materials that may be selected from the lists presented in Sections <a class="Reference" href="#subsec:Diffusivity-Materials">4.8.3↑</a> and <a class="Reference" href="#subsec:Solubility-Materials">4.8.4↑</a>, respectively. Each solute tag must include a &ldquo;sol&rdquo; attribute
</div>
<div class="Indented">
The optional &lt;solid_bound&gt; tag specifies which solid-bound molecule should be included in the multiphasic mixture. Multiple solid-bound molecules may be specified. Each tag should include the required <i>sbm</i> attribute, which references an <i>id</i> from the &lt;SolidBoundMolecules&gt; description in the &lt;Globals&gt; section (Section <a class="Reference" href="#subsec:Solid-Bound-Molecules">3.6.3↑</a>). The following parameter must be defined in this description:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;rho0&gt;
</td>
<td align="left" valign="top" style="width: 3in;">
initial value of the referential apparent density of the solid-bound molecule <span class="MathJax_Preview"><script type="math/tex">
\rho_{r}^{\sigma}
</script>
</span> 
</td>
<td align="left" valign="top">
[<b>M</b>/<b>L</b><span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{3}}
</script>
</span>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;rhomin&gt;
</td>
<td align="left" valign="top" style="width: 3in;">
optional minimum allowable value of <span class="MathJax_Preview"><script type="math/tex">
\rho_{r}^{\sigma}
</script>
</span> (zero by default)
</td>
<td align="left" valign="top">
[<b>M</b>/<b>L</b><span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{3}}
</script>
</span>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;rhomax&gt;
</td>
<td align="left" valign="top" style="width: 3in;">
optional maximum allowable value of <span class="MathJax_Preview"><script type="math/tex">
\rho_{r}^{\sigma}
</script>
</span> (none by default)
</td>
<td align="left" valign="top">
[<b>M</b>/<b>L</b><span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{3}}
</script>
</span>] 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
If a chemical reaction involves this solid-bound molecule its referential apparent density may evolve over time. The user may place lower and upper bounds on the allowable range of an evolving <span class="MathJax_Preview"><script type="math/tex">
\rho_{r}^{\sigma}
</script>
</span>.
</div>
<div class="Indented">
<i>Example:</i>
</div>
<pre class="LyX-Code">
&lt;material id="2" name="Media" type="multiphasic"&gt;
  &lt;phi0&gt;0.2&lt;/phi0&gt;
  &lt;fixed_charge_density&gt;-40&lt;/fixed_charge_density&gt;
  &lt;solid name="Solid Matrix" type="Holmes-Mow"&gt;
    &lt;density&gt;1&lt;/density&gt;
    &lt;E&gt;0.28&lt;/E&gt;
    &lt;v&gt;0&lt;/v&gt;
    &lt;beta&gt;0&lt;/beta&gt;
  &lt;/solid&gt;
  &lt;permeability name="Permeability" type="perm-Holmes-Mow"&gt;
    &lt;perm&gt;1e-3&lt;/perm&gt;
    &lt;M&gt;0&lt;/M&gt;
    &lt;alpha&gt;0&lt;/alpha&gt;
  &lt;/permeability&gt;
  &lt;osmotic_coefficient name="Ideal" type="osm-coef-const"&gt;
    &lt;osmcoef&gt;1.0&lt;/osmcoef&gt;
  &lt;/osmotic_coefficient&gt;
  &lt;solute sol="1"&gt;
    &lt;diffusivity name="Diffusivity" type="diff-const-iso"&gt;
      &lt;free_diff&gt;1e-3&lt;/free_diff&gt;
      &lt;diff&gt;1e-3&lt;/diff&gt;
    &lt;/diffusivity&gt;
    &lt;solubility name="Solubility" type="solub-const"&gt;
      &lt;solub&gt;1.0&lt;/solub&gt;
    &lt;/solubility&gt;
  &lt;/solute&gt;
  &lt;solute sol="2"&gt;
    &lt;diffusivity name="Diffusivity" type="diff-const-iso"&gt;
      &lt;free_diff&gt;1e-3&lt;/free_diff&gt;
      &lt;diff&gt;1e-3&lt;/diff&gt;
    &lt;/diffusivity&gt;
    &lt;solubility name="Solubility" type="solub-const"&gt;
      &lt;solub&gt;1.0&lt;/solub&gt;
    &lt;/solubility&gt;
  &lt;/solute&gt;
&lt;/material&gt;
</pre>
<div class="Unindented">
When a multiphasic material is employed in an analysis, it is also necessary to specify the values of the universal gas constant <span class="MathJax_Preview"><script type="math/tex">
R
</script>
</span> [<b>F</b><span class="MathJax_Preview"><script type="math/tex">
\cdot
</script>
</span><b>L</b>/<b>n</b><span class="MathJax_Preview"><script type="math/tex">
\cdot
</script>
</span><b>T</b>], absolute temperature <span class="MathJax_Preview"><script type="math/tex">
\theta
</script>
</span> [<b>T</b>], and Faraday’s constant <span class="MathJax_Preview"><script type="math/tex">
F_{c}
</script>
</span> [<b>Q</b>/<b>n</b>] in the &lt;Globals&gt; section, using a self-consistent set of units.
</div>
<div class="Indented">
<i>Example:</i>
</div>
<pre class="LyX-Code">
&lt;Globals&gt;
  &lt;Constants&gt;
    &lt;R&gt;8.314e-6&lt;/R&gt;
    &lt;T&gt;298&lt;/T&gt;
    &lt;Fc&gt;96500e-9&lt;/Fc&gt;
  &lt;/Constants&gt;
  &lt;Solutes&gt;
    &lt;solute id="1" name="Na"&gt;
      &lt;charge_number&gt;1&lt;/charge_number&gt;
    &lt;/solute&gt;
    &lt;solute id="2" name="Cl"&gt;
      &lt;charge_number&gt;-1&lt;/charge_number&gt;
    &lt;/solute&gt;
  &lt;/Solutes&gt;
&lt;/Globals&gt;
</pre>
<div class="Unindented">
<i>Example:</i>
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="none" valign="top" style="width: 90pt;" colspan="2">
Self-consistent units for a triphasic analysis
</td>

</tr>
<tr>
<td align="none" valign="top" style="width: 90pt;" colspan="2">
<b>Primary Units</b>
</td>

</tr>
<tr>
<td align="none" valign="top" style="width: 90pt;">
time
</td>
<td align="none" valign="top" style="width: 129pt;">
s 
</td>

</tr>
<tr>
<td align="none" valign="top" style="width: 90pt;">
length
</td>
<td align="none" valign="top" style="width: 129pt;">
mm 
</td>

</tr>
<tr>
<td align="none" valign="top" style="width: 90pt;">
force
</td>
<td align="none" valign="top" style="width: 129pt;">
N 
</td>

</tr>
<tr>
<td align="none" valign="top" style="width: 90pt;">
mole
</td>
<td align="none" valign="top" style="width: 129pt;">
nmol 
</td>

</tr>
<tr>
<td align="none" valign="top" style="width: 90pt;">
charge
</td>
<td align="none" valign="top" style="width: 129pt;">
C 
</td>

</tr>
<tr>
<td align="none" valign="top" style="width: 90pt;">
temperature
</td>
<td align="none" valign="top" style="width: 129pt;">
K 
</td>

</tr>
<tr>
<td align="none" valign="top" style="width: 90pt;" colspan="2">
<b>Derived Units</b>
</td>

</tr>
<tr>
<td align="none" valign="top" style="width: 90pt;">
stress
</td>
<td align="none" valign="top" style="width: 129pt;">
N/mm<span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{2}}
</script>
</span>, MPa 
</td>

</tr>
<tr>
<td align="none" valign="top" style="width: 90pt;">
permeability
</td>
<td align="none" valign="top" style="width: 129pt;">
mm<span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{4}}
</script>
</span>/N<span class="MathJax_Preview"><script type="math/tex">
\cdot
</script>
</span>s, mm<span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{2}}
</script>
</span>/MPa <span class="MathJax_Preview"><script type="math/tex">
\cdot
</script>
</span>s 
</td>

</tr>
<tr>
<td align="none" valign="top" style="width: 90pt;">
diffusivity
</td>
<td align="none" valign="top" style="width: 129pt;">
mm<span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{2}}
</script>
</span>/s 
</td>

</tr>
<tr>
<td align="none" valign="top" style="width: 90pt;">
concentration
</td>
<td align="none" valign="top" style="width: 129pt;">
nmol/mm<span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{3}}
</script>
</span>, mM 
</td>

</tr>
<tr>
<td align="none" valign="top" style="width: 90pt;">
charge density
</td>
<td align="none" valign="top" style="width: 129pt;">
nEq/mm<span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{3}}
</script>
</span>, mEq/L 
</td>

</tr>
<tr>
<td align="none" valign="top" style="width: 90pt;">
voltage
</td>
<td align="none" valign="top" style="width: 129pt;">
mV 
</td>

</tr>
<tr>
<td align="none" valign="top" style="width: 90pt;">
current density
</td>
<td align="none" valign="top" style="width: 129pt;">
A/mm<span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{2}}
</script>
</span> 
</td>

</tr>
<tr>
<td align="none" valign="top" style="width: 90pt;">
current
</td>
<td align="none" valign="top" style="width: 129pt;">
A 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
It is also possible to create models with multiphasic materials that use different solutes in different regions. In that case, introduce additional solute entries in the &lt;Solutes&gt; section and refer to those solute ids in the multiphasic material descriptions. Generally, two adjoining multiphasic regions may share the same solute (e.g., Na in both regions), in which case that solute may transport freely across the interface separating these regions; or they may share no solute, in which case the interface is impermeable to all solutes.
</div>
<div class="Indented">
<p><br/>
</p>

</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-4.9.3">4.9.3</a> Solvent Supply Materials<a class="Label" name="subsec:Solvent-Supply-Materials"> </a>
</h3>
<div class="Unindented">
Solvent supply materials may be used to simulate an external source of solvent, such as supply from microvasculature that is not modeled explicitly. The solvent supply term, <span class="MathJax_Preview"><script type="math/tex">
\hat{\varphi}^{w}
</script>
</span>, appears in the mass balance relation for the mixture, <span class="MathJax_Preview">
<script type="math/tex;mode=display">
\begin{equation}
\divg\left(\mathbf{v}^{s}+\mathbf{w}\right)=\hat{\varphi}^{w}\,.\label{eq:solvent-supply-mass-balance}
\end{equation}
</script>

</span>
<span class="MathJax_Preview"><script type="math/tex">
\hat{\varphi}^{w}
</script>
</span> has units of reciprocal time [<b>t</b><span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{-1}}
</script>
</span>]; it represents the rate at which the volume fraction of solvent changes with time.
</div>
<div class="Indented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.9.3.1">4.9.3.1</a> Starling Equation<a class="Label" name="subsec:Starling-Equation-MP"> </a>
</h4>
<div class="Unindented">
The material type for Starling’s equation for fluid supply is <i>&ldquo;Starling&rdquo;</i>. The following material parameters need to be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;kp&gt;
</td>
<td align="left" valign="top">
hydraulic filtration coefficient, <span class="MathJax_Preview"><script type="math/tex">
k_{p}
</script>
</span>
</td>
<td align="left" valign="top">
[<b>L</b><span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{2}}
</script>
</span>/<b>F</b><span class="MathJax_Preview"><script type="math/tex">
\cdot
</script>
</span><b>t</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;pv&gt;
</td>
<td align="left" valign="top">
effective fluid pressure in external source, <span class="MathJax_Preview"><script type="math/tex">
\tilde{p}_{v}
</script>
</span>
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;qc sol=&rdquo;n&rdquo;&gt;
</td>
<td align="left" valign="top">
osmotic filtration coefficient, <span class="MathJax_Preview"><script type="math/tex">
q_{c}^{\alpha}
</script>
</span> 
</td>
<td align="left" valign="top">
[<b>L</b><span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{3}}
</script>
</span>/<b>n</b><span class="MathJax_Preview"><script type="math/tex">
\cdot
</script>
</span><b>t</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;cv sol=&rdquo;n&rdquo;&gt;
</td>
<td align="left" valign="top">
effective solute concentration in external source, <span class="MathJax_Preview"><script type="math/tex">
\tilde{c}_{v}^{\alpha}
</script>
</span>
</td>
<td align="left" valign="top">
[<b>n</b>/<b>L</b><span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{3}}
</script>
</span>] 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
The fluid supply is given by Starling’s equation, <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\hat{\varphi}^{w}=k_{p}\left(\tilde{p}_{v}-\tilde{p}\right)+\sum\limits _{\alpha}q_{c}^{\alpha}\left(\tilde{c}_{v}^{\alpha}-\tilde{c}^{\alpha}\right)\,,

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
\tilde{p}
</script>
</span> is the effective fluid pressure in the multiphasic material.
</div>
<div class="Indented">
<i>Example:</i>
</div>
<div class="Indented">
This example defines a solvent supply material of the Starling type for a multiphasic mixture containing one solute.
</div>
<pre class="LyX-Code">
&lt;solvent_supply type="Starling"&gt;
  &lt;kp&gt;0.001&lt;/kp&gt;
  &lt;pv&gt;0.1&lt;/pv&gt;
  &lt;qc sol=”1”&gt;1e-5&lt;/qc&gt;
  &lt;cv sol=”1”&gt;150&lt;/cv&gt;
&lt;/solvent_supply&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h2 class="Section">
<a class="toc" name="toc-Section-4.10">4.10</a> Chemical Reactions<a class="Label" name="sec:Chemical-Reactions"> </a>
</h2>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-4.10.1">4.10.1</a> Guidelines for Chemical Reaction Analyses<a class="Label" name="subsec:Guidelines-Chemical-Reactions"> </a>
</h3>
<div class="Unindented">
Chemical reactions may be modeled within a multiphasic mixture. The reaction may involve solutes (<span class="MathJax_Preview"><script type="math/tex">
\alpha=\iota)
</script>
</span> and solid-bound molecules (<span class="MathJax_Preview"><script type="math/tex">
\alpha=\sigma)
</script>
</span> that move with the solid matrix (<span class="MathJax_Preview"><script type="math/tex">
\mathbf{v}^{\sigma}=\mathbf{v}^{s},\,\forall\sigma)
</script>
</span>. Consider a general chemical reaction, <span class="MathJax_Preview">
<script type="math/tex;mode=display">
\begin{equation}
\sum\limits _{\alpha}\nu_{R}^{\alpha}\mathcal{E}^{\alpha}\to\sum\limits _{\alpha}\nu_{P}^{\alpha}\mathcal{E}^{\alpha},\label{eq:cr-forward-reaction}
\end{equation}
</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
\mathcal{E}^{\alpha}
</script>
</span> is the chemical species representing constituent <span class="MathJax_Preview"><script type="math/tex">
\alpha
</script>
</span> in the mixture; <span class="MathJax_Preview"><script type="math/tex">
\nu_{R}^{\alpha}
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
\nu_{P}^{\alpha}
</script>
</span> represent stoichiometric coefficients of the reactants and products, respectively. To maintain consistency with classical chemical kinetics, the analysis of chemical reactions employs molar concentrations <span class="MathJax_Preview"><script type="math/tex">
c^{\alpha}
</script>
</span> and molar supplies <span class="MathJax_Preview"><script type="math/tex">
\hat{c}^{\alpha}
</script>
</span> on a solution-volume basis for all reactants and products, whether they are solutes or solid-bound molecular species.
</div>
<div class="Indented">
Since the molar supply of reactants and products is constrained by stoichiometry, it follows that all molar supplies <span class="MathJax_Preview"><script type="math/tex">
\hat{c}^{\alpha}
</script>
</span> in a specific chemical reaction may be related to a <i>molar production rate</i> <span class="MathJax_Preview"><script type="math/tex">
\hat{\zeta}
</script>
</span> according to <span class="MathJax_Preview">
<script type="math/tex;mode=display">
\begin{equation}
\hat{c}^{\alpha}=\nu^{\alpha}\hat{\zeta}\,,\label{eq:cr-concentration-supply}
\end{equation}
</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
\nu^{\alpha}
</script>
</span> represents the net stoichiometric coefficient for <span class="MathJax_Preview"><script type="math/tex">
\mathcal{E}^{\alpha}
</script>
</span>, <span class="MathJax_Preview">
<script type="math/tex;mode=display">
\begin{equation}
\nu^{\alpha}=\nu_{P}^{\alpha}-\nu_{R}^{\alpha}.\label{eq:cr-net-stoich-coeff}
\end{equation}
</script>

</span>
Thus, formulating constitutive relations for <span class="MathJax_Preview"><script type="math/tex">
\hat{c}^{\alpha}
</script>
</span> is equivalent to providing a single relation for <span class="MathJax_Preview"><script type="math/tex">
\hat{\zeta}\left(\theta,\mathbf{F},c^{\alpha}\right)
</script>
</span>. When the chemical reaction is reversible, <span class="MathJax_Preview">
<script type="math/tex;mode=display">
\begin{equation}
\sum\limits _{\alpha}\nu_{R}^{\alpha}\mathcal{E}^{\alpha}\rightleftharpoons\sum\limits _{\alpha}\nu_{P}^{\alpha}\mathcal{E}^{\alpha},\label{eq:cr-reversible-reaction}
\end{equation}
</script>

</span>
the relations of <a class="Reference" href="#eq:cr-concentration-supply">(↓)</a>-<a class="Reference" href="#eq:cr-net-stoich-coeff">(↓)</a> still apply but the constitutive relation for <span class="MathJax_Preview"><script type="math/tex">
\hat{\zeta}
</script>
</span> would be different.
</div>
<div class="Indented">
<i>Example:</i>
</div>
<div class="Indented">
Consider the dissociation of CaCl<span class="MathJax_Preview"><script type="math/tex">
_{\mathrm{2}}
</script>
</span> into ions Ca<span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{2+}}
</script>
</span> and Cl<span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{-}}
</script>
</span>, <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\mbox{CaCl}_{2}\rightleftharpoons\mbox{Ca}^{2+}+2\mbox{Cl}^{-}.

</script>

</span>
The mixture contains three constituents. The stoichiometric coefficients of the reactants are <span class="MathJax_Preview"><script type="math/tex">
\nu_{R}^{\mbox{CaCl}_{2}}=1
</script>
</span>, <span class="MathJax_Preview"><script type="math/tex">
\nu_{R}^{\mbox{Ca}^{2+}}=0
</script>
</span>, <span class="MathJax_Preview"><script type="math/tex">
\nu_{R}^{\mbox{Cl}^{-}}=0
</script>
</span>, and those of the products are <span class="MathJax_Preview"><script type="math/tex">
\nu_{P}^{\mbox{CaCl}_{2}}=0
</script>
</span>, <span class="MathJax_Preview"><script type="math/tex">
\nu_{P}^{\mbox{Ca}^{2+}}=1
</script>
</span>, <span class="MathJax_Preview"><script type="math/tex">
\nu_{P}^{\mbox{Cl}^{-}}=2
</script>
</span>.
</div>
<div class="Indented">
The reaction production rate <span class="MathJax_Preview"><script type="math/tex">
\hat{\zeta}
</script>
</span> enters into the governing equations of multiphasic mixtures via the mass balance relation for each solute, <span class="MathJax_Preview">
<script type="math/tex;mode=display">
\begin{equation}
\frac{1}{J}\frac{D^{s}\left[J\left(1-\varphi^{s}\right)c^{\iota}\right]}{Dt}+\divg\mathbf{j}^{\iota}=\left(1-\varphi^{s}\right)\nu^{\iota}\hat{\zeta}\,,\label{eq:cr-solute-mass-balance}
\end{equation}
</script>

</span>
the mass balance for the mixture, <span class="MathJax_Preview">
<script type="math/tex;mode=display">
\begin{equation}
\divg\left(\mathbf{v}^{s}+\mathbf{w}\right)=\left(1-\varphi^{s}\right)\hat{\zeta}\overline{\mathcal{V}}\,,\label{eq:cr-mixture-mass-balance}
\end{equation}
</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
\overline{\mathcal{V}}=\sum\limits _{\alpha}\nu^{\alpha}\mathcal{V}^{\alpha}
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
\mathcal{V}^{\alpha}=M^{\alpha}/\rho_{T}^{\alpha}
</script>
</span> is the molar volume of <span class="MathJax_Preview"><script type="math/tex">
\alpha
</script>
</span>, and the mass balance for solid-bound constituents, <span class="MathJax_Preview">
<script type="math/tex;mode=display">
\begin{equation}
D^{s}\rho_{r}^{\sigma}/Dt=\hat{\rho}_{r}^{\sigma}\,,\label{eq:cr-sbm-mass-balance}
\end{equation}
</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
\rho_{r}^{\sigma}
</script>
</span> is the referential apparent mass density (mass of <span class="MathJax_Preview"><script type="math/tex">
\sigma
</script>
</span> per mixture volume in the reference configuration), and <span class="MathJax_Preview"><script type="math/tex">
\hat{\rho}_{r}^{\sigma}
</script>
</span> is the referential apparent mass supply of solid constituent <span class="MathJax_Preview"><script type="math/tex">
\sigma
</script>
</span>, related to molar concentrations and supplies via <span class="MathJax_Preview">
<script type="math/tex;mode=display">
\begin{equation}
c^{\sigma}=\frac{\rho_{r}^{\sigma}}{\left(J-\varphi_{r}^{s}\right)M^{\sigma}},\quad\hat{c}^{\sigma}=\frac{\hat{\rho}_{r}^{\sigma}}{\left(J-\varphi_{r}^{s}\right)M^{\sigma}}\,.\label{eq:concentration-density-relations}
\end{equation}
</script>

</span>
Internally, the content of solid-bound species is stored in <span class="MathJax_Preview"><script type="math/tex">
\rho_{r}^{\sigma}
</script>
</span> and <a class="Reference" href="#eq:concentration-density-relations">(↓)</a> is used to evaluate <span class="MathJax_Preview"><script type="math/tex">
c^{\sigma}
</script>
</span> when needed for the calculation of <span class="MathJax_Preview"><script type="math/tex">
\hat{\zeta}
</script>
</span>. If a solid-bound molecule is involved in a chemical reaction, equation <a class="Reference" href="#eq:cr-sbm-mass-balance">(↓)</a> is integrated to produce an updated value of <span class="MathJax_Preview"><script type="math/tex">
\rho_{r}^{\sigma}
</script>
</span>, using <span class="MathJax_Preview"><script type="math/tex">
\hat{\rho}_{r}^{\sigma}=\left({J-\varphi_{r}^{s}}\right)M^{\sigma}\nu^{\sigma}\hat{\zeta}
</script>
</span> based on <a class="Reference" href="#eq:cr-concentration-supply">(↓)</a> and <a class="Reference" href="#eq:concentration-density-relations">(↓)</a>.
</div>
<div class="Indented">
Evolving solid content due to chemical reactions implies that the referential solid volume fraction <span class="MathJax_Preview"><script type="math/tex">
\varphi_{r}^{s}
</script>
</span> may not remain constant. This value is updated at every time point using <span class="MathJax_Preview">
<script type="math/tex;mode=display">
\begin{equation}
\varphi_{r}^{s}=\varphi_{0}^{s}+\sum\limits _{\sigma}\frac{\rho_{r}^{\sigma}}{\rho_{T}^{\sigma}}\,,\label{eq:cr-referential-solid-vol-frac}
\end{equation}
</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
\varphi_{0}^{s}
</script>
</span> is the solid volume fraction specified by the multiphasic material parameter <i>phi0</i> (Section <a class="Reference" href="#subsec:General-Specification-Multiphasic-Mat">4.9.2↑</a>). Thus, <span class="MathJax_Preview"><script type="math/tex">
\varphi_{0}^{s}
</script>
</span> may be used to account for the solid volume fraction not contributed explicitly by solid-bound molecules. Based on kinematics, the solid volume fraction in the current configuration is given by <span class="MathJax_Preview"><script type="math/tex">
\varphi^{s}=\varphi_{r}^{s}/J
</script>
</span>. Therefore, since <span class="MathJax_Preview"><script type="math/tex">
0\leqslant\varphi^{s}\leqslant1
</script>
</span> by definition, it follows that <span class="MathJax_Preview"><script type="math/tex">
0\leqslant\varphi_{r}^{s}\leqslant J
</script>
</span>, implying that the referential solid volume fraction may evolve to values greater than unity when growth leads to swelling of the multiphasic mixture.
</div>
<div class="Indented">
Similarly, if solid-bound molecules are charged and their content evolves over time, the referential fixed charge density may also evolve with chemical reactions according to <span class="MathJax_Preview">
<script type="math/tex;mode=display">
\begin{equation}
c_{r}^{F}=c_{0}^{F}+\frac{1}{1-\varphi_{r}^{s}}\sum\limits _{\sigma}\frac{z^{\sigma}\rho_{r}^{\sigma}}{M^{\sigma}}\,,\label{eq:cr-referential-FCD}
\end{equation}
</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
c_{0}^{F}
</script>
</span> is the referential fixed charge density specified by the multiphasic material parameter <i>fixed_charge_density</i> (Section <a class="Reference" href="#subsec:General-Specification-Multiphasic-Mat">4.9.2↑</a>). Thus, <span class="MathJax_Preview"><script type="math/tex">
c_{0}^{F}
</script>
</span> may be used to account for the fixed charge density not contributed explicitly by solid-bound molecules.
</div>
<div class="Indented">
A chemical reaction is properly balanced when <span class="MathJax_Preview">
<script type="math/tex;mode=display">
\begin{equation}
\sum\limits _{\alpha}\nu^{\alpha}M^{\alpha}=0\,,\label{eq:cr-balanced-reaction}
\end{equation}
</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
M^{\alpha}
</script>
</span> is the molar mass of <span class="MathJax_Preview"><script type="math/tex">
\alpha
</script>
</span>. This constraint implies that the net gain in mass of products must be the same as the net loss in mass of reactants. However, this constraint is not verified in the code, allowing users to model chemical reactions with implicit constituents (constituents that are neither explicitly modeled as solutes nor as solid-bound molecules, for which <span class="MathJax_Preview"><script type="math/tex">
\nu^{\alpha}
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
M^{\alpha}
</script>
</span> are not given). For example, a chemical reaction where cells consume glucose to form a protein from amino-acids building blocks may have the form <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\mbox{cells}+\mbox{glucose}+\mbox{amino\thinspace acids}\to\mbox{cells}+\mbox{protein}+\mbox{waste\thinspace products}\,.

</script>

</span>
The user may opt to model only the glucose reactant and the protein product explicitly, while the presence of all other species in this reaction is implicit. In these types of analyses the user must beware of potential inconsistencies in the evolving mass of reactants and products since only some of those constituents are modeled explicitly. In particular, the evolution of <span class="MathJax_Preview"><script type="math/tex">
\varphi_{r}^{s}
</script>
</span> as given in <b><a class="Reference" href="#eq:cr-referential-solid-vol-frac">(↓)</a></b> can only account for the explicitly modeled solid-bound molecules. Furthermore, when some reactants and products are implicit, the value of the reaction molar volume <span class="MathJax_Preview"><script type="math/tex">
\overline{\mathcal{V}}
</script>
</span> calculated in the code becomes inaccurate and may produce unexpected results in the evaluation of the mixture mass balance relation in <a class="Reference" href="#eq:cr-mixture-mass-balance">(↓)</a>. Therefore, the user is given the option to override the value of <span class="MathJax_Preview"><script type="math/tex">
\overline{\mathcal{V}}
</script>
</span> calculated in the code. In particular, if the precise molar volumes of all the species in a reaction are not known, assuming that <span class="MathJax_Preview"><script type="math/tex">
\overline{\mathcal{V}}\approx0
</script>
</span> is a reasonable choice equivalent to assuming that all the constituents have approximately the same density <span class="MathJax_Preview"><script type="math/tex">
\rho_{T}^{\alpha}
</script>
</span>, as may be deduced from <a class="Reference" href="#eq:cr-balanced-reaction">(↓)</a>.
</div>
<div class="Indented">
Since the electroneutrality condition is enforced in multiphasic mixtures in FEBio, it follows that chemical reactions must not violate this condition. Enforcing electroneutrality in a chemical reaction is equivalent to satisfying <span class="MathJax_Preview">
<script type="math/tex;mode=display">
\begin{equation}
\sum\limits _{\alpha}z^{\alpha}\nu^{\alpha}=0\,.\label{eq:cr-electroneutrality}
\end{equation}
</script>

</span>
This constraint is checked within the code and an error is generated when it is violated.
</div>
<div class="Indented">
A constitutive relation must be provided for the molar production rate <span class="MathJax_Preview"><script type="math/tex">
\hat{\zeta}\left(\theta,\mathbf{F},c^{\alpha}\right)
</script>
</span> of each chemical reaction.
</div>
<div class="Indented">
<p><br/>
</p>

</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-4.10.2">4.10.2</a> General Specification for Chemical Reactions<a class="Label" name="subsec:General-Specification-Chem-React"> </a>
</h3>
<div class="Unindented">
The material type for a chemical reaction is &ldquo;<i>reaction</i>&rdquo;. The &lt;reaction&gt; tag must appear inside the definition of a multiphasic mixture and the reaction is defined only for that mixture. Multiple chemical reactions may be defined in a given mixture. Each &lt;reaction&gt; tag must include a <i>type</i> attribute that identifies the constitutive relation for <span class="MathJax_Preview"><script type="math/tex">
\hat{\zeta}
</script>
</span>.
</div>
<div class="Indented">
The stoichiometric coefficients <span class="MathJax_Preview"><script type="math/tex">
\nu_{R}^{\alpha}
</script>
</span> of the reactants and <span class="MathJax_Preview"><script type="math/tex">
\nu_{P}^{\alpha}
</script>
</span> for the products must be specified in every reaction. Optionally, the net reaction molar volume <span class="MathJax_Preview"><script type="math/tex">
\overline{\mathcal{V}}
</script>
</span> may be specified explicitly to override the internal value calculated in the code. Therefore, the following parameters need to be defined in a chemical reaction:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;vR&gt;
</td>
<td align="left" valign="top">
reactant stoichiometric coefficient <span class="MathJax_Preview"><script type="math/tex">
\nu_{R}^{\alpha}
</script>
</span>
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;vP&gt;
</td>
<td align="left" valign="top">
product stoichiometric coefficient <span class="MathJax_Preview"><script type="math/tex">
\nu_{P}^{\alpha}
</script>
</span> 
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;Vbar&gt;
</td>
<td align="left" valign="top">
optional override value for <span class="MathJax_Preview"><script type="math/tex">
\overline{\mathcal{V}}
</script>
</span>
</td>
<td align="left" valign="top">
[<b>L</b><span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{3}}
</script>
</span>/<b>n</b>] 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
Each &lt;vR&gt; and &lt;vP&gt; tag must include either the <i>sol</i> attribute, which should reference a solute <i>id</i> from the &lt;Solutes&gt; description in the &lt;Globals&gt; section (Section <a class="Reference" href="#subsec:Solutes">3.6.2↑</a>), or the <i>sbm</i> attribute, which should reference a solid-bound molecule <i>id</i> from the &lt;SolidBoundMolecules&gt; description in the &lt;Globals&gt; section (Section <a class="Reference" href="#subsec:Solid-Bound-Molecules">3.6.3↑</a>). Only solutes and solid-bound molecules that have been included in the parent multiphasic mixture may be specified as reactants or products of a chemical reaction.
</div>
<div class="Indented">
Additional parameters may be needed in the definition of a chemical reaction, depending on the specific form of the constitutive relation for the production rate.
</div>
<div class="Indented">
<p><br/>
</p>

</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-4.10.3">4.10.3</a> Chemical Reaction Materials<a class="Label" name="subsec:Chemical-Reaction-Materials"> </a>
</h3>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.10.3.1">4.10.3.1</a> Law of Mass Action for Forward Reactions<a class="Label" name="subsec:Mass-Action-Forward"> </a>
</h4>
<div class="Unindented">
The material type for the Law of Mass Action for a forward reaction is <i>mass-action-forward</i>. The following parameters must be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;forward_rate&gt;
</td>
<td align="left" valign="top">
specific forward reaction rate <span class="MathJax_Preview"><script type="math/tex">
k
</script>
</span> 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
For this type of reaction the constitutive relation for the molar production rate is given by <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\hat{\zeta}=k\prod\limits _{\alpha}\left(c^{\alpha}\right)^{\nu_{R}^{\alpha}}\,.

</script>

</span>
The constitutive form of the specific forward reaction rate must be selected from the list of materials given in Section <a class="Reference" href="#subsec:Specific-Reaction-Rate">4.10.4↓</a>. The units of <span class="MathJax_Preview"><script type="math/tex">
\hat{\zeta}
</script>
</span> are [<b>n</b>/<b>L</b><span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{3}}\cdot
</script>
</span><b>t</b>] and those of <span class="MathJax_Preview"><script type="math/tex">
c^{\alpha}
</script>
</span> are [<b>n</b>/<b>L</b><span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{3}}
</script>
</span>].
</div>
<div class="Indented">
<i>Example:</i>
</div>
<div class="Indented">
Consider the forward reaction that produces solid copper sulfide from solid copper and solid sulfur, <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\mbox{Cu}+\mbox{S}\to\mbox{CuS}

</script>

</span>
All three species are modeled explicitly in the mixture as solid-bound molecules, with id’s 1 (Cu), 2 (for S) and 3 (for CuS). The chemical reaction material is given by:
</div>
<pre class="LyX-Code">
&lt;reaction name="copper sulfide production" type="mass-action-forward"&gt;
  &lt;vR sbm="1"&gt;1&lt;/vR&gt;
  &lt;vR sbm="2"&gt;1&lt;/vR&gt;
  &lt;vP sbm="3"&gt;1&lt;/vP&gt;
  &lt;forward_rate type="constant reaction rate"&gt;
    &lt;k&gt;1e-3&lt;/k&gt;
  &lt;/forward_rate&gt;
&lt;/reaction&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.10.3.2">4.10.3.2</a> Law of Mass Action for Reversible Reactions<a class="Label" name="subsec:Mass-Action-Reversible"> </a>
</h4>
<div class="Unindented">
The material type for the Law of Mass Action for a reversible reaction is <i>mass-action-reversible</i>. The following parameters must be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;forward_rate&gt;
</td>
<td align="left" valign="top">
specific forward reaction rate <span class="MathJax_Preview"><script type="math/tex">
k_{F}
</script>
</span> 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;reverse_rate&gt;
</td>
<td align="left" valign="top">
specific reverse reaction rate <span class="MathJax_Preview"><script type="math/tex">
k_{R}
</script>
</span> 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
For this type of reaction the constitutive relation for the molar production rate is given by <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\hat{\zeta}=\hat{\zeta}_{F}-\hat{\zeta}_{R}\,,

</script>

</span>
where <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\begin{aligned}\hat{\zeta}_{F} & =k_{F}\prod\limits _{\alpha}\left(c^{\alpha}\right)^{\nu_{R}^{\alpha}}\\
\hat{\zeta}_{R} & =k_{R}\prod\limits _{\alpha}\left(c^{\alpha}\right)^{\nu_{P}^{\alpha}}
\end{aligned}
\,.

</script>

</span>
The constitutive form of the specific forward and reverse reaction rates must be selected from the list of materials given in Section <a class="Reference" href="#subsec:Specific-Reaction-Rate">4.10.4↓</a>. The units of <span class="MathJax_Preview"><script type="math/tex">
\hat{\zeta}_{F}
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
\hat{\zeta}_{R}
</script>
</span> are [<b>n</b>/<b>L</b><span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{3}}\cdot
</script>
</span><b>t</b>] and those of <span class="MathJax_Preview"><script type="math/tex">
c^{\alpha}
</script>
</span> are [<b>n</b>/<b>L</b><span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{3}}
</script>
</span>].
</div>
<div class="Indented">
<i>Example:</i>
</div>
<div class="Indented">
Consider the reversible dissociation of CaCl salt into Ca<span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{2+}}
</script>
</span> and Cl<span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{-}}
</script>
</span> in water, <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\mbox{CaCl}_{2}\rightleftharpoons\mbox{Ca}^{2+}+2\mbox{Cl}^{-}

</script>

</span>
All three species are modeled explicitly in the mixture as solutes, with id’s 1 (for CaCl<span class="MathJax_Preview"><script type="math/tex">
_{\mathrm{2}})
</script>
</span>, 2 (for Ca<span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{2+}})
</script>
</span> and 3 (for Cl<span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{-}})
</script>
</span>. The chemical reaction material is given by:
</div>
<pre class="LyX-Code">
&lt;reaction name="CaCl2 dissociation" type="mass-action-reversible"&gt;
  &lt;vR sol="1"&gt;1&lt;/vR&gt;
  &lt;vP sol="2"&gt;1&lt;/vP&gt;
  &lt;vP sol="3"&gt;2&lt;/vP&gt;
  &lt;forward_rate type="constant"&gt;
    &lt;k&gt;1.0&lt;/k&gt;
  &lt;/forward_rate&gt;
  &lt;reverse_rate type="constant"&gt;
    &lt;k&gt;0.1&lt;/k&gt;
  &lt;/reverse_rate&gt;
&lt;/reaction&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.10.3.3">4.10.3.3</a> Michaelis-Menten Reaction<a class="Label" name="subsec:Michaelis-Menten-Reaction"> </a>
</h4>
<div class="Unindented">
The material type for the Michaelis-Menten reaction is <i>Michaelis-Menten</i>. The following parameters must be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;forward_rate&gt;
</td>
<td align="left" valign="top" style="width: 3in;">
maximum rate at saturating substrate concentration <span class="MathJax_Preview"><script type="math/tex">
V_{\max}
</script>
</span> 
</td>
<td align="left" valign="top">
[<b>n</b>/<b>L</b><span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{3}}\cdot
</script>
</span><b>t</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;Km&gt;
</td>
<td align="left" valign="top" style="width: 3in;">
substrate concentration when reaction rate is half of <span class="MathJax_Preview"><script type="math/tex">
V_{\max}
</script>
</span> 
</td>
<td align="left" valign="top">
[<b>n</b>/<b>L</b><span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{3}}
</script>
</span>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;c0&gt;
</td>
<td align="left" valign="top" style="width: 3in;">
optional minimum substrate concentration to trigger reaction 
</td>
<td align="left" valign="top">
[<b>n</b>/<b>L</b><span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{3}}
</script>
</span>] 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
The Michaelis-Menten reaction may be used to model enzyme kinetics where the enzyme <span class="MathJax_Preview"><script type="math/tex">
\mathcal{E}^{e}
</script>
</span> triggers the conversion of the substrate <span class="MathJax_Preview"><script type="math/tex">
\mathcal{E}^{s}
</script>
</span> into the product <span class="MathJax_Preview"><script type="math/tex">
\mathcal{E}^{p}
</script>
</span>. The product molar supply is given by <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\hat{c}^{p}=\begin{cases}
\frac{V_{\max}c^{s}}{K_{m}+c^{s}} & c^{s}\geqslant c_{0}\\
0 & c^{s}<c_{0}
\end{cases}\,,

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
c^{s}
</script>
</span> is the substrate concentration. The default value of <span class="MathJax_Preview"><script type="math/tex">
c_{0}
</script>
</span> is 0. This relation may be derived, with some simplifying assumptions, by applying the law of mass action to the combination of two reactions, <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\mathcal{E}^{e}+\mathcal{E}^{s}\rightleftharpoons\mathcal{E}^{es}\to\mathcal{E}^{e}+\mathcal{E}^{p}

</script>

</span>
Since the enzyme is not modeled explicitly in the Michaelis-Menten approximation to these two reactions, this reaction model is effectively equivalent to <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\mathcal{E}^{s}\to\mathcal{E}^{p}.

</script>

</span>
Therefore, this reaction accepts only one reactant tag &lt;vR&gt; and one product tag &lt;vP&gt;. For consistency with the formulation of this reaction, the stoichiometric coefficients should be set to <span class="MathJax_Preview"><script type="math/tex">
\nu_{R}^{s}=\nu_{P}^{p}=1
</script>
</span>, so that <span class="MathJax_Preview"><script type="math/tex">
\hat{c}^{p}=\hat{\zeta}
</script>
</span>.
</div>
<div class="Indented">
The constitutive form of the specific forward reaction rate <span class="MathJax_Preview"><script type="math/tex">
V_{\max}
</script>
</span> must be selected from the list of materials given in Section <a class="Reference" href="#subsec:Specific-Reaction-Rate">4.10.4↓</a>.
</div>
<div class="Indented">
<i>Example:</i>
</div>
<pre class="LyX-Code">
&lt;reaction name="enzyme kinetics" type="Michaelis-Menten"&gt;
  &lt;Vbar&gt;0&lt;/Vbar&gt;
  &lt;vR sol="1"&gt;1&lt;/vR&gt;
  &lt;vP sol="2"&gt;1&lt;/vP&gt;
  &lt;forward_rate type="constant"&gt;
    &lt;k&gt;1.0&lt;/k&gt;
  &lt;/forward_rate&gt;
  &lt;Km&gt;5.0&lt;/Km&gt;
&lt;/reaction&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-4.10.4">4.10.4</a> Specific Reaction Rate Materials<a class="Label" name="subsec:Specific-Reaction-Rate"> </a>
</h3>
<div class="Unindented">
The following sections define specific materials that can be used to define the reaction rate of a chemical reaction.
</div>
<div class="Indented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.10.4.1">4.10.4.1</a> Constant Reaction Rate<a class="Label" name="subsec:Constant-Reaction-Rate"> </a>
</h4>
<div class="Unindented">
The material type for a constant specific reaction rate is <i>constant reaction rate</i>. The following parameter must be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;k&gt;
</td>
<td align="left" valign="top">
constant specific reaction rate <span class="MathJax_Preview"><script type="math/tex">
k
</script>
</span> 
</td>
<td align="left" valign="top">
[<i>units vary</i>] 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
<i>Example:</i>
</div>
<pre class="LyX-Code">
&lt;reaction name="enzyme kinetics" type="Michaelis-Menten"&gt;
  &lt;Vbar&gt;0&lt;/Vbar&gt;
  &lt;vR sol="1"&gt;1&lt;/vR&gt;
  &lt;vP sol="2"&gt;1&lt;/vP&gt;
  &lt;forward_rate type="constant reaction rate"&gt;
    &lt;k&gt;1.0&lt;/k&gt;
  &lt;/forward_rate&gt;
  &lt;Km&gt;5.0&lt;/Km&gt;
&lt;/reaction&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.10.4.2">4.10.4.2</a> Huiskes Reaction Rate<a class="Label" name="subsec:Huiskes-Reaction-Rate"> </a>
</h4>
<div class="Unindented">
The material type for the Huiskes reaction rate is <i>Huiskes reaction rate</i>. The following parameters must be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;B&gt;
</td>
<td align="left" valign="top">
reaction rate per specific strain energy <span class="MathJax_Preview"><script type="math/tex">
B
</script>
</span>
</td>
<td align="left" valign="top">
[<i>units vary</i>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;psi0&gt;
</td>
<td align="left" valign="top">
specific strain energy at homeostasis <span class="MathJax_Preview"><script type="math/tex">
\psi_{0}
</script>
</span> 
</td>
<td align="left" valign="top">
[<b>F</b><span class="MathJax_Preview"><script type="math/tex">
\cdot
</script>
</span><b>L</b>/<b>M</b>] 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
The Huiskes specific reaction rate has the form <span class="MathJax_Preview">
<script type="math/tex;mode=display">

k=\frac{B}{J-\varphi_{r}^{s}}\left(\frac{\Psi_{r}}{\rho_{r}^{s}}-\psi_{0}\right)\,,

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
\Psi_{r}
</script>
</span> is the strain energy density of the solid (strain energy in current configuration per mixture volume in the reference configuration) and <span class="MathJax_Preview"><script type="math/tex">
\rho_{r}^{s}=\sum\nolimits _{\sigma}\rho_{r}^{\sigma}
</script>
</span> is the referential apparent solid density (mass of solid in current configuration per mixture volume in reference configuration). The ratio <span class="MathJax_Preview"><script type="math/tex">
\Psi_{r}/\rho_{r}^{s}
</script>
</span> is the specific strain energy (strain energy per mass of solid in the current configuration). The Huiskes specific reaction rate may assume positive and negative values; it reduces to zero at homeostasis, when <span class="MathJax_Preview"><script type="math/tex">
\Psi_{r}/\rho_{r}^{s}=\psi_{0}
</script>
</span>.
</div>
<div class="Indented">
<i>Example:</i>
</div>
<div class="Indented">
To reproduce the interstitial solid remodeling theory proposed by Weinans et al. <span class="bibcites">[<a class="bibliocite" name="cite-36" href="#biblio-36"><span class="bib-index">36</span></a>]</span>, consider the forward reaction <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\mbox{cells}+\mbox{solutes}\to\mbox{cells}+\mbox{solid}\,,

</script>

</span>
where cells convert solutes (e.g., nutrients) into synthesized solid when the specific strain energy exceeds the homeostatic value. If the cells and solutes are implicit in this reaction (e.g., if it is assumed that their concentrations change negligibly), the production rate of the solid may be given by <span class="MathJax_Preview"><script type="math/tex">
\hat{\zeta}=k
</script>
</span> using the law of mass action for a forward rection, where <span class="MathJax_Preview"><script type="math/tex">
k
</script>
</span> has the form given above.
</div>
<pre class="LyX-Code">
&lt;reaction name="solid remodeling" type="mass-action-forward"&gt;
  &lt;vP sbm="1"&gt;1&lt;/vP&gt;
  &lt;forward_rate type="Huiskes reaction rate"&gt;
    &lt;B&gt;1.0&lt;/B&gt;
    &lt;psi0&gt;0.01&lt;/psi0&gt;
  &lt;/forward_rate&gt;
  &lt;Km&gt;5.0&lt;/Km&gt;
&lt;/reaction&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h2 class="Section">
<a class="toc" name="toc-Section-4.11">4.11</a> Rigid Body<a class="Label" name="sec:Rigid-Body"> </a>
</h2>
<div class="Unindented">
A rigid body can be defined using the rigid material model. The material type for a rigid body is &ldquo;<i>rigid body&rdquo;</i>. The following parameters are defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;density&gt;
</td>
<td align="left" valign="top">
Density of rigid body
</td>
<td align="left" valign="top">
[<b>M</b>/<b>L</b><span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{3}}
</script>
</span>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;center_of_mass&gt;
</td>
<td align="left" valign="top">
Position of the center of mass
</td>
<td align="left" valign="top">
[<b>L</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;E&gt;
</td>
<td align="left" valign="top">
Young’s modulus
</td>
<td align="left" valign="top">
[<b>P</b>] 
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;v&gt;
</td>
<td align="left" valign="top">
Poisson’s ratio
</td>
<td align="left" valign="top">
[ ] 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
If the <i>center_of_mass </i>parameter is omitted, FEBio will calculate the center of mass automatically. In this case, a density <i>must</i> be specified. If the <i>center_of_mass </i>is defined the <i>density </i>parameter may be omitted. Omitting both will generate an error message.
</div>
<div class="Indented">
The Young’s modulus <span class="MathJax_Preview"><script type="math/tex">
E
</script>
</span>and Poisson ratio <span class="MathJax_Preview"><script type="math/tex">
v
</script>
</span> currently have no effect on the results. The only place where they are used is in the calculation of a material stiffness for some auto-penalty contact formulation. If you are using contact it is advised to enter sensible values. Otherwise these parameters may be omitted.
</div>
<div class="Indented">
The degrees of freedom of a rigid body are initially unconstrained<span class="FootOuter"><span class="SupFootMarker"> [L] </span><span class="HoverFoot"><span class="SupFootMarker"> [L] </span> This is different from previous versions of FEBio where rigid bodies were initially fully constrained.</span></span>. This implies that a rigid body is free to move in all three directions and rotate about any of the coordinate axes. To constrain a rigid body degree of freedom you may use the <i>Boundary </i>section (Section <a class="Reference" href="#subsec:Prescribed-Rigid-Body-DOFs">3.11.4↑</a>) or <i>Constraints</i> sections (Section <a class="Reference" href="#subsec:Rigid-Joints">3.14.1↑</a>).
</div>
<div class="Indented">
<i>Example:</i>
</div>
<pre class="LyX-Code">
&lt;material id="1" type="rigid body"&gt;
  &lt;density&gt;1.0&lt;/density&gt;
  &lt;center_of_mass&gt;0,0,0&lt;/center_of_mass&gt;
&lt;/material&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h2 class="Section">
<a class="toc" name="toc-Section-4.12">4.12</a> Active Contraction<a class="Label" name="sec:Active-Contraction"> </a>
</h2>
<div class="Unindented">
Active contraction materials may be used to impose a (typically) contractile stress within a solid material, by incorporating the contraction material within a solid mixture. The total stress in the solid mixture is simply <span class="MathJax_Preview"><script type="math/tex">
\boldsymbol{\sigma}=\boldsymbol{\sigma}^{s}+\boldsymbol{\sigma}^{a}
</script>
</span>, where <span class="MathJax_Preview"><script type="math/tex">
\boldsymbol{\sigma}^{s}
</script>
</span> is the solid stress (due to strain and strain history), and <span class="MathJax_Preview"><script type="math/tex">
\boldsymbol{\sigma}^{a}
</script>
</span> is the active contractile stress. The calculation of the contractile stress is the same, wether the solid mixture consists of uncoupled or compressible materials.
</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-4.12.1">4.12.1</a> Contraction in Mixtures of Uncoupled Materials<a class="Label" name="subsec:Contraction-Mixtures-Uncoupled"> </a>
</h3>
<div class="Unindented">
When the solid mixture consists of uncoupled materials, the active contraction material should be selected from the list below.
</div>
<div class="Indented">
<p><br/>
</p>

</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.12.1.1">4.12.1.1</a> Uncoupled Prescribed Uniaxial Active Contraction<a class="Label" name="subsec:Uncoupled-Uniaxial-Contraction"> </a>
</h4>
<div class="Unindented">
The material type for prescribed active contraction along a single direction (or fiber) in an uncoupled solid mixture is &ldquo;<i>uncoupled</i> <i>prescribed uniaxial active contraction</i>&rdquo;. This material must be combined with a stable uncoupled material that acts as a passive matrix, using a &ldquo;<i>uncoupled solid mixture</i>&rdquo; container as described in Section <a class="Reference" href="#subsec:Uncoupled-Solid-Mixture">4.1.2.15↑</a>. The following material parameters need to be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;T0&gt;
</td>
<td align="left" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
T_{0},
</script>
</span> representing the prescribed stress
</td>
<td align="left" valign="top">
[<b>P</b>]
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;theta&gt;
</td>
<td align="left" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\theta,
</script>
</span> azimuthal angle for fiber orientation in local coordinate system
</td>
<td align="left" valign="top">
[<b>deg</b>]
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;phi&gt;
</td>
<td align="left" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\varphi,
</script>
</span> declination angle for fiber orientation in local coordinate system
</td>
<td align="left" valign="top">
[<b>deg</b>]
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
<div class="Frameless" style="width: 100%;">
<div class="PlainVisible">
<div class="center">
<img class="embedded" src="Figures/FigSphericalAngles.png" alt="figure Figures/FigSphericalAngles.png" style="max-width: 108px; max-height: 106px;"/>

</div>
<br/>
<div class="center">
<b>Spherical angles</b>
</div>

</div>

</div>
<div class="defskip"> </div>
</div>
<div class="Indented">
In the reference configuration, the fiber is oriented along <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\mathbf{n}_{r}=\sin\varphi\cos\theta\mathbf{e}_{1}+\sin\varphi\sin\theta\mathbf{e}_{2}+\cos\varphi\mathbf{e}_{3}

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
\left(\mathbf{e}_{1},\mathbf{e}_{2},\mathbf{e}_{3}\right)
</script>
</span> are orthonormal vectors representing the local element coordinate system (Section <a class="Reference" href="#subsec:Specifying-Fiber-Orientation">4.1.1↑</a>). The parameters &lt;theta&gt; and &lt;phi&gt; are optional, with default values of <span class="MathJax_Preview"><script type="math/tex">
\theta=
</script>
</span>0° and <span class="MathJax_Preview"><script type="math/tex">
\varphi=
</script>
</span>90°, such that <span class="MathJax_Preview"><script type="math/tex">
\mathbf{n}_{r}=\mathbf{e}_{1}
</script>
</span>. The active stress <span class="MathJax_Preview"><script type="math/tex">
\boldsymbol{\sigma}^{a}
</script>
</span> for this material is given by <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\boldsymbol{\sigma}^{a}=J^{-1}T_{0}\mathbf{n}\otimes\mathbf{n}\,,

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
\mathbf{n}=\mathbf{F}\cdot\mathbf{n}_{r}
</script>
</span> is the stretched fiber orientation in the current (deformed) configuration.
</div>
<div class="Indented">
<i>Example</i>:
</div>
<div class="Indented">
Uniaxial contraction along <span class="MathJax_Preview"><script type="math/tex">
\mathbf{e}_{1}
</script>
</span>, in a mixture containing a Mooney-Rivlin solid.
</div>
<pre class="LyX-Code">
&lt;material id="1" type="uncoupled solid mixture"&gt;
  &lt;mat_axis type="local"&gt;0,0,0&lt;/mat_axis&gt;
  &lt;solid type="Mooney-Rivlin"&gt;
    &lt;c1&gt;1.0&lt;/c1&gt;
    &lt;c2&gt;0&lt;/c2&gt;
    &lt;k&gt;1000&lt;/k&gt;
  &lt;/solid&gt;
  &lt;solid type="prescribed uniaxial active contraction uncoupled"&gt;
    &lt;T0 lc="2"&gt;1&lt;/T0&gt;
    &lt;theta&gt;0&lt;/theta&gt;
    &lt;phi&gt;90&lt;/phi&gt;
  &lt;/solid&gt;
&lt;/material&gt;
</pre>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.12.1.2">4.12.1.2</a> Uncoupled Prescribed Transversely Isotropic Active Contraction<a class="Label" name="subsec:Uncoupled-TISO-Contraction"> </a>
</h4>
<div class="Unindented">
The material type for prescribed isotropic active contraction in a plane transverse to a given direction (or fiber), in an uncoupled solid mixture, is &ldquo;<i>prescribed trans iso active contraction uncoupled</i>&rdquo;. This material must be combined with a stable uncoupled material that acts as a passive matrix, using a &ldquo;<i>uncoupled solid mixture</i>&rdquo; container as described in Section <a class="Reference" href="#subsec:Uncoupled-Solid-Mixture">4.1.2.15↑</a>. The following material parameters need to be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;T0&gt;
</td>
<td align="left" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
T_{0},
</script>
</span> representing the prescribed stress
</td>
<td align="left" valign="top">
[<b>P</b>]
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;theta&gt;
</td>
<td align="left" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\theta,
</script>
</span> azimuthal angle for fiber orientation in local coordinate system
</td>
<td align="left" valign="top">
[<b>deg</b>]
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;phi&gt;
</td>
<td align="left" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\varphi,
</script>
</span> declination angle for fiber orientation in local coordinate system
</td>
<td align="left" valign="top">
[<b>deg</b>]
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
<div class="Frameless" style="width: 100%;">
<div class="PlainVisible">
<div class="center">
<img class="embedded" src="Figures/FigSphericalAngles.png" alt="figure Figures/FigSphericalAngles.png" style="max-width: 108px; max-height: 106px;"/>

</div>
<br/>
<div class="center">
<b>Spherical angles</b>
</div>

</div>

</div>
<div class="defskip"> </div>
</div>
<div class="Indented">
In the reference configuration, the fiber is oriented along <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\mathbf{n}_{r}=\sin\varphi\cos\theta\mathbf{e}_{1}+\sin\varphi\sin\theta\mathbf{e}_{2}+\cos\varphi\mathbf{e}_{3}

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
\left(\mathbf{e}_{1},\mathbf{e}_{2},\mathbf{e}_{3}\right)
</script>
</span> are orthonormal vectors representing the local element coordinate system (Section <a class="Reference" href="#subsec:Specifying-Fiber-Orientation">4.1.1↑</a>). The parameters &lt;theta&gt; and &lt;phi&gt; are optional, with default values of <span class="MathJax_Preview"><script type="math/tex">
\theta=
</script>
</span>0° and <span class="MathJax_Preview"><script type="math/tex">
\varphi=
</script>
</span>90°, such that <span class="MathJax_Preview"><script type="math/tex">
\mathbf{n}_{r}=\mathbf{e}_{1}
</script>
</span>. The active stress <span class="MathJax_Preview"><script type="math/tex">
\boldsymbol{\sigma}^{a}
</script>
</span> for this material is given by <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\boldsymbol{\sigma}^{a}=J^{-1}T_{0}\left(\mathbf{B}-\mathbf{n}\otimes\mathbf{n}\right)\,,

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
\mathbf{n}=\mathbf{F}\cdot\mathbf{n}_{r}
</script>
</span> is the stretched fiber orientation in the current (deformed) configuration and <span class="MathJax_Preview"><script type="math/tex">
\mathbf{B}=\mathbf{F}\cdot\mathbf{F}^{T}
</script>
</span> is the left Cauchy-Green tensor.
</div>
<div class="Indented">
<i>Example</i>:
</div>
<div class="Indented">
Isotropic contraction in plane transverse to <span class="MathJax_Preview"><script type="math/tex">
\mathbf{e}_{1}
</script>
</span>, in a mixture containing a Mooney-Rivlin solid.
</div>
<pre class="LyX-Code">
&lt;material id="1" type="uncoupled solid mixture"&gt;
  &lt;mat_axis type="local"&gt;0,0,0&lt;/mat_axis&gt;
  &lt;solid type="Mooney-Rivlin"&gt;
    &lt;c1&gt;1.0&lt;/c1&gt;
    &lt;c2&gt;0&lt;/c2&gt;
    &lt;k&gt;1000&lt;/k&gt;
  &lt;/solid&gt;
  &lt;solid type="prescribed trans iso active contraction uncoupled"&gt;
    &lt;T0 lc="2"&gt;1&lt;/T0&gt;
    &lt;theta&gt;0&lt;/theta&gt;
    &lt;phi&gt;90&lt;/phi&gt;
  &lt;/solid&gt;
&lt;/material&gt;
</pre>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.12.1.3">4.12.1.3</a> Uncoupled Prescribed Isotropic Active Contraction<a class="Label" name="subsec:Uncoupled-Isotropic-Contraction"> </a>
</h4>
<div class="Unindented">
The material type for prescribed isotropic active contraction, in an uncoupled solid mixture, is &ldquo;<i>prescribed isotropic active contraction uncoupled</i>&rdquo;. This material must be combined with a stable uncoupled material that acts as a passive matrix, using a &ldquo;<i>uncoupled solid mixture</i>&rdquo; container as described in Section <a class="Reference" href="#subsec:Uncoupled-Solid-Mixture">4.1.2.15↑</a>. The following material parameters need to be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;T0&gt;
</td>
<td align="none" valign="top" style="width: 189pt;">
<span class="MathJax_Preview"><script type="math/tex">
T_{0},
</script>
</span> representing the prescribed stress
</td>
<td align="left" valign="top">
[<b>P</b>]
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
The active stress <span class="MathJax_Preview"><script type="math/tex">
\boldsymbol{\sigma}^{a}
</script>
</span> for this material is given by <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\boldsymbol{\sigma}^{a}=J^{-1}T_{0}\mathbf{B}\,.

</script>

</span>
Note: If the solid material in the mixture is (nearly) incompressible, this isotropic contraction will cause no change in the deformation.
</div>
<div class="Indented">
<i>Example</i>:
</div>
<div class="Indented">
Isotropic contraction in a mixture containing a Mooney-Rivlin solid.
</div>
<pre class="LyX-Code">
&lt;material id="1" type="uncoupled solid mixture"&gt;
  &lt;mat_axis type="local"&gt;0,0,0&lt;/mat_axis&gt;
  &lt;solid type="Mooney-Rivlin"&gt;
    &lt;c1&gt;1.0&lt;/c1&gt;
    &lt;c2&gt;0&lt;/c2&gt;
    &lt;k&gt;5.0&lt;/k&gt;
  &lt;/solid&gt;
  &lt;solid type="prescribed isotropic active contraction uncoupled"&gt;
    &lt;T0 lc="2"&gt;1&lt;/T0&gt;
  &lt;/solid&gt;
&lt;/material&gt;
</pre>
<div class="Unindented">
<p><br/>
</p>

</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-4.12.2">4.12.2</a> Contraction in Mixtures of Compressible Materials<a class="Label" name="subsec:Contraction-Mixtures-Compressible"> </a>
</h3>
<div class="Unindented">
<a class="Label" name="subsubsec:mylabel27"> </a> When the solid mixture consists of compressible materials, the active contraction material should be selected from the list below.
</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.12.2.1">4.12.2.1</a> Prescribed Uniaxial Active Contraction<a class="Label" name="subsec:Prescribed-Uniaxial-Contraction"> </a>
</h4>
<div class="Unindented">
The material type for prescribed active contraction along a single direction (or fiber) in a solid mixture of compressible materials is &ldquo;<i>prescribed uniaxial active contraction</i>&rdquo;. This material must be combined with a stable compressible material that acts as a passive matrix, using a &ldquo;<i>solid mixture</i>&rdquo; container as described in Section <a class="Reference" href="#subsec:Solid-Mixture">4.1.3.21↑</a>. The following material parameters need to be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;T0&gt;
</td>
<td align="left" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
T_{0},
</script>
</span> representing the prescribed stress
</td>
<td align="left" valign="top">
[<b>P</b>]
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;theta&gt;
</td>
<td align="left" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\theta,
</script>
</span> azimuthal angle for fiber orientation in local coordinate system
</td>
<td align="left" valign="top">
[<b>deg</b>]
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;phi&gt;
</td>
<td align="left" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\varphi,
</script>
</span> declination angle for fiber orientation in local coordinate system
</td>
<td align="left" valign="top">
[<b>deg</b>]
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
<div class="Frameless" style="width: 100%;">
<div class="PlainVisible">
<div class="center">
<img class="embedded" src="Figures/FigSphericalAngles.png" alt="figure Figures/FigSphericalAngles.png" style="max-width: 108px; max-height: 106px;"/>

</div>
<br/>
<div class="center">
<b>Spherical angles</b>
</div>

</div>

</div>
<div class="defskip"> </div>
</div>
<div class="Indented">
In the reference configuration, the fiber is oriented along <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\mathbf{n}_{r}=\sin\varphi\cos\theta\mathbf{e}_{1}+\sin\varphi\sin\theta\mathbf{e}_{2}+\cos\varphi\mathbf{e}_{3}

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
\left(\mathbf{e}_{1},\mathbf{e}_{2},\mathbf{e}_{3}\right)
</script>
</span> are orthonormal vectors representing the local element coordinate system (Section <a class="Reference" href="#subsec:Specifying-Fiber-Orientation">4.1.1↑</a>). The parameters &lt;theta&gt; and &lt;phi&gt; are optional, with default values of <span class="MathJax_Preview"><script type="math/tex">
\theta=
</script>
</span>0° and <span class="MathJax_Preview"><script type="math/tex">
\varphi=
</script>
</span>90°, such that <span class="MathJax_Preview"><script type="math/tex">
\mathbf{n}_{r}=\mathbf{e}_{1}
</script>
</span>. The active stress <span class="MathJax_Preview"><script type="math/tex">
\boldsymbol{\sigma}^{a}
</script>
</span> for this material is given by <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\boldsymbol{\sigma}^{a}=J^{-1}T_{0}\mathbf{n}\otimes\mathbf{n}\,,

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
\mathbf{n}=\mathbf{F}\cdot\mathbf{n}_{r}
</script>
</span> is the stretched fiber orientation in the current (deformed) configuration.
</div>
<div class="Indented">
<i>Example</i>:
</div>
<div class="Indented">
Uniaxial contraction along <span class="MathJax_Preview"><script type="math/tex">
\mathbf{e}_{1}
</script>
</span>, in a mixture containing a neo-Hookean solid.
</div>
<pre class="LyX-Code">
&lt;material id="1" type="solid mixture"&gt;
  &lt;mat_axis type="local"&gt;0,0,0&lt;/mat_axis&gt;
  &lt;solid type="neo-Hookean"&gt;
    &lt;E&gt;1.0&lt;/E&gt;
    &lt;v&gt;0.3&lt;/v&gt;
  &lt;/solid&gt;
  &lt;solid type="prescribed uniaxial active contraction"&gt;
    &lt;T0 lc="2"&gt;1&lt;/T0&gt;
    &lt;theta&gt;0&lt;/theta&gt;
    &lt;phi&gt;90&lt;/phi&gt;
  &lt;/solid&gt;
&lt;/material&gt;
</pre>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.12.2.2">4.12.2.2</a> Prescribed Transversely Isotropic Active Contraction<a class="Label" name="subsec:Prescribed-TISO-Contraction"> </a>
</h4>
<div class="Unindented">
The material type for prescribed isotropic active contraction in a plane transverse to a given direction (or fiber), in a solid mixture of compressible materials, is &ldquo;<i>prescribed trans iso active contraction</i>&rdquo;. This material must be combined with a stable compressible material that acts as a passive matrix, using a &ldquo;<i>solid mixture</i>&rdquo; container as described in Section <a class="Reference" href="#subsec:Solid-Mixture">4.1.3.21↑</a>. The following material parameters need to be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;T0&gt;
</td>
<td align="left" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
T_{0},
</script>
</span> representing the prescribed stress
</td>
<td align="left" valign="top">
[<b>P</b>]
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;theta&gt;
</td>
<td align="left" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\theta,
</script>
</span> azimuthal angle for fiber orientation in local coordinate system
</td>
<td align="left" valign="top">
[<b>deg</b>]
</td>

</tr>
<tr>
<td align="left" valign="top">
&lt;phi&gt;
</td>
<td align="left" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
\varphi,
</script>
</span> declination angle for fiber orientation in local coordinate system
</td>
<td align="left" valign="top">
[<b>deg</b>]
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
<div class="Frameless" style="width: 100%;">
<div class="PlainVisible">
<div class="center">
<img class="embedded" src="Figures/FigSphericalAngles.png" alt="figure Figures/FigSphericalAngles.png" style="max-width: 108px; max-height: 106px;"/>

</div>
<br/>
<div class="center">
<b>Spherical angles</b>
</div>

</div>

</div>
<div class="defskip"> </div>
</div>
<div class="Indented">
In the reference configuration, the fiber is oriented along <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\mathbf{n}_{r}=\sin\varphi\cos\theta\mathbf{e}_{1}+\sin\varphi\sin\theta\mathbf{e}_{2}+\cos\varphi\mathbf{e}_{3}

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
\left(\mathbf{e}_{1},\mathbf{e}_{2},\mathbf{e}_{3}\right)
</script>
</span> are orthonormal vectors representing the local element coordinate system (Section <a class="Reference" href="#subsec:Specifying-Fiber-Orientation">4.1.1↑</a>). The parameters &lt;theta&gt; and &lt;phi&gt; are optional, with default values of <span class="MathJax_Preview"><script type="math/tex">
\theta=
</script>
</span>0°and <span class="MathJax_Preview"><script type="math/tex">
\varphi=
</script>
</span>90°, such that <span class="MathJax_Preview"><script type="math/tex">
\mathbf{n}_{r}=\mathbf{e}_{1}
</script>
</span>. The active stress <span class="MathJax_Preview"><script type="math/tex">
\boldsymbol{\sigma}^{a}
</script>
</span> for this material is given by <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\boldsymbol{\sigma}^{a}=J^{-1}T_{0}\left(\mathbf{B}-\mathbf{n}\otimes\mathbf{n}\right)\,,

</script>

</span>
where <span class="MathJax_Preview"><script type="math/tex">
\mathbf{n}=\mathbf{F}\cdot\mathbf{n}_{r}
</script>
</span> is the stretched fiber orientation in the current (deformed) configuration and <span class="MathJax_Preview"><script type="math/tex">
\mathbf{B}=\mathbf{F}\cdot\mathbf{F}^{T}
</script>
</span> is the left Cauchy-Green tensor.
</div>
<div class="Indented">
<i>Example</i>:
</div>
<div class="Indented">
Isotropic contraction in plane transverse to <span class="MathJax_Preview"><script type="math/tex">
\mathbf{e}_{1}
</script>
</span>, in a mixture containing a neo-Hookean solid.
</div>
<pre class="LyX-Code">
&lt;material id="1" type="solid mixture"&gt;
  &lt;mat_axis type="local"&gt;0,0,0&lt;/mat_axis&gt;
  &lt;solid type="neo-Hookean"&gt;
    &lt;E&gt;1.0&lt;/E&gt;
    &lt;v&gt;0.3&lt;/v&gt;
  &lt;/solid&gt;
  &lt;solid type="prescribed trans iso active contraction"&gt;
    &lt;T0 lc="2"&gt;1&lt;/T0&gt;
    &lt;theta&gt;0&lt;/theta&gt;
    &lt;phi&gt;90&lt;/phi&gt;
  &lt;/solid&gt;
&lt;/material&gt;
</pre>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-4.12.2.3">4.12.2.3</a> Prescribed Isotropic Active Contraction<a class="Label" name="subsec:Prescribed-Isotropic-Contraction"> </a>
</h4>
<div class="Unindented">
The material type for prescribed isotropic active contraction, in a solid mixture of compressible materials, is &ldquo;<i>prescribed isotropic active contraction</i>&rdquo;. This material must be combined with a stable compressible material that acts as a passive matrix, using a &ldquo;<i>solid mixture</i>&rdquo; container as described in Section <a class="Reference" href="#subsec:Solid-Mixture">4.1.3.21↑</a>. The following material parameters need to be defined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
&lt;T0&gt;
</td>
<td align="left" valign="top">
<span class="MathJax_Preview"><script type="math/tex">
T_{0},
</script>
</span> representing the prescribed stress
</td>
<td align="left" valign="top">
[<b>P</b>]
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
The active stress <span class="MathJax_Preview"><script type="math/tex">
\boldsymbol{\sigma}^{a}
</script>
</span> for this material is given by <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\boldsymbol{\sigma}^{a}=J^{-1}T_{0}\mathbf{B}\,.

</script>

</span>
<i>Example</i>:
</div>
<div class="Indented">
Isotropic contraction in a mixture containing a neo-Hookean solid.
</div>
<pre class="LyX-Code">
&lt;material id="1" type="solid mixture"&gt;
  &lt;mat_axis type="local"&gt;0,0,0&lt;/mat_axis&gt;
  &lt;solid type="neo-Hookean"&gt;
    &lt;E&gt;1.0&lt;/E&gt;
    &lt;v&gt;0&lt;/v&gt;
  &lt;/solid&gt;
  &lt;solid type="prescribed isotropic active contraction"&gt;
    &lt;T0 lc="2"&gt;1&lt;/T0&gt;
  &lt;/solid&gt;
&lt;/material&gt;
</pre>
<h1 class="Chapter">
<a class="toc" name="toc-Chapter-5">5</a> Restart Input file<a class="Label" name="chap:Restart-Input-file"> </a>
</h1>
<div class="Unindented">
As of version 1.1.6, FEBio will output a binary dump restart file. The user can either run the restart on the binary dump or create a restart input file.
</div>
<div class="Indented">
The restart feature in FEBio allows the user to continue a previously terminated analysis. In addition, it allows the user to modify some of the parameters during the restart. To activate the restart feature, define the <i>restart </i>element in the Control section:
</div>
<pre class="LyX-Code">
&lt;Control&gt;
  &lt;restart [file="&lt;dump file&gt;"]&gt;1&lt;/restart&gt;
  ...
&lt;/Control&gt;
</pre>
<div class="Unindented">
This describes the format of the restart input file. This file is used to redefine some parameters when restarting a previously terminated run. The structure is very similar to the FEBio input file and also uses XML formatting.
</div>
<div class="Indented">
Since the file uses XML, the first line must be the XML header:
</div>
<pre class="LyX-Code">
&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;
</pre>
<div class="Unindented">
The next line contains the root element of the restart file, and has to be:
</div>
<pre class="LyX-Code">
&lt;febio_restart version="1.0"&gt;
</pre>
<div class="Unindented">
The restart file is composed of the following sections. These sections are sub-elements of the <i>febio_restart </i>root element.
</div>
<div class="Description">
<span class="Description-entry"><i><i>Archive</i></i></span> define the binary dump file used for restarting. 
</div>
<div class="Description">
<span class="Description-entry"><i><i>Control</i></i></span> redefine some control parameters 
</div>
<div class="Description">
<span class="Description-entry"><i><i>LoadData</i></i></span> redefine some loadcurves. 
</div>
<div class="Unindented">
All sections are optional except for the Archive section, and need only be defined when redefining parameters. In the following paragraphs we describe the different sections in more detail.
</div>
<h2 class="Section">
<a class="toc" name="toc-Section-5.1">5.1</a> The Archive Section<a class="Label" name="sec:The-Archive-Section"> </a>
</h2>
<div class="Unindented">
The Archive section must be the first sub-element of the <i>febio_restart </i>root element. This section defines the name of the binary dump file:
</div>
<pre class="LyX-Code">
&lt;Archive&gt;archive.dmp&lt;/Archive&gt;
</pre>
<h2 class="Section">
<a class="toc" name="toc-Section-5.2">5.2</a> The Control Section<a class="Label" name="sec:The-Control-Section"> </a>
</h2>
<div class="Unindented">
The following control parameters can be redefined:
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
<b>Parameter</b>
</td>
<td align="left" valign="top">
<b>Description</b> 
</td>

</tr>
<tr>
<td align="left" valign="top">
dtol
</td>
<td align="left" valign="top">
convergence tolerance for displacements 
</td>

</tr>
<tr>
<td align="left" valign="top">
etol
</td>
<td align="left" valign="top">
convergence tolerance for energy 
</td>

</tr>
<tr>
<td align="left" valign="top">
rtol
</td>
<td align="left" valign="top">
convergence tolerance for residual 
</td>

</tr>
<tr>
<td align="left" valign="top">
lstol
</td>
<td align="left" valign="top">
line search tolerance 
</td>

</tr>
<tr>
<td align="left" valign="top">
max_refs
</td>
<td align="left" valign="top">
maximum number of stiffness reformations 
</td>

</tr>
<tr>
<td align="left" valign="top">
max_ups
</td>
<td align="left" valign="top">
maximum number of BFGS updates 
</td>

</tr>
<tr>
<td align="left" valign="top">
restart
</td>
<td align="left" valign="top">
restart file generation flag 
</td>

</tr>
<tr>
<td align="left" valign="top">
plot_level
</td>
<td align="left" valign="top">
defines the frequency of the plot file generation 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<h2 class="Section">
<a class="toc" name="toc-Section-5.3">5.3</a> The LoadData Section<a class="Label" name="sec:The-LoadData-Section"> </a>
</h2>
<div class="Unindented">
In the LoadData section the user can redefine some or all of the load curves. The syntax is identical to the LoadData section of the FEBio input file:
</div>
<pre class="LyX-Code">
&lt;LoadData&gt;
  &lt;loadcurve id="n"&gt;
    &lt;loadpoint&gt;0, 0&lt;/loadpoint&gt;
    ...
    &lt;loadpoint&gt;1, 0.54&lt;/loadpoint&gt;
  &lt;/loadcurve&gt;
&lt;/LoadData&gt;
</pre>
<div class="Unindented">
In this case the loadcurve <i>id </i>is the loadcurve number of the loadcurve that the user wishes to redefine.
</div>
<h2 class="Section">
<a class="toc" name="toc-Section-5.4">5.4</a> Example<a class="Label" name="sec:Example"> </a>
</h2>
<div class="Unindented">
The following example defines a restart input file. No parameters are redefined. Only the mandatory <i>Archive </i>element is defined. In this case the analysis will simply continue where it left off:
</div>
<pre class="LyX-Code">
&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;
&lt;febio_restart version="1.0"&gt;
  &lt;Archive&gt;out.dmp&lt;/Archive&gt;
&lt;/febio_restart&gt;
</pre>
<h1 class="Chapter">
<a class="toc" name="toc-Chapter-6">6</a> Multi-Step Analysis<a class="Label" name="chap:Multi-step-Analysis"> </a>
</h1>
<div class="Unindented">
A multi-step analysis is defined using multiple steps, where in each step the user can redefine control parameters and boundary conditions. This is useful, for instance, for defining time-dependant boundary conditions or for switching between different analysis types during the simulation.
</div>
<div class="Indented">
Multi-step models require a slightly different file organization compared to single-step models. More specifically, the Control section is not specified at the top of the input file. Instead, a <i>Step </i>section is added at the bottom of the file for each step and a <i>Control </i>section is defined for each step.
</div>
<h2 class="Section">
<a class="toc" name="toc-Section-6.1">6.1</a> The Step Section<a class="Label" name="sec:The-Step-Section"> </a>
</h2>
<div class="Unindented">
The multi-step analysis feature introduces a new section to the input file. Each step requires its own <i>step </i>section, preferably at the bottom of the input file. In this step section, the user can redefine the control section and the boundary section. The following format is suggested when defining a multi-step analysis:
</div>
<pre class="LyX-Code">
&lt;febio_spec version="2.5"&gt;
  &lt;Module type="solid"/&gt;
  &lt;Material&gt;
    &lt;!-- materials go here --&gt;
  &lt;/Material&gt;
  &lt;Geometry&gt;
    &lt;!-- geometry goes here --&gt;
  &lt;/Geometry&gt;
  &lt;Boundary&gt;
    &lt;!-- global boundary conditions --&gt;
  &lt;/Boundary&gt;
  &lt;LoadData&gt;
    &lt;!-- load curve data goes here --&gt;
  &lt;/LoadData&gt;
  &lt;Step&gt;
    &lt;Control&gt;
      &lt;!-- local control settings --&gt;
    &lt;/Control&gt;
    &lt;Boundary&gt;
      &lt;!-- local boundary conditions --&gt;
    &lt;/Boundary&gt;
  &lt;/Step&gt;
&lt;/febio_spec&gt;
</pre>
<div class="Unindented">
The first part of the file looks similar to a normal input file, except that the control section only is not specified. Also, the Boundary, Loads, Constraints, Contact, sections should only contain global boundary conditions.
</div>
<div class="Indented">
At the end of the file the user defines as many Step sections as needed. In each Step section, the user can now define the control parameters and boundary conditions.
</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-6.1.1">6.1.1</a> Boundary Conditions<a class="Label" name="subsec:Boundary-Conditions"> </a>
</h3>
<div class="Unindented">
In a multi-step analysis boundary conditions can be applied that are only active during the step. This applies to the <i>Boundary</i>, <i>Loads</i>, <i>Contact </i>and <i>Constraints </i>section of the FEBio input file. These sections can thus be placed inside the <i>Step </i>section to define a boundary condition that is only active during the step. If one of these sections is defined before the first <i>Step</i> section, the corresponding boundary conditions remain enforced during all the steps.
</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-6.1.2">6.1.2</a> Relative Boundary Conditions<a class="Label" name="subsec:Relative-Boundary-Conditions"> </a>
</h3>
<div class="Unindented">
Some boundary conditions can be defined as relative boundary conditions. This means that the corresponding conditions will be applied to the final configuration of the previous step and not to the original reference configuration. For example, if a prescribed displacement is defined as relative the displacement will be taken with respect of the positions of the final configuration. This makes it possible to switch between load and displacement controlled boundary conditions in multi-step analyses.
</div>
<h2 class="Section">
<a class="toc" name="toc-Section-6.2">6.2</a> An Example<a class="Label" name="sec:An-Example"> </a>
</h2>
<div class="Unindented">
The following example illustrates the use of the multi-step feature of FEBio. This problem defines two steps. In the first step, a single element is stretched using a prescribed boundary condition. In the second step, the boundary condition is removed and the analysis type is switched from quasi-static to a dynamic analysis. Note the presence of the global fixed boundary constraints, which will remain enforced during both steps:
</div>
<pre class="LyX-Code">
&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;
&lt;febio_spec version="2.5"&gt;
  &lt;Module type="solid"/&gt;
  &lt;Material&gt;
    &lt;material id="1" name="Material 1" type="neo-Hookean"&gt;
      &lt;density&gt;1.0&lt;/density&gt;
      &lt;E&gt;1&lt;/E&gt;
      &lt;v&gt;0.45&lt;/v&gt;
    &lt;/material&gt;
  &lt;/Material&gt;
  &lt;Geometry&gt;
    &lt;Nodes&gt;
      &lt;node id="1"&gt;-2.0,-0.5, 0.0&lt;/node&gt;
      &lt;node id="2"&gt;-2.0,-0.5, 1.0&lt;/node&gt;
      &lt;node id="3"&gt;-2.0, 0.5, 0.0&lt;/node&gt;
      &lt;node id="4"&gt;-2.0, 0.5, 1.0&lt;/node&gt;
      &lt;node id="5"&gt; 2.0,-0.5, 0.0&lt;/node&gt;
      &lt;node id="6"&gt; 2.0,-0.5, 1.0&lt;/node&gt;
      &lt;node id="7"&gt; 2.0, 0.5, 0.0&lt;/node&gt;
      &lt;node id="8"&gt; 2.0, 0.5, 1.0&lt;/node&gt;
    &lt;/Nodes&gt;
    &lt;Elements&gt;
      &lt;hex8 id="1" mat="1"&gt;1,5,7,3,2,6,8,4&lt;/hex8&gt;
    &lt;/Elements&gt;
    &lt;NodeSet name="set1"&gt;
      &lt;node id="1"/&gt;
      &lt;node id="2"/&gt;
      &lt;node id="3"/&gt;
      &lt;node id="4"/&gt;
    &lt;/NodeSet&gt;
    &lt;NodeSet name="set2"&gt;
      &lt;node id="1"/&gt;
      &lt;node id="2"/&gt;
      &lt;node id="5"/&gt;
      &lt;node id="6"/&gt;
    &lt;/NodeSet&gt;
    &lt;NodeSet name="set3"&gt;
      &lt;node id="1"/&gt;
      &lt;node id="3"/&gt;
      &lt;node id="5"/&gt;
      &lt;node id="7"/&gt;
    &lt;/NodeSet&gt;
    &lt;NodeSet name="set4"&gt;
      &lt;node id="5"/&gt;
      &lt;node id="6"/&gt;
      &lt;node id="7"/&gt;
      &lt;node id="8"/&gt;
    &lt;/NodeSet&gt;
  &lt;/Geometry&gt;
  &lt;Boundary&gt;
    &lt;fix bc="x" node_set="set1"/&gt;
    &lt;fix bc="y" node_set="set2"/&gt;
    &lt;fix bc="z" node_set="set3"/&gt;
  &lt;/Boundary&gt;
  &lt;LoadData&gt;
    &lt;loadcurve id="1"&gt;
      &lt;loadpoint&gt;0,0&lt;/loadpoint&gt;
      &lt;loadpoint&gt;1,0.1&lt;/loadpoint&gt;
    &lt;/loadcurve&gt;
  &lt;/LoadData&gt;
  &lt;Step id="1"&gt;
    &lt;Control&gt;
      &lt;time_steps&gt;10&lt;/time_steps&gt;
      &lt;step_size&gt;0.1&lt;/step_size&gt;
    &lt;/Control&gt;
    &lt;Boundary&gt;
      &lt;prescribe bc="x" node_set="set4"&gt;
	&lt;scale lc="1"&gt;1.0&lt;/scale&gt;
	&lt;node id="8" bc="x" lc="1"&gt;1&lt;/node&gt;
      &lt;/prescribe&gt;
    &lt;/Boundary&gt;
  &lt;/Step&gt;
  &lt;Step id="2"&gt;
    &lt;Control&gt;
      &lt;time_steps&gt;50&lt;/time_steps&gt;
      &lt;step_size&gt;0.5&lt;/step_size&gt;
      &lt;analysis type="dynamic"&gt;&lt;/analysis&gt;
    &lt;/Control&gt;
  &lt;/Step&gt;
&lt;/febio_spec&gt;
</pre>
<h1 class="Chapter">
<a class="toc" name="toc-Chapter-7">7</a> Parameter Optimization<a class="Label" name="chap:Parameter-Optimization"> </a>
</h1>
<div class="Unindented">
This chapter describes FEBio’s parameter optimization module. This module tries to estimate material parameters by solving an inverse finite element problem, where the &ldquo;solution&rdquo; of the problem is known, and the problem’s material parameters are sought. In this case, the solution will often be an experimentally determined reaction force curve, and the unknown parameters are the material parameters that will recreate the reaction force curve by solving a forward FE problem. The user will need to input this reaction force curve as well as an initial guess for the material parameters. This is done using a separate input file which is described next.
</div>
<h2 class="Section">
<a class="toc" name="toc-Section-7.1">7.1</a> Optimization Input File<a class="Label" name="sec:Optimization-Input-File"> </a>
</h2>
<div class="Unindented">
Like all FEBio input files, the parameter optimization input file is an xml-formatted text file. The following sections are defined:
</div>
<div class="Description">
<span class="Description-entry"><i><i>Model</i></i></span> optional section defining the FE problem input file. 
</div>
<div class="Description">
<span class="Description-entry"><i><i>Options</i></i></span> optional section defining the optimization control parameters. 
</div>
<div class="Description">
<span class="Description-entry"><i><i>Function</i></i></span> defines the parameter that generates the function values of the solution that are to be fitted. 
</div>
<div class="Description">
<span class="Description-entry"><i><i>Parameters</i></i></span> defines the material parameters that are to be determined. 
</div>
<div class="Description">
<span class="Description-entry"><i><i>Constraints</i></i></span> defines linear constraints for the material parameters. 
</div>
<div class="Description">
<span class="Description-entry"><i><i>LoadData</i></i></span> defines the experimental reaction force using load curves. 
</div>
<div class="Unindented">
In the following paragraphs each section will be explained in detail.
</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-7.1.1">7.1.1</a> Model Section<a class="Label" name="subsec:Model-Section"> </a>
</h3>
<div class="Unindented">
This section is included for backwards compatibility, but the model is now specified on the command line as described in Section <a class="Reference" href="#sec:Running-Parameter-Optimization">7.2↓</a>. The model section defines the file name for the FE input problem. This input file defines the problem that will be solved by FEBio repeatedly. This xml-tag only takes a single value, namely the name of a valid FEBio input file. For example,
</div>
<pre class="LyX-Code">
&lt;Model&gt;ex1.feb&lt;/Model&gt;
</pre>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-7.1.2">7.1.2</a> Options Section<a class="Label" name="subsec:Options-Section"> </a>
</h3>
<div class="Unindented">
This section defines the control parameters for the optimization. The options that can be defined will depend on the chosen optimization method, which is set with an attribute of the Options section. Currently the two implemented optimization methods are the &ldquo;Levenberg-Marquardt&rdquo; method (type=&ldquo;levmar&rdquo;) and the &ldquo;Constrained Levenberg-Marquardt&rdquo; method (type=&ldquo;constrained levmar&rdquo;). Documentation for the Constrained Levenberg-Marquardt method can be found at <a href="http://users.ics.forth.gr/~lourakis/levmar/">http://users.ics.forth.gr/~lourakis/levmar/</a>.
</div>
<div class="Indented">
Note that this section is optional. When omitted, default values for the control parameters are chosen. The following parameters can be defined.
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
<b>Parameter</b>
</td>
<td align="left" valign="top" style="width: 3in;">
<b>Description</b>
</td>
<td align="left" valign="top">
<b>Default</b> 
</td>

</tr>
<tr>
<td align="left" valign="top">
type attribute
</td>
<td align="left" valign="top" style="width: 3in;">
Optimization method
</td>
<td align="left" valign="top">
levmar 
</td>

</tr>
<tr>
<td align="left" valign="top">
obj_tol
</td>
<td align="left" valign="top" style="width: 3in;">
Convergence tolerance for objective function. (1)
</td>
<td align="left" valign="top">
0.001 
</td>

</tr>
<tr>
<td align="left" valign="top">
f_diff_scale
</td>
<td align="left" valign="top" style="width: 3in;">
Forward difference scale factor (2)
</td>
<td align="left" valign="top">
0.001 
</td>

</tr>
<tr>
<td align="left" valign="top">
log_level
</td>
<td align="left" valign="top" style="width: 3in;">
Sets the amount of output that is generated on screen and in the logfile (3)
</td>
<td align="left" valign="top">
LOG_NEVER 
</td>

</tr>
<tr>
<td align="left" valign="top">
tau
</td>
<td align="left" valign="top" style="width: 3in;">
Step size scale factor (4)
</td>
<td align="left" valign="top">
1.0e-3 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
For example,
</div>
<pre class="LyX-Code">
&lt;Options type="constrained levmar"&gt;
  &lt;obj_tol&gt;0.001&lt;/obj_tol&gt;
  &lt;f_diff_scale&gt;0.001&lt;/f_diff_scale&gt;
&lt;/Options&gt;
</pre>
<div class="Unindented">
<i>Comments:</i>
</div>
<ol>
<li>
The objective function that is to be minimized is a function of the reaction force values: <div class="Unindented">
<span class="MathJax_Preview">
<script type="math/tex;mode=display">

f\left(\mathbf{a}\right)=\sum\limits _{i=1}^{n}\left[y_{i}-y\left(x_{i};\mathbf{a}\right)\right]^{2}.

</script>

</span>
Here, <span class="MathJax_Preview"><script type="math/tex">
y\left(x;\mathbf{a}\right)
</script>
</span> is the function that describes the model, <b><span class="MathJax_Preview"><script type="math/tex">
\mathbf{a}
</script>
</span> </b>is a vector with the (unknown) material parameters and the <span class="MathJax_Preview"><script type="math/tex">
\left(x_{i},y_{i}\right)
</script>
</span> are the experimentally (or otherwise) obtained data that approximates the ideal model.
</div>

</li>
<li>
The optimization method currently implemented requires the calculation of the gradient of the model function <span class="MathJax_Preview"><script type="math/tex">
y
</script>
</span>with respect to the model parameters <b><span class="MathJax_Preview"><script type="math/tex">
\mathbf{a}
</script>
</span></b>. Since this gradient is not known, FEBio will approximate it using forward differences. For example, the <span class="MathJax_Preview"><script type="math/tex">
k
</script>
</span>-th component of the gradient is approximated as follows. <div class="Unindented">
<span class="MathJax_Preview">
<script type="math/tex;mode=display">

\frac{\partial y}{\partial a_{k}}\approx\frac{1}{\delta a_{k}}\left[y\left(a_{1},\cdots,a_{k}+\delta a_{k},\cdots,a_{m}\right)-y\left(a_{1},\cdots,a_{k},\cdots,a_{m}\right)\right]

</script>

</span>
The value for <span class="MathJax_Preview"><script type="math/tex">
\delta a_{k}
</script>
</span>is determined from the following formula. <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\delta a_{k}=\varepsilon\left(1+a_{k}\right)

</script>

</span>
where, <span class="MathJax_Preview"><script type="math/tex">
\varepsilon
</script>
</span>is the forward difference scale factor which can be set by the user with the <i>fdiff_scale </i>option.
</div>

</li>
<li>
The <i>log_level </i>allows the user to control exactly how much output from the time iterations of each optimization iteration is written to the screen and logfile. The following values are allowed: <div class="Unindented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
<b>Value</b>
</td>
<td align="left" valign="top">
<b>Description</b> 
</td>

</tr>
<tr>
<td align="left" valign="top">
LOG_DEFAULT
</td>
<td align="left" valign="top">
Use default settings (may be omitted) 
</td>

</tr>
<tr>
<td align="left" valign="top">
LOG_NEVER
</td>
<td align="left" valign="top">
Don’t generate any output 
</td>

</tr>
<tr>
<td align="left" valign="top">
LOG_FILE_ONLY
</td>
<td align="left" valign="top">
Save to the logfile only 
</td>

</tr>
<tr>
<td align="left" valign="top">
LOG_SCREEN_ONLY
</td>
<td align="left" valign="top">
Only print to the screen 
</td>

</tr>
<tr>
<td align="left" valign="top">
LOG_FILE_AND_SCREEN
</td>
<td align="left" valign="top">
Save to the logfile and print to the screen 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>

</li>
<li>
The step size scale factor <i>tau</i> can be set as an input only for the Constrained Levenberg-Marquardt method. 
</li>

</ol>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-7.1.3">7.1.3</a> Function Section<a class="Label" name="subsec:Function-Section"> </a>
</h3>
<div class="Unindented">
This section defines the parameter that will generate the function values that are to be fitted to the experimental data. Currently, only one function parameter can be defined and it is defined using the <i>fnc</i> tag. For example,
</div>
<pre class="LyX-Code">
&lt;Function&gt;
  &lt;fnc lc="1"&gt;rigid.Fx&lt;/fnc&gt;
&lt;/Function&gt;
</pre>
<div class="Unindented">
This example defines the <span class="MathJax_Preview"><script type="math/tex">
x
</script>
</span>-component of a rigid body material named <i>rigid</i> as the model’s function parameter. The <i>lc </i>attribute defines the loadcurve number that describes the model’s experimental data.
</div>
<div class="Indented">
Note that currently only rigid body materials can be used to define the function parameter, and only using the following data components.
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
<b>Component</b>
</td>
<td align="left" valign="top">
<b>Description</b> 
</td>

</tr>
<tr>
<td align="left" valign="top">
Fx
</td>
<td align="left" valign="top">
x-component of the rigid body reaction force 
</td>

</tr>
<tr>
<td align="left" valign="top">
Fy
</td>
<td align="left" valign="top">
y-component of the rigid body reaction force 
</td>

</tr>
<tr>
<td align="left" valign="top">
Fz
</td>
<td align="left" valign="top">
z-component of the rigid body reaction force 
</td>

</tr>
<tr>
<td align="left" valign="top">
Mx
</td>
<td align="left" valign="top">
x-component of the rigid body reaction moment 
</td>

</tr>
<tr>
<td align="left" valign="top">
My
</td>
<td align="left" valign="top">
y-component of the rigid body reaction moment 
</td>

</tr>
<tr>
<td align="left" valign="top">
Mz
</td>
<td align="left" valign="top">
z-component of the rigid body reaction moment 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-7.1.4">7.1.4</a> Parameters Section<a class="Label" name="subsec:Parameters-Section"> </a>
</h3>
<div class="Unindented">
This section defines the material parameters that are to be determined. Each parameter is defined using the <i>param </i>element:
</div>
<pre class="LyX-Code">
&lt;Parameters&gt;
  &lt;param name="[name]"&gt;[guess], [min], [max], [scale]&lt;/param&gt;
&lt;/Parameters&gt;
</pre>
<div class="Unindented">
The <i>name </i>attribute gives the name of the parameter that is to be determined. The format of the name depends on the nesting of the material description in the input file. FEBio supports names in the following form:
</div>
<div class="Indented">
For most materials, the following format is used to reference a parameter.
</div>
<pre class="LyX-Code">
material_name.parameter
</pre>
<div class="Unindented">
For example, assume a material, named <i>Material1</i>, of type neo-Hookean is defined. Then we can reference the Young’s modulus (E) as follows.
</div>
<pre class="LyX-Code">
name="Material1.E"
</pre>
<div class="Unindented">
In FEBio many materials define nested parameters, meaning the material properties have parameters of their own. Examples are the <i>biphasic, biphasic-solute </i>and <i>multiphasic </i>materials. In general, nested parameters are referenced using the material name, the property and the parameter.
</div>
<pre class="LyX-Code">
material_name.property.parameter
</pre>
<div class="Unindented">
For instance, assume a biphasic material, named <i>Material1</i> is defined. To reference the <i>perm </i>parameter, use the following syntax.
</div>
<pre class="LyX-Code">
name="Material1.permeability.perm"
</pre>
<div class="Unindented">
If this material has a <i>neo-Hookean </i>solid matrix, then the Young’s modulus is referenced as follows.
</div>
<pre class="LyX-Code">
name="Material1.solid.E"
</pre>
<div class="Unindented">
For multiply nested properties, the syntax extends naturally. For instance, assume a biphasic material with a visco-elastic material, having a neo-Hookean material as a solid matrix. In this case, the Young’s modulus is referenced as follows.
</div>
<pre class="LyX-Code">
name="Material1.solid.elastic.E"
</pre>
<div class="Unindented">
The only exception to this is when the <i>solid </i>property references a solid mixture. In that case, the components of the mixture are referenced by name. For example, assume again a biphasic material, where the <i>solid</i> is a solid mixture of which the first component is a neo-Hookean material, named <i>solid1</i>. Now, the Young’s modulus is referenced as follows.
</div>
<pre class="LyX-Code">
name="Material1.solid.solid1.E"
</pre>
<div class="Unindented">
Furthermore, if a parameter is part of an array, its name should be specified in the form parameter[index], where the index is one-based.
</div>
<div class="Indented">
Each parameter takes four values: [guess] is the initial guess for this parameter, [min] and [max] are the minimum and maximum values respectively for this parameter, and [scale] is a representative scale (magnitude) for this parameter. This value is used to normalize the optimization parameter and improve convergence. If not specified by the user, it defaults to the initial guess.
</div>
<div class="Indented">
For example, for a neo-Hookean solid, named <i>mat1</i>
</div>
<pre class="LyX-Code">
&lt;Parameters&gt;
  &lt;param name="mat1.E"&gt;1.0, 0.0, 5.0, 1.0&lt;/param&gt;
  &lt;param name="mat1.v"&gt;0.1, 0.0, 0.5, 1.0&lt;/param&gt;
&lt;/Parameters&gt;
</pre>
<div class="Unindented">
This example defines two material parameters. The first component of the name (here <i>mat1</i>) is the name of the material as defined in the model input file (defined in the <i>Model </i>section). The second component (here <i>E</i> and <i>v</i>) are the names of the material parameters.
</div>
<div class="Indented">
For a solid mixture that includes an ellipsoidal fiber distribution,
</div>
<pre class="LyX-Code">
&lt;Parameters&gt;
  &lt;param name="mat1.mat2.ksi[1]"&gt;0.2, 0, 6, 1.0&lt;/param&gt;
&lt;/Parameters&gt;
</pre>
<div class="Unindented">
In this example, the name of the solid mixture is <i>mat1</i>; the name of the ellipsoidal fiber distribution solid is <i>mat2</i>; and <i>ksi[1]</i> is the first material parameter in an array of three values for this parameter. In order for this naming convention to work correctly, the user must ensure that a unique name is given for each solid in a solid mixture.
</div>
<div class="Indented">
For a biphasic material, the parameter name for material properties of the &lt;solid&gt; and &lt;permeability&gt; materials can be referenced as in this example,
</div>
<pre class="LyX-Code">
&lt;Parameters&gt;
  &lt;param name="mat1.phi0"&gt;0.2, 0.01, 0.99, 0.5&lt;/param&gt;
  &lt;param name="mat1.solid.E"&gt;0.1, 0.01, 0.5, 1.0&lt;/param&gt;
  &lt;param name="mat1.permeability.perm"&gt;2e-3,5e-4,1e-2,1e-3&lt;/param&gt;
&lt;/Parameters&gt;
</pre>
<div class="Unindented">
Note that <i>phi0</i> is a material parameter that belongs to the biphasic material description, whereas <i>E</i> belongs to the solid description and <i>perm</i> belongs to the permeability description.
</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-7.1.5">7.1.5</a> Constraints Section<a class="Label" name="subsec:Constraints-Section"> </a>
</h3>
<div class="Unindented">
The Constrained Levenberg-Marquardt method allows linear constraints on the material parameters. If <b><span class="MathJax_Preview"><script type="math/tex">
\mathbf{a}
</script>
</span></b> is the material parameter vector, then the linear constraint is of the form: <span class="MathJax_Preview">
<script type="math/tex;mode=display">

c_{1}a_{1}+c_{2}a_{2}+...+c_{n}a_{n}+b=0\quad.

</script>

</span>
The coefficients <span class="MathJax_Preview"><script type="math/tex">
c_{1},c_{2},...,c_{n},b
</script>
</span> are the inputs of the constraint tag. For example, if the linear constraint is <span class="MathJax_Preview"><script type="math/tex">
2a_{1}-a_{2}+3=0
</script>
</span> , then the Constraints section would be:
</div>
<pre class="LyX-Code">
&lt;Constraints&gt;
  &lt;constraint&gt;2, -1, 3&lt;/constraint&gt;
&lt;/Constraints&gt;
</pre>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-7.1.6">7.1.6</a> Load Data Section<a class="Label" name="subsec:Load-Data-Section"> </a>
</h3>
<div class="Unindented">
This section serves the same purpose as in the regular FEBio input file: it defines all the load curves that are used in the parameter optimization. Currently, only one load curve needs to be defined, namely the experimental data to which the model will be fitted. The format is identical to that of the usual FEBio input file (see Section <a class="Reference" href="#sec:LoadData-Section">3.17↑</a>).
</div>
<div class="Indented">
Each load curve is defined through an array of value pairs <span class="MathJax_Preview"><script type="math/tex">
\left(x_{i},y_{i}\right)
</script>
</span>, where the <span class="MathJax_Preview"><script type="math/tex">
x
</script>
</span>component refers to the (simulation) time and the <span class="MathJax_Preview"><script type="math/tex">
y
</script>
</span>component to is the function value.
</div>
<h2 class="Section">
<a class="toc" name="toc-Section-7.2">7.2</a> Running a Parameter Optimization<a class="Label" name="sec:Running-Parameter-Optimization"> </a>
</h2>
<div class="Unindented">
As explained above, a parameter optimization problem is described using two input files. First, a standard FEBio input file that defines the geometry, materials, boundary conditions, etc. The second input file describes the parameter optimization data, such as the objective and which material parameters are to be optimized. The format of the second file is described above. A parameter optimization can only be initiated from the command line. For example:
</div>
<pre class="LyX-Code">
&gt;febio –i model.feb –s optim.feb
</pre>
<div class="Unindented">
The output of a parameter optimization analysis is a log file that contains the screen output of the FEBio run as well as the optimized parameter values.
</div>
<h2 class="Section">
<a class="toc" name="toc-Section-7.3">7.3</a> An Example Input File<a class="Label" name="sec:An-Example-Input"> </a>
</h2>
<div class="Unindented">
Below follows a complete example of an optimization input file.
</div>
<pre class="LyX-Code">
&lt;?xml version="1.0"?&gt;
&lt;febio_optimize&gt;
  &lt;Model&gt;ex1.feb&lt;/Model&gt;
  &lt;Options&gt;
    &lt;obj_tol&gt;0.001&lt;/obj_tol&gt;
    &lt;f_diff_scale&gt;0.001&lt;/f_diff_scale&gt;
  &lt;/Options&gt;
  &lt;Function&gt;
    &lt;fnc lc="1"&gt;rigid.Fx&lt;/fnc&gt;
  &lt;/Function&gt;
  &lt;Parameters&gt;
    &lt;param name="mat1.E"&gt;1, 0, 5&lt;/param&gt;
    &lt;param name="mat1.v"&gt;-0.5, 0, 0.5&lt;/param&gt;
  &lt;/Parameters&gt;
  &lt;LoadData&gt;
    &lt;loadcurve id="1"&gt;
      &lt;point&gt;0.0, 0&lt;/point&gt;
      &lt;point&gt;0.5, 1&lt;/point&gt;
      &lt;point&gt;1.0, 2&lt;/point&gt;
    &lt;/loadcurve&gt;
  &lt;/LoadData&gt;
&lt;/febio_optimize&gt;
</pre>
<div class="Unindented">
<i>Comments</i>:
</div>
<ol>
<li>
Notice that the xml root element is <i>febio_optimize</i> for the optimization input file. 
</li>
<li>
Here, the FEBio input file that contains the actual FE model data is <i>ex1.feb</i>. This file is a standard FEBio input file that defines all geometry, materials, boundary conditions and more. 
</li>
<li>
The <i>Options </i>section is included here, but can be omitted. If omitted default values will be used for all control parameters. 
</li>
<li>
The function parameter and material parameters are defined through &ldquo;material name&rdquo;.&ldquo;parameter name&rdquo; pairs. The name of the materials and their parameters are defined in the FEBio input file (in this example, <i>ex1.feb</i>). 
</li>

</ol>
<h1 class="Chapter">
<a class="toc" name="toc-Chapter-8">8</a> Troubleshooting<a class="Label" name="chap:Troubleshooting"> </a>
</h1>
<div class="Unindented">
Running a nonlinear finite element analysis can be a very challenging task. The large deformations and complex constitutive models can make it very difficult to obtain a converged solution. There are many causes for nonconvergence, ranging from element inversions, material instability, failure to enforce contact constraints and many more. Sometimes it is possible that FEBio gives you a converged solution, but the solution is meaningless or at least not what was expected.
</div>
<div class="Indented">
Fortunately, many of these issues can be prevented or solved with little effort. This chapter discusses some strategies to prevent common problems and to troubleshoot a problematic run. It offers some sanity checks before you run your model which can save you a lot of frustration down the road. And when things do go bad, we hope that the strategies suggested here may prove helpful.
</div>
<div class="Indented">
However, keep in mind, that the finite element method cannot solve all problems. It is a very powerful numerical method, but with limitations. Understanding these limitations and how they affect your modeling work is crucial in becoming a good analysist.
</div>
<h2 class="Section">
<a class="toc" name="toc-Section-8.1">8.1</a> Before You Run Your Model<a class="Label" name="sec:Before-You-Run"> </a>
</h2>
<div class="Unindented">
In this section we’ll discuss what a well-defined finite element model is and some things you may need to check before you run your model in FEBio.
</div>
<div class="Indented">
A well-defined finite element model contains a finite element mesh, a valid material and properly defined boundary and contact conditions in order to define a unique solution to the problem under study. We will look at each of these requirements in more detail in the following sections.
</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-8.1.1">8.1.1</a> The Finite Element Mesh<a class="Label" name="subsec:Finite-Element-Mesh"> </a>
</h3>
<div class="Unindented">
A finite element mesh is required to solve a problem with FEBio. The mesh defines a discretization of the problem domain in nodes and connected elements. FEBio only supports certain elements and thus the mesh must be composed of elements from this set. See Section <a class="Reference" href="#subsec:Elements-Section">3.8.2↑</a> for a discussion of the supported elements. In addition, FEBio assumes a specific ordering of the nodes of an element. FEBio cannot discover if the nodes are in the correct order, but if they are not, FEBio will most likely have trouble converging or throw negative jacobians. If FEBio discovers negative jacobians before the first time step, it is likely that the nodes of the elements are not defined in the proper order.
</div>
<div class="Indented">
For shell elements, the initial thickness of an element is also important. When elements are too thick (the thickness is of the same order as the element size), FEBio may complain about negative jacobians. This may be particularly a problem in areas of high curvature. The only solution around this issue might be to remesh the problematic area.
</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-8.1.2">8.1.2</a> Materials<a class="Label" name="subsec:Materials"> </a>
</h3>
<div class="Unindented">
A material in FEBio defines the constitutive response of the domain to which the material is assigned. See Chapter <a class="Reference" href="#chap:Materials">4↑</a> for a detailed list of all the available materials in FEBio. It is important to understand that the module defines which materials you can use. For example, the biphasic material cannot be used in the <i>solid </i>module. Although some cases of invalid material use are caught, in many situations the resulting behavior is undefined. The following table shows a list of some of FEBio’s special materials and the modules in which they can be used.
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
<b>Material</b>
</td>
<td align="left" valign="top">
<b>Solid</b>
</td>
<td align="center" valign="top">
<b>Biphasic</b>
</td>
<td align="center" valign="top">
<b>Solute</b>
</td>
<td align="center" valign="top">
<b>Multiphasic</b>
</td>
<td align="center" valign="top">
<b>Heat</b> 
</td>

</tr>
<tr>
<td align="left" valign="top">
<i>biphasic</i>
</td>
<td align="left" valign="top">

</td>
<td align="center" valign="top">
<b>YES</b>
</td>
<td align="center" valign="top">
<b>YES</b> 
</td>
<td align="center" valign="top">
<b>YES</b>
</td>
<td align="center" valign="top">

</td>

</tr>
<tr>
<td align="left" valign="top">
<i>biphasic-solute</i>
</td>
<td align="left" valign="top">

</td>
<td align="center" valign="top">

</td>
<td align="center" valign="top">
<b>YES</b>
</td>
<td align="center" valign="top">
<b>YES</b>
</td>
<td align="center" valign="top">

</td>

</tr>
<tr>
<td align="left" valign="top">
<i>triphasic</i>
</td>
<td align="left" valign="top">

</td>
<td align="center" valign="top">

</td>
<td align="center" valign="top">
<b>YES</b>
</td>
<td align="center" valign="top">
<b>YES</b>
</td>
<td align="center" valign="top">

</td>

</tr>
<tr>
<td align="left" valign="top">
<i>multiphasic</i>
</td>
<td align="left" valign="top">

</td>
<td align="center" valign="top">

</td>
<td align="center" valign="top">

</td>
<td align="center" valign="top">
<b>YES</b>
</td>
<td align="center" valign="top">

</td>

</tr>
<tr>
<td align="left" valign="top">
<i>isotropic Fourier</i>
</td>
<td align="left" valign="top">

</td>
<td align="center" valign="top">

</td>
<td align="center" valign="top">

</td>
<td align="center" valign="top">

</td>
<td align="center" valign="top">
<b>YES</b> 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
In addition to using the proper materials for a given module, it is also important to understand that most material parameters have a limited range in which they define valid constitutive behavior. For example, in a neo-Hookean material the Young’s modulus must be positive and the Poisson’s ratio must larger than -1 and less than 0.5. FEBio has most of these limits implemented in the code and will throw an error when a parameter value is defined that falls outside the valid range.
</div>
<div class="Indented">
Since material parameters can be defined as functions of time through a loadcurve, FEBio will check all parameters at the beginning of each time step. When a parameter has become invalid the run will be aborted.
</div>
<div class="Indented">
Some constitutive models are only valid for a limited amount of deformation. All materials in FEBio are designed for large deformation (in the sense that they are objective under arbitrary deformation), but that does not imply unlimited deformation. When the deformation becomes too large, the material response may become unphysical and although FEBio gives an answer, the result may be meaningless (see Section <a class="Reference" href="#sec:Understanding-the-Solution">8.6↓</a> for a discussion on interpreting the result). Some materials also become unstable at extremely large deformations. A classical example is the Mooney-Rivlin material. For a certain range of values of the material parameters, and under certain loading conditions, the stress-strain response can have a zero slope at large deformations. In that case, FEBio will most likely not be able to converge since the slope of the stress-strain response is used to progress towards the solution.
</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-8.1.3">8.1.3</a> Boundary Conditions<a class="Label" name="subsec:Trouble-Boundary-Conditions"> </a>
</h3>
<div class="Unindented">
Boundary conditions are necessary to uniquely define the solution of the problem under study. Improperly defined boundary conditions can lead to underconstrained or overconstrained problems.
</div>
<div class="Indented">
If the problem is underconstrained the solution is not uniquely defined and FEBio will not be able to find a solution. The most common example of an undercontrained problem is one where the rigid body modes are not constrained. A rigid body mode is a mode of deformation that does alter the stress in the body. Affine translation and rotation of the entire mesh are two ways to introduce a rigid body mode. In a (quasi-)static finite element analysis all rigid body modes must be properly constrained in order to find a unique solution. This can often very easily be achieved by constraining and edge or face of the model from moving at all.
</div>
<div class="Indented">
If the problem is over-constrained, FEBio will usually find an answer but it is probably not the solution that was sought. The most common cause of an over-constrained model is one that has conflicting boundary conditions. For example, a force is applied to a node that is fixed.
</div>
<h2 class="Section">
<a class="toc" name="toc-Section-8.2">8.2</a> Debugging a Model<a class="Label" name="sec:Debugging-a-Model"> </a>
</h2>
<div class="Unindented">
When a model is not running as expected, the first thing to try is rerun the problem using FEBio’s debug mode. Debug mode can be activated by adding a –g on the command line. For example,
</div>
<pre class="LyX-Code">
&gt;febio –i file.feb -g
</pre>
<div class="Unindented">
When in debug mode, FEBio will do additional checks during the solution (e.g. check for NAN’s, check for zeroes on the diagonal of the stiffness matrix, etc.) and will store all non-converged states to the plot file. Inspecting these non-converged states can often be useful to identify the cause of the problem. (E.g. when the model seems to disappear at some point might indicate a rigid body mode.)
</div>
<div class="Indented">
Since storing all non-converged states may make the plot-file too large for post-processing, debug mode can also be turned on during the analysis. To do this, start the problem normally (without the debug flag –g). Then, right before the problem starts to fail, interrupt the run (using ctrl+c) and wait for the FEBio prompt to appear. Once it appears, enter <i>debug </i>[ENTER], and then <i>cont </i>[ENTER] to continue the run in debug mode.
</div>
<h2 class="Section">
<a class="toc" name="toc-Section-8.3">8.3</a> Common Issues<a class="Label" name="sec:Common-Issues"> </a>
</h2>
<div class="Unindented">
In this section we take a look at some of the most common problems you may run into when solving a finite element problem with FEBio. We’ll discuss possible causes of and solutions to these issues.
</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-8.3.1">8.3.1</a> Inverted elements<a class="Label" name="subsec:Inverted-elements"> </a>
</h3>
<div class="Unindented">
When an element inverts, the element becomes so distorted that in certain areas of the element the Jacobian becomes zero or negative. In order to obtain a physically realistic solution, the Jacobian of the deformation must be positive at all points of the domain. Thus, when a negative Jacobian is found in an element, FEBio cannot continue. Fortunatly, FEBio’s automatic time-stepping algorithm can usually circumvent this problem by cutting the time step back and retrying the step using a smaller time step. In addition, FEBio will recalculate the global stiffness matrix. The combination of a reduced time step and a refactored stiffness matrix will often be sufficient to overcome the negative Jacobian. However, when it is not, you may have run into a more serious problem. These are some of the common causes that may require additional user intervention.
</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-8.3.1.1">8.3.1.1</a> Material instability<a class="Label" name="subsec:Material-instability"> </a>
</h4>
<div class="Unindented">
At large deformations, some materials can become unstable. This is usually caused by a softening of the material at large deformations. When the material softens too much the global stiffness matrix can become ill-conditioned and FEBio will not be able to find the correct solution. Unfortunately, there is no easy solution around this issue and you may need to consider using a different constitutive model.
</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-8.3.1.2">8.3.1.2</a> Time step too large<a class="Label" name="subsec:Time-step-too-large"> </a>
</h4>
<div class="Unindented">
Altough the auto-time stepper will automatically adjust the time step in case of trouble, it is designed to work within user defined limits and sometimes they are not set properly to solve the problem. The most common issue is that the minimum time step is set too large. Cutting back the minimum in addition to the initial time step can often help in preventing negative Jacobians.
</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-8.3.1.3">8.3.1.3</a> Elements too distorted<a class="Label" name="subsec:Elements-too-distorted"> </a>
</h4>
<div class="Unindented">
<a class="Label" name="para:elements"> </a> When elemens get too distorted they might not be able to deform any further without inverting the element. In this case, it may be necessary to adjust the mesh in the area where the elements are inverting.
</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-8.3.1.4">8.3.1.4</a> Shells are too thick<a class="Label" name="subsec:Shells-too-thick"> </a>
</h4>
<div class="Unindented">
A shell is an element where it is assumed that one dimension is much smaller compared to the other two directions. When the mesh is really fine, this assumption may no longer be valid and it could happen that the shell becomes too thick. When a shell gets too thick it can create negative Jacobians in the out-of-plane integration points, especially in areas of high curvature. To overcome this, you may need to remesh the affected area, adjust the shell thickness or even replace the shells with solid elements.
</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-8.3.1.5">8.3.1.5</a> Rigid body modes<a class="Label" name="subsec:Rigid-body-modes"> </a>
</h4>
<div class="Unindented">
A rigid body mode is a mode of deformation that does not alter the stress in the body. Uniform translation or rotation of the entire model are two possible rigid body modes. In the presence of a rigid body mode, the solution is not uniquely defined and FEBio will most likely throw negative Jacobians. The solution is to identify the rigid body mode and to eliminate it by applying additional constraints to the model.
</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-8.3.2">8.3.2</a> Failure to converge<a class="Label" name="subsec:Failure-to-converge"> </a>
</h3>
<div class="Unindented">
FEBio uses an iterative method to solve the nonlinear finite element equations. This means that for each time step the solution for that step is obtained by a succession of iterations, where each iteration brings the model (hopefully) closer to the solution for that step. An iterative method requires a convergence criterium to decide when to stop iterating and FEBio uses no less than three criteria. (In biphasic and multiphasic problems additional convergence criteria are used for the pressure and concentration degrees of freedom.) The convergence norm for each of these criteria is defined by the user in the control section of the input file.
</div>
<div class="Indented">
Sometimes it happens that FEBio cannot converge on a time step. We’ll take a look at some of the most common causes in the next following sections. Also take a look at possible causes of element inversions above. Sometimes, the issues that cause an element inversion may also manifest themselves in convergence problems before the element actually inverts.
</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-8.3.2.1">8.3.2.1</a> No loads applied<a class="Label" name="subsec:No-loads-applied"> </a>
</h4>
<div class="Unindented">
Ironically, when no loads are applied, FEBio will often struggle to find a solution. The reason (and solution!) is simple. Although no loads are applied, FEBio still performs many calculations and due to round-off errors, the result of these calculations may render the convergence norms not exactly zero. FEBio then tries to apply the convergence criteria to these really small norms and again due to round-off error will not be able to satisfy the convergence criteria.
</div>
<div class="Indented">
FEBio can actually detect this situation. It looks at the residual norm and when this is smaller than a user-defined limit it assumes that no loads are present and moves on to the next time step. However, this limit is actually problem dependent and it can happen that for your particular problem the limit is set too small. In that case, the solution is to increase the limit. This can be done by setting the <i>min_residual </i>parameter in the <i>Control </i>section of the input file. For example,
</div>
<pre class="LyX-Code">
&lt;min_residual&gt;1e-15&lt;/min_residual&gt;
</pre>
<div class="Unindented">
If the residual norm now drops below this value, FEBio will consider the time step converged and move on to the next time step.
</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-8.3.2.2">8.3.2.2</a> Convergence Tolerance Too Tight <a class="Label" name="subsec:Convergence-Tolerance-Too-Tight"> </a>
</h4>
<div class="Unindented">
In some cases, the default convergence tolerances are too tight and FEBio will not be able to converge. In that case, adjusting the affected convergence norms is a possible solution. This is done by editing the corresponding norms in the Control section of the input file. However, this should only be done when no other cause can be identified for the convergence problems.
</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-8.3.2.3">8.3.2.3</a> Forcing convergence<a class="Label" name="subsec:Forcing-convergence"> </a>
</h4>
<div class="Unindented">
It is possible to force a time step to converge. This can be done by interrupting the run (using ctrl+c) and then enter the <i>conv </i>command at the FEBio prompt. This will force the time step to converge and FEBio will continue with the next time step. This is not a recommended practice as the solution may become unstable and in fact it is unlikely that FEBio will be able to converge any of the following time steps. However, it can be useful in some scenarios. For example, if there is no load applied in the initial time step and FEBio has trouble getting past this initial step (see Section <a class="Reference" href="#subsec:No-loads-applied">8.3.2.1↑</a>) or when you want to store the current state to the plot file without having to rerun the problem in debug mode (although the <i>plot </i>command or <i>debug </i>command might be better alternatives).
</div>
<h4 class="Subsubsection">
<a class="toc" name="toc-Subsubsection-8.3.2.4">8.3.2.4</a> Problems due to Contact<a class="Label" name="subsec:Problems-due-Contact"> </a>
</h4>
<div class="Unindented">
When contact interfaces are defined, convergence problems can often be traced back to problems with the contact interfaces. See Section <a class="Reference" href="#sec:Guidelines-for-Contact">8.4↓</a> for more details on how to properly use contact interfaces in FEBio.
</div>
<h2 class="Section">
<a class="toc" name="toc-Section-8.4">8.4</a> Guidelines for Contact Problems<a class="Label" name="sec:Guidelines-for-Contact"> </a>
</h2>
<div class="Unindented">
FEBio offers many contact interfaces which allow the user to model complex boundary interactions. However, this capability comes at a price and the use of contact interfaces may create several problems in the solution process. It is hoped that the guidelines presented in this section may prevent many of the most common problems with contact.
</div>
<div class="Indented">
Most of the contact algorithms implemented in FEBio offer two contact enforcement methods: a penalty method and an augmented Lagrangian method. Since the strategies for these two methods are slightly different, we will look at them separately. These algorithms are discussed in much more detail in the <a href="http://help.mrl.sci.utah.edu/help/index.jsp">FEBio Theory Manual</a>.
</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-8.4.1">8.4.1</a> The penalty method<a class="Label" name="subsec:The-penalty-method"> </a>
</h3>
<div class="Unindented">
The penalty method enforces contact by &ldquo;penalizing&rdquo; (in an energy sense) any deviation from the contact constraint. In other words, when the two contacting surfaces penetrate, a force is generated proportional to the distance of penetration, which has the effect that the surfaces will now repell each other. The strength of this repelling force is controlled by the user through the <i>penalty factor</i>.
</div>
<div class="Indented">
The obvious downside of this method is that some penetration is necessary to generate the contact force. The larger the penalty factor, the smaller this penetration needs to be and thus the better the contact constraint is enforced. However, choosing the penalty factor too large may cause the problem to become unstable since the contact force (and corresponding stiffness) will dominate the other forces in the model. Choosing a good penalty factor can thus be often difficult and may require several attempts before getting it &ldquo;right&rdquo;. To help with choosing a penalty factor, FEBio offers the <i>auto_penalty </i>option for many of its contact interfaces which will estimate a good penalty factor based on element size and initial material stiffness. However, even then it may still take a few tries before getting the penalty factor good enough.
</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-8.4.2">8.4.2</a> Augmented Lagrangian Method<a class="Label" name="subsec:Augmented-Lagrangian-Method"> </a>
</h3>
<div class="Unindented">
In theory, in the presence of constraints, the corresponding Lagrange multipliers must be calculated which, in the case of contact, correspond to the contact forces that enforce the contact constraint exactly. Unfortunately, the exact evaluation of these Lagrange multiplies is numerically very challenging and therefore in FEBio it was decided to evaluate these Lagrange multipliers in an iterative method, named the <i>Augmented Lagrangian </i>method. Using this method, FEBio will solve a time step several times (these iterations are termed <i>augmentations</i>), where each time the approximate Lagrange mutlipliers are updated (or <i>augmented</i>).
</div>
<div class="Indented">
The obvious drawback of this method is that now each time step has to be solved several times. However, the advantage of avoiding the numerical problems of obtaining the exact Lagrange multipliers and the fact that in most contact problems very little extra work is needed to solve these augmentations, makes this method very attractive. In addition, it often gives better enforcement of the contact constraint compared to the penalty method.
</div>
<div class="Indented">
So why not just use the augmented Lagrangian method? Well, often the penalty method will give good results and since the penalty method is much faster, it is often the preferred choice of many analysists.
</div>
<div class="Indented">
In many cases, users are only interested in the final time step. For these users it may be of interest that it is possible to use the augmented Lagrange method only in the final time step. This can be done by defining a loadcurve for the <i>laugon </i>contact parameter. Then, define the corresponding loadcurve as zero everywhere except for the final time step. FEBio will now only use the augmented Lagrangian method in the final time step (and the penalty method all other steps).
</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-8.4.3">8.4.3</a> Initial Separation<a class="Label" name="subsec:Initial-Separation"> </a>
</h3>
<div class="Unindented">
FEBio often struggles with problems that have an initial separation. This is especially so when the problem is force-driven, meaning that the deformation of the model is driven by a force (opposed to displacement-driven problems). In general, when the contact interface is necessary to define a well-constrained problem it is best to avoid initial separation if possible. Another way around this issue is to first use a displacement to bring the surfaces in contact and then replace the displacement with a force.
</div>
<h2 class="Section">
<a class="toc" name="toc-Section-8.5">8.5</a> Guidelines for Multiphasic Analyses<a class="Label" name="sec:Guidelines-for-Multiphasic"> </a>
</h2>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-8.5.1">8.5.1</a> Initial State of Swelling<a class="Label" name="subsec:Initial-State-Swelling-1"> </a>
</h3>
<div class="Unindented">
Under traction-free conditions, a multiphasic material is usually in a state of swelling due to the osmotic pressure difference between the interstitial fluid and the external environment. This osmotic pressure arises from the difference in interstitial versus external concentrations of cations and anions, caused by the charged solid matrix and the requirement to satisfy electroneutrality. An osmotic pressure difference arising from such electrostatic interactions is known as the <i>Donnan osmotic pressure</i>. When the Donnan pressure is non-zero, traction-free conditions do not produce stress-free conditions for the solid matrix, since the matrix must expand until its stressed state resists the swelling pressure.
</div>
<div class="Indented">
The Donnan pressure reduces to zero when the fixed charged density is zero, or when the external environment is infinitely hypertonic (having ion concentrations infinitely greater than the interstitial fixed charge density). Since these two conditions represent special cases, it is generally necessary to devise methods for achieving the desired initial state of swelling, in an analysis where loads or displacements need to be prescribed over and above this swollen state. Swelling occurs as a result of the influx of solvent into the porous solid matrix. This influx is a time-dependent process that could require extensive analysis time. Therefore, it is computationally efficacious to achieve the initial state of swelling by using a multi-step analysis (Chapter <a class="Reference" href="#chap:Multi-step-Analysis">6↑</a>) where the first step is a steady-state analysis (Section <a class="Reference" href="#subsec:Common-Parameters">3.5.1↑</a>). In this steady-state step, the fixed charge density may be ramped up from zero to the desired value using a load curve for that property or, alternatively, the external environmental conditions may be reduced from a very high hypertonic state down to the desired level. In the second step, prescribed displacement boundary conditions (when needed) may be specified to be of type <i>relative</i> (Section <a class="Reference" href="#subsec:Prescribed-Nodal-Degrees">3.11.1↑</a>), so that they become superposed over and above the initial swelling state.
</div>
<div class="Indented">
<i>Example:</i>
</div>
<pre class="LyX-Code">
&lt;Module type="multiphasic"/&gt;
&lt;!-- rest of file --&gt;
&lt;Step&gt;
  &lt;Control&gt;
    &lt;analysis type="steady-state"/&gt;
    ...
  &lt;/Control&gt;
&lt;/Step&gt;
&lt;Step&gt;
  &lt;Control&gt;
    ...
  &lt;/Control&gt;
  &lt;Boundary&gt;
    &lt;prescribe type="relative"&gt;
      &lt;node id="22" bc="z" lc="4"&gt;1&lt;/node&gt;
      ...
    &lt;/prescribe&gt;
  &lt;/Boundary&gt;
&lt;/Step&gt;
</pre>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-8.5.2">8.5.2</a> Prescribed Boundary Conditions<a class="Label" name="subsec:Prescribed-Boundary-Conditions-1"> </a>
</h3>
<div class="Unindented">
In most analyses, it may be assumed that the ambient fluid pressure and electric potential in the external environment are zero, thus <span class="MathJax_Preview"><script type="math/tex">
p_{\ast}=0
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
\psi_{\ast}=0
</script>
</span>, where the subscripted asterisk is used to denote environmental conditions. Since the external environment does not include a solid matrix, the fixed charge density there is zero. For example, for a triphasic analysis, <span class="MathJax_Preview"><script type="math/tex">
c_{\ast}^{+}=c_{\ast}^{-}\equiv c_{\ast}
</script>
</span>. It follows that the effective fluid pressure in the external environment is <span class="MathJax_Preview"><script type="math/tex">
\tilde{p}_{\ast}=-R\theta\Phi_{\ast}\sum\nolimits _{\alpha}c_{\ast}^{\alpha}
</script>
</span> and the effective concentrations are <span class="MathJax_Preview"><script type="math/tex">
\tilde{c}_{\ast}^{\alpha}=c_{\ast}^{\alpha}/\hat{\kappa}_{\ast}^{\alpha}\tilde{c}_{\ast}^{\alpha}
</script>
</span>. Therefore, in multiphasic analyses, whenever the external environment contains solutes with concentrations <span class="MathJax_Preview"><script type="math/tex">
c_{\ast}^{\alpha}
</script>
</span>, the user must remember to prescribe non-zero boundary conditions for the effective solute concentrations <i>and</i> the effective fluid pressure.
</div>
<div class="Indented">
Letting <span class="MathJax_Preview"><script type="math/tex">
p_{\ast}=0
</script>
</span> also implies that prescribed mixture normal tractions (Section <a class="Reference" href="#subsec:Mixture-Normal-Traction">3.12.2.3↑</a>) represent only the traction above ambient conditions. Note that users are not obligated to assume that <span class="MathJax_Preview"><script type="math/tex">
p_{\ast}=0
</script>
</span>. However, if a non-zero value is assumed for the ambient pressure, then users must remember to incorporate this non-zero value whenever prescribing mixture normal tractions. Similarly, users are not required to assume that <span class="MathJax_Preview"><script type="math/tex">
\psi_{\ast}=0
</script>
</span>; when a non-zero value is assumed for the electric potential of the external environment, the prescribed boundary conditions for the effective concentrations should be evaluated using the corresponding partition coefficient, <span class="MathJax_Preview"><script type="math/tex">
\tilde{c}_{\ast}^{\alpha}=c_{\ast}^{\alpha}/\tilde{\kappa}_{\ast}^{\alpha}
</script>
</span>.
</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-8.5.3">8.5.3</a> Prescribed Initial Conditions<a class="Label" name="subsec:Prescribed-Initial-Conditions-1"> </a>
</h3>
<div class="Unindented">
When a multiphasic material is initially exposed to a given external environment with effective pressure <span class="MathJax_Preview"><script type="math/tex">
\tilde{p}_{\ast}
</script>
</span> and effective concentrations <span class="MathJax_Preview"><script type="math/tex">
\tilde{c}_{\ast}^{\alpha}
</script>
</span>, the initial conditions inside the material should be set to <span class="MathJax_Preview"><script type="math/tex">
\tilde{p}=\tilde{p}_{\ast}
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
\tilde{c}^{\alpha}=\tilde{c}_{\ast}^{\alpha}
</script>
</span> in order to expedite the evaluation of the initial state of swelling. The values of <span class="MathJax_Preview"><script type="math/tex">
\tilde{p}_{\ast}
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
\tilde{c}_{\ast}^{\alpha}
</script>
</span> should be evaluated as described in Section <a class="Reference" href="#subsec:Prescribed-Boundary-Conditions-1">8.5.2↑</a>.
</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-8.5.4">8.5.4</a> Prescribed Effective Solute Flux<a class="Label" name="subsec:Prescribed-Effective-Solute-Flux-1"> </a>
</h3>
<div class="Unindented">
The finite element formulation for multiphasic materials in FEBio requires that the natural boundary condition for solute <span class="MathJax_Preview"><script type="math/tex">
\alpha
</script>
</span> be prescribed as <span class="MathJax_Preview"><script type="math/tex">
\tilde{j}_{n}^{\alpha}\equiv j_{n}^{\alpha}+\sum\nolimits _{\beta}z^{\beta}j_{n}^{\beta}
</script>
</span>, where <span class="MathJax_Preview"><script type="math/tex">
\tilde{j}_{n}^{\alpha}
</script>
</span> is the effective solute flux. For a mixture containing only neutral solutes (<span class="MathJax_Preview"><script type="math/tex">
z^{\beta}=0,\,\forall\beta
</script>
</span> ), it follows that <span class="MathJax_Preview"><script type="math/tex">
\tilde{j}_{n}^{\alpha}=j_{n}^{\alpha}
</script>
</span>.
</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-8.5.5">8.5.5</a> Prescribed Electric Current Density<a class="Label" name="subsec:Prescribed-Electric-Current-1"> </a>
</h3>
<div class="Unindented">
The electric current density in a mixture is a linear superposition of the ion fluxes, <span class="MathJax_Preview">
<script type="math/tex;mode=display">

\mathbf{I}_{e}=F_{c}\sum\limits _{\alpha}z^{\alpha}\mathbf{j}^{\alpha}\,.

</script>

</span>
Since only the normal component <span class="MathJax_Preview"><script type="math/tex">
j_{n}^{\alpha}=\mathbf{j}^{\alpha}\cdot\mathbf{n}
</script>
</span> of ion fluxes may be prescribed at a boundary, it follows that only the normal component <span class="MathJax_Preview"><script type="math/tex">
I_{n}=\mathbf{I}_{e}\cdot\mathbf{n}
</script>
</span> of the current density may be prescribed. To prescribe <span class="MathJax_Preview"><script type="math/tex">
I_{n}
</script>
</span>, it is necessary to know the nature of the ion species in the mixture, and how the current is being applied. For example, if the ions in the triphasic mixture consist of Na<span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{+}}
</script>
</span> and Cl<span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{-}}
</script>
</span>, and if the current is being applied using silver/silver chloride (Ag/AgCl) electrodes, a chemical reaction occurs at the anode where Ag combines with Cl<span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{-}}
</script>
</span> to produce AgCl, donating an electron to the electrode to transport the current. At the cathode, the reverse process takes place. Therefore, in this system, there is only flux of Cl<span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{-}}
</script>
</span> and no flux of Na<span class="MathJax_Preview"><script type="math/tex">
^{\mathrm{+}}
</script>
</span> (<span class="MathJax_Preview"><script type="math/tex">
j_{n}^{+}=0)
</script>
</span> at the electrode-mixture interface, so that the prescribed boundary condition should be <span class="MathJax_Preview"><script type="math/tex">
j_{n}^{-}=-I_{n}/F_{c}
</script>
</span>. Since <span class="MathJax_Preview"><script type="math/tex">
z^{+}=+1
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
z^{-}=-1
</script>
</span> in a triphasic mixture, the corresponding effective fluxes are given by <span class="MathJax_Preview"><script type="math/tex">
\tilde{j}_{n}^{+}=2j_{n}^{+}-j_{n}^{-}=I_{n}/F_{c}
</script>
</span> and <span class="MathJax_Preview"><script type="math/tex">
\tilde{j}_{n}^{-}=j_{n}^{+}=0
</script>
</span>.
</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-8.5.6">8.5.6</a> Electrical Grounding<a class="Label" name="subsec:Electrical-Grounding-1"> </a>
</h3>
<div class="Unindented">
If a multiphasic mixture containing ions is completely surrounded by ion-impermeant boundaries it is necessary to ground the mixture to prevent unconstrained fluctuations of the electric potential. Grounding is performed by prescribing the effective concentration of one or more ions, at a location inside the mixture or on one of its boundaries corresponding to the location of the grounding electrode. The choice of ion(s) to constrain may be guided by the type of grounding electrode and the reference electrolyte bath in which it is inserted.
</div>
<h2 class="Section">
<a class="toc" name="toc-Section-8.6">8.6</a> Understanding the Solution<a class="Label" name="sec:Understanding-the-Solution"> </a>
</h2>
<div class="Unindented">
Okay, FEBio found a solution. Great, but how do you know it is the right one? Well, it turns out this is in fact a harder question than it may seem. In any finite element model there are numerous assumptions and approximations and trying to discuss all of these is outside the scope of this section. Instead, we’ll look at some of the most typical problems that FEBio users have run into.
</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-8.6.1">8.6.1</a> Mesh convergence<a class="Label" name="subsec:Mesh-convergence"> </a>
</h3>
<div class="Unindented">
The solution calculated by FEBio only applies to the mesh for which it was solved. However, the &ldquo;exact&rdquo; solution must be independent of the mesh and therefore a mesh convergence study is almost always necessary to make sure the FEBio solution is close to this exact solution. In practice this means that a model must be run several times with an increasingly finer mesh to find out at which mesh density the FEBio solution no longer changes.
</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-8.6.2">8.6.2</a> Constraint enforcement<a class="Label" name="subsec:Constraint-enforcement"> </a>
</h3>
<div class="Unindented">
FEBio uses many iterative algorithms for enforcing constraints. For each of these contraints the user must verify that the solution indeed satisfies these constraints sufficiently. The two most common constraints used in FEBio are incompressibility and contact.
</div>
<div class="Indented">
For uncoupled materials, incompressibility (for hexahedral elements) is handled in FEBio using a three-field formulation in addition to the enforcement of the incompressibility constraint. This constraint is usually enforced using a penalty formulation (although an augmented Lagrangian method is also available). To inspect whether the incompressibility constraint is satisfied sufficiently the user can look at the volume ratio which has to be close to one. If it deviates from one too much the user needs to increase the &ldquo;bulk modulus&rdquo; of the material.
</div>
<div class="Indented">
For coupled materials, incompressibility is not treated explicitly and care must be taken when using coupled materials in a near-incompressible regime (e.g. setting the Poisson’s ratio too close to 0.5 for a neo-Hookean material). In that case, the solution will most likely &ldquo;lock&rdquo; which manifests itself in displacements that are too small. Inspection of the volume ratio may not be sufficient to identify locking. However, a mesh convergence study will often help in identifying this problem.
</div>
<div class="Indented">
When a contact constraint is not sufficiently enforced, the contacting surfaces will have penetrated. This problem is usually identified easily by looking at the deformed model in a post-processing software (e.g. PostView). Increasing the penalty factor and/or decreasing the augmented Lagrangian tolerance should solve this problem.
</div>
<h2 class="Section">
<a class="toc" name="toc-Section-8.7">8.7</a> Limitations of FEBio<a class="Label" name="sec:Limitations-of-FEBio"> </a>
</h2>
<div class="Unindented">
If you run into a problem that you can’t seem to solve, maybe you ran into a limitation of FEBio. This section discusses some important limitations of the software and how they may affect the outcome of your analysis.
</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-8.7.1">8.7.1</a> Geometrical instabilities<a class="Label" name="subsec:Geometrical-instabilities"> </a>
</h3>
<div class="Unindented">
A geometrical instability is a point in the solution at which several paths for continuing the solution are possible. Typical examples are buckling of a column or inflation of a balloon. FEBio’s Newton based solvers cannot handle buckling since usually at these points, the material’s elasticity tangent is not uniquely defined. Although in some cases FEBio will be able to pass a buckling point, in most cases, FEBio will not be able to converge to a solution.
</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-8.7.2">8.7.2</a> Material instabilities<a class="Label" name="subsec:Material-instabilities"> </a>
</h3>
<div class="Unindented">
A material instability is a point in the stress-strain response where the slope of the stress-strain curve effectively becomes zero. Since FEBio’s Newton based solvers use this slope to advance the solution, a zero slope would mean an infinite step and FEBio will not be able to continue.
</div>
<div class="Indented">
The slope (or more accurately the elasticity tangent tensor) does not have to be zero to cause problems. For materials that soften at large deformations, this slope may become so small that it renders the global stiffness matrix ill-conditioned. It is unlikely that FEBio will be able to continue and even if it finds a solution, it may not to useful.
</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-8.7.3">8.7.3</a> Remeshing<a class="Label" name="subsec:Remeshing"> </a>
</h3>
<div class="Unindented">
FEBio is designed to solve problems that can undergo large deformations. However, when the deformations become too large it can happen that the finite element mesh cannot be distorted any further without inverting elements. In that case, FEBio will not be able to continue the solution and will most likely terminate with a negative jacobian error message.
</div>
<div class="Indented">
One possible solution to this problem is to remesh the model at the point at which the deformation become too large, but currently FEBio does not have any remeshing capabilities. The only remedy at this point is to plan ahead and design your mesh in such a way that the elements will not invert in the range of deformation that you are interested in (e.g. place a butterfly mesh in sharp corners or make the mesh finer in areas of larger deformation).
</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-8.7.4">8.7.4</a> Force-driven Problems<a class="Label" name="subsec:Force-driven-Problems"> </a>
</h3>
<div class="Unindented">
When the primary method of deforming the model is a force, the problem is said to be force-driven. (Opposed to a displacement-driven model where the deformation is caused by displacement boundary conditions.) Force-driven forces are inherently unstable and FEBio has limited capabilities of handling such problems<span class="FootOuter"><span class="SupFootMarker"> [M] </span><span class="HoverFoot"><span class="SupFootMarker"> [M] </span> As of FEBio 2.0, some features are available that may help with this issue, but they are still experimental.</span></span>. The cause of this instability can easily be explained using a simple example. Imagine a box that is constrained in all directions except one. In the unconstrained direction, apply two equal but opposite forces on opposite faces. In order to prevent the box from flying away, the box must generate stresses which balance the applied forces exactly. Unfortunately, the numerical solution will only be approximate due to numerical round-off errors inherent in the calculation. Even the slightest deviation from balancing the forces exactly will create a net-force which in turn causes the model to fly off in the unconstrained direction (in which a rigid body mode now exists).
</div>
<div class="Indented">
Usually, these problems are circumvented by adjusting the boundary conditions so that rigid body modes cannot exist. In the previous example this can be done by only modeling half of the box and enforcing a symmetry boundary condition. However, in some cases this is not possible. This is often the case in force-driven contact problems, where the contact interface is necessary to define a well-constrained model. When there is an initial separation (or even when the surfaces have no initial overlap) the initial contact force is zero, which is equivalent to having no contact enforcement, and thus the model is under-constrained. Therefore, for force-driven contact problems it is important to have some initial contact before starting the analysis.
</div>
<h3 class="Subsection">
<a class="toc" name="toc-Subsection-8.7.5">8.7.5</a> Solutions obtained on Multi-processor Machines<a class="Label" name="subsec:Solutions-Multi-Processor"> </a>
</h3>
<div class="Unindented">
Although technically not a limitation of FEBio it is important that users are aware that in some cases you may get a different convergence history or sometimes even a slightly different answer when you run the same model twice on a multi-processor machine. This is caused by the fact that on multi-processor machines the same calculations can be executed in a different order and due to the accumulation of numerical round-off errors may result in slightly different answers. The type of problems that are mostly affected by this are problems that are close too being ill-conditioned. Also, problems that have many time steps or require many iterations for each time step may be affected by this.
</div>
<div class="Indented">
If you experience different answers for the same problem, try running the model on just one processor (if possible). See Section <a class="Reference" href="#sec:Using-Multiple-Processors">2.6↑</a> for more information on how to run FEBio on multi-processor machines.
</div>
<h2 class="Section">
<a class="toc" name="toc-Section-8.8">8.8</a> Where to Get More Help<a class="Label" name="sec:Where-More-Help"> </a>
</h2>
<div class="Unindented">
When you get here, you may be ready to pull all your hair out, but fret not, all is not lost. In fact, some people may have run into a similar issue and found a solution. The first place to find these people is on the FEBio user’s forum (<a href="http://mrl.sci.utah.edu">http://mrl.sci.utah.edu</a>). This forum contains hundreds of posts by FEBio users and is monitored by the FEBio developers who will always be more than happy to help you with your problems. In addition, this forum can be used to report bugs or to request a new feature. It is the ideal portal to find help with your problems so don’t hesitate to use it!
</div>
<h1 class="Chapter">
<a class="toc" name="toc-Chapter-9">9</a> Configuration File<a class="Label" name="chap:Configuration-File"> </a>
</h1>
<div class="Unindented">
As of version 1.2, FEBio requires a configuration file to run. The purpose of this file is to store platform-specific settings such as the default linear solver. See Section <a class="Reference" href="#sec:Configuration-file">2.5↑</a> for more information on how to use this file. This section details the format of this file.
</div>
<div class="Indented">
The configuration file uses an xml format. The root element must be <i>febio_config</i>. The required attribute <i>version </i>specifies the version number of the format. Currently this value must be set to &ldquo;1.0&rdquo;. The following elements are defined.
</div>
<div class="Indented">
<div class="center">
<div class="defskip"> </div><table>
<tr>
<td align="left" valign="top">
<b>Parameter</b>
</td>
<td align="left" valign="top">
<b>Description</b> 
</td>

</tr>
<tr>
<td align="left" valign="top">
linear_solver
</td>
<td align="left" valign="top">
Set the default linear solver for the platform (1) 
</td>

</tr>
<tr>
<td align="left" valign="top">
import
</td>
<td align="left" valign="top">
Load a plugin file (2) 
</td>

</tr>
<tr>
<td align="left" valign="top">
set
</td>
<td align="left" valign="top">
define an alias (3) 
</td>

</tr>

</table>
<div class="defskip"> </div>
</div>

</div>
<div class="Indented">
<i>Comments:</i>
</div>
<ol>
<li>
FEBio supports several linear solvers, such as Pardiso and Skyline. Not all solvers are available for all platforms. Only the Skyline solver is available for all platforms. As of version 1.2, the Pardiso solver is available on most platforms. (Support for the SuperLU solver was removed as of version 2.0.) 
</li>
<li>
As of FEBio 2.0 the user can create and use plugins designed for FEBio. These plugins extend the standard capabilities without the need to recompile the FEBio code. See Chapter <a class="Reference" href="#chap:FEBio-Plugins">10↓</a> for more information on using plugins in FEBio. 
</li>
<li>
As of FEBio 2.5 the configuration file supports aliases which can be used to define plugin paths. The <i>set </i>tag defines an alias. The name of the alias is specified via the <i>name </i>attribute. Aliases are accessed using the $(<i>name</i>) syntax. See below for an example. 
</li>

</ol>
<div class="Unindented">
An example configuration file.
</div>
<pre class="LyX-Code">
&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;
&lt;febio_config version="1.0"&gt;
  &lt;linear_solver type="pardiso"/&gt;
  &lt;set name="PluginsDir"&gt;C:\path\to\plugins&lt;/set&gt;
  &lt;import&gt;$(PluginsDir)\myplugin.dll&lt;/import&gt;
&lt;/febio_config&gt;
</pre>
<h1 class="Chapter">
<a class="toc" name="toc-Chapter-10">10</a> FEBio Plugins<a class="Label" name="chap:FEBio-Plugins"> </a>
</h1>
<div class="Unindented">
As of version 2.0 FEBio supports plugins. Plugins are dynamic libraries which extend the capabilities of FEBio at runtime without the need to recompile the entire source code. This offers the user a powerful mechanism for extending the default feature set of FEBio with little effort. In addition, the development of the plugin is independent of the FEBio source code, which implies that upgrading to a newer version of FEBio will not require a recompilation of the plugin<span class="FootOuter"><span class="SupFootMarker"> [N] </span><span class="HoverFoot"><span class="SupFootMarker"> [N] </span> When upgrading to a newer version of FEBio, it may be necessary to recompile the plugin if the plugin interface was changed. As long as the plugin remains compatible with the new interface, no code changes are required.</span></span>. The <a href="http://febiodoc.sci.utah.edu/doxygen/">FEBio Developer’s 
Manual</a> explains in detail how to create these plugins. In this section we outline how to use the plugins with FEBio. Using plugins, users can create custom materials, boundary conditions, loads, output variables, etc. Users can also define custom &ldquo;tasks&rdquo; with plugins. A task is simply a wrapper around FEBio. (FEBio actually defines several tasks by default. The standard task simply loads the input file, runs the model and creates the output files. Other tasks perform diagnostics). Algorithms that require repeated evaluations of FE models (e.g. parameter optimization) can easily be implemented as a plugin that defines such a custom task.
</div>
<div class="Paragraph">
<a class="toc" name="toc-Paragraph-2"></a><b>Using Plugins</b>
</div>
<div class="Unindented">
A plugin is compiled into a dynamic library (dll or dylib) or shared object (so) and containes the compiled code of the library. In order to use this plugin, you must add the path to and name of the plugin file in the FEBio configuration file (see Chapter <a class="Reference" href="#chap:Configuration-File">9↑</a> for a discussion of the configuration file). For each plugin, an <i>import </i>item has to be added in this configuration file. For example,
</div>
<pre class="LyX-Code">
&lt;import&gt;myplugin.dll&lt;/import&gt;
</pre>
<div class="Unindented">
You may need to add the full path to the plugin if FEBio has problems locating the plugin.
</div>
<pre class="LyX-Code">
&lt;import&gt;C:\path\to\my\plugins\myplugin.dll&lt;/import&gt;
</pre>
<div class="Unindented">
When FEBio starts, it will first load all the plugins that are defined in the configuration file before it reads the input file. This way, sections in the input file that require the plugin’s capabilities will already be available for use. If FEBio cannot find a plugin it will terminate with an error message.
</div>
<div class="Indented">
<a class="toc" name="Bibliography"></a><h1 class="biblio">
Bibliography
</h1>
<p class="biblio">
<span class="entry">[<a class="biblioentry" name="biblio-1"><span class="bib-index">1</span></a>] </span> <span class="bib-authors">Michael B Albro, Vikram Rajan, Roland Li, Clark T Hung, Gerard A Ateshian</span>. <span class="bib-title">Characterization of the Concentration-Dependence of Solute Diffusivity and Partitioning in a Model Dextran-Agarose Transport System</span>. <i><span class="bib-journal">Cell Mol Bioeng</span></i>, <span class="bib-volume">2</span>(<span class="bib-number">3</span>):<span class="bib-pages">295-305</span>, <span class="bib-year">2009</span>.
</p>
<p class="biblio">
<span class="entry">[<a class="biblioentry" name="biblio-2"><span class="bib-index">2</span></a>] </span> <span class="bib-authors">E.M. Arruda, M.C. Boyce</span>. <span class="bib-title">A Three-Dimensional Constitutive Model for the Large Stretch Behavior of Rubber Elastic Materials</span>. <i><span class="bib-journal">J. Mech. Phys. Solids</span></i>, <span class="bib-volume">41</span>(<span class="bib-number">2</span>):<span class="bib-pages">389-412</span>, <span class="bib-year">1993</span>.
</p>
<p class="biblio">
<span class="entry">[<a class="biblioentry" name="biblio-3"><span class="bib-index">3</span></a>] </span> <span class="bib-authors">G. A. Ateshian, K. D. Costa</span>. <span class="bib-title">A frame-invariant formulation of Fung elasticity</span>. <i><span class="bib-journal">J Biomech</span></i>, <span class="bib-volume">42</span>(<span class="bib-number">6</span>):<span class="bib-pages">781-5</span>, <span class="bib-year">2009</span>. URL <a href="http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?cmd=Retrieve&db=PubMed&dopt=Citation&list_uids=19281991"><span class="bib-url">http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?cmd=Retrieve&db=PubMed&dopt=Citation&list_uids=19281991</span></a>.
</p>
<p class="biblio">
<span class="entry">[<a class="biblioentry" name="biblio-4"><span class="bib-index">4</span></a>] </span> <span class="bib-authors">G. A. Ateshian, V. Rajan, N. O. Chahine, C. E. Canal, C. T. Hung</span>. <span class="bib-title">Modeling the matrix of articular cartilage using a continuous fiber angular distribution predicts many observed phenomena</span>. <i><span class="bib-journal">J Biomech Eng</span></i>, <span class="bib-volume">131</span>(<span class="bib-number">6</span>):<span class="bib-pages">061003</span>, <span class="bib-year">2009</span>. URL <a href="http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?cmd=Retrieve&db=PubMed&dopt=Citation&list_uids=19449957"><span class="bib-url">http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?cmd=Retrieve&db=PubMed&dopt=Citation&list_uids=19449957</span></a>.
</p>
<p class="biblio">
<span class="entry">[<a class="biblioentry" name="biblio-5"><span class="bib-index">5</span></a>] </span> <span class="bib-authors">G. A. Ateshian, T. Ricken</span>. <span class="bib-title">Multigenerational interstitial growth of biological tissues</span>. <i><span class="bib-journal">Biomech Model Mechanobiol</span></i>, <span class="bib-volume">9</span>(<span class="bib-number">6</span>):<span class="bib-pages">689-702</span>, <span class="bib-year">2010</span>. URL <a href="http://www.ncbi.nlm.nih.gov/pubmed/20238138"><span class="bib-url">http://www.ncbi.nlm.nih.gov/pubmed/20238138</span></a>.
</p>
<p class="biblio">
<span class="entry">[<a class="biblioentry" name="biblio-6"><span class="bib-index">6</span></a>] </span> <span class="bib-authors">G. A. Ateshian, W. H. Warden, J. J. Kim, R. P. Grelsamer, V. C. Mow</span>. <span class="bib-title">Finite deformation biphasic material properties of bovine articular cartilage from confined compression experiments</span>. <i><span class="bib-journal">J Biomech</span></i>, <span class="bib-volume">30</span>(<span class="bib-number">11-12</span>):<span class="bib-pages">1157-64</span>, <span class="bib-year">1997</span>. URL <a href="http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?cmd=Retrieve&db=PubMed&dopt=Citation&list_uids=9456384"><span class="bib-url">http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?cmd=Retrieve&db=PubMed&dopt=Citation&list_uids=9456384</span></a>.
</p>
<p class="biblio">
<span class="entry">[<a class="biblioentry" name="biblio-7"><span class="bib-index">7</span></a>] </span> <span class="bib-authors">G. A. Ateshian</span>. <span class="bib-title">Anisotropy of fibrous tissues in relation to the distribution of tensed and buckled fibers</span>. <i><span class="bib-journal">J Biomech Eng</span></i>, <span class="bib-volume">129</span>(<span class="bib-number">2</span>):<span class="bib-pages">240-9</span>, <span class="bib-year">2007</span>. URL <a href="http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?cmd=Retrieve&db=PubMed&dopt=Citation&list_uids=17408329"><span class="bib-url">http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?cmd=Retrieve&db=PubMed&dopt=Citation&list_uids=17408329</span></a>.
</p>
<p class="biblio">
<span class="entry">[<a class="biblioentry" name="biblio-8"><span class="bib-index">8</span></a>] </span> <span class="bib-authors">GA Ateshian, SA Maas, J.A. Weiss</span>. <span class="bib-title">Finite element algorithm for frictionless contact of porous permeable media under finite deformation and sliding</span>. <i><span class="bib-journal">J. Biomech. Engn.</span></i>, <span class="bib-volume">132</span>(<span class="bib-number">6</span>):<span class="bib-pages">1006-1019</span>, <span class="bib-year">2010</span>.
</p>
<p class="biblio">
<span class="entry">[<a class="biblioentry" name="biblio-9"><span class="bib-index">9</span></a>] </span> <span class="bib-authors">Gerard A Ateshian, Benjamin J Ellis, Jeffrey A Weiss</span>. <span class="bib-title">Equivalence between short-time biphasic and incompressible elastic material responses</span>. <i><span class="bib-journal">J Biomech Eng</span></i>, <span class="bib-volume">129</span>(<span class="bib-number">3</span>):<span class="bib-pages">405-12</span>, <span class="bib-year">2007</span>.
</p>
<p class="biblio">
<span class="entry">[<a class="biblioentry" name="biblio-10"><span class="bib-index">10</span></a>] </span> <span class="bib-authors">Gerard A Ateshian</span>. <span class="bib-title">Viscoelasticity using reactive constrained solid mixtures</span>. <i><span class="bib-journal">J Biomech</span></i>, <span class="bib-volume">48</span>(<span class="bib-number">6</span>):<span class="bib-pages">941-7</span>, <span class="bib-year">2015</span>.
</p>
<p class="biblio">
<span class="entry">[<a class="biblioentry" name="biblio-11"><span class="bib-index">11</span></a>] </span> <span class="bib-authors">SS Blemker</span>. <span class="bib-title">3D Modeling of Complex Muscle Architecture and Geometry</span>. <span class="bib-year">2004</span>.
</p>
<p class="biblio">
<span class="entry">[<a class="biblioentry" name="biblio-12"><span class="bib-index">12</span></a>] </span> <span class="bib-authors">Javier Bonet, Richard D. Wood</span>. <i><span class="bib-title">Nonlinear continuum mechanics for finite element analysis</span></i>. <span class="bib-publisher">Cambridge University Press</span>, <span class="bib-year">1997</span>.
</p>
<p class="biblio">
<span class="entry">[<a class="biblioentry" name="biblio-13"><span class="bib-index">13</span></a>] </span> <span class="bib-authors">D R Carter, W C Hayes</span>. <span class="bib-title">Bone compressive strength: the influence of density and strain rate</span>. <i><span class="bib-journal">Science</span></i>, <span class="bib-volume">194</span>(<span class="bib-number">4270</span>):<span class="bib-pages">1174-6</span>, <span class="bib-year">1976</span>.
</p>
<p class="biblio">
<span class="entry">[<a class="biblioentry" name="biblio-14"><span class="bib-index">14</span></a>] </span> <span class="bib-authors">D R Carter, W C Hayes</span>. <span class="bib-title">The compressive behavior of bone as a two-phase porous structure</span>. <i><span class="bib-journal">J Bone Joint Surg Am</span></i>, <span class="bib-volume">59</span>(<span class="bib-number">7</span>):<span class="bib-pages">954-62</span>, <span class="bib-year">1977</span>.
</p>
<p class="biblio">
<span class="entry">[<a class="biblioentry" name="biblio-15"><span class="bib-index">15</span></a>] </span> <span class="bib-authors">JC Criscione, SA Douglas, WC Hunter</span>. <span class="bib-title">Physically based strain invariant set for materials exhibiting transversely isotropic behavior</span>. <i><span class="bib-journal">J. Mech. Phys. Solids</span></i>, <span class="bib-volume">49</span>:<span class="bib-pages">871-897</span>, <span class="bib-year">2001</span>.
</p>
<p class="biblio">
<span class="entry">[<a class="biblioentry" name="biblio-16"><span class="bib-index">16</span></a>] </span> <span class="bib-authors">A. Curnier, He Qi-Chang, P. Zysset</span>. <span class="bib-title">Conewise linear elastic materials</span>. <i><span class="bib-journal">J Elasticity</span></i>, <span class="bib-volume">37</span>(<span class="bib-number">1</span>):<span class="bib-pages">1-38</span>, <span class="bib-year">1994</span>.
</p>
<p class="biblio">
<span class="entry">[<a class="biblioentry" name="biblio-17"><span class="bib-index">17</span></a>] </span> <span class="bib-authors">Y. C. Fung, K. Fronek, P. Patitucci</span>. <span class="bib-title">Pseudoelasticity of arteries and the choice of its mathematical expression</span>. <i><span class="bib-journal">Am J Physiol</span></i>, <span class="bib-volume">237</span>(<span class="bib-number">5</span>):<span class="bib-pages">H620-31</span>, <span class="bib-year">1979</span>. URL <a href="http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?cmd=Retrieve&db=PubMed&dopt=Citation&list_uids=495769"><span class="bib-url">http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?cmd=Retrieve&db=PubMed&dopt=Citation&list_uids=495769</span></a>.
</p>
<p class="biblio">
<span class="entry">[<a class="biblioentry" name="biblio-18"><span class="bib-index">18</span></a>] </span> <span class="bib-authors">Y. C. Fung</span>. <i><span class="bib-title">Biomechanics : mechanical properties of living tissues</span></i>. <span class="bib-publisher">Springer-Verlag</span>, <span class="bib-year">1993</span>. URL <a href="http://www.loc.gov/catdir/enhancements/fy0814/92033749-t.html http://www.loc.gov/catdir/enhancements/fy0814/92033749-d.html"><span class="bib-url">http://www.loc.gov/catdir/enhancements/fy0814/92033749-t.html http://www.loc.gov/catdir/enhancements/fy0814/92033749-d.html</span></a>.
</p>
<p class="biblio">
<span class="entry">[<a class="biblioentry" name="biblio-19"><span class="bib-index">19</span></a>] </span> <span class="bib-authors">M.W. Gee, C.R. Dohrmann, S.W. Key, W.A. Wall</span>. <span class="bib-title">A uniform nodal strain tetrahedron with isochoric stabilization</span>. <i><span class="bib-journal">Int. J. Numer. Meth. Engng</span></i>, (<span class="bib-number">78</span>):<span class="bib-pages">429-443</span>, <span class="bib-year">2009</span>.
</p>
<p class="biblio">
<span class="entry">[<a class="biblioentry" name="biblio-20"><span class="bib-index">20</span></a>] </span> <span class="bib-authors">M.J.A. Girard, J.C. Downs, C. F. Burgoyne</span>. <span class="bib-title">Peripapillary and posterior scleral mechanics - Part I: Development of an anisotropic hyperelastic constitutive model</span>. <i><span class="bib-journal">J Biomech Eng</span></i>, <span class="bib-volume">131</span>(<span class="bib-number">5</span>):<span class="bib-pages">051011</span>, <span class="bib-year">2009</span>.
</p>
<p class="biblio">
<span class="entry">[<a class="biblioentry" name="biblio-21"><span class="bib-index">21</span></a>] </span> <span class="bib-authors">C.L.M. Gouget, M.J.A. Girard, C.R. Ethier</span>. <span class="bib-title">A constrained von Mises distribution to describe fiber organization in thin soft tissues</span>. <i><span class="bib-journal">Biomechanics And Modeling in Mechanobiolgy</span></i>, <span class="bib-volume">11</span>(<span class="bib-number">3-4</span>):<span class="bib-pages">475-482</span>, <span class="bib-year">2012</span>.
</p>
<p class="biblio">
<span class="entry">[<a class="biblioentry" name="biblio-22"><span class="bib-index">22</span></a>] </span> <span class="bib-authors">M. H. Holmes, V. C. Mow</span>. <span class="bib-title">The nonlinear characteristics of soft gels and hydrated connective tissues in ultrafiltration</span>. <i><span class="bib-journal">J Biomech</span></i>, <span class="bib-volume">23</span>(<span class="bib-number">11</span>):<span class="bib-pages">1145-56</span>, <span class="bib-year">1990</span>. URL <a href="http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?cmd=Retrieve&db=PubMed&dopt=Citation&list_uids=2277049"><span class="bib-url">http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?cmd=Retrieve&db=PubMed&dopt=Citation&list_uids=2277049</span></a>.
</p>
<p class="biblio">
<span class="entry">[<a class="biblioentry" name="biblio-23"><span class="bib-index">23</span></a>] </span> <span class="bib-authors">J. C. Iatridis, L. A. Setton, R. J. Foster, B. A. Rawlins, M. Weidenbaum, V. C. Mow</span>. <span class="bib-title">Degeneration affects the anisotropic and nonlinear behaviors of human anulus fibrosus in compression</span>. <i><span class="bib-journal">J Biomech</span></i>, <span class="bib-volume">31</span>(<span class="bib-number">6</span>):<span class="bib-pages">535-44</span>, <span class="bib-year">1998</span>. URL <a href="http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?cmd=Retrieve&db=PubMed&dopt=Citation&list_uids=9755038"><span class="bib-url">http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?cmd=Retrieve&db=PubMed&dopt=Citation&list_uids=9755038</span></a>.
</p>
<p class="biblio">
<span class="entry">[<a class="biblioentry" name="biblio-24"><span class="bib-index">24</span></a>] </span> <span class="bib-authors">W M Lai, J S Hou, V C Mow</span>. <span class="bib-title">A triphasic theory for the swelling and deformation behaviors of articular cartilage</span>. <i><span class="bib-journal">J Biomech Eng</span></i>, <span class="bib-volume">113</span>(<span class="bib-number">3</span>):<span class="bib-pages">245-58</span>, <span class="bib-year">1991</span>.
</p>
<p class="biblio">
<span class="entry">[<a class="biblioentry" name="biblio-25"><span class="bib-index">25</span></a>] </span> <span class="bib-authors">Y. Lanir</span>. <span class="bib-title">Constitutive equations for fibrous connective tissues</span>. <i><span class="bib-journal">J Biomech</span></i>, <span class="bib-volume">16</span>(<span class="bib-number">1</span>):<span class="bib-pages">1-12</span>, <span class="bib-year">1983</span>. URL <a href="http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?cmd=Retrieve&db=PubMed&dopt=Citation&list_uids=6833305"><span class="bib-url">http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?cmd=Retrieve&db=PubMed&dopt=Citation&list_uids=6833305</span></a>.
</p>
<p class="biblio">
<span class="entry">[<a class="biblioentry" name="biblio-26"><span class="bib-index">26</span></a>] </span> <span class="bib-authors">T. A. Laursen, B. N. Maker</span>. <span class="bib-title">Augmented Lagrangian quasi-newton solver for constrained nonlinear finite element applications</span>. <i><span class="bib-journal">International Journal for Numerical Methods in Engineering</span></i>, <span class="bib-volume">38</span>(<span class="bib-number">21</span>):<span class="bib-pages">3571-3590</span>, <span class="bib-year">1995</span>.
</p>
<p class="biblio">
<span class="entry">[<a class="biblioentry" name="biblio-27"><span class="bib-index">27</span></a>] </span> <span class="bib-authors">B. N. Maker</span>. <span class="bib-title">Rigid bodies for metal forming analysis with NIKE3D</span>. <i><span class="bib-journal">University of California, Lawrence Livermore Lab Rept</span></i>, <span class="bib-volume">UCRL-JC-119862</span>:<span class="bib-pages">1-8</span>, <span class="bib-year">1995</span>.
</p>
<p class="biblio">
<span class="entry">[<a class="biblioentry" name="biblio-28"><span class="bib-index">28</span></a>] </span> <span class="bib-authors">V.C. Mow, S.C. Kuei, W.M. Lai, C.G. Armstrong</span>. <span class="bib-title">Biphasic creep and stress relaxation of articular cartilage in compression: Theory and experiments</span>. <i><span class="bib-journal">J. Biomech. Eng.</span></i>, <span class="bib-volume">102</span>:<span class="bib-pages">73-84</span>, <span class="bib-year">1980</span>.
</p>
<p class="biblio">
<span class="entry">[<a class="biblioentry" name="biblio-29"><span class="bib-index">29</span></a>] </span> <span class="bib-authors">J T Overbeek</span>. <span class="bib-title">The Donnan equilibrium</span>. <i><span class="bib-journal">Prog Biophys Biophys Chem</span></i>, <span class="bib-volume">6</span>:<span class="bib-pages">57-84</span>, <span class="bib-year">1956</span>.
</p>
<p class="biblio">
<span class="entry">[<a class="biblioentry" name="biblio-30"><span class="bib-index">30</span></a>] </span> <span class="bib-authors">M. A. Puso, J. A. Weiss</span>. <span class="bib-title">Finite element implementation of anisotropic quasi-linear viscoelasticity using a discrete spectrum approximation</span>. <i><span class="bib-journal">J Biomech Eng</span></i>, <span class="bib-volume">120</span>(<span class="bib-number">1</span>):<span class="bib-pages">62-70</span>, <span class="bib-year">1998</span>. URL <a href="http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?cmd=Retrieve&db=PubMed&dopt=Citation&list_uids=9675682"><span class="bib-url">http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?cmd=Retrieve&db=PubMed&dopt=Citation&list_uids=9675682</span></a>.
</p>
<p class="biblio">
<span class="entry">[<a class="biblioentry" name="biblio-31"><span class="bib-index">31</span></a>] </span> <span class="bib-authors">K. M. Quapp, J. A. Weiss</span>. <span class="bib-title">Material characterization of human medial collateral ligament</span>. <i><span class="bib-journal">J Biomech Eng</span></i>, <span class="bib-volume">120</span>(<span class="bib-number">6</span>):<span class="bib-pages">757-63</span>, <span class="bib-year">1998</span>. URL <a href="http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?cmd=Retrieve&db=PubMed&dopt=Citation&list_uids=10412460"><span class="bib-url">http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?cmd=Retrieve&db=PubMed&dopt=Citation&list_uids=10412460</span></a>.
</p>
<p class="biblio">
<span class="entry">[<a class="biblioentry" name="biblio-32"><span class="bib-index">32</span></a>] </span> <span class="bib-authors">J.C. Simo, R.L. Taylor</span>. <span class="bib-title">Quasi-incompressible finite elasticity in principal stretches: Continuum basis and numerical algorithms</span>. <i><span class="bib-journal">Computer Methods in Applied Mechanics and Engineering</span></i>, <span class="bib-volume">85</span>:<span class="bib-pages">273-310</span>, <span class="bib-year">1991</span>.
</p>
<p class="biblio">
<span class="entry">[<a class="biblioentry" name="biblio-33"><span class="bib-index">33</span></a>] </span> <span class="bib-authors">JC Simo</span>. <span class="bib-title">On a fully three-dimensional finite-strain viscoelastic damage model: formulation and computational aspects</span>. <i><span class="bib-journal">Computer methods in applied mechanics and engineering</span></i>, <span class="bib-volume">60</span>(<span class="bib-number">2</span>):<span class="bib-pages">153—173</span>, <span class="bib-year">1987</span>.
</p>
<p class="biblio">
<span class="entry">[<a class="biblioentry" name="biblio-34"><span class="bib-index">34</span></a>] </span> <span class="bib-authors">Anthony James Merril Spencer</span>. <i><span class="bib-title">Continuum Theory of the Mechanics of Fibre-Reinforced Composites</span></i>. <span class="bib-publisher">Springer-Verlag</span>, <span class="bib-year">1984</span>.
</p>
<p class="biblio">
<span class="entry">[<a class="biblioentry" name="biblio-35"><span class="bib-index">35</span></a>] </span> <span class="bib-authors">D.R. Veronda, R.A. Westmann</span>. <span class="bib-title">Mechanical Characterization of Skin - Finite Deformations</span>. <i><span class="bib-journal">J. Biomechanics</span></i>, <span class="bib-volume">Vol. 3</span>:<span class="bib-pages">111-124</span>, <span class="bib-year">1970</span>.
</p>
<p class="biblio">
<span class="entry">[<a class="biblioentry" name="biblio-36"><span class="bib-index">36</span></a>] </span> <span class="bib-authors">H Weinans, R Huiskes, H J Grootenboer</span>. <span class="bib-title">The behavior of adaptive bone-remodeling simulation models</span>. <i><span class="bib-journal">J Biomech</span></i>, <span class="bib-volume">25</span>(<span class="bib-number">12</span>):<span class="bib-pages">1425-41</span>, <span class="bib-year">1992</span>.
</p>
<p class="biblio">
<span class="entry">[<a class="biblioentry" name="biblio-37"><span class="bib-index">37</span></a>] </span> <span class="bib-authors">J.A. Weiss, B.N. Maker, S. Govindjee</span>. <span class="bib-title">Finite element implementation of incompressible, transversely isotropic hyperelasticity</span>. <i><span class="bib-journal">Computer Methods in Applications of Mechanics and Engineering</span></i>, <span class="bib-volume">135</span>:<span class="bib-pages">107-128</span>, <span class="bib-year">1996</span>.
</p>

</div>

</div>
</body>
</html>
