#pragma once

#include "mat3d.h"
#include "tens3d.h"

//-----------------------------------------------------------------------------
//! Class for 6th order tensor based on symmetry requirements for second-order hyperelasticity:
//  - E = d2Phi/dGijkdGlmn  
//  - RC symmetry in the first three legs (Eijklmn = Eikjlmn) 
//  - RC symmetry in the last three legs (Eijklmn = Eijklnm)  
//  - major-like symmetry when switching the order of the partial derivatives (Eijklmn = Elmnijk)
//  - 324 out of 729 compenents are unique
//
// E111111	d[  0]	E112111	d[ 18]	E113111	d[ 36]	E122111	d[ 54]	E123111	d[ 72]	E133111	d[ 90]	E211111	d[108]	E212111	d[126]	E213111	d[144]	E222111	d[162]	E223111	d[180]	E233111	d[198]	E311111	d[216]	E312111	d[234]	E313111	d[252]	E322111	d[270]	E323111	d[288]	E333111	d[306]		
// E111112	d[  1]	E112112	d[ 19]	E113112	d[ 37]	E122112	d[ 55]	E123112	d[ 73]	E133112	d[ 91]	E211112	d[109]	E212112	d[127]	E213112	d[145]	E222112	d[163]	E223112	d[181]	E233112	d[199]	E311112	d[217]	E312112	d[235]	E313112	d[253]	E322112	d[271]	E323112	d[289]	E333112	d[307]
// E111113	d[  2]	E112113	d[ 20]	E113113	d[ 38]	E122113	d[ 56]	E123113	d[ 74]	E133113	d[ 92]	E211113	d[110]	E212113	d[128]	E213113	d[146]	E222113	d[164]	E223113	d[182]	E233113	d[200]	E311113	d[218]	E312113	d[236]	E313113	d[254]	E322113	d[272]	E323113	d[290]	E333113	d[308]
// E111122	d[  3]	E112122	d[ 21]	E113122	d[ 39]	E122122	d[ 57]	E123122	d[ 75]	E133122	d[ 93]	E211122	d[111]	E212122	d[129]	E213122	d[147]	E222122	d[165]	E223122	d[183]	E233122	d[201]	E311122	d[219]	E312122	d[237]	E313122	d[255]	E322122	d[273]	E323122	d[291]	E333122	d[309]
// E111123	d[  4]	E112123	d[ 22]	E113123	d[ 40]	E122123	d[ 58]	E123123	d[ 76]	E133123	d[ 94]	E211123	d[112]	E212123	d[130]	E213123	d[148]	E222123	d[166]	E223123	d[184]	E233123	d[202]	E311123	d[220]	E312123	d[238]	E313123	d[256]	E322123	d[274]	E323123	d[292]	E333123	d[310]
// E111133	d[  5]	E112133	d[ 23]	E113133	d[ 41]	E122133	d[ 59]	E123133	d[ 77]	E133133	d[ 95]	E211133	d[113]	E212133	d[131]	E213133	d[149]	E222133	d[167]	E223133	d[185]	E233133	d[203]	E311133	d[221]	E312133	d[239]	E313133	d[257]	E322133	d[275]	E323133	d[293]	E333133	d[311]
// E111211	d[  6]	E112211	d[ 24]	E113211	d[ 42]	E122211	d[ 60]	E123211	d[ 78]	E133211	d[ 96]	E211211	d[114]	E212211	d[132]	E213211	d[150]	E222211	d[168]	E223211	d[186]	E233211	d[204]	E311211	d[222]	E312211	d[240]	E313211	d[258]	E322211	d[276]	E323211	d[294]	E333211	d[312]
// E111212	d[  7]	E112212	d[ 25]	E113212	d[ 43]	E122212	d[ 61]	E123212	d[ 79]	E133212	d[ 97]	E211212	d[115]	E212212	d[133]	E213212	d[151]	E222212	d[169]	E223212	d[187]	E233212	d[205]	E311212	d[223]	E312212	d[241]	E313212	d[259]	E322212	d[277]	E323212	d[295]	E333212	d[313]
// E111213	d[  8]	E112213	d[ 26]	E113213	d[ 44]	E122213	d[ 62]	E123213	d[ 80]	E133213	d[ 98]	E211213	d[116]	E212213	d[134]	E213213	d[152]	E222213	d[170]	E223213	d[188]	E233213	d[206]	E311213	d[224]	E312213	d[242]	E313213	d[260]	E322213	d[278]	E323213	d[296]	E333213	d[314]
// E111222	d[  9]	E112222	d[ 27]	E113222	d[ 45]	E122222	d[ 63]	E123222	d[ 81]	E133222	d[ 99]	E211222	d[117]	E212222	d[135]	E213222	d[153]	E222222	d[171]	E223222	d[189]	E233222	d[207]	E311222	d[225]	E312222	d[243]	E313222	d[261]	E322222	d[279]	E323222	d[297]	E333222	d[315]
// E111223	d[ 10]	E112223	d[ 28]	E113223	d[ 46]	E122223	d[ 64]	E123223	d[ 82]	E133223	d[100]	E211223	d[118]	E212223	d[136]	E213223	d[154]	E222223	d[172]	E223223	d[190]	E233223	d[208]	E311223	d[226]	E312223	d[244]	E313223	d[262]	E322223	d[280]	E323223	d[298]	E333223	d[316]
// E111233	d[ 11]	E112233	d[ 29]	E113233	d[ 47]	E122233	d[ 65]	E123233	d[ 83]	E133233	d[101]	E211233	d[119]	E212233	d[137]	E213233	d[155]	E222233	d[173]	E223233	d[191]	E233233	d[209]	E311233	d[227]	E312233	d[245]	E313233	d[263]	E322233	d[281]	E323233	d[299]	E333233	d[317]
// E111311	d[ 12]	E112311	d[ 30]	E113311	d[ 48]	E122311	d[ 66]	E123311	d[ 84]	E133311	d[102]	E211311	d[120]	E212311	d[138]	E213311	d[156]	E222311	d[174]	E223311	d[192]	E233311	d[210]	E311311	d[228]	E312311	d[246]	E313311	d[264]	E322311	d[282]	E323311	d[300]	E333311	d[318]
// E111312	d[ 13]	E112312	d[ 31]	E113312	d[ 49]	E122312	d[ 67]	E123312	d[ 85]	E133312	d[103]	E211312	d[121]	E212312	d[139]	E213312	d[157]	E222312	d[175]	E223312	d[193]	E233312	d[211]	E311312	d[229]	E312312	d[247]	E313312	d[265]	E322312	d[283]	E323312	d[301]	E333312	d[319]
// E111313	d[ 14]	E112313	d[ 32]	E113313	d[ 50]	E122313	d[ 68]	E123313	d[ 86]	E133313	d[104]	E211313	d[122]	E212313	d[140]	E213313	d[158]	E222313	d[176]	E223313	d[194]	E233313	d[212]	E311313	d[230]	E312313	d[248]	E313313	d[266]	E322313	d[284]	E323313	d[302]	E333313	d[320]
// E111322	d[ 15]	E112322	d[ 33]	E113322	d[ 51]	E122322	d[ 69]	E123322	d[ 87]	E133322	d[105]	E211322	d[123]	E212322	d[141]	E213322	d[159]	E222322	d[177]	E223322	d[195]	E233322	d[213]	E311322	d[231]	E312322	d[249]	E313322	d[267]	E322322	d[285]	E323322	d[303]	E333322	d[321]
// E111323	d[ 16]	E112323	d[ 34]	E113323	d[ 52]	E122323	d[ 70]	E123323	d[ 88]	E133323	d[106]	E211323	d[124]	E212323	d[142]	E213323	d[160]	E222323	d[178]	E223323	d[196]	E233323	d[214]	E311323	d[232]	E312323	d[250]	E313323	d[268]	E322323	d[286]	E323323	d[304]	E333323	d[322]
// E111333	d[ 17]	E112333	d[ 35]	E113333	d[ 53]	E122333	d[ 71]	E123333	d[ 89]	E133333	d[107]	E211333	d[125]	E212333	d[143]	E213333	d[161]	E222333	d[179]	E223333	d[197]	E233333	d[215]	E311333	d[233]	E312333	d[251]	E313333	d[269]	E322333	d[287]	E323333	d[305]	E333333	d[323]

class tens6d
{
public:
	enum { NNZ = 324 };

	// default constructor
	tens6d(){}
	
	tens6d(const double g)
	{
		for (int i = 0; i < NNZ; i++)
			d[i] = g;
	}

	tens6d(double m[324])
	{
		for (int i = 0; i < NNZ; i++)
			d[i] = m[i];
	}

	// arithmetic operators
	tens6d operator + (const tens6d& t) const;
	tens6d operator - (const tens6d& t) const;
	tens6d operator * (double g) const;
	tens6d operator / (double g) const;

	// arithmetic assignment operators
	tens6d& operator += (const tens6d& t);
	tens6d& operator -= (const tens6d& t);
	tens6d& operator *= (double g);
	tens6d& operator /= (double g);

	// unary operators
	tens6d operator - () const;
	
	// initialize to zero
	void zero();

	void unit();

	tens3drs contract3rs(tens3drs H);


public:
	double d[NNZ];	// stored in column major order
};

// The following file contains the actual definition of the class functions
#include "tens6d.hpp"